parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"XaHR":[function(require,module,exports) {
var define;
var t;function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(){window.b2&&(window.b2.animateLoopId&&cancelAnimationFrame(window.b2.animateLoopId),window.b2.animateLoopId=null),String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return this.indexOf(t,e=e||0)===e});var n={_isInitializing:!1},o={isDeserializing:!1,isCalculatingBus:!1,images:{},registerImage:function(t,e,i,s,r){o.images[t]=new n.ImageAsset(t,e,i,s,r),ye(t)},getRegisteredImageNames:function(){return Object.keys(o.images)},unregisterImage:function(t){delete o.images[t]},getImageAsset:function(t){if("string"==typeof t)return o.images[t]},showVersion:function(t){o.isCtrlDown(t)&&t.shiftKey&&76==t.keyCode&&alert("b2 HTML5 "+n.Util.getVersion()+"\n"+s)},callLater:function(t,e,i,n){return setTimeout(function(){t.apply(e,i)},n||Ee.CALL_LATER_DELAY)},isEmptyObject:function(t){for(var e in t)return!1;return!0},xml:function(t){if(window.DOMParser)return(new DOMParser).parseFromString(t,"text/xml");var e=new ActiveXObject("Microsoft.XmlDOM");return e.async=!1,e.loadXml(t),e},num:function(t){return"number"==typeof t&&!isNaN(t)&&isFinite(t)},getter:function(t){var e=t.charAt(0).toUpperCase()+t.slice(1);return(/ble$/.test(t)||/ed$/.test(t)?"is":"get")+e},setter:function(t){return"set"+(t.charAt(0).toUpperCase()+t.slice(1))},_id:["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],id:function(){for(var t=[],e=0;e<32;e++)t[e]=this._id[Math.floor(16*n.Util.random())];return t[12]="4",t[16]=this._id[3&t[16]|8],t.join("")},keys:function(t){var e,i=new at;for(e in t)i.add(e);return i},es:["toString","toLocaleString","valueOf"],ip:function(t,e){var i="_"+e;t[o.getter(e)]=function(){return this[i]},t[o.setter(e)]=function(t){var n=this[i];this[i]=t,this.firePropertyChange(e,n,t)}},validateLicense:function(t){s=t,et()},ibool:function(t,e){var i="_"+e;t["is"+(e.charAt(0).toUpperCase()+e.slice(1))]=function(){return this[i]},t[o.setter(e)]=function(t){var n=this[i];this[i]=t,this.firePropertyChange(e,n,t)}},getValue:function(t,e,i){var n="get"+(o=e.charAt(0).toUpperCase()+e.slice(1)),o="is"+o;return i?"boolean"===i?t[o]():t[n]():t[n]?t[n]():t[o]?t[o]():t[e]},setValue:function(t,e,i){t["set"+e.charAt(0).toUpperCase()+e.slice(1)](i)},clone:function(t){if(!t)return null;var e,i={};for(e in t)i[e]=t[e];return i},cloneRect:function(t){return t?{x:t.x,y:t.y,width:t.width,height:t.height}:null},classCache:{},getClass:function(t){if(!(s=o.classCache[t])){for(var e=t.split("."),i=e.length,s=window,r=0;r<i;r++)(s=s[e[r]])||"b2"===e[r]&&(s=n);o.classCache[t]=s}return s},newInstance:function(t){var e=o.getClass(t)||window[t];if(!e)return null;var i=arguments.length,n=arguments;if(1===i)return new e;if(2===i)return new e(n[1]);if(3===i)return new e(n[1],n[2]);if(4===i)return new e(n[1],n[2],n[3]);if(5===i)return new e(n[1],n[2],n[3],n[4]);if(6===i)return new e(n[1],n[2],n[3],n[4],n[5]);if(7===i)return new e(n[1],n[2],n[3],n[4],n[5],n[6]);if(8===i)return new e(n[1],n[2],n[3],n[4],n[5],n[6],n[7]);throw"don't support args more than 7"},addMethod:function(t,e){var i,n=t.prototype;for(i in e)n[i]=e[i]},ext:function(t,e,i){var n,s;if("string"==typeof t&&(n=t,t=o.getClass(t)),e&&((s=function(){}).prototype=e.prototype,t.prototype=new s,(t.prototype.constructor=t).superClass=e.prototype,e.prototype.constructor==Object.prototype.constructor&&(e.prototype.constructor=e)),n&&(t.prototype.getClassName=function(){return n}),i){var r,a=t.prototype;for(r in i)g.ext(r,a,i);for(var h=o.es.length,l=0;l<h;l++)r=o.es[l],i.hasOwnProperty(r)&&!i.propertyIsEnumerable(r)&&(a[r]=i[r])}},setViewBounds:function(t,e){var i;t&&(t.adjustBounds?t.adjustBounds(e):(i=!(i=t.style)&&t.getView()?t.getView().style:i)&&(i.position="absolute",i.left=e.x+"px",i.top=e.y+"px",i.width=e.width+"px",i.height=e.height+"px"))},getImageSrc:function(t){var e=o.getImageAsset(t);return e?e.getSrc()?e.getSrc():e.getImage().getAttribute("src"):t},nextColorCount:0,nextColor:function(){return o.nextColorCount>=Ee.COLORS.length&&(o.nextColorCount=0),Ee.COLORS[o.nextColorCount++]},isCtrlDown:function(t){return t.ctrlKey||t.metaKey},isShiftDown:function(t){return t.shiftKey},isAltDown:function(t){return t.altKey},setText:function(t,e,i){i?u.isFirefox?t.textContent=e:t.innerText=e:t.innerHTML=e},fillDescendant:function(t,e){e.add(t),t.hasChildren()&&t.getChildren().forEach(function(t){o.fillDescendant(t,e)})}},s=(Date,"l=1.0\ntype=1\ngis=0\n3d=0\nstart=2018-06-10\nend=2018-10-01\nnote=This license applies to the evaluation version of b2. The License is limited to noncommercial use. Noncommercial use relates only to educational, research, personal or evaluation purposes. Any other use is commercial use. You may not use the Software in connection with any business activities.And You are not permitted to modify the software or attempt to decipher, decompile, disassemble or reverse engineer this Software.\nsignature=1f897768fb5142a58952c945765759d9ee5f8dbfc64dcb7159c4607d93b0ddb1479431f8a8bc32f35db3f2a881f80d98a0c7218266989c865824d8c7f46a24b9f3b28de5a23d661d85e6a0e35e35d0188bfbebd1665234c03a4cb073fc1ca11458703f348444c6870939edfb18e4291c67d44a1cfe2f1044176d28dc8ceb284d4e8a3b83e8e47676f371ceffee001326414ced054caf635889a79a50fdc37749f3ae6c96093f383ec29b31f694f991603fd1232aa130aa8bfe2a1765d52a011c4208e913ebf1d3135c22bda064d8dc34862b0f7af775453c3e4ab63f306ec03f8db8e26ab5d9fa71cb539c3463358758d78cb653a044899b243dcf2e8ac8a39c097ad71db019c58def664c5c314bce2ef0c8b0372a9bed4e7f1e98e92d6a89a3a16d89ad9b8884c972e7cc2797d24509943753d2f65a89ba20a1c539e44863ee463149e897078200c9d89f7986837087e756b5fd41009be8b06a24817a9e4350929916da11ea9657077276da3c05255fcbd5a3e2894954f050f968b42fe00ec63bb10e1bc63c5c1788440272dd154631f63044347bf9316e70a83a76644d18ec98de6bc1a1d46bdf303191261c173288bec19dbc0cef94d4e1f175f54f23368042ccf4eefe2bd0a8fd0e4b7bc544d6d9a6e92b629d730e44db44f41e4b0c10395b54d0a5f725afb78f19d74bca148f3b342ff219a6c82d892f5c9d106b3a96f14d4112398afc1f57ae46123cda51be78cca6e7d4f70c7eb1b0abd728623df5805066832cacec35536c265463519f8ae2bddea39fdb9a8e0b5d59f9cfbdf19ffb4ba47d5e729ebe8b81c6168dd2e44138a0cbf98d940345c3e8a831a0182e6fc44859be8d541079d4a238b2cbec386085dac25f80fcb4cf382976374e6c232468");"function"==typeof t?t(function(){return n}):"object"==("undefined"==typeof exports?"undefined":e(exports))&&(module.exports=n),window&&(window.b2=n,window._b2=o,window.blood2d=n),n.animate={},n.network={},n.network.interaction={},n.controls={},n.charts={},n.layout={};var r,a,h=window.navigator,l=window.document,c=window.Image;window.document||(a=!0,c=(r=function(){}).Image,h={userAgent:""},l={});var d,u=(v={},d=h.userAgent.toLowerCase(),v.isOpera=/opera/.test(d),v.isIE=/msie/.test(d)||/trident/.test(d)||/edge/.test(d),v.isFirefox=/firefox/i.test(d),v.isChrome=/chrome/i.test(d),v.isSafari=!v.isChrome&&/safari/i.test(d),v.isIPhone=/iphone/.test(d),v.isIPod=/ipod/.test(d),v.isIPad=/ipad/.test(d),v.isAndroid=/android/i.test(d),v.isWebOS=/webos/i.test(d),v.isMSTouchable=v.isIE&&(h.msMaxTouchPoints&&1<h.msMaxTouchPoints||h.maxTouchPoints&&1<h.maxTouchPoints),v.isTouchable="ontouchend"in l||v.isMSTouchable,v);o.ua=u;var g={__accessor:function(t,e){for(var i=e.__accessor,n=i.length,s=0;s<n;s++)o.ip(t,i[s])},__bool:function(t,e){for(var i=e.__bool,n=i.length,s=0;s<n;s++)o.ibool(t,i[s])},__client:function(t,e){t.getClient=function(t){return this._clientMap[t]},t.setClient=function(t,e){var i=this._clientMap[t];return null==e?delete this._clientMap[t]:this._clientMap[t]=e,this.firePropertyChange("C:"+t,i,e)&&this.onClientChanged(t,i,e),this},t.getClientProperties=function(){return o.keys(this._clientMap)},t.getClientMap=function(){return this._clientMap},t.onClientChanged=function(t,e,i){}},__style:function(t,e){t.getStyle=function(t){var e=this._styleMap[t];return null==e?Ce._m[t]:e},t.setStyle=function(t,e){var i=this._styleMap[t];return null==e?delete this._styleMap[t]:this._styleMap[t]=e,this.firePropertyChange("S:"+t,i,e)&&this.onStyleChanged(t,i,e),this},t.getStyleProperties=function(){return o.keys(this._styleMap)},t.onStyleChanged=function(t,e,i){}},__new:function(t,e){t.newInstance=function(){var t=o.getClass(this.getClassName());if(!t)return null;var e=arguments.length,i=arguments;if(0===e)return new t;if(1===e)return new t(i[0]);if(2===e)return new t(i[0],i[1]);if(3===e)return new t(i[0],i[1],i[2]);if(4===e)return new t(i[0],i[1],i[2],i[3]);if(5===e)return new t(i[0],i[1],i[2],i[3],i[4]);if(6===e)return new t(i[0],i[1],i[2],i[3],i[4],i[5]);if(7===e)return new t(i[0],i[1],i[2],i[3],i[4],i[5],i[6]);throw"don't support args more than 7"}},__property:function(t,e){t.getValue=function(t,e){return"accessor"===this._propertyType?o.getValue(t,this._propertyName):"style"===this._propertyType&&t.getStyle?t.getStyle(this._propertyName):"client"===this._propertyType&&t.getClient?t.getClient(this._propertyName):"field"===this._propertyType?t[this._propertyName]:null},t.setValue=function(t,e,i){if("accessor"===this._propertyType)t[o.setter(this._propertyName)](e);else{if("style"===this._propertyType&&t.setStyle)return t.setStyle(this._propertyName,e);if("client"===this._propertyType&&t.setClient)return t.setClient(this._propertyName,e);"field"===this._propertyType&&(t[this._propertyName]=e)}}},map:{__accessor:1,__bool:1,__client:1,__style:1,__new:1,__tree:1,__property:1},ext:function(t,e,i){1===g.map[t]?g[t](e,i):e[t]=i[t]}};o.extend=g;var _=o.Matrix=function(t,e,i,n,o,s){this.setMatrix(t,e,i,n,o,s)};_.identity=function(){return new _(1,0,0,1,0,0)},_.prototype.setMatrix=function(t,e,i,n,o,s){this._m11=t,this._m12=e,this._m21=i,this._m22=n,this._offsetX=o,this._offsetY=s,(this._type=0)!=this._m21||0!=this._m12?this._type=4:(1==this._m11&&1==this._m22||(this._type=2),0==this._offsetX&&0==this._offsetY||(this._type|=1),0==(3&this._type)&&(this._type=0))},_.prototype.transform=function(){var t=2===arguments.length?{x:arguments[0],y:arguments[1]}:arguments[0];if(!t||!o.num(t.x)||!o.num(t.y))throw"arguments should contain x, y";switch(this._type){case 0:return{x:t.x,y:t.y};case 1:return{x:this._offsetX+t.x,y:this._offsetY+t.y};case 2:return{x:t.x*this._m11,y:t.y*this._m22};case 3:return{x:t.x*this._m11+this._offsetX,y:t.y*this._m22+this._offsetY}}return{x:this._m11*t.x+t.y*this._m21+this._offsetX,y:this._m22*t.y+t.x*this._m12+this._offsetY}},_.prototype.translate=function(t,e){this.multiply(new _(1,0,0,1,t,e))},_.prototype.scale=function(t,e){this.multiply(new _(t,0,0,e,0,0))},_.prototype.rotate=function(t,e,i){t=t*Math.PI/180;var n=Math.sin(t);t=Math.cos(t);this.multiply(new _(t,n,-n,t,e*(1-t)+i*n,i*(1-t)-e*n))},_.prototype.skew=function(t,e){this.multiply(new _(1,Math.tan(e*Math.PI/180),Math.tan(t*Math.PI/180),1,0,0))},_.prototype.multiply=function(t){var e=this,i=t,n=e._type,o=i._type;if(0!=o)if(0==n)e.setMatrix(i._m11,i._m12,i._m21,i._m22,i._offsetX,i._offsetY);else if(1==o)e._offsetX+=i._offsetX,e._offsetY+=i._offsetY,4!=n&&(e._type|=1);else if(1==n){var s=e._offsetX;t=e._offsetY;e.setMatrix(i._m11,i._m12,i._m21,i._m22,i._offsetX,i._offsetY),e._offsetX=s*i._m11+t*i._m21+i._offsetX,e._offsetY=s*i._m12+t*i._m22+i._offsetY,e._type=4==o?4:3}else switch(n<<4|o){case 34:return e._m11*=i._m11,void(e._m22*=i._m22);case 35:return e._m11*=i._m11,e._m22*=i._m22,e._offsetX=i._offsetX,e._offsetY=i._offsetY,void(e._type=3);case 36:case 52:case 66:case 67:case 68:return void e.setMatrix(e._m11*i._m11+e._m12*i._m21,e._m11*i._m12+e._m12*i._m22,e._m21*i._m11+e._m22*i._m21,e._m21*i._m12+e._m22*i._m22,e._offsetX*i._m11+e._offsetY*i._m21+i._offsetX,e._offsetX*i._m12+e._offsetY*i._m22+i._offsetY);case 50:return e._m11*=i._m11,e._m22*=i._m22,e._offsetX*=i._m11,void(e._offsetY*=i._m22);case 51:return e._m11*=i._m11,e._m22*=i._m22,e._offsetX=i._m11*e._offsetX+i._offsetX,void(e._offsetY=i._m22*e._offsetY+i._offsetY);default:console.log("Matrix multiply hit an invalid case: "+combinedType)}};var f={getDistance:function(t,e){var i=e.x-t.x;t=e.y-t.y;return Math.sqrt(i*i+t*t)},getCenterPoint:function(t,e){return t&&e?{x:(t.x+e.x)/2,y:(t.y+e.y)/2}:null==e&&t.width?{x:t.x+t.width/2,y:t.y+t.height/2}:void 0},isPointInPolygon:function(t,e){var i=0,n=0,o=!1,s=(t=t._as||t).length;for(i=0,n=s-1;i<s;n=i++){var r=t[i],a=t[n];r.y>e.y!=a.y>e.y&&e.x<(a.x-r.x)*(e.y-r.y)/(a.y-r.y)+r.x&&(o=!o)}return o},unionRect:function(t,e){if(t&&!e)return o.cloneRect(t);if(!t&&e)return o.cloneRect(e);if(t&&e){var i=Math.min(t.x,e.x),n=Math.min(t.y,e.y),s=Math.max(t.x+t.width,e.x+e.width)-i;e=Math.max(t.y+t.height,e.y+e.height)-n;return t.x=i,t.y=n,t.width=s,t.height=e,t}return null},intersects:function(t,e){if(!t||!e)return!1;var i=e.width,n=e.height,o=t.width,s=t.height;if(o<=0||s<=0||i<=0||n<=0)return!1;var r=e.x,a=e.y;e=t.x;return s+=t=t.y,i+=r,n+=a,((o+=e)<e||r<o)&&(s<t||a<s)&&(i<r||e<i)&&(n<a||t<n)},intersection:function(t,e){if(!t||!e)return!1;var i=e.x,n=e.y,o=t.x,s=t.y,r=i;r+=e.width;var a=n;a+=e.height;var h=o;e=s;return(h+=t.width)<r&&(r=h),(e+=t.height)<a&&(a=e),a-=n=n<s?s:n,0==(r-=i=i<o?o:i)||0===a?null:{x:i,y:n,width:r,height:a}},contains:function(t,e){var i=e.x,n=e.y,o=e.width,s=e.height,r=t.width,a=t.height;if((r|a|o|s)<0)return!1;if(e=t.x,t=t.y,i<e||n<t)return!1;if(r+=e,(o+=i)<=i){if(e<=r||r<o)return!1}else if(e<=r&&r<o)return!1;if(a+=t,(s+=n)<=n){if(t<=a||a<s)return!1}else if(t<=a&&a<s)return!1;return!0},getLinePoints:function(t){if(!t)return null;var e=new at;return t.forEach(function(t){e.addAll(t)}),e},getLineRect:function(t){return t=f.getLinePoints(t),f.getRect(t)},getRect:function(t,e){if(!t)return null;var i=(t=t._as?t._as:t).length;if(i<=0)return null;var n=t[0];e=e||{x:null,y:null,width:0,height:0};for(var o,s,r,a,h=0;h<i;h++)(n=t[h])instanceof at?f.getRect(n,e):(null==e.x&&(e.x=n.x,e.y=n.y),o=Math.min(e.x,n.x),s=Math.min(e.y,n.y),r=Math.max(e.x+e.width,n.x),a=Math.max(e.y+e.height,n.y),e.x=o,e.y=s,e.width=r-o,e.height=a-s);return e},addPadding:function(t,e,i,n){n=n||-1;var o=e.getStyle(i)*n;0!=o&&f.grow(t,o,o),0!=(o=e.getStyle(i+".left")*n)&&(t.x-=o,t.width+=o),0!=(o=e.getStyle(i+".right")*n)&&(t.width+=o),0!=(o=e.getStyle(i+".top")*n)&&(t.y-=o,t.height+=o),0!=(o=e.getStyle(i+".bottom")*n)&&(t.height+=o),t.width<0&&(t.width=-t.width,t.x-=t.width),t.height<0&&(t.height=-t.height,t.y-=t.height)},grow:function(t,e,i){if(null==t)return null;null==i&&(i=e);var n=t.width+e+e;if(!(n<0)){var o=t.height+i+i;if(!(o<0))return t.x-=e,t.y-=i,t.width=n,t.height=o,t}},containsPoint:function(t,e,i){return arguments.length<3&&(i=e.y,e=e.x),!(!t||e<t.x||i<t.y||e>t.x+t.width||i>t.y+t.height)},getHotSpot:function(t,e,i,n,o){if("oval"===o)return{x:t+.5*i+.35*i,y:e+n/2-Math.sqrt(.1275)*n};if("circle"===o){var s=t+i/2,r=e+n/2;return e=r-(o=Math.min(i,n)/2),r=(i=2*o)/2,{x:(t=s-o)+i/2+(o=r*(o=(n=2*o)/2)/Math.sqrt(r*r+o*o)),y:e+n/2-o}}return e={x:t+i,y:e},3<i&&(e.x-=3),3<n&&(e.y+=3),e},getCircleRect:function(t){var e=Math.min(t.width,t.height)/2;return{x:t.x+t.width/2-e,y:t.y+t.height/2-e,width:2*e,height:2*e}},getEllipsePoint:function(t,e){if(!t||!e)return null;var i=t.x+t.width/2,n=t.y+t.height/2,o=e.x-i,s=e.y-n;e=t.width/2,t=t.height/2,e=Math.sqrt(1/(1/e/e+s*s/o/o/t/t));return{x:i+(e=o<0?-e:e),y:n+(0==o?0<s?t:-t:e*s/o)}},createMatrix:function(t,e,i){var n=Math.sin(t);t=Math.cos(t);return new _(t,n,-n,t,e*(1-t)+i*n,i*(1-t)-e*n)},calculatePointInfoAlongLineBySegments:function(t,e,i,n,o){return f.calculatePointInfoAlongLine(f.getPointObject(t,e),i,n,o)},calculatePointInfoAlongLine:function(t,e,i,n){if(e=void 0===e||e,i=i||0,n=n||0,!t||t.size()<2)throw"must more than two points";if(!e){var o=f.reversePath(t);return f.calculatePointInfoAlongLine(o,!0,i,n)}for(var s,r,a,h,l,c=0,d=(t=t._as?t._as:t).length,u=0;u<d;u++)if(a=t[u],0!=u){if(i<=0){s=l=f.calculatePointInfoOnStraightLine(f._getPoint(h),f._getControlPoint(a),i,n);break}if(i<c+(r=f._getLength(a,h))){s=l=f.getPathInfo(a,h,i-c,n,r);break}c+=r,h=a}else h=a;return null==s&&(h=t[d-1],e=f._getPoint(h),o=(h=h instanceof at?h._as:h)instanceof Array?f._getControlPoint(h):f._getPoint(t[d-2]),o=Math.atan2(e.y-o.y,e.x-o.x),(l=f.transformPoint(e,o,i-c,n)).angle=o,s=l),s},reversePath:function(t){for(var e,i=new at,n=null,o=(t=t._as?t._as:t).length-1;0<=o;o--)e=t[o],i.add(f._getReversePath(e,n)),n=e;return i},_getPoint:function(t){return(t=t._as?t._as:t)instanceof Array?t[t.length-1]:t},_getControlPoint:function(t){return(t=t._as?t._as:t)instanceof Array?t[t.length-2]:t},_getReversePath:function(t,e){return t=f._getPoint(t),null!=(e=e&&e._as?e._as:e)&&e instanceof Array?2==e.length?new at([e[0],t]):new at([e[1],e[0],t]):t},_getLength:function(t,e){var i=f._getPoint(e);e=f._getPoint(t);return(t=t instanceof at?t._as:t)instanceof Array?f.calculateCurveLength(i,t,1):(t=e.y-i.y,i=e.x-i.x,Math.sqrt(i*i+t*t))},getPathInfo:function(t,e,i,n,o){var s,r=f._getPoint(e),a=f._getPoint(t);return(t=t instanceof at?t._as:t)instanceof Array?(o<0&&(o=f._getLength(t,e)),r=(s=f.calculatePointInfoOnCurveLine(r,t,i/o)).point,s=s.angle,i=0):s=Math.atan2(a.y-r.y,a.x-r.x),f.transformPoint(r,s,i,n)},transformPoint:function(t,e,i,n){return n={x:i,y:n},(n=f.createMatrix(e,0,0).transform(n)).x+=t.x,n.y+=t.y,{point:n,angle:e}},calculatePointInfoOnStraightLine:function(t,e,i,n){return e=Math.atan2(e.y-t.y,e.x-t.x),f.transformPoint(t,e,i,n)},calculatePointInfoOnCurveLine:function(t,e,i){if(i<0||1<i)throw"Illegal arguments";return 2==(e=e._as?e._as:e).length?f._calculatePointInfoOnCurveLine2(t,e[0],e[1],i):f._calculatePointInfoOnCurveLine3(t,e[0],e[1],e[2],i)},_calculatePointInfoOnCurveLine2:function(t,e,i,n){var o=2*(t.x+i.x-2*e.x)*n+2*e.x-2*t.x,s=2*(t.y+i.y-2*e.y)*n+2*e.y-2*t.y;o=Math.atan2(s,o);return{point:{x:(t.x+i.x-2*e.x)*n*n+(2*e.x-2*t.x)*n+t.x,y:(t.y+i.y-2*e.y)*n*n+(2*e.y-2*t.y)*n+t.y},angle:o}},_calculatePointInfoOnCurveLine3:function(t,e,i,n,o){var s=1-o,r=s*s*s,a=o*o*o;return{point:{x:r*t.x+3*o*s*s*e.x+3*o*o*s*i.x+a*n.x,y:r*t.y+3*o*s*s*e.y+3*o*o*s*i.y+a*n.y},angle:Math.atan2(f._bezeSpeedY(t,e,i,n,o),f._bezeSpeedX(t,e,i,n,o))}},calculateCurveLength:function(t,e,i){return 2==(e=e._as?e._as:e).length?f._calculateCurveLength(t,e[0],e[1],i):f._calculateBezierCurveLength(t,e[0],e[1],e[2],i)},_calculateCurveLength:function(t,e,i,n){if(n<=0||1<n)return 0;for(var o,s,r,a=Math.floor(n*(Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))+Math.sqrt((i.x-e.x)*(i.x-e.x)+(i.y-e.y)*(i.y-e.y)))/2),h=0,l=n/(a=a<=0?1:a),c=0;c<a;c++)o=2*(t.x+i.x-2*e.x)*(r=l*c)+2*e.x-2*t.x,s=2*(t.y+i.y-2*e.y)*r+2*e.y-2*t.y,o*=l,s*=l,h+=Math.sqrt(o*o+s*s);return h},_calculateBezierCurveLength:function(t,e,i,n,o){if(o<=0||1<o)return 0;var s=Math.floor(1e4*o);if(1==(1&s)&&s++,0==s)return 0;for(var r=Math.floor(s/2),a=0,h=0,l=o/s,c=0;c<r;c++)a+=f._bezeSpeed(t,e,i,n,(2*c+1)*l);for(c=1;c<r;c++)h+=f._bezeSpeed(t,e,i,n,2*c*l);return(f._bezeSpeed(t,e,i,n,0)+f._bezeSpeed(t,e,i,n,1)+2*h+4*a)*l/3},_bezeSpeedX:function(t,e,i,n,o){var s=1-o;return-3*t.x*s*s+3*e.x*s*s-6*e.x*s*o+6*i.x*s*o-3*i.x*o*o+3*n.x*o*o},_bezeSpeedY:function(t,e,i,n,o){var s=1-o;return-3*t.y*s*s+3*e.y*s*s-6*e.y*s*o+6*i.y*s*o-3*i.y*o*o+3*n.y*o*o},_bezeSpeed:function(t,e,i,n,o){var s=f._bezeSpeedX(t,e,i,n,o);o=f._bezeSpeedY(t,e,i,n,o);return Math.sqrt(s*s+o*o)},getPointObject:function(t,e){if(e&&0!=e.size()){var i=new at;e=e._as,t=t._as;for(var n,o=0,s=e.length,r=t.length,a=0;a<s&&(n=e[a],o!=r);a++)"cubicto"===n?o<r-2&&i.add([t[o++],t[o++],t[o++]]):"quadto"===n?o<r-1&&i.add([t[o++],t[o++]]):o<r&&i.add(t[o++]);for(;o<r;o++)i.add(t[o]);return i}return t},calculateLineLength:function(t,e){if(!t||t.size()<2)return 0;if(e)return f.calculateLineLength(f.getPointObject(t,e));for(var i,n,o,s,r,a,h=(t=t._as).length,l=0,c=0;c<h;c++)o=t[c],0!=c?(i=(n=(n=o)instanceof at?n._as:n)instanceof Array?(s=f.calculateCurveLength(i,n,1),n[n.length-1]):(a=o.y-i.y,r=o.x-i.x,s=Math.sqrt(r*r+a*a),n),l+=s):i=o;return l},toDegrees:function(t){return 180*t/Math.PI},toRadians:function(t){return t/180*Math.PI},getRadiansBetweenLines:function(t,e){return Math.atan2(e.y-t.y,e.x-t.x)},getAngle:function(t,e){return t.x===e.x?e.y===t.y?0:e.y>t.y?Math.PI/2:-Math.PI/2:Math.atan((e.y-t.y)/(e.x-t.x))},pointInPolygonFlat:function(t,e,i,n){for(var o=t[0],s=t[1],r=!1,a=((n=void 0===n?e.length:n)-(i=void 0===i?0:i))/2,h=0,l=a-1;h<a;l=h++){var c=e[i+2*h+0],d=e[i+2*h+1],u=e[i+2*l+0],g=e[i+2*l+1];s<d!=s<g&&o<(u-c)*(s-d)/(g-d)+c&&(r=!r)}return r},pointInPolygon:function(t,e,i,n){return 0<e.length&&Array.isArray(e[0])?this.pointInPolygonNested(t,e,i,n):this.pointInPolygonFlat(t,e,i,n)},pointInPolygonNested:function(t,e,i,n){for(var o=+t[0],s=+t[1].toFixed(4),r=!1,a=(n=void 0===n?e.length:n)-(i=void 0===i?0:i),h=!1,l=!1,c=[],d=[],u=0,g=a-1;u<a;g=u++)c.push(e[u+i][0]),d.push(+e[u+i][1].toFixed(4));for(Math.max.apply(Math,c)<=o&&(h=!0),Math.max.apply(Math,d)<=s&&(l=!0),u=0,g=a-1;u<a;g=u++){var _=e[u+i][0],f=+e[u+i][1].toFixed(4),A=e[g+i][0],y=+e[g+i][1].toFixed(4);(h?s<f!=s<y&&o<=(A-_)*(s-f)/(y-f)+_:l?o<_!=o<A&&s<=(y-f)*(o-_)/(A-_)+f:s<f!=s<y&&o<(A-_)*(s-f)/(y-f)+_)&&(r=!r)}return r}};o.math=f;var A={getPoints:function(t){var e=new at;return t.forEach(function(t){e.add({x:t.x,y:t.y}),e.add({x:t.x+t.width,y:t.y+t.height}),e.add({x:t.x+t.width,y:t.y}),e.add({x:t.x,y:t.y+t.height})}),e},rectangle:function(t){var e;return t.forEach(function(t){e=f.unionRect(e,t)}),e},oval:function(t){var e=A.rectangle(t),i=0,n=e.height/e.width,o=n*n,s=e.x+e.width/2,r=e.y+e.height/2;return A.getPoints(t).forEach(function(t){var e=t.x-s;t=t.y-r;i<(t=e*e+t*t/o)&&(i=t)}),n*=i=Math.sqrt(i),{x:s-i,y:r-n,width:2*i,height:2*n}},circle:function(t){var e=A.rectangle(t),i=0,n=e.x+e.width/2,o=e.y+e.height/2;return A.getPoints(t).forEach(function(t){var e=t.x-n;t=t.y-o;i<(t=e*e+t*t)&&(i=t)}),i=Math.sqrt(i),{x:n-i,y:o-i,width:2*i,height:2*i}},roundrect:function(t){var e=A.rectangle(t);t=Math.min(e.width,e.height)/16;return f.grow(e,t,t),e},star:function(t){return t=A.rectangle(t),f.grow(t,t.width,t.height),t},triangle:function(t){return(t=A.rectangle(t)).x-=t.width/2,t.width*=2,t.y-=t.height,t.height*=2,t},hexagon:function(t){return(t=A.rectangle(t)).x-=t.width/2,t.width*=2,t},pentagon:function(t){return(t=A.rectangle(t)).x-=t.width/6,t.width+=t.width/3,t.y-=t.height/4,t.height+=t.height/4,t},diamond:function(t){return(t=A.rectangle(t)).x-=t.width/2,t.width+=t.width,t.y-=t.height/2,t.height+=t.height,t},trapezoidal:function(t){return(t=A.rectangle(t)).x-=t.width/2,t.width+=t.width,t.y-=t.height/2,t.height+=t.height,t}};o.group=A;var y={"topleft.topleft":function(t,e){return{x:t.x-e.width,y:t.y-e.height}},"topleft.topright":function(t,e){return{x:t.x,y:t.y-e.height}},"top.top":function(t,e){return{x:t.x+t.width/2-e.width/2,y:t.y-e.height}},"topright.topleft":function(t,e){return{x:t.x+t.width-e.width,y:t.y-e.height}},"topright.topright":function(t,e){return{x:t.x+t.width,y:t.y-e.height}},topleft:function(t,e){return{x:t.x-e.width/2,y:t.y-e.height/2}},top:function(t,e){return{x:t.x-e.width/2+t.width/2,y:t.y-e.height/2}},topright:function(t,e){return{x:t.x-e.width/2+t.width,y:t.y-e.height/2}},"topleft.bottomleft":function(t,e){return{x:t.x-e.width,y:t.y}},"topleft.bottomright":function(t,e){return{x:t.x,y:t.y}},"top.bottom":function(t,e){return{x:t.x+t.width/2-e.width/2,y:t.y}},"topright.bottomleft":function(t,e){return{x:t.x-e.width+t.width,y:t.y}},"topright.bottomright":function(t,e){return{x:t.x+t.width,y:t.y}},"left.left":function(t,e){return{x:t.x-e.width,y:t.y+t.height/2-e.height/2}},left:function(t,e){return{x:t.x-e.width/2,y:t.y+t.height/2-e.height/2}},"left.right":function(t,e){return{x:t.x,y:t.y+t.height/2-e.height/2}},center:function(t,e){return{x:t.x+t.width/2-e.width/2,y:t.y+t.height/2-e.height/2}},"right.left":function(t,e){return{x:t.x+t.width-e.width,y:t.y+t.height/2-e.height/2}},right:function(t,e){return{x:t.x+t.width-e.width/2,y:t.y+t.height/2-e.height/2}},"right.right":function(t,e){return{x:t.x+t.width,y:t.y+t.height/2-e.height/2}},"bottomleft.topleft":function(t,e){return{x:t.x-e.width,y:t.y+t.height-e.height}},"bottomleft.topright":function(t,e){return{x:t.x,y:t.y+t.height-e.height}},"bottom.top":function(t,e){return{x:t.x+t.width/2-e.width/2,y:t.y+t.height-e.height}},"bottomright.topleft":function(t,e){return{x:t.x+t.width-e.width,y:t.y+t.height-e.height}},"bottomright.topright":function(t,e){return{x:t.x+t.width,y:t.y+t.height-e.height}},bottomleft:function(t,e){return{x:t.x-e.width/2,y:t.y+t.height-e.height/2}},bottom:function(t,e){return{x:t.x+t.width/2-e.width/2,y:t.y+t.height-e.height/2}},bottomright:function(t,e){return{x:t.x+t.width-e.width/2,y:t.y+t.height-e.height/2}},"bottomleft.bottomleft":function(t,e){return{x:t.x-e.width,y:t.y+t.height}},"bottomleft.bottomright":function(t,e){return{x:t.x,y:t.y+t.height}},"bottom.bottom":function(t,e){return{x:t.x+t.width/2-e.width/2,y:t.y+t.height}},"bottomright.bottomleft":function(t,e){return{x:t.x+t.width-e.width,y:t.y+t.height}},"bottomright.bottomright":function(t,e){return{x:t.x+t.width,y:t.y+t.height}},get:function(t,e,i){if(!e)throw"refRect can not be null";i=i||{width:0,height:0};var n=y[t];if(n)return n(e,i);throw"Can not resolve '"+t+"' position"}};o.position=y;var p={preventDefault:function(t){Ee.KEEP_DEFAULT_FUNCTION(t)||(t.preventDefault?t.preventDefault():t.preventManipulation?t.preventManipulation():t.returnValue=!1)},insertAfter:function(t,e){return e?e.parentNode.insertBefore(t,e.nextSibling):t.parentNode.insertBefore(t,t.parentNode.firstChild),t},forEach:function(t,e,i){if(p.isVisible(t)){for(var n=t.childNodes.length,o=0;o<n;o++)p.forEach(t.childNodes[o],e,i);i?e.call(i,t):e(t)}},setVisible:function(t,e){t.style.display=e?"block":"none"},isVisible:function(t){return"style"in t&&"none"!==t.style.display},release:function(t){for(var e=t.childNodes.length,i=0;i<e;i++)p.release(t.childNodes[i]);0<e&&p.clear(t),t._pool&&t._pool.release(t)},clear:function(t){for(;t.firstChild;)t.removeChild(t.firstChild)},setZoom:function(t,e){var i,n=t.style;n.setProperty&&(u.isFirefox?(n.setProperty("-moz-transform","scale("+e+")",null),n.setProperty("-moz-transform-origin","0 0",null)):u.isOpera?(n.setProperty("-o-transform","scale("+e+")",null),n.setProperty("-o-transform-origin","0 0",null)):u.isChrome||u.isSafari?(n.setProperty("-webkit-transform","scale("+e+")",null),n.setProperty("-webkit-transform-origin","0 0",null),i=null,t._webkitInvaildateDiv?i=t._webkitInvaildateDiv:(i=l.createElement("div"),t._webkitInvaildateDiv=i),i.parentNode&&i.parentNode==t?t.removeChild(i):t.appendChild(i)):u.isIE?(n.setProperty("-ms-transform","scale("+e+")",null),n.setProperty("-ms-transform-origin","0 0",null)):(n.setProperty("transform","scale("+e+")",null),n.setProperty("transform-origin","0 0",null)))},setRotate:function(t,e){var i,n=t.style;n.setProperty&&(u.isFirefox?(n.setProperty("-moz-transform","scale("+e+")",null),n.setProperty("-moz-transform-origin","0 0",null)):u.isOpera?(n.setProperty("-o-transform","scale("+e+")",null),n.setProperty("-o-transform-origin","0 0",null)):u.isChrome||u.isSafari?(n.setProperty("-webkit-transform","scale("+e+")",null),n.setProperty("-webkit-transform-origin","0 0",null),i=null,t._webkitInvaildateDiv?i=t._webkitInvaildateDiv:(i=l.createElement("div"),t._webkitInvaildateDiv=i),i.parentNode&&i.parentNode==t?t.removeChild(i):t.appendChild(i)):u.isIE?(n.setProperty("-ms-transform","scale("+e+")",null),n.setProperty("-ms-transform-origin","0 0",null)):(n.setProperty("transform","scale("+e+")",null),n.setProperty("transform-origin","0 0",null)))},setCSSStyle:function(t,e,i){t.style.setProperty(e,i,null)},removeCSSStyle:function(t,e){t.style.removeProperty(e)},getCSSStyle:function(t,e){return t.style.getPropertyValue(e)},setBorderRaidus:function(t,e){u.isFirefox?t.style.MozBorderRadius=e:t.style.borderRadius=e},createSelect:function(t,e){var i,n,o,s=l.createElement("select");if(Array.isArray(t))for(i=0;i<t.length;i++)n=t[i],(o=l.createElement("option")).innerHTML=n,o.setAttribute("value",n),n===e&&o.setAttribute("selected","true"),s.appendChild(o);else for(i=0;i<t.values.length;i++)n=t.values[i],(o=l.createElement("option")).innerHTML=t.map[n],o.setAttribute("value",n),n===e&&o.setAttribute("selected","true"),s.appendChild(o);return s},createImg:function(t){var e=l.createElement("img");return e.style.position="absolute","string"==typeof t&&e.setAttribute("src",t),e},createView:function(t,e){var i=l.createElement("div");return i.style.position=Ee.VIEW_POSITION,i.style.fontSize=Ee.VIEW_FONT_SIZE,i.style.fontFamily=Ee.VIEW_FONT_FAMILY,i.style.cursor="default",i.style.outline="none",i.style.textAlign="left",i.style.msTouchAction="none",i.style.touchAction="none",i.tabIndex=0,e||(i.onmousedown=p.preventDefault),i.style.setProperty&&(i.style.setProperty("-khtml-user-select","none",null),i.style.setProperty("-webkit-user-select","none",null),i.style.setProperty("-moz-user-select","none",null),i.style.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",null)),t&&(i.style.overflow=t),i},createDiv:function(){var t=l.createElement("div");return t.style.position="absolute",t.style.msTouchAction="none",t.style.touchAction="none",t},createCanvas:function(t,e){if(t=t||0,e=e||0,a)return new r(t,e);var i=l.createElement("canvas");return i.style.position="absolute",i.style.msTouchAction="none",i.style.touchAction="none",i.width=t,i.height=e,i},setCanvas:function(t,e,i,n,o){2===arguments.length&&(i=e.y,n=e.width,o=e.height,e=e.x),t.style.left=e+"px",t.style.top=i+"px",t.setAttribute("width",n),t.setAttribute("height",o),t._viewRect={x:e,y:i,width:n,height:o};var s=t.getContext("2d");return 0!==s.shadowBlur&&(s.shadowOffsetX=0,s.shadowOffsetY=0,s.shadowBlur=0,s.shadowColor="rgba(0,0,0,0.0)"),s.clearRect(0,0,n,o),s.translate(-e,-i),s},setImg:function(t,e,i){t.setAttribute("src",e),t.style.left=i.x+"px",t.style.top=i.y+"px",t.style.width=i.width+"px",t.style.height=i.height+"px",t._viewRect=o.clone(i)},setDiv:function(t,e,i,n,s){n=o.num(n)?n:0,t.style.left=e.x-n+"px",t.style.top=e.y-n+"px",t.style.width=e.width+"px",t.style.height=e.height+"px",t._viewRect=o.clone(e),t.style.backgroundColor=i||"",t.style.border=0<n?n+"px "+s+" solid":""},changeTypeForMS:function(t){var e,i=t;return 0!==t.indexOf("MSPointer")&&0!==t.indexOf("pointer")||(0===t.indexOf("MSPointer")?(e=t.substring(9,10).toLowerCase(),e+=t.substring(10)):e=t.substring(7,8),window.MSPointerEvent?i="MSPointer"+e.substring(0,1).toUpperCase()+e.substring(1):window.PointerEvent&&(i="pointer"+e)),i},addEventListener:function(t,e,i,n){var o,s="_"+(t=this.changeTypeForMS(t))+"_";n[s]||((o=function(t){o.instance[o.method](t)}).method=e,(o.instance=n)[s]=o,i.addEventListener(t,o,!1))},removeEventListener:function(t,e,i){var n="_"+(t=this.changeTypeForMS(t))+"_",o=i[n];o&&(e.removeEventListener(t,o,!1),delete i[n])},isValidEvent:function(t,e){if(!e)return!1;if(e.target===t)if(u.isFirefox){if(t.clientHeight<t.scrollHeight&&e.layerX<25)return!1;if(t.clientWidth<t.scrollWidth&&e.layerY<25)return!1}else if(e.offsetX>t.clientWidth||e.offsetY>t.clientHeight)return!1;return!0},getLogicalPoint:function(t,e,i,n){i=i||1;var o=t.getBoundingClientRect();if(u.isTouchable&&e.changedTouches&&0<e.changedTouches.length){var s=e.changedTouches[0],r=u.isAndroid?0:gt.scrollLeft(),a=u.isAndroid?0:gt.scrollTop();a={x:(s.clientX+t.scrollLeft-o.left-r)/i,y:(s.clientY+t.scrollTop-o.top-a)/i}}else{if(!p.isValidEvent(t,e))return null;a={x:(e.clientX-o.left+t.scrollLeft)/i,y:(e.clientY-o.top+t.scrollTop)/i}}return a},handle_mousedown:function(t,e){p.target&&p.handle_mouseup(e),window.addEventListener("mousemove",p.handle_mousemove,!1),window.addEventListener("mouseup",p.handle_mouseup,!1),p.target=t},handle_mousemove:function(t){p.target.handle_mousemove&&p.target.handle_mousemove(t),p.target.handleMouseMove&&p.target.handleMouseMove(t)},handle_mouseup:function(t){p.target.handle_mouseup&&p.target.handle_mouseup(t),p.target.handleMouseUp&&p.target.handleMouseUp(t),window.removeEventListener("mousemove",p.handle_mousemove,!1),window.removeEventListener("mouseup",p.handle_mouseup,!1),delete p.target},getClientPoint:function(t){return{x:t.clientX,y:t.clientY}},windowWidth:function(){return"number"==typeof window.innerWidth?window.innerWidth:l.documentElement&&l.documentElement.clientWidth?l.documentElement.clientWidth:l.body&&l.body.clientWidth?l.body.clientWidth:0},windowHeight:function(){return"number"==typeof window.innerHeight?window.innerHeight:l.documentElement&&l.documentElement.clientHeight?l.documentElement.clientHeight:l.body&&l.body.clientHeight?l.body.clientHeight:0}},m={cache:{},g:(o.html=p).createCanvas().getContext("2d"),getTextSize:function(t,e){m.g.font=t||Ee.FONT,(t=m.cache[m.g.font])||(t=2*m.g.measureText("e").width+4,m.cache[m.g.font]=t),e=e||"";for(var i,n=(e=String(e)).split("\n"),o=0,s=(e=n.length)-1;0<=s;s--)o<(i=m.g.measureText(n[s]).width)&&(o=i);return{width:o+4,height:t*e}},getSubStringInLength:function(t,e,i){var n=this;return i<this.getTextSize(t,e).width?function t(e,i,o,s,r){if(i<=e)return s.substring(0,e+1);var a=Math.floor((e+i)/2),h=s.substring(0,a+1);return r<n.getTextSize(o,h).width?t(e,a-1,o,s,r):(e=a+1,a=s.substring(0,e+1),r<n.getTextSize(o,a).width?h:t(e,i,o,s,r))}(0,e.length-1,t,e,i):e},_getCollapseTextInLength:function(t,e,i){var n=this.getTextSize(t,e).width;if(i<n){for(var o=0,s="",r=e,a=n;i<a;){var h=this.getSubStringInLength(t,r,i);s=s+h+"\n";o+=h.length,r=e.substring(o),a=this.getTextSize(t,r).width}return s+r}return e},getCollapseTextInLength:function(t,e,i){for(var n=e,s=e,r="",a=0;a<n.length;a++)(c=n.charAt(a)).match(/[^\x00-\x80]/g)?r+="2":c.match(/\s/)?r+="3":r+="1";for(var h=1;h<4;h++)for(var l=1;l<4;l++)h!==l&&(r=r.replace(new RegExp(h+""+l,"g"),h+"^"+l));var c;for(h=0;h<r.length;h++)(c=r.charAt(h)).match(/\^/g)&&(s=this.replacePos(s,h+1,"^"));var d=s.split("^"),u="",g=i,_=0,f=!1;for(h=0;h<d.length;h++){var A=o.g.getTextSize(t,d[0]),y=d[0],p=o.g._getCollapseTextInLength(t,y,g).split("\n"),m=Math.ceil(A.width/g);for(l=0;l<m;l++)if(""===u)u=p[l];else{if(""===p[l])break;u+="\n"+p[l]}if(0===h)break}for(h=1;h<d.length;h++)if(f?_+=o.g.getTextSize(t,d[h-1]).width:_=o.g.getTextSize(t,d[h-1]).width,(A=o.g.getTextSize(t,d[h])).width+_%g<g)u+=d[h],f=!0;else for(y=d[h],p=o.g._getCollapseTextInLength(t,y,g).split("\n"),m=Math.ceil(A.width/g),l=0;l<m;l++)u+="\n"+p[l],_=0;return u},replacePos:function(t,e,i){return t.substr(0,e-1)+i+t.substring(e-1,t.length)},drawText:function(t,e,i,n,o,s,r){e=e||"",e=String(e),n=n||Ee.FONT;var a=s||"center";t.font=n,t.fillStyle=o,t.textAlign=a,t.textBaseline="middle";var h,l=e.split("\n"),c=l.length,d=0,g=i?void 0===i.width?(h=i.x,i.y):(d=r||i.height/c,"left"==a?h=i.x:"center"==a&&(h=i.x+i.width/2),i.y+d/2):h=0;u.isOpera&&(g-=2);for(var _=0;_<c;_++)"right"==a&&(t.textAlign="left",h=i.x+i.width-m.getTextSize(n,l[_]).width),t.fillText(l[_],h,g),g+=d},drawArc:function(t,e,i,n,o,s,r,a){var h,l,c,d,u,g=-(o=Math.abs(o)>2*Math.PI?2*Math.PI:o)/(h=Math.ceil(Math.abs(o)/(Math.PI/4))),_=-n;if(0<h){o=e+Math.cos(n)*s,n=i+Math.sin(-n)*r,a?t.lineTo(o,n):t.moveTo(o,n);for(var f=0;f<h;f++)u=(_+=g)-g/2,l=e+Math.cos(_)*s,c=i+Math.sin(_)*r,d=e+Math.cos(u)*(s/Math.cos(g/2)),u=i+Math.sin(u)*(r/Math.cos(g/2)),t.quadraticCurveTo(d,u,l,c)}},dashedLine:function(t,e,i,n,o,s,r){var a=s-n,h=r-o;if(0!=(r=Math.sqrt(a*a+h*h))){a/=r,h/=r;for(var l=r,c=-i.offset,d=i.drawing,u=i.patternIndex;c<l;)l<=(c+=e[u])&&(i.offset=e[u]-(c-l),i.patternIndex=u,i.drawing=d,c=l),d?t.lineTo(n+c*a,o+c*h):t.moveTo(n+c*a,o+c*h),d=!d,u=(u+1)%e.length}},drawLinePoints:function(t,e,i,n,o){var s,r,a,h,l,c=0,d=0,u=e.size(),g=i&&0<i.length&&i[0]&&i[1]?new ht(t,i[0],1<i.length?i[1]:i[0]):t;if(n)for(d=0,l=n.size();d<l;d++)if("moveto"===(s=n.get(d))&&c<u)r=e.get(c++),g.moveTo(r.x,r.y);else if("lineto"===s&&c<u)r=e.get(c++),g.lineTo(r.x,r.y);else if("cubicto"===s&&c<u-2)r=e.get(c++),a=e.get(c++),h=e.get(c++),g.bezierCurveTo(r.x,r.y,a.x,a.y,h.x,h.y);else{if(!("quadto"===s&&c<u-1))throw"Can not resolve segment '"+s+"'";r=e.get(c++),a=e.get(c++),g.quadraticCurveTo(r.x,r.y,a.x,a.y)}else this._drawLine(e,g);o&&g.closePath()},_drawLine:function(t,e){var i,n,o,s=0,r=t.size(),a=t.get(0);for(e.moveTo(a.x,a.y),s=1;s<r;s++)(o=t.get(s)).size?2===(n=o.size())?(a=o.get(0),i=o.get(1),e.quadraticCurveTo(a.x,a.y,i.x,i.y)):3===n&&(a=o.get(0),i=o.get(1),n=o.get(2),e.bezierCurveTo(a.x,a.y,i.x,i.y,n.x,n.y)):e.lineTo(o.x,o.y)},drawRoundRect:function(t,e,i,n,o,s,r,a,h){6===arguments.length&&(h=a=r=s);var l=e+n,c=i+o;s=s<(u=n<o?2*n:2*o)?s:u,r=r<u?r:u,a=a<u?a:u;var d=.292893218813453*(h=h<u?h:u),u=.585786437626905*h;t.moveTo(l,c-h),t.quadraticCurveTo(l,c-u,l-d,c-d),t.quadraticCurveTo(l-u,c,l-h,c),d=.292893218813453*a,u=.585786437626905*a,t.lineTo(e+a,c),t.quadraticCurveTo(e+u,c,e+d,c-d),t.quadraticCurveTo(e,c-u,e,c-a),d=.292893218813453*s,u=.585786437626905*s,t.lineTo(e,i+s),t.quadraticCurveTo(e,i+u,e+d,i+d),t.quadraticCurveTo(e+u,i,e+s,i),d=.292893218813453*r,u=.585786437626905*r,t.lineTo(l-r,i),t.quadraticCurveTo(l-u,i,l-d,i+d),t.quadraticCurveTo(l,i+u,l,i+r),t.lineTo(l,c-h)},drawVector:function(t,e,i,n,o,s,r){var a;4===arguments.length?(o=n.y,s=n.width,r=n.height,n=n.x):5===arguments.length&&"roundrect"===e&&((a={}).topLeft=o,a.topRight=o,a.bottomLeft=o,a.bottomRight=o,o=n.y,s=n.width,r=n.height,n=n.x);var h=m["_"+e];h&&(t.beginPath(),i&&0<i.length&&(t=new ht(t,i[0],1<i.length?i[1]:i[0])),5===arguments.length&&"roundrect"===e?h(t,{x:n,y:o,width:s,height:r},a):h(t,n,o,s,r))},_rectangle:function(t,e,i,n,o){t.rect(e,i,n,o)},_circle:function(t,e,i,n,o){e+=n/2,i+=o/2,o=Math.min(n,o)/2,t instanceof ht?m.drawArc(t,e,i,0,2*Math.PI,o,o,!1):t.arc(e,i,o,0,2*Math.PI,!0)},_oval:function(t,e,i,n,o){var s,r,a,h;t instanceof ht?m.drawArc(t,e+n/2,i+o/2,0,2*Math.PI,n/2,o/2,!1):(s=n/2*.5522848,r=o/2*.5522848,a=e+n,h=i+o,n=e+n/2,t.moveTo(e,o=i+o/2),t.bezierCurveTo(e,o-r,n-s,i,n,i),t.bezierCurveTo(n+s,i,a,o-r,a,o),t.bezierCurveTo(a,o+r,n+s,h,n,h),t.bezierCurveTo(n-s,h,e,o+r,e,o))},_roundrect:function(t,e,i,n,o){var s;3===arguments.length?(s=i,i=e.y,n=e.width,o=e.height,e=e.x,s.topLeft?m.drawRoundRect(t,e,i,n,o,s.topLeft):m.drawRoundRect(t,e,i,n,o,Math.min(Math.min(n,o)/4,10))):m.drawRoundRect(t,e,i,n,o,Math.min(Math.min(n,o)/4,10))},_star:function(t,e,i,n,o){var s=2*n,r=2*o,a=e+n/2,h=i+o/2;t.moveTo(a-s/4,h-r/12),t.lineTo(e+.306*n,i+.579*o),t.lineTo(a-s/6,h+r/4),t.lineTo(e+n/2,i+.733*o),t.lineTo(a+s/6,h+r/4),t.lineTo(e+.693*n,i+.579*o),t.lineTo(a+s/4,h-r/12),t.lineTo(e+.611*n,i+.332*o),t.lineTo(a+0,h-r/4),t.lineTo(e+.388*n,i+.332*o),t.closePath()},_triangle:function(t,e,i,n,o){t.moveTo(e+n/2,i),t.lineTo(e+n,i+o),t.lineTo(e,i+o),t.closePath()},_hexagon:function(t,e,i,n,o){t.moveTo(e,i+o/2),t.lineTo(e+n/4,i+o),t.lineTo(e+3*n/4,+i+o),t.lineTo(e+n,i+o/2),t.lineTo(e+3*n/4,i),t.lineTo(e+n/4,i),t.closePath()},_pentagon:function(t,e,i,n,o){var s=2*n,r=2*o;n=e+n/2,o=i+o/2;t.moveTo(n-s/4,o-r/12),t.lineTo(n-s/6,o+r/4),t.lineTo(n+s/6,o+r/4),t.lineTo(n+s/4,o-r/12),t.lineTo(n+0,o-r/4),t.closePath()},_trapezoidal:function(t,e,i,n,o){t.moveTo(e+n/4,i),t.lineTo(e,i+o),t.lineTo(e+n,i+o),t.lineTo(e+3*n/4,i),t.closePath()},_diamond:function(t,e,i,n,o){t.moveTo(e+n/2,i),t.lineTo(e,i+o/2),t.lineTo(e+n/2,i+o),t.lineTo(e+n,i+o/2),t.closePath()},fill:function(t,e,i,n,o,s,r,a){var h=x[i];t.fillStyle=h?5===arguments.length?h(t,e,n,o.x,o.y,o.width,o.height):h(t,e,n,o,s,r,a):e},createRadialGradient:function(t,e,i,n,o,s,r,a,h){return(r=t.createRadialGradient(n+s*a,o+r*h,Math.min(s,r)/24,n+s/2,o+r/2,Math.max(s,r)/2)).addColorStop(0,i),r.addColorStop(1,e),r},drawPath:function(t,e,i,s,r,a,h,l){var c=t._element,d=t.getBodyRect();s&&f.addPadding(d,c,i+".padding",1);var u=o.clone(d),g=c.getStyle(i+".outline.width");0<g&&f.grow(u,g/2,g/2),s=t.setShadow(t,e,u),0!=c.getAngle()&&(c instanceof Le||(d=c.getOriginalRect()),n.Util.rotateCanvas(s,d,c.getAngle())),(e=c.getStyle(i+".fill"))&&(A=t._innerColor&&!lt.hasDefault(t._element)?t._innerColor:c.getStyle(i+".fill.color"),(_=c.getStyle(i+".gradient"))?m.fill(s,A,_,c.getStyle(i+".gradient.color"),d):s.fillStyle=A);var _=c.getStyle(i+".shape"),A=c.getStyle("group.shape.roundrect.radius");return e&&(s.beginPath(),a?m.drawLinePoints(s,a,null,h,l):"roundrect"===_&&"group"===i?m.drawVector(s,_,null,d,A):m.drawVector(s,_,null,d),s.fill()),0<g&&(s.lineWidth=g,s.lineCap=c.getStyle(i+".cap"),s.lineJoin=c.getStyle(i+".join"),s.strokeStyle=c.getStyle(i+".outline.color"),s.beginPath(),a?m.drawLinePoints(s,a,r,h,l):"roundrect"===_&&"group"===i?m.drawVector(s,_,r,d,A):m.drawVector(s,_,r,d),s.stroke()),u},draw3DRect:function(t,e,i,n,o,s,r){if(0!==i){arguments.length<=4&&(r=n.height,s=n.width,o=n.y,n=n.x);var a,h,l=0<i;if(i=Math.abs(i),t.lineWidth=1,t.lineCap="square",1===i)a=m.brighter(e),h=m.darker(e),t.strokeStyle=l?a:h,t.beginPath(),t.moveTo(n,o),t.lineTo(n,o+r),t.moveTo(n,o),t.lineTo(n+s,o),t.closePath(),t.stroke(),t.strokeStyle=l?h:a,t.beginPath(),t.moveTo(n,o+r),t.lineTo(n+s,o+r),t.moveTo(n+s,o),t.lineTo(n+s,o+r),t.closePath(),t.stroke();else for(var c=2*i,d=50/c,u=0;u<c;u++)a=m.brighter(e,50-u*d),h=m.darker(e,50-u*d),n+=.5,o+=.5,--s,--r,t.strokeStyle=l?a:h,t.beginPath(),t.moveTo(n,o),t.lineTo(n,o+r),t.moveTo(n,o),t.lineTo(n+s,o),t.closePath(),t.stroke(),t.strokeStyle=l?h:a,t.beginPath(),t.moveTo(n,o+r),t.lineTo(n+s,o+r),t.moveTo(n+s,o),t.lineTo(n+s,o+r),t.closePath(),t.stroke()}},brighter:function(t,e){return m.adjustBrightness2(t,e=e||50)},darker:function(t,e){return m.adjustBrightness2(t,-(e=e||50))},adjustBrightness2:function(t,e){var i,n;if(0===e)return t;t=ue(t);var o=e<0?(e=(100+e)/100,i=Math.ceil(t.r*e),n=Math.ceil(t.g*e),Math.ceil(t.b*e)):(i=t.r,n=t.g,o=t.b,i+=(255-i)*(e/=100),n+=(255-n)*e,o+=(255-o)*e,i=Math.min(Math.ceil(i),255),n=Math.min(Math.ceil(n),255),Math.min(Math.ceil(o),255));return"rgba("+i+","+n+","+o+",1)"},getColorArray:function(t){return de.clearRect(0,0,1,1),de.fillStyle=t,de.fillRect(0,0,1,1),de.getImageData(0,0,1,1).data},hit:function(t,e,i,n){if(!t)return!1;var o=t._viewRect;if(!o)return!1;if(e-=o.x,i-=o.y,e<0||i<0||e>=o.width||i>=o.height)return!1;try{for(var s=t.getContext("2d").getImageData(e,i,1,1).data,r=0,a=s.length;r<a;r+=4)if(0!==s[r+3])return!0}catch(t){return!0}return!1},intersects:function(t,e){if(!t)return!1;if(!(e=f.intersection(e,t._viewRect)))return!1;e.x-=t._viewRect.x,e.y-=t._viewRect.y;try{for(var i=t.getContext("2d").getImageData(e.x,e.y,e.width,e.height).data,n=0,o=i.length;n<o;n+=4)if(0!==i[n+3])return!0}catch(t){}return!1},strokeRect:function(t,e,i,o){e&&(t.beginPath(),t.strokeStyle=i||n.Util.randomColor(),t.lineWidth=o||2,t.strokeRect(e.x,e.y,e.width,e.height),t.stroke())}};o.g=m;var v,x={"linear.southwest":function(t,e,i,n,o,s,r){return(o=t.createLinearGradient(n,o+r,n+s,o)).addColorStop(0,i),o.addColorStop(1,e),o},"linear.southeast":function(t,e,i,n,o,s,r){return(o=t.createLinearGradient(n+s,o+r,n,o)).addColorStop(0,i),o.addColorStop(1,e),o},"linear.northwest":function(t,e,i,n,o,s,r){return(o=t.createLinearGradient(n+s,o+r,n,o)).addColorStop(0,e),o.addColorStop(1,i),o},"linear.northeast":function(t,e,i,n,o,s,r){return(r=t.createLinearGradient(n+s,o,n,o+r)).addColorStop(0,i),r.addColorStop(1,e),r},"linear.north":function(t,e,i,n,o,s,r){return(r=t.createLinearGradient(n,o,n,o+r)).addColorStop(0,i),r.addColorStop(1,e),r},"linear.south":function(t,e,i,n,o,s,r){return(r=t.createLinearGradient(n,o,n,o+r)).addColorStop(0,e),r.addColorStop(1,i),r},"linear.west":function(t,e,i,n,o,s,r){return(o=t.createLinearGradient(n,o,n+s,o)).addColorStop(0,i),o.addColorStop(1,e),o},"linear.east":function(t,e,i,n,o,s,r){return(o=t.createLinearGradient(n,o,n+s,o)).addColorStop(0,e),o.addColorStop(1,i),o},"radial.center":function(t,e,i,n,o,s,r){return m.createRadialGradient(t,e,i,n,o,s,r,.5,.5)},"radial.southwest":function(t,e,i,n,o,s,r){return m.createRadialGradient(t,e,i,n,o,s,r,.25,.75)},"radial.southeast":function(t,e,i,n,o,s,r){return m.createRadialGradient(t,e,i,n,o,s,r,.75,.75)},"radial.northwest":function(t,e,i,n,o,s,r){return m.createRadialGradient(t,e,i,n,o,s,r,.25,.25)},"radial.northeast":function(t,e,i,n,o,s,r){return m.createRadialGradient(t,e,i,n,o,s,r,.75,.25)},"radial.north":function(t,e,i,n,o,s,r){return m.createRadialGradient(t,e,i,n,o,s,r,.5,.25)},"radial.south":function(t,e,i,n,o,s,r){return m.createRadialGradient(t,e,i,n,o,s,r,.5,.75)},"radial.west":function(t,e,i,n,o,s,r){return m.createRadialGradient(t,e,i,n,o,s,r,.25,.5)},"radial.east":function(t,e,i,n,o,s,r){return m.createRadialGradient(t,e,i,n,o,s,r,.75,.5)},"spread.horizontal":function(t,e,i,n,o,s,r){return(o=t.createLinearGradient(n,o,n+s,o)).addColorStop(0,e),o.addColorStop(.5,i),o.addColorStop(1,e),o},"spread.vertical":function(t,e,i,n,o,s,r){return(r=t.createLinearGradient(n,o,n,o+r)).addColorStop(0,e),r.addColorStop(.5,i),r.addColorStop(1,e),r},"spread.diagonal":function(t,e,i,n,o,s,r){return(r=t.createLinearGradient(n+s,o,n,o+r)).addColorStop(0,e),r.addColorStop(.5,i),r.addColorStop(1,e),r},"spread.antidiagonal":function(t,e,i,n,o,s,r){return(r=t.createLinearGradient(n,o,n+s,o+r)).addColorStop(0,e),r.addColorStop(.5,i),r.addColorStop(1,e),r},"spread.north":function(t,e,i,n,o,s,r){return(r=t.createLinearGradient(n,o-r/4,n,o+r+r/4)).addColorStop(0,e),r.addColorStop(1/3,i),r.addColorStop(2/3,e),r.addColorStop(1,i),r},"spread.south":function(t,e,i,n,o,s,r){return(r=t.createLinearGradient(n,o-r/4,n,o+r+r/4)).addColorStop(0,i),r.addColorStop(1/3,e),r.addColorStop(2/3,i),r.addColorStop(1,e),r},"spread.west":function(t,e,i,n,o,s,r){return(o=t.createLinearGradient(n-s/4,o,n+s+s/4,o)).addColorStop(0,e),o.addColorStop(1/3,i),o.addColorStop(2/3,e),o.addColorStop(1,i),o},"spread.east":function(t,e,i,n,o,s,r){return(o=t.createLinearGradient(n-s/4,o,n+s+s/4,o)).addColorStop(0,i),o.addColorStop(1/3,e),o.addColorStop(2/3,i),o.addColorStop(1,e),o}};function w(t,e,i){null!=t&&("number"==typeof t?this.fromNumber(t,e,i):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}function E(){return new w(null)}n.Util={getVersion:function(){return"5.8.4"},registerImage:function(t,e,i,n,s){o.registerImage(t,e,i,n,s)},registerImageByUrl:function(t,e,i,o){var s,r;e&&t&&0<t.indexOf(".json")?((s=new XMLHttpRequest).onreadystatechange=function(){var t;4===s.readyState&&200===s.status&&(t=JSON.parse(s.responseText),n.Util.registerImage(e,t),i&&i.invalidateElementUIs(),o&&o())},s.open("GET",t,!0),s.send()):((r=new c).src=t,r.onload=function(){n.Util.registerImage(e,r,r.width,r.height),r.onload=null,i&&i.invalidateElementUIs(),o&&o()})},getRegisteredImageNames:function(){return o.getRegisteredImageNames()},unregisterImage:function(t){o.unregisterImage(t)},getImageAsset:function(t){return o.getImageAsset(t)},validateLicense:function(t){o.validateLicense(t)},getLicense:function(){return s},isPermissionGIS:function(){return rt()},moveElements:function(t,e,i,o,s,r){var a,h,l;0===e&&0===i||t&&!t.isEmpty()&&((a=n.animate.AnimateManager).endAnimate(),t=lt.filterMovingElements(t),o&&(h=new at,l=new at),t.forEach(function(t){t instanceof be&&(o?(h.add(t),l.add({x:t.getX()+e,y:t.getY()+i})):t.translate(e,i))}),o?a.start(new n.animate.AnimateLocation(h,l,s)):s&&s())},isTypeOf:function(t,e){if(t===e)return!0;for(var i=t.superClass;i;){if(i===e.prototype)return!0;i=i.constructor.superClass}return!1},setFocus:function(t){var e,i,n,o,s;l.activeElement!==t&&(n=l.documentElement,o=l.body,n&&(u.isIE||u.isOpera||n.scrollLeft||n.scrollTop)?(e=n.scrollLeft,i=n.scrollTop,s=n):o&&(e=o.scrollLeft,i=o.scrollTop,s=o),t.focus(),s&&(s.scrollLeft=e,s.scrollTop=i))},isOpera:u.isOpera,isIE:u.isIE,isFirefox:u.isFirefox,isChrome:u.isChrome,isSafari:u.isSafari,isIPhone:u.isIPhone,isIPod:u.isIPod,isIPad:u.isIPad,isAndroid:u.isAndroid,isWebOS:u.isWebOS,isTouchable:u.isTouchable,ext:function(t,e,i){o.ext(t,e,i)},getValue:function(t,e,i){return o.getValue(t,e,i)},setValue:function(t,e,i){o.setValue(t,e,i)},grow:function(t,e,i){f.grow(t,e,i)},containsPoint:function(t,e,i){return f.containsPoint.apply(null,arguments)},intersects:function(t,e){return f.intersects(t,e)},getRect:function(t){return f.getRect(t)},unionRect:function(t,e){return f.unionRect(t,e)},createDiv:function(){return p.createDiv()},createCanvas:function(){return p.createCanvas()},setCanvas:function(t,e,i,n,o){return p.setCanvas.apply(null,arguments)},drawVector:function(t,e,i,n,o,s,r){m.drawVector.apply(null,arguments)},fill:function(t,e,i,n,o,s,r,a){m.fill.apply(null,arguments)},getClass:function(t){return o.getClass(t)},getAllClassNames:function(){var t,e=[];for(t in o.classCache)e.push(t);return e},newInstance:function(t){return o.newInstance.apply(null,arguments)},isDeserializing:function(){return o.isDeserializing},addEventListener:function(t,e,i,n){p.addEventListener(t,e,i,n)},removeEventListener:function(t,e,i){p.removeEventListener(t,e,i)},drawArrow:function(t,e,i,n,o,s,r,a,h,l,c,d,u){oe.drawArrow.apply(null,arguments)},calculatePointAngleAlongLine:function(t,e,i,n,o){return f.calculatePointInfoAlongLineBySegments(t,e,i,n,o)},getSubNetwork:function(t){return lt.getSubNetwork(t)},transformPoint:function(t,e,i,n){return f.transformPoint(t,e,i,n)},getToolTipDiv:function(){return ft.getToolTipDiv()},showToolTip:function(t,e){ft.showToolTip(t,e)},hideToolTip:function(){ft.hideToolTip()},resetToolTip:function(){ft.resetToolTip()},setCSSStyle:function(t,e,i){p.setCSSStyle(t,e,i)},removeCSSStyle:function(t,e){p.removeCSSStyle(t,e)},getCSSStyle:function(t,e){return p.getCSSStyle(t,e)},toDegrees:function(t){return f.toDegrees(t)},toRadians:function(t){return f.toDegrees(t)},getRadiansBetweenLines:function(t,e){return f.getRadiansBetweenLines(t,e)},getElementsBounds:function(t,e){var i=null;return t.forEach(function(t){var o,s;t.getRect&&(s=(s=e&&(o=e.getElementUI(t))?o.getViewRect():s)||t.getRect(),i=i?n.Util.unionRect(i,s):s)}),i},getPointIndex:function(t,e,i){if(i=i||10,t)for(var n=t.size();n--;)if(f.getDistance(t.get(n),e)<=i)return n;return-1},registerVectorShape:function(t,e){o.g["_"+t]=e},rotateCanvas:function(t,e,i){t.translate(e.x+e.width/2,e.y+e.height/2),t.rotate(i*Math.PI/180),t.translate(-(e.x+e.width/2),-(e.y+e.height/2))},registerShape:function(t,e){Zt(t,e)},registerDraw:function(t,e){Ht(t,e)},getFilterColor:function(t,e){return ge(t,e)},registerGifImage:function(t,e){},parseVectorData:function(t){return pt(t)},getSharedLinks:function(t,e){var i=t.getLinks(),n=e.getLinks();return i&&0!=i.size()&&n&&0!=n.size()?(i.size()>n.size()?i:n).toList(function(i){return i.getFromNode()==t&&i.getToNode()==e||i.getFromNode()==e&&i.getToNode()==t}):null},isSharedLinks:function(t,e){var i=!1,n=t.getLinks(),o=e.getLinks();return n&&0!=n.size()&&o&&0!=o.size()&&(n.size()>o.size()?n:o).forEach(function(n){return!(n.getFromNode()==t&&n.getToNode()==e||n.getFromNode()==e&&n.getToNode()==t)||!(i=!0)}),i},playAnimate:Xt,pauseAnimate:function(t){t.pause()},resumeAnimate:function(t){t.resume()},stopAnimate:function(t,e){jt(t,e)},pauseAllAnimates:function(){Object.keys($t).forEach(function(t){(t=$t[t])&&t.pause()})},resumeAllAnimates:function(){Object.keys($t).forEach(function(t){(t=$t[t])&&t.resume()})},stopAllAnimates:function(t){var e;null==(e=t)&&(e=!0),Object.keys($t).forEach(function(t){(t=$t[t])&&(e&&Kt(t,t.to),t.onStop&&t.onStop())}),$t={}},randomColor:function(){return"#"+("00000"+(16777216*this.random()<<0).toString(16)).substr(-6)},random:function(){return Math.random()},getHSVColor:function(t,e,i){var n,o,s,r,a,h,l;switch(t&&void 0===e&&void 0===i&&(e=t.s,i=t.v,t=t.h),a=i*(1-e),h=i*(1-(t=6*t-(r=Math.floor(6*t)))*e),l=i*(1-(1-t)*e),r%6){case 0:n=i,o=l,s=a;break;case 1:n=h,o=i,s=a;break;case 2:n=a,o=i,s=l;break;case 3:n=a,o=h,s=i;break;case 4:n=l,o=a,s=i;break;case 5:n=i,o=a,s=h}return"#"+toHex(255*n)+toHex(255*o)+toHex(255*s)},toHex:function(t){return 1==(t=parseInt(t).toString(16)).length?"0"+t:t},makeHighRes:function(t){var e=t.getContext("2d"),i=window.devicePixelRatio||1,n=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1,o=i/n;i!==n&&(i=t.width,n=t.height,t.width=Math.round(i*o),t.height=Math.round(n*o),t.style.width=i+"px",t.style.height=n+"px",e.scale(o,o))},newFunction:function(){var t=arguments,e=t.length;return 1===e?o.newInstance("Function",t[0]):2===e?o.newInstance("Function",t[0],t[1]):3===e?o.newInstance("Function",t[0],t[1],t[2]):4===e?o.newInstance("Function",t[0],t[1],t[2],t[3]):5===e?o.newInstance("Function",t[0],t[1],t[2],t[3],t[4]):6===e?o.newInstance("Function",t[0],t[1],t[2],t[3],t[4],t[5]):7===e?o.newInstance("Function",t[0],t[1],t[2],t[3],t[4],t[5],t[6]):8===e?o.newInstance("Function",t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]):null}},o.ext("b2.Util",Object,{}),v="Microsoft Internet Explorer"==h.appName?(w.prototype.am=function(t,e,i,n,o,s){for(var r=32767&e,a=e>>15;0<=--s;){var h=32767&this[t],l=this[t++]>>15,c=a*h+l*r;o=((h=r*h+((32767&c)<<15)+i[n]+(1073741823&o))>>>30)+(c>>>15)+a*l+(o>>>30),i[n++]=1073741823&h}return o},30):"Netscape"!=h.appName?(w.prototype.am=function(t,e,i,n,o,s){for(;0<=--s;){var r=e*this[t++]+i[n]+o;o=Math.floor(r/67108864),i[n++]=67108863&r}return o},26):(w.prototype.am=function(t,e,i,n,o,s){for(var r=16383&e,a=e>>14;0<=--s;){var h=16383&this[t],l=this[t++]>>14,c=a*h+l*r;o=((h=r*h+((16383&c)<<14)+i[n]+o)>>28)+(c>>14)+a*l,i[n++]=268435455&h}return o},28),w.prototype.DB=v,w.prototype.DM=(1<<v)-1,w.prototype.DV=1<<v,w.prototype.FV=Math.pow(2,52),w.prototype.F1=52-v,w.prototype.F2=2*v-52;for(var C="0123456789abcdefghijklmnopqrstuvwxyz",T=new Array,b="0".charCodeAt(0),I=0;I<=9;++I)T[b++]=I;for(b="a".charCodeAt(0),I=10;I<36;++I)T[b++]=I;for(b="A".charCodeAt(0),I=10;I<36;++I)T[b++]=I;function L(t){return C.charAt(t)}function S(t,e){return null==(e=T[t.charCodeAt(e)])?-1:e}function k(t){var e=E();return e.fromInt(t),e}function P(t){var e,i=1;return 0!=(e=t>>>16)&&(t=e,i+=16),0!=(e=t>>8)&&(t=e,i+=8),0!=(e=t>>4)&&(t=e,i+=4),0!=(e=t>>2)&&(t=e,i+=2),0!=(e=t>>1)&&(t=e,i+=1),i}function R(t){this.m=t}function D(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function B(t,e){return t&e}function M(t,e){return t|e}function O(t,e){return t^e}function N(t,e){return t&~e}function F(){}function z(t){return t}function V(t){this.r2=E(),this.q3=E(),w.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}R.prototype.convert=function(t){return t.s<0||0<=t.compareTo(this.m)?t.mod(this.m):t},R.prototype.revert=function(t){return t},R.prototype.reduce=function(t){t.divRemTo(this.m,null,t)},R.prototype.mulTo=function(t,e,i){t.multiplyTo(e,i),this.reduce(i)},R.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},D.prototype.convert=function(t){var e=E();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&0<e.compareTo(w.ZERO)&&this.m.subTo(e,e),e},D.prototype.revert=function(t){var e=E();return t.copyTo(e),this.reduce(e),e},D.prototype.reduce=function(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var i=32767&t[e],n=i*this.mpl+((i*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(t[i=e+this.m.t]+=this.m.am(0,n,t,e,0,this.m.t);t[i]>=t.DV;)t[i]-=t.DV,t[++i]++}t.clamp(),t.drShiftTo(this.m.t,t),0<=t.compareTo(this.m)&&t.subTo(this.m,t)},D.prototype.mulTo=function(t,e,i){t.multiplyTo(e,i),this.reduce(i)},D.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},w.prototype.copyTo=function(t){for(var e=this.t-1;0<=e;--e)t[e]=this[e];t.t=this.t,t.s=this.s},w.prototype.fromInt=function(t){this.t=1,this.s=t<0?-1:0,0<t?this[0]=t:t<-1?this[0]=t+DV:this.t=0},w.prototype.fromString=function(t,e){var i;if(16==e)i=4;else if(8==e)i=3;else if(256==e)i=8;else if(2==e)i=1;else if(32==e)i=5;else{if(4!=e)return void this.fromRadix(t,e);i=2}this.t=0,this.s=0;for(var n=t.length,o=!1,s=0;0<=--n;){var r=8==i?255&t[n]:S(t,n);r<0?"-"==t.charAt(n)&&(o=!0):(o=!1,0==s?this[this.t++]=r:s+i>this.DB?(this[this.t-1]|=(r&(1<<this.DB-s)-1)<<s,this[this.t++]=r>>this.DB-s):this[this.t-1]|=r<<s,(s+=i)>=this.DB&&(s-=this.DB))}8==i&&0!=(128&t[0])&&(this.s=-1,0<s&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),o&&w.ZERO.subTo(this,this)},w.prototype.clamp=function(){for(var t=this.s&this.DM;0<this.t&&this[this.t-1]==t;)--this.t},w.prototype.dlShiftTo=function(t,e){for(var i=this.t-1;0<=i;--i)e[i+t]=this[i];for(i=t-1;0<=i;--i)e[i]=0;e.t=this.t+t,e.s=this.s},w.prototype.drShiftTo=function(t,e){for(var i=t;i<this.t;++i)e[i-t]=this[i];e.t=Math.max(this.t-t,0),e.s=this.s},w.prototype.lShiftTo=function(t,e){for(var i=t%this.DB,n=this.DB-i,o=(1<<n)-1,s=Math.floor(t/this.DB),r=this.s<<i&this.DM,a=this.t-1;0<=a;--a)e[a+s+1]=this[a]>>n|r,r=(this[a]&o)<<i;for(a=s-1;0<=a;--a)e[a]=0;e[s]=r,e.t=this.t+s+1,e.s=this.s,e.clamp()},w.prototype.rShiftTo=function(t,e){e.s=this.s;var i=Math.floor(t/this.DB);if(i>=this.t)e.t=0;else{var n=t%this.DB,o=this.DB-n,s=(1<<n)-1;e[0]=this[i]>>n;for(var r=i+1;r<this.t;++r)e[r-i-1]|=(this[r]&s)<<o,e[r-i]=this[r]>>n;0<n&&(e[this.t-i-1]|=(this.s&s)<<o),e.t=this.t-i,e.clamp()}},w.prototype.subTo=function(t,e){for(var i=0,n=0,o=Math.min(t.t,this.t);i<o;)n+=this[i]-t[i],e[i++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;i<this.t;)n+=this[i],e[i++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;i<t.t;)n-=t[i],e[i++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e[i++]=this.DV+n:0<n&&(e[i++]=n),e.t=i,e.clamp()},w.prototype.multiplyTo=function(t,e){var i=this.abs(),n=t.abs(),o=i.t;for(e.t=o+n.t;0<=--o;)e[o]=0;for(o=0;o<n.t;++o)e[o+i.t]=i.am(0,n[o],e,o,0,i.t);e.s=0,e.clamp(),this.s!=t.s&&w.ZERO.subTo(e,e)},w.prototype.squareTo=function(t){for(var e=this.abs(),i=t.t=2*e.t;0<=--i;)t[i]=0;for(i=0;i<e.t-1;++i){var n=e.am(i,e[i],t,2*i,0,1);(t[i+e.t]+=e.am(i+1,2*e[i],t,2*i+1,n,e.t-i-1))>=e.DV&&(t[i+e.t]-=e.DV,t[i+e.t+1]=1)}0<t.t&&(t[t.t-1]+=e.am(i,e[i],t,2*i,0,1)),t.s=0,t.clamp()},w.prototype.divRemTo=function(t,e,i){var n=t.abs();if(!(n.t<=0)){if((l=this.abs()).t<n.t)return null!=e&&e.fromInt(0),void(null!=i&&this.copyTo(i));null==i&&(i=E());var o=E(),s=this.s,r=t.s;0<(t=this.DB-P(n[n.t-1]))?(n.lShiftTo(t,o),l.lShiftTo(t,i)):(n.copyTo(o),l.copyTo(i));var a=o.t,h=o[a-1];if(0!=h){var l=h*(1<<this.F1)+(1<a?o[a-2]>>this.F2:0),c=this.FV/l,d=(1<<this.F1)/l,u=1<<this.F2,g=i.t,_=g-a,f=null==e?E():e;for(o.dlShiftTo(_,f),0<=i.compareTo(f)&&(i[i.t++]=1,i.subTo(f,i)),w.ONE.dlShiftTo(a,f),f.subTo(o,o);o.t<a;)o[o.t++]=0;for(;0<=--_;){var A=i[--g]==h?this.DM:Math.floor(i[g]*c+(i[g-1]+u)*d);if((i[g]+=o.am(0,A,i,_,0,a))<A)for(o.dlShiftTo(_,f),i.subTo(f,i);i[g]<--A;)i.subTo(f,i)}null!=e&&(i.drShiftTo(a,e),s!=r&&w.ZERO.subTo(e,e)),i.t=a,i.clamp(),0<t&&i.rShiftTo(t,i),s<0&&w.ZERO.subTo(i,i)}}},w.prototype.invDigit=function(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return 0<(e=(e=(e=(e=e*(2-(15&t)*e)&15)*(2-(255&t)*e)&255)*(2-((65535&t)*e&65535))&65535)*(2-t*e%this.DV)%this.DV)?this.DV-e:-e},w.prototype.isEven=function(){return 0==(0<this.t?1&this[0]:this.s)},w.prototype.exp=function(t,e){if(4294967295<t||t<1)return w.ONE;var i,n=E(),o=E(),s=e.convert(this),r=P(t)-1;for(s.copyTo(n);0<=--r;)e.sqrTo(n,o),0<(t&1<<r)?e.mulTo(o,s,n):(i=n,n=o,o=i);return e.revert(n)},w.prototype.toString=function(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var i,n=(1<<e)-1,o=!1,s="",r=this.t,a=this.DB-r*this.DB%e;if(0<r--)for(a<this.DB&&0<(i=this[r]>>a)&&(o=!0,s=L(i));0<=r;)a<e?(i=(this[r]&(1<<a)-1)<<e-a,i|=this[--r]>>(a+=this.DB-e)):(i=this[r]>>(a-=e)&n,a<=0&&(a+=this.DB,--r)),(o=0<i||o)&&(s+=L(i));return o?s:"0"},w.prototype.negate=function(){var t=E();return w.ZERO.subTo(this,t),t},w.prototype.abs=function(){return this.s<0?this.negate():this},w.prototype.compareTo=function(t){var e=this.s-t.s;if(0!=e)return e;var i=this.t;if(0!=(e=i-t.t))return e;for(;0<=--i;)if(0!=(e=this[i]-t[i]))return e;return 0},w.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+P(this[this.t-1]^this.s&this.DM)},w.prototype.mod=function(t){var e=E();return this.abs().divRemTo(t,null,e),this.s<0&&0<e.compareTo(w.ZERO)&&t.subTo(e,e),e},w.prototype.modPowInt=function(t,e){return e=new(t<256||e.isEven()?R:D)(e),this.exp(t,e)},w.ZERO=k(0),w.ONE=k(1),F.prototype.convert=z,F.prototype.revert=z,F.prototype.mulTo=function(t,e,i){t.multiplyTo(e,i)},F.prototype.sqrTo=function(t,e){t.squareTo(e)},V.prototype.convert=function(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=E();return t.copyTo(e),this.reduce(e),e},V.prototype.revert=function(t){return t},V.prototype.reduce=function(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);0<=t.compareTo(this.m);)t.subTo(this.m,t)},V.prototype.mulTo=function(t,e,i){t.multiplyTo(e,i),this.reduce(i)},V.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)};var U=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],H=(1<<26)/U[U.length-1];function Z(){this.i=0,this.j=0,this.S=new Array}w.prototype.chunkSize=function(t){return Math.floor(Math.LN2*this.DB/Math.log(t))},w.prototype.toRadix=function(t){if(null==t&&(t=10),0==this.signum()||t<2||36<t)return"0";var e=this.chunkSize(t),i=Math.pow(t,e),n=k(i),o=E(),s=E(),r="";for(this.divRemTo(n,o,s);0<o.signum();)r=(i+s.intValue()).toString(t).substr(1)+r,o.divRemTo(n,o,s);return s.intValue().toString(t)+r},w.prototype.fromRadix=function(t,e){this.fromInt(0);for(var i=this.chunkSize(e=null==e?10:e),n=Math.pow(e,i),o=!1,s=0,r=0,a=0;a<t.length;++a){var h=S(t,a);h<0?"-"==t.charAt(a)&&0==this.signum()&&(o=!0):(r=e*r+h,++s>=i&&(this.dMultiply(n),this.dAddOffset(r,0),r=s=0))}0<s&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(r,0)),o&&w.ZERO.subTo(this,this)},w.prototype.fromNumber=function(t,e,i){if("number"==typeof e)if(t<2)this.fromInt(1);else for(this.fromNumber(t,i),this.testBit(t-1)||this.bitwiseTo(w.ONE.shiftLeft(t-1),M,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(w.ONE.shiftLeft(t-1),this);else{var n=new Array;i=7&t;n.length=1+(t>>3),e.nextBytes(n),0<i?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}},w.prototype.bitwiseTo=function(t,e,i){for(var n,o=Math.min(t.t,this.t),s=0;s<o;++s)i[s]=e(this[s],t[s]);if(t.t<this.t){for(n=t.s&this.DM,s=o;s<this.t;++s)i[s]=e(this[s],n);i.t=this.t}else{for(n=this.s&this.DM,s=o;s<t.t;++s)i[s]=e(n,t[s]);i.t=t.t}i.s=e(this.s,t.s),i.clamp()},w.prototype.changeBit=function(t,e){return t=w.ONE.shiftLeft(t),this.bitwiseTo(t,e,t),t},w.prototype.addTo=function(t,e){for(var i=0,n=0,o=Math.min(t.t,this.t);i<o;)n+=this[i]+t[i],e[i++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;i<this.t;)n+=this[i],e[i++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;i<t.t;)n+=t[i],e[i++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,0<n?e[i++]=n:n<-1&&(e[i++]=this.DV+n),e.t=i,e.clamp()},w.prototype.dMultiply=function(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()},w.prototype.dAddOffset=function(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}},w.prototype.multiplyLowerTo=function(t,e,i){var n,o=Math.min(this.t+t.t,e);for(i.s=0,i.t=o;0<o;)i[--o]=0;for(n=i.t-this.t;o<n;++o)i[o+this.t]=this.am(0,t[o],i,o,0,this.t);for(n=Math.min(t.t,e);o<n;++o)this.am(0,t[o],i,o,0,e-o);i.clamp()},w.prototype.multiplyUpperTo=function(t,e,i){var n=i.t=this.t+t.t- --e;for(i.s=0;0<=--n;)i[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)i[this.t+n-e]=this.am(e-n,t[n],i,0,0,this.t+n-e);i.clamp(),i.drShiftTo(1,i)},w.prototype.modInt=function(t){if(t<=0)return 0;var e=this.DV%t,i=this.s<0?t-1:0;if(0<this.t)if(0==e)i=this[0]%t;else for(var n=this.t-1;0<=n;--n)i=(e*i+this[n])%t;return i},w.prototype.millerRabin=function(t){var e=this.subtract(w.ONE),i=e.getLowestSetBit();if(i<=0)return!1;var o=e.shiftRight(i);U.length<(t=t+1>>1)&&(t=U.length);for(var s=E(),r=0;r<t;++r){s.fromInt(U[Math.floor(n.Util.random()*U.length)]);var a=s.modPow(o,this);if(0!=a.compareTo(w.ONE)&&0!=a.compareTo(e)){for(var h=1;h++<i&&0!=a.compareTo(e);)if(0==(a=a.modPowInt(2,this)).compareTo(w.ONE))return!1;if(0!=a.compareTo(e))return!1}}return!0},w.prototype.clone=function(){var t=E();return this.copyTo(t),t},w.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},w.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},w.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},w.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},w.prototype.toByteArray=function(){var t=this.t,e=new Array;e[0]=this.s;var i,n=this.DB-t*this.DB%8,o=0;if(0<t--)for(n<this.DB&&(i=this[t]>>n)!=(this.s&this.DM)>>n&&(e[o++]=i|this.s<<this.DB-n);0<=t;)n<8?(i=(this[t]&(1<<n)-1)<<8-n,i|=this[--t]>>(n+=this.DB-8)):(i=this[t]>>(n-=8)&255,n<=0&&(n+=this.DB,--t)),0!=(128&i)&&(i|=-256),0==o&&(128&this.s)!=(128&i)&&++o,(0<o||i!=this.s)&&(e[o++]=i);return e},w.prototype.equals=function(t){return 0==this.compareTo(t)},w.prototype.min=function(t){return this.compareTo(t)<0?this:t},w.prototype.max=function(t){return 0<this.compareTo(t)?this:t},w.prototype.and=function(t){var e=E();return this.bitwiseTo(t,B,e),e},w.prototype.or=function(t){var e=E();return this.bitwiseTo(t,M,e),e},w.prototype.xor=function(t){var e=E();return this.bitwiseTo(t,O,e),e},w.prototype.andNot=function(t){var e=E();return this.bitwiseTo(t,N,e),e},w.prototype.not=function(){for(var t=E(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t},w.prototype.shiftLeft=function(t){var e=E();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e},w.prototype.shiftRight=function(t){var e=E();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e},w.prototype.getLowestSetBit=function(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+function(t){if(0==t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}(this[t]);return this.s<0?this.t*this.DB:-1},w.prototype.bitCount=function(){for(var t=0,e=this.s&this.DM,i=0;i<this.t;++i)t+=function(t){for(var e=0;0!=t;)t&=t-1,++e;return e}(this[i]^e);return t},w.prototype.testBit=function(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<t%this.DB)},w.prototype.setBit=function(t){return this.changeBit(t,M)},w.prototype.clearBit=function(t){return this.changeBit(t,N)},w.prototype.flipBit=function(t){return this.changeBit(t,O)},w.prototype.add=function(t){var e=E();return this.addTo(t,e),e},w.prototype.subtract=function(t){var e=E();return this.subTo(t,e),e},w.prototype.multiply=function(t){var e=E();return this.multiplyTo(t,e),e},w.prototype.divide=function(t){var e=E();return this.divRemTo(t,e,null),e},w.prototype.remainder=function(t){var e=E();return this.divRemTo(t,null,e),e},w.prototype.divideAndRemainder=function(t){var e=E(),i=E();return this.divRemTo(t,e,i),new Array(e,i)},w.prototype.modPow=function(t,e){var i=t.bitLength(),n=k(1);if(i<=0)return n;var o=i<18?1:i<48?3:i<144?4:i<768?5:6,s=new(i<8?R:e.isEven()?V:D)(e),r=new Array,a=3,h=o-1,l=(1<<o)-1;if(r[1]=s.convert(this),1<o){var c=E();for(s.sqrTo(r[1],c);a<=l;)r[a]=E(),s.mulTo(c,r[a-2],r[a]),a+=2}var d,u,g=t.t-1,_=!0,f=E();for(i=P(t[g])-1;0<=g;){for(h<=i?d=t[g]>>i-h&l:(d=(t[g]&(1<<i+1)-1)<<h-i,0<g&&(d|=t[g-1]>>this.DB+i-h)),a=o;0==(1&d);)d>>=1,--a;if((i-=a)<0&&(i+=this.DB,--g),_)r[d].copyTo(n),_=!1;else{for(;1<a;)s.sqrTo(n,f),s.sqrTo(f,n),a-=2;0<a?s.sqrTo(n,f):(u=n,n=f,f=u),s.mulTo(f,r[d],n)}for(;0<=g&&0==(t[g]&1<<i);)s.sqrTo(n,f),u=n,n=f,f=u,--i<0&&(i=this.DB-1,--g)}return s.revert(n)},w.prototype.modInverse=function(t){var e=t.isEven();if(this.isEven()&&e||0==t.signum())return w.ZERO;for(var i=t.clone(),n=this.clone(),o=k(1),s=k(0),r=k(0),a=k(1);0!=i.signum();){for(;i.isEven();)i.rShiftTo(1,i),e?(o.isEven()&&s.isEven()||(o.addTo(this,o),s.subTo(t,s)),o.rShiftTo(1,o)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),e?(r.isEven()&&a.isEven()||(r.addTo(this,r),a.subTo(t,a)),r.rShiftTo(1,r)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);0<=i.compareTo(n)?(i.subTo(n,i),e&&o.subTo(r,o),s.subTo(a,s)):(n.subTo(i,n),e&&r.subTo(o,r),a.subTo(s,a))}return 0!=n.compareTo(w.ONE)?w.ZERO:0<=a.compareTo(t)?a.subtract(t):a.signum()<0?(a.addTo(t,a),a.signum()<0?a.add(t):a):a},w.prototype.pow=function(t){return this.exp(t,new F)},w.prototype.gcd=function(t){var e=this.s<0?this.negate():this.clone(),i=t.s<0?t.negate():t.clone();e.compareTo(i)<0&&(o=e,e=i,i=o);var n=e.getLowestSetBit(),o=i.getLowestSetBit();if(o<0)return e;for(0<(o=n<o?n:o)&&(e.rShiftTo(o,e),i.rShiftTo(o,i));0<e.signum();)0<(n=e.getLowestSetBit())&&e.rShiftTo(n,e),0<(n=i.getLowestSetBit())&&i.rShiftTo(n,i),0<=e.compareTo(i)?(e.subTo(i,e),e.rShiftTo(1,e)):(i.subTo(e,i),i.rShiftTo(1,i));return 0<o&&i.lShiftTo(o,i),i},w.prototype.isProbablePrime=function(t){var e,i=this.abs();if(1==i.t&&i[0]<=U[U.length-1]){for(e=0;e<U.length;++e)if(i[0]==U[e])return!0;return!1}if(i.isEven())return!1;for(e=1;e<U.length;){for(var n=U[e],o=e+1;o<U.length&&n<H;)n*=U[o++];for(n=i.modInt(n);e<o;)if(n%U[e++]==0)return!1}return i.millerRabin(t)},w.prototype.square=function(){var t=E();return this.squareTo(t),t},Z.prototype.init=function(t){for(var e,i,n=0;n<256;++n)this.S[n]=n;for(n=e=0;n<256;++n)e=e+this.S[n]+t[n%t.length]&255,i=this.S[n],this.S[n]=this.S[e],this.S[e]=i;this.i=0,this.j=0},Z.prototype.next=function(){var t;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,t=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]};var W,G=256;function Y(){var t;t=(new Date).getTime(),X[j++]^=255&t,X[j++]^=t>>8&255,X[j++]^=t>>16&255,X[j++]^=t>>24&255,G<=j&&(j-=G)}if(null==X){var X=new Array,j=0;if("Netscape"==h.appName&&h.appVersion<"5"&&window.crypto)for(var K=window.crypto.random(32),J=0;J<K.length;++J)X[j++]=255&K.charCodeAt(J);for(;j<G;)J=Math.floor(65536*n.Util.random()),X[j++]=J>>>8,X[j++]=255&J;j=0,Y()}function Q(){if(null==W){for(Y(),(W=new Z).init(X),j=0;j<X.length;++j)X[j]=0;j=0}return W.next()}function q(){}function $(t,e){return new w(t,e)}function tt(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}q.prototype.nextBytes=function(t){for(var e=0;e<t.length;++e)t[e]=Q()},tt.prototype.doPublic=function(t){return t.modPowInt(this.e,this.n)},tt.prototype.setPublic=function(t,e){this.n=$(t,16),this.e=parseInt(e,16)},tt.prototype.encrypt=function(t){return null==(t=function(t,e){if(e<t.length+11)return null;for(var i=new Array,n=t.length-1;0<=n&&0<e;){var o=t.charCodeAt(n--);o<128?i[--e]=o:127<o&&o<2048?(i[--e]=63&o|128,i[--e]=o>>6|192):(i[--e]=63&o|128,i[--e]=o>>6&63|128,i[--e]=o>>12|224)}i[--e]=0;for(var s=new q,r=new Array;2<e;){for(r[0]=0;0==r[0];)s.nextBytes(r);i[--e]=r[0]}return i[--e]=2,i[--e]=0,new w(i)}(t,this.n.bitLength()+7>>3))||null==(t=this.doPrivate(t))?null:0==(1&(t=t.toString(16)).length)?t:"0"+t},tt.prototype.doPrivate=function(t){if(null==this.p||null==this.q)return t.modPow(this.d,this.n);for(var e=t.mod(this.p).modPow(this.dmp1,this.p),i=t.mod(this.q).modPow(this.dmq1,this.q);e.compareTo(i)<0;)e=e.add(this.p);return e.subtract(i).multiply(this.coeff).mod(this.p).multiply(this.q).add(i)},tt.prototype.setPrivate=function(t,e,i){this.n=$(t,16),this.e=parseInt(e,16),this.d=$(i,16)},tt.prototype.setPrivateEx=function(t,e,i,n,o,s,r,a){this.n=$(t,16),this.e=parseInt(e,16),this.d=$(i,16),this.p=$(n,16),this.q=$(o,16),this.dmp1=$(s,16),this.dmq1=$(r,16),this.coeff=$(a,16)},tt.prototype.decrypt=function(t){return t=$(t,16),null==(t=this.doPublic(t))?null:function(t,e){for(var i=t.toByteArray(),n=0;n<i.length&&0==i[n];)++n;if(i.length-n!=e-1||2!=i[n])return null;for(++n;0!=i[n];)if(++n>=i.length)return null;for(var o="";++n<i.length;){var s=255&i[n];s<128?o+=String.fromCharCode(s):191<s&&s<224?(o+=String.fromCharCode((31&s)<<6|63&i[n+1]),++n):(o+=String.fromCharCode((15&s)<<12|(63&i[n+1])<<6|63&i[n+2]),n+=2)}return o}(t,this.n.bitLength()+7>>3)};var et=function(){it.v(s)},it={},nt="6a384c1259bdb5e731ec96b3174683f48a2c56a85e52e7a5bb20b58711ce50c1a294bd5e1d1752e766085e9ae94bae6d217c25dbb5fcdb86a8a9a7e180fa066723d00fcb85fcf7c9d29f8cc8859f53244a49c0bc30dcc45156daf8843ce1d24fe8ebc9a3c186bb26e9d0714041aef160304c1db8cc5728cf4acb39d29755f319";function ot(t){if(!st(t))return!0;var e=new Date;return null!=t.beginDate&&0<=t.beginDate.getTime()-e.getTime()||null!=t.endDate&&t.endDate.getTime()-e.getTime()<=0}it.cross=function(t){if(t){for(var e="",i=0;i<t.length;)i+1<t.length&&(e+=t[i+1]),e+=t[i],i+=2;return e}return null},it.reverse=function(t){if(t){for(var e="",i=t.length;0<i;i--)e+=t[i-1];return e}return null},it.v=function(t){if(t){var e=it;if(e.start=null,e.beginDate=null,e.end=null,e.endDate=null,e.gis=null,e["3D"]=null,e["3d"]=null,e.l=null,e.__li__=null,0<t.indexOf("signature=")){var i=(n=t.split("signature="))[0],n=n[1],o=new tt;o.setPublic(nt,"10001");for(var s,r=n,a=r.length,h=0,l="";h<a;)s=r.substr(h,256),l+=o.decrypt(s),h+=256;if(l===i)return e.i(t),!0}}return!1},it.i=function(t){for(var e,i,n=it,o=(n.__li__=t).split("\n"),s=o.length-1;0<=s;s--)e=(i=o[s].split("="))[0],i=i[1],n[e]=i;null!=n.start&&(n.beginDate=new Date(Date.parse(n.start.replace(/-/g,"/")))),null!=n.end&&(n.endDate=new Date(Date.parse(n.end.replace(/-/g,"/")))),(t=null!=(t=n.gis)?parseInt(t):t)&&(n._isPermissionGIS=!0),(t=null!=(t=n["3D"]||n["3d"])?parseInt(t):t)&&(n._isPermission3D=!0),n["3D"]&&(n._isPermission3D=!0),null!=n.l&&(n.version=n.l)};var st=function(t){return void 0!==t.__li__&&!t._isPermission3D},rt=function(){return!ot(it)&&it._isPermissionGIS};it.$z=function(t){var e=new tt;e.setPublic(nt,"10001");for(var i,n=t,o=n.length,s=0,r="";s<o;)i=n.substr(s,256),r+=e.decrypt(i),s+=256;return r},it.twm=function(t){var e,i,n,o=it,s=o.$z("4cd18113d0c7046bfe51f7a3fbd41c2b7cf14dd785d6ea7cec9da17710d3acfb8ce0cb9cf10839f4bd51e88819de19cdc0db09278584396156fcb65abe0353ac49d01326b30efa0ea98a07da9f8ceeb7572fc1b37b5965ba6103ccba4913b62e36e49425c6ff21a2f008830c59cff8f29058769f858c8a9f0bab3eaea7fb8a9e"),r=this.type,a=this.markText;t[o.$z("648be38cd61c870e95ffc1ea0676af40736c1365015abc326e891a4de67b4de3d4b05da70b9aebedc83ec26ecf71eb74c72f42f6d9a4be2d507d2f67d2860b7b66e3ba1d565e15923f2db335ff922eef17c01b59818b583d5656412d6cc9d9ba70001c2c88e3efd492c6b13a07fda5f325b333138a2036f4696542ec137cc341")]=o.__li__,"3"===r&&!ot(it)&&void 0===a||(null==t.__liLabel&&(t.__liLabel=l.createElement("div")),void 0===o.startDate&&(o.startDate=new Date),(i=(new Date).getTime()-o.startDate.getTime())<3e4||(n=a,(e=ot(o)&&3e5<i)?(n=o.$z("OtYQOeOff85m4X6gFgHDnD/Y7AWHVYMRa68zAQETVWhX9/ArUAsaIFlpANLovJ8fMYyU8MPBViWj2Ot2aC54bp7PJXsxBiBrCM+74ysBX0DHHZ/ZxmReMQE2S+jSJsQJlxPO2UWBw6CvHJ+8zwA5KSbaQccYL58ucnrOQFzmJiw="),n="2D License is ExpiredPlease Contact Jeff!"):"2"!=r||void 0!==n&&""!=n?"1"!=r||a||(n=s):n=o.$z("644d54bf9c59afbd8a742a9e7e2731f23f149ccb7f04c3547548c50ac2d77faea108b55f1f6261e99869f1c06b84e8abdefdf45b5170048531421f3d528123972ba2f03d70f37c33f1341dc12f986e0089e42bab517e2a05b455d12d90991bbba9bc45c715a81943062ea5fa5408c8b1b9270d260cc5a67b38ecc4178ce512fc"),void 0!==n&&((s=(i=t).__liLabel).innerHTML=n,i._rootCanvas?(s.type=r,s.mark=a,s.expired=e,i._xyz=s):(t=o=0,s.style.position="absolute",n=i.getView().style,t=null!=a&&""!=a||"2"==r?(o=10-i.getView().scrollLeft,10-i.getView().scrollTop):(o=n.width.replace("px","")/2-50-i.getView().scrollLeft,n.height.replace("px","")/2-i.getView().scrollTop),s.style.right=o+"px",s.style.bottom=t+"px",s.style.fontSize="120%",e&&(i.getView().style.opacity=.1,s.style.color="red",s.style.fontSize="150%"),i.getView().appendChild(s)))))},o.validateLicense(s);var at=function t(){if(this._as=[],1===arguments.length){var e=arguments[0];if((e=e instanceof t?e._as:e)instanceof Array)for(var i=e.length,n=0;n<i;n++)this._as.push(e[n]);else!1===e?(this._duplicatable=!1,this._map={}):null!=e&&this._as.push(e)}else if(1<arguments.length)for(i=arguments.length,n=0;n<i;n++)this._as.push(arguments[n])};n.List=at,o.ext("b2.List",Object,{_duplicatable:!0,size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(t,e){if(!this._duplicatable){if(this._map[t._id])return;this._map[t._id]=!0}return void 0===e?this._as.push(t):this._as.splice(e,0,t)},addAll:function(t){if((t=t instanceof at?t._as:t)instanceof Array)for(var e=t.length,i=0;i<e;i++)this.add(t[i]);else this.add(t)},get:function(t){return this._as[t]},remove:function(t){return this._duplicatable||this._map[t&&t._id]?(0<=(t=this._as.indexOf(t))&&t<this._as.length&&this.removeAt(t),t):-1},removeAt:function(t){return t=this._as.splice(t,1)[0],!this._duplicatable&&t&&delete this._map[t._id],t},set:function(t,e){var i=this._as[t];if(i===e)return e;if(!this._duplicatable){if(this._map[e._id])throw"duplicate item:"+e;delete this._map[i._id],this._map[e._id]=!0}return this._as[t]=e,i},clear:function(){return this._duplicatable||(this._map={}),this._as.splice(0,this._as.length)},contains:function(t){return this._duplicatable?0<=this.indexOf(t):!!this._map[t&&t._id]},indexOf:function(t){return this._as.indexOf(t)},forEach:function(t,e){for(var i=this._as.length,n=0;n<i;n++){var o=this._as[n];e?t.call(e,o):t(o)}},forEachReverse:function(t,e){for(var i=this._as.length-1;0<=i;i--){var n=this._as[i];e?t.call(e,n):t(n)}},toArray:function(t,e){if(t){for(var i=[],n=this._as.length,o=0;o<n;o++){var s=this._as[o];e?t.call(e,s)&&i.push(s):t(s)&&i.push(s)}return i}return this._as.concat()},toList:function(t,e){if(t){for(var i=new at,n=this._as.length,o=0;o<n;o++){var s=this._as[o];e?t.call(e,s)&&i.add(s):t(s)&&i.add(s)}return i}return new at(this)},sort:function(t){return t?this._as.sort(t):this._as.sort(),this},toString:function(){return this._as.toString()}});var ht=function(t,e,i){this.g=t,this.onLength=e,this.offLength=i,this.isLine=!0,this.overflow=0,this.dashLength=e+i,this.pen={x:0,y:0}};o.ext(ht,Object,{_curveaccuracy:6,moveTo:function(t,e){this.pen={x:t,y:e},this.g.moveTo(t,e),this.start||(this.start={x:t,y:e})},lineTo:function(t,e){var i=t-this.pen.x,n=e-this.pen.y,o=Math.atan2(n,i);n=Math.cos(o),i=Math.sin(o),o=this.lineLength(this.pen.x,this.pen.y,t,e);if(this.overflow){if(this.overflow>o)return this.isLine?this._lineTo(t,e):this.moveTo(t,e),void(this.overflow-=o);if(this.isLine?this._lineTo(this.pen.x+n*this.overflow,this.pen.y+i*this.overflow):this.moveTo(this.pen.x+n*this.overflow,this.pen.y+i*this.overflow),o-=this.overflow,this.overflow=0,this.isLine=!this.isLine,!o)return}var s=Math.floor(o/this.dashLength);if(s){for(var r=n*this.onLength,a=i*this.onLength,h=n*this.offLength,l=i*this.offLength,c=0;c<s;c++)this.isLine?(this._lineTo(this.pen.x+r,this.pen.y+a),this.moveTo(this.pen.x+h,this.pen.y+l)):(this.moveTo(this.pen.x+h,this.pen.y+l),this._lineTo(this.pen.x+r,this.pen.y+a));o-=this.dashLength*s}this.isLine?o>this.onLength?(this._lineTo(this.pen.x+n*this.onLength,this.pen.y+i*this.onLength),this.moveTo(t,e),this.overflow=this.offLength-(o-this.onLength),this.isLine=!1):(this._lineTo(t,e),o==this.onLength?(this.overflow=0,this.isLine=!this.isLine):(this.overflow=this.onLength-o,this.moveTo(t,e))):o>this.offLength?(this.moveTo(this.pen.x+n*this.offLength,this.pen.y+i*this.offLength),this._lineTo(t,e),this.overflow=this.onLength-(o-this.offLength),this.isLine=!0):(this.moveTo(t,e),o==this.offLength?(this.overflow=0,this.isLine=!this.isLine):this.overflow=this.offLength-o)},quadraticCurveTo:function(t,e,i,n){var o,s=this.pen.x,r=this.pen.y,a=this.curveLength(s,r,t,e,i,n),h=0,l=0;if(this.overflow){if(this.overflow>a)return this.isLine?this._curveTo(t,e,i,n):this.moveTo(i,n),void(this.overflow-=a);if(h=this.overflow/a,o=this.curveSliceUpTo(s,r,t,e,i,n,h),this.isLine?this._curveTo(o[2],o[3],o[4],o[5]):this.moveTo(o[4],o[5]),this.overflow=0,this.isLine=!this.isLine,!a)return}var c=a-a*h,d=Math.floor(c/this.dashLength),u=this.onLength/a,g=this.offLength/a;if(d)for(var _=0;_<d;_++)this.isLine?(o=this.curveSlice(s,r,t,e,i,n,h,l=h+u),this._curveTo(o[2],o[3],o[4],o[5]),h=l,o=this.curveSlice(s,r,t,e,i,n,h,l=h+g),this.moveTo(o[4],o[5])):(o=this.curveSlice(s,r,t,e,i,n,h,l=h+g),this.moveTo(o[4],o[5]),h=l,o=this.curveSlice(s,r,t,e,i,n,h,l=h+u),this._curveTo(o[2],o[3],o[4],o[5])),h=l;c=a-a*h,this.isLine?c>this.onLength?(o=this.curveSlice(s,r,t,e,i,n,h,l=h+u),this._curveTo(o[2],o[3],o[4],o[5]),this.moveTo(i,n),this.overflow=this.offLength-(c-this.onLength),this.isLine=!1):(o=this.curveSliceFrom(s,r,t,e,i,n,h),this._curveTo(o[2],o[3],o[4],o[5]),a==this.onLength?(this.overflow=0,this.isLine=!this.isLine):(this.overflow=this.onLength-c,this.moveTo(i,n))):c>this.offLength?(o=this.curveSlice(s,r,t,e,i,n,h,l=h+g),this.moveTo(o[4],o[5]),o=this.curveSliceFrom(s,r,t,e,i,n,l),this._curveTo(o[2],o[3],o[4],o[5]),this.overflow=this.onLength-(c-this.offLength),this.isLine=!0):(this.moveTo(i,n),c==this.offLength?(this.overflow=0,this.isLine=!this.isLine):this.overflow=this.offLength-c)},bezierCurveTo:function(t,e,i,n,o,s){this.pen={x:o,y:s};var r=[this.onLength,this.offLength];this.g.setLineDash&&this.g.setLineDash(r),this.g.lineDash=r,this.g.bezierCurveTo(t,e,i,n,o,s)},rect:function(t,e,i,n){this.pen={x:t,y:e},this.moveTo(t,e),this.lineTo(t,e+n),this.lineTo(t+i,e+n),this.lineTo(t+i,e),this.lineTo(t,e)},closePath:function(){this.lineTo(this.start.x,this.start.y)},lineLength:function(t,e,i,n){return t=i-t,e=n-e,Math.sqrt(t*t+e*e)},curveLength:function(t,e,i,n,o,s,r){for(var a,h,l,c,d=0,u=t,g=e,_=0<r?r:this._curveaccuracy,f=1;f<=_;f++)d+=this.lineLength(u,g,a=(h=(c=1-(a=f/_))*c)*t+(l=2*a*c)*i+(c=a*a)*o,c=h*e+l*n+c*s),u=a,g=c;return d},curveSlice:function(t,e,i,n,o,s,r,a){return 0==r?this.curveSliceUpTo(t,e,i,n,o,s,a):1==a?this.curveSliceFrom(t,e,i,n,o,s,r):((s=this.curveSliceUpTo(t,e,i,n,o,s,a)).push(r/a),this.curveSliceFrom.apply(this,s))},curveSliceUpTo:function(t,e,i,n,o,s,r){var a,h;return 1!=r&&(a=i+(o-i)*r,h=n+(s-n)*r,o=(i=t+(i-t)*r)+(a-i)*r,s=(n=e+(n-e)*r)+(h-n)*r),[t,e,i,n,o,s]},curveSliceFrom:function(t,e,i,n,o,s,r){var a;return 1!=r&&(t=(a=t+(i-t)*r)+((i+=(o-i)*r)-a)*r,e=(a=e+(n-e)*r)+((n+=(s-n)*r)-a)*r),[t,e,i,n,o,s]},_lineTo:function(t,e){t==this.pen.x&&e==this.pen.y||(this.pen={x:t,y:e},this.g.lineTo(t,e))},_curveTo:function(t,e,i,n){t==i&&e==n&&i==this.pen.x&&n==this.pen.y||(this.pen={x:i,y:n},this.g.quadraticCurveTo(t,e,i,n))}}),o.DashedLine=ht;var lt={DEFAULTS:{default:1,"default.vector":1,"vector.default":1},VECTORS:{vector:1,"default.vector":1,"vector.default":1},hasDefault:function(t){return!(t instanceof be)||(t=t.getStyle("body.type"),1===lt.DEFAULTS[t])},hasVector:function(t){return t instanceof be&&(t=t.getStyle("body.type"),1===lt.VECTORS[t])},hasAgentLinks:function(t){for(var e=t.getChildrenSize(),i=0;i<e;i++){var n=t.getChildAt(i);if(n instanceof be&&lt.hasAgentLinks(n))return!0}return t.hasAgentLinks()},getParents:function(t,e,i){i=i||!0;for(var n=new at,o=t._parent;null!=o&&o!==e;)n.add(o,0),o=o._parent;return i&&null!=o&&o===e&&n.add(o,0),n},getSubNetwork:function(t){if(!t)return null;if(t instanceof n.Link){var e=t._fromAgent,i=t._toAgent;return e&&i&&(e=lt.getSubNetwork(e))===lt.getSubNetwork(i)?e:null}var o=t._parent;if(!o)return null;for(;o instanceof n.Link&&!o.ISubNetwork;)o=o._parent;return o.ISubNetwork?o:lt.getSubNetwork(o)},figureSameSubNetworkAgent:function(t){if(!t)return null;for(var e=t._parent;e instanceof Le;){if(!(e._parent instanceof Le))return e.isExpanded()?t:e;e.isExpanded()||(t=e),e=e._parent}return t},figureSpanSubNetworkAgent:function(t,e){if(!t||!e)return null;var i=lt.getSubNetwork(t),n=lt.getSubNetwork(e);if(i==n)return t;for(;null!=n&&i!=n;)n=lt.getSubNetwork(n);if(i===n)return t;var o=new at;o.add(t,0);for(var s=t._parent;s instanceof be&&!e.isDescendantOf(s);)o.add(s,0),s=s._parent;for(var r=o.size(),a=0;a<r;a++){var h=o.get(a);if(h instanceof Le&&!h.isExpanded())return h;if(h.ISubNetwork)return h}return t},figureFromAgent:function(t){if(t.isLooped())return t.getFromNode();var e=lt.figureSameSubNetworkAgent(t.getFromNode()),i=lt.figureSameSubNetworkAgent(t.getToNode());return e===i?t.getFromNode():lt.figureSpanSubNetworkAgent(e,i)},figureToAgent:function(t){if(t.isLooped())return t.getToNode();var e=lt.figureSameSubNetworkAgent(t.getFromNode()),i=lt.figureSameSubNetworkAgent(t.getToNode());return e===i?t.getToNode():lt.figureSpanSubNetworkAgent(i,e)},getBundleLinks:function(t,e){if(!t||!e)return null;var i,n,o,s;if(t===e){if(!(s=t.getLoopedLinks()))return null;s=new at(s)}else{var r=t.getAgentLinks(),a=e.getAgentLinks();if(!r||!a)return null;for(n=r.size(),i=0;i<n;i++)o=r.get(i),a.contains(o)&&(s=s||new at).add(o)}if(null!=s)for(i=0;i<s.size();i++)(o=s.get(i)).getStyle("link.bundle.enable")||(o._setBundleLinks(null),s.removeAt(i),i--);return s},resetBundleLinks:function(t,e){var i=lt.getBundleLinks(t,e);if(i&&0!==i.size()){var o=null;if(1!==i.size()){var s,r=new at;for(d=0;d<i.size();d++)l=(o=i.get(d)).getStyle("link.bundle.id"),r.indexOf(l)<0&&r.add(l);r.sort();for(var a=new at,h=0;h<r.size();h++){for(var l=r.get(h),c=new at,d=0;d<i.size();d++)l===(o=i.get(d)).getStyle("link.bundle.id")&&c.add(o);s=new n.BundleLinks(c,a),a.add(s)}for(h=0;h<a.size();h++)for(s=a.get(h),d=0;d<s.getLinks().size();d++)(o=s.getLinks().get(d))._setBundleLinks(s)}else(o=i.get(0))._setBundleLinks(null)}},moveElements:function(t,e,i,n){for(var o=lt.filterMovingElements(t,n),s=o.size(),r=0;r<s;r++)o.get(r).translate(e,i)},filterMovingElements:function(t,e){for(var i=new at,o=t.size(),s=0;s<o;s++){var r=t.get(s);if(r instanceof be&&(!e||e(r))){for(var a=!0,h=i.toArray(),l=0;l<h.length;l++){var c=h[l];a&&c instanceof n.Follower&&r instanceof n.Follower&&r.isLoopedHostOn(c)?a=!1:c instanceof n.Follower&&c.isHostOn(r)?i.remove(c):a&&r instanceof n.Follower&&c instanceof be&&r.isHostOn(c)?a=!1:lt.isDescendantOfGroup(c,r)?i.remove(c):a&&lt.isDescendantOfGroup(r,c)&&(a=!1)}a&&i.add(r)}}return i},isDescendantOfGroup:function(t,e){if(!(t&&e instanceof Le))return!1;if(!e.hasChildren())return!1;for(t=t._parent;t instanceof Le;){if(t===e)return!0;t=t._parent}return!1}};o.element=lt;var ct={between:function(t,e,i){return t<=i&&i<=e||e<=i&&i<=t},considerEast:function(t,e,i){return!e||(ct.between(e.x,i.x,t.x)?i.x>e.x:Math.abs(e.x-t.x)>Math.abs(i.x-t.x))},considerWest:function(t,e,i){return!e||(ct.between(e.x,i.x,t.x)?i.x<e.x:Math.abs(e.x-t.x)>Math.abs(i.x-t.x))},considerNorth:function(t,e,i){return!e||(ct.between(e.y,i.y,t.y)?i.y<e.y:Math.abs(e.y-t.y)>Math.abs(i.y-t.y))},considerSouth:function(t,e,i){return!e||(ct.between(e.y,i.y,t.y)?i.y>e.y:Math.abs(e.y-t.y)>Math.abs(i.y-t.y))},getHorizontalPoint:function(t,e,i){return ct.between(e.x,i.x,t.x)?{x:t.x,y:e.y}:Math.abs(t.x-e.x)<Math.abs(t.x-i.x)?{x:e.x,y:e.y}:{x:i.x,y:i.y}},getVerticalPoint:function(t,e,i){return ct.between(e.y,i.y,t.y)?{x:e.x,y:t.y}:Math.abs(t.y-e.y)<Math.abs(t.y-i.y)?{x:e.x,y:e.y}:{x:i.x,y:i.y}},getPoint:function(t,e,i,n,o){var s=Math.abs(n.x-i.x)>Math.abs(n.y-i.y);return"south"===o?s&&ct.considerSouth(e,t,i)?ct.getHorizontalPoint(e,i,n):null:"north"===o?s&&ct.considerNorth(e,t,i)?ct.getHorizontalPoint(e,i,n):null:"west"===o?!s&&ct.considerWest(e,t,i)?ct.getVerticalPoint(e,i,n):null:"east"===o?!s&&ct.considerEast(e,t,i)?ct.getVerticalPoint(e,i,n):null:"nearby"!==o?null:(n=s?ct.getHorizontalPoint(e,i,n):ct.getVerticalPoint(e,i,n),!t||f.getDistance(t,e)>f.getDistance(n,e)?n:null)},getBusPoint:function(t,e,i){var n,o=t.size();if(0<o){for(var s=t.get(0),r=1;r<o;r++){var a=t.get(r),h=ct.getPoint(n,e,s,a,i);h&&(n=h),s=a}n=n||{x:s.x,y:s.y}}return n}};o.bus=ct;var dt={createFromPoint:function(t,i){var s=t._element;if(!s.getFromAgent())return{x:0,y:0};var r,a,h=s.getStyle("link.from.position"),l=s.getStyle("link.from.xoffset"),c=s.getStyle("link.from.yoffset");if((A=s.getStyle("link.from.percent"))&&A instanceof Array&&2===A.length&&A[0]<=1&&0<=A[0]&&A[1]<=1&&0<=A[1]){var d=(u=s.getFromAgent()).getSize();return{x:u.getRect().x+d.width*A[0],y:u.getRect().y+d.height*A[1]}}if(t._network._edgeDetect){var u=s.getFromAgent(),g=s.getToAgent(),_=u.getImage(),A=(d=o.images[_],u.getCenterLocation()),y=g.getCenterLocation();g=this._getPointAngleDegree(y.x,y.y,A.x,A.y),y={x:0,y:0};if(d&&((A=d._image)&&Vt(A)||A&&n.Util.getImageAsset(_)._cache))return Vt(A)?d._edgeData||(d._edgeData=d._createEdgeData(A,u._width,u._height)):"object"==e(A)&&(d._edgeData||(d._edgeData=d._createEdgeData(n.Util.getImageAsset(_)._cache,u.getWidth(),u.getHeight()))),y.x=d._edgeData[g].x+u.getRect().x,y.y=d._edgeData[g].y+u.getRect().y,y}return o.isCalculatingBus||(o.isCalculatingBus=!0,s.getFromAgent()instanceof n.Bus&&(g=s.getFromAgent(),lt.hasVector(g)?(u=i?i._getElementZoomRect(t,g.getRect()):g.getRect(),"oval"===(y=g.getStyle("vector.shape"))?a=f.getEllipsePoint(u,dt.createToPoint(t)):"circle"===y?a=f.getEllipsePoint(f.getCircleRect(u),dt.createToPoint(t)):"rectangle"!==y&&"roundrect"!==y||((r=new at).add({x:g.x,y:g.y}),r.add({x:g.x+g.width,y:g.y}),r.add({x:g.x+g.width,y:g.y+g.height}),r.add({x:g.x,y:g.y+g.height}),r.add({x:g.x,y:g.y}),r=i?i._getShapeNodeZoomPoints(t,r):r,a=ct.getBusPoint(r,dt.createToPoint(t),g.getStyle("bus.style")))):(r=i?i._getShapeNodeZoomPoints(t,g.getPoints()):g.getPoints(),a=ct.getBusPoint(r,dt.createToPoint(t),g.getStyle("bus.style")))),o.isCalculatingBus=!1),a?(a.x+=l,a.y+=c):a=t._network.getPosition(h,s.getFromAgent(),null,l,c,!0),a},createToPoint:function(t,i){var s=t._element;if(!s.getToAgent())return{x:0,y:0};var r,a,h=s.getStyle("link.to.position"),l=s.getStyle("link.to.xoffset"),c=s.getStyle("link.to.yoffset");if((y=s.getStyle("link.to.percent"))&&y instanceof Array&&2===y.length&&y[0]<=1&&0<=y[0]&&y[1]<=1&&0<=y[1]){var d=(u=s.getToAgent()).getSize();return{x:u.getRect().x+d.width*y[0],y:u.getRect().y+d.height*y[1]}}if(t._network._edgeDetect){var u,g=s.getFromAgent(),_=(u=s.getToAgent()).getImage(),A=(d=o.images[_],g.getLocation()),y=u.getCenterLocation();g=this._getPointAngleDegree(A.x,A.y,y.x,y.y),A={x:0,y:0};if(d&&((y=d._image)&&Vt(y)||y&&n.Util.getImageAsset(_)._cache))return Vt(y)?d._edgeData||(d._edgeData=d._createEdgeData(y,u.getWidth(),u.getHeight())):"object"==e(y)&&(d._edgeData||(d._edgeData=d._createEdgeData(n.Util.getImageAsset(_)._cache,u.getWidth(),u.getHeight()))),A.x=d._edgeData[g].x+u.getRect().x,A.y=d._edgeData[g].y+u.getRect().y,A}return o.isCalculatingBus||(o.isCalculatingBus=!0,s.getToAgent()instanceof n.Bus&&(g=s.getToAgent(),lt.hasVector(g)?(u=i?i._getElementZoomRect(t,g.getRect()):g.getRect(),"oval"===(A=g.getStyle("vector.shape"))?a=f.getEllipsePoint(u,dt.createFromPoint(t)):"circle"===A?a=f.getEllipsePoint(f.getCircleRect(u),dt.createFromPoint(t)):"rectangle"!==A&&"roundrect"!==A||((r=new at).add({x:g.x,y:g.y}),r.add({x:g.x+g.width,y:g.y}),r.add({x:g.x+g.width,y:g.y+g.height}),r.add({x:g.x,y:g.y+g.height}),r.add({x:g.x,y:g.y}),r=i?i._getShapeNodeZoomPoints(t,r):r,a=ct.getBusPoint(r,dt.createFromPoint(t),g.getStyle("bus.style")))):(r=i?i._getShapeNodeZoomPoints(t,g.getPoints()):g.getPoints(),a=ct.getBusPoint(r,dt.createFromPoint(t),g.getStyle("bus.style")))),o.isCalculatingBus=!1),a?(a.x+=l,a.y+=c):a=t._network.getPosition(h,s.getToAgent(),null,l,c,!0),a},fillLoopedPoints:function(t,e,i){var n,o=dt.getBundleGap(t,!0),s=o,r=t.getStyle("link.looped.type");if("north"===(t=t.getStyle("link.looped.direction")))return"arc"===r?dt.drawArc(e.x+e.width/2,e.y,0,Math.PI,o,o,!1,i):(n={x:e.x+e.width/2,y:e.y},i.add({x:n.x+s,y:n.y}),i.add({x:n.x+s,y:n.y-o}),i.add({x:n.x-s,y:n.y-o}),i.add({x:n.x-s,y:n.y})),{x:e.x+e.width/2,y:e.y-o};if("northeast"===t)return"arc"===r?dt.drawArc(e.x+e.width,e.y,1.5*Math.PI,1.5*Math.PI,o,o,!1,i):(n={x:e.x+e.width,y:e.y},i.add({x:n.x,y:n.y+s}),i.add({x:n.x+s,y:n.y+s}),i.add({x:n.x+s,y:n.y-o}),i.add({x:n.x-s,y:n.y-o}),i.add({x:n.x-s,y:n.y})),{x:e.x+e.width+.707*o,y:e.y-.707*o};if("east"===t)return"arc"===r?dt.drawArc(e.x+e.width,e.y+e.height/2,1.5*Math.PI,Math.PI,o,o,!1,i):(n={x:e.x+e.width,y:e.y+e.height/2},i.add({x:n.x,y:n.y-s}),i.add({x:n.x+o,y:n.y-s}),i.add({x:n.x+o,y:n.y+s}),i.add({x:n.x,y:n.y+s})),{x:e.x+e.width+o,y:e.y+e.height/2};if("southeast"===t)return"arc"===r?dt.drawArc(e.x+e.width,e.y+e.height,Math.PI,1.5*Math.PI,o,o,!1,i):(n={x:e.x+e.width,y:e.y+e.height},i.add({x:n.x,y:n.y-s}),i.add({x:n.x+s,y:n.y-s}),i.add({x:n.x+s,y:n.y+o}),i.add({x:n.x-s,y:n.y+o}),i.add({x:n.x-s,y:n.y})),{x:e.x+e.width+.707*o,y:e.y+e.height+.707*o};if("south"===t)return"arc"===r?dt.drawArc(e.x+e.width/2,e.y+e.height,Math.PI,Math.PI,o,o,!1,i):(n={x:e.x+e.width/2,y:e.y+e.height},i.add({x:n.x-s,y:n.y}),i.add({x:n.x-s,y:n.y+o}),i.add({x:n.x+s,y:n.y+o}),i.add({x:n.x+s,y:n.y})),{x:e.x+e.width/2,y:e.y+e.height+o};if("southwest"===t)return"arc"===r?dt.drawArc(e.x,e.y+e.height,.5*Math.PI,1.5*Math.PI,o,o,!1,i):(n={x:e.x,y:e.y+e.height},i.add({x:n.x,y:n.y-s}),i.add({x:n.x-s,y:n.y-s}),i.add({x:n.x-s,y:n.y+o}),i.add({x:n.x+s,y:n.y+o}),i.add({x:n.x+s,y:n.y})),{x:e.x-.707*o,y:e.y+e.height+.707*o};if("west"===t)return"arc"===r?dt.drawArc(e.x,e.y+e.height/2,.5*Math.PI,Math.PI,o,o,!1,i):(n={x:e.x,y:e.y+e.height/2},i.add({x:n.x,y:n.y-s}),i.add({x:n.x-o,y:n.y-s}),i.add({x:n.x-o,y:n.y+s}),i.add({x:n.x,y:n.y+s})),{x:e.x-o,y:e.y+e.height/2};if("northwest"===t)return"arc"===r?dt.drawArc(e.x,e.y,0,1.5*Math.PI,o,o,!1,i):(n={x:e.x,y:e.y},i.add({x:n.x,y:n.y+s}),i.add({x:n.x-s,y:n.y+s}),i.add({x:n.x-s,y:n.y-o}),i.add({x:n.x+s,y:n.y-o}),i.add({x:n.x+s,y:n.y})),{x:e.x-.707*o,y:e.y-.707*o};throw"Can not resolve link looped direction '"+t+"'"},drawArc:function(t,e,i,n,o,s,r,a){var h,l=-(n=Math.abs(n)>2*Math.PI?2*Math.PI:n)/(h=Math.ceil(Math.abs(n)/(Math.PI/4))),c=-i;if(0<h){n=t+Math.cos(i)*o,i=e+Math.sin(-i)*s,a.add({x:n,y:i});for(var d=0;d<h;d++){var u=(c+=l)-l/2,g=t+Math.cos(c)*o,_=e+Math.sin(c)*s,f=t+Math.cos(u)*(o/Math.cos(l/2)),A=e+Math.sin(u)*(s/Math.cos(l/2));(u=new at).add({x:f,y:A}),u.add({x:g,y:_}),a.add(u)}}},fillBundlePoints:function(t,e,i,n,o,s){var r;if(t._element.getBundleCount(),t._element.getBundleIndex(),t.getStyle("link.bundle.expanded"),"parallel"!==e&&0===(r=dt.getBundleGap(t,!1)))return o.add(i),o.add(n),f.getCenterPoint(i,n);void 0===r&&(r=dt.getBundleGap(t,!1));var a=dt.getBundleOffset(t);t=f.getDistance(i,n);s&&(a*=s=s.getSizeZoom(),r*=s),"arc"!==e&&"triangle"!==e||o.add({x:0,y:0}),"arc"===e&&o.add({x:0,y:r}),o.add({x:a,y:r}),o.add({x:t-a,y:r}),"arc"===e&&o.add({x:t,y:r}),"arc"!==e&&"triangle"!==e||o.add({x:t,y:0});n=Math.atan2(n.y-i.y,n.x-i.x);for(var h=f.createMatrix(n,0,0),l=0,c=o.size();l<c;l++){var d=o.get(l);(d=h.transform(d)).x+=i.x,d.y+=i.y,o.set(l,d)}return"arc"!==e?dt.calculateCenterPoint(o):(n=f.getCenterPoint(o.get(2),o.get(3)),(e=new at).add(o.get(1)),e.add(o.get(2)),o.set(1,e),(e=new at).add(o.get(4)),e.add(o.get(5)),o.set(4,e),o.removeAt(5),o.removeAt(2),n)},calculateCenterPoint:function(t){var e=t.size();if(null==t||e<1)return{x:0,y:0};if(e%2!=0)return t.get((e-1)/2);var i=e/2;e=t.get(i-1),i=t.get(i);return{x:(e.x+i.x)/2,y:(e.y+i.y)/2}},getBundleOffset:function(t){var e=f.getDistance(t.getFromPoint(),t.getToPoint());return 2*(t=t.getStyle("link.bundle.offset"))<e?t:e/2},getBundleGap:function(t,e){var i=t._element;if(!i.getBundleLinks())return e?i.getStyle("link.looped.gap"):0;for(var n=e?"link.looped.gap":"link.bundle.gap",o=null,s=0,r=0,a=i.getBundleLinks().getSiblings(),h=0,l=i.getStyle("link.bundle.independent"),c=i.getStyle("link.bundle.group.gap"),d=0,u=a.size();d<u;d++){var g=a.get(d);if(!l||g===i.getBundleLinks()){for(var _=0,f=g.getLinks().size();_<f;_++){var A,y=g.getLinks().get(_);l===y.getStyle("link.bundle.independent")&&t._network.isVisible(y)&&(h=null==o?(o=y).getStyle(n):(r+=h/2+(A=y.getStyle(n))/2,A),y===i&&(s=r+c/2))}r+=c}}return e?r-s+h:(e=s-r/2,null!=o&&i.getFromAgent()!==o.getFromAgent()?-e:e)},isTargetPriority:function(t,e,i){if(t){if(e.height<i.height)return e.height+i.height<Math.max(e.y+e.height,i.y+i.height)-Math.min(e.y,i.y)+e.height/2}else if(e.width<i.width)return e.width+i.width<Math.max(e.x+e.width,i.x+i.width)-Math.min(e.x,i.x)+e.width/2;return!0},calculateOrthogonalAndFlexionalLinkPoints:function(t,e,i,n){var o,s=dt.isHorizontal(t,e,i,n),r=new at;dt.isFlexionalTypeLink(t)?dt.flexional(s,e,i,r,n.getStyle("link.extend")):(dt.orthogonal(t,e,i,r,s,n),0===(dt.isSplitByPercent(t,n)?dt.calculateSplitValueByPercent(t,s,e,i,n.getStyle("link.split.percent")):n.getStyle("link.split.value"))&&(s=!s)),0===r.size()?dt.isTargetPriority(s,e,i)?(o={x:i.x+i.width/2,y:i.y+i.height/2},r.add(dt.rectanglePerimeter(e,!0,o)),r.add(dt.rectanglePerimeter(i,!1,r.get(r.size()-1)))):(o={x:e.x+e.width/2,y:e.y+e.height/2},o=dt.rectanglePerimeter(i,!1,o),r.add(dt.rectanglePerimeter(e,!0,o)),r.add(o)):(o=r.get(0),r.add(dt.rectanglePerimeter(e,!0,o),0),r.add(dt.rectanglePerimeter(i,!1,r.get(r.size()-1))));var a=r.size();if(a<2)return r;for(var h=r.get(0),l=1;l<a-1;l++){var c=r.get(l);c.x===h.x&&c.y===h.y&&(r.remove(c),a--,l--),h=c}return r},isHorizontal:function(t,e,i,n){if(t){if("flexional.horizontal"===t||"orthogonal.horizontal"===t||"orthogonal.H.V"===t||"extend.left"===t||"extend.right"===t)return!0;if("flexional.vertical"===t||"orthogonal.vertical"===t||"orthogonal.V.H"===t||"extend.top"===t||"extend.bottom"===t)return!1}return t=dt.calculateXGap(e,i),dt.calculateYGap(e,i)<=t},flexional:function(t,e,i,n,o){t?dt.flexionalHorizontal(e,i,n,o):dt.flexionalVertical(e,i,n,o)},isSplitByPercent:function(t,e){return e.getStyle("link.split.by.percent")},isExtendTypeLink:function(t){return t&&("extend.top"===t||"extend.left"===t||"extend.bottom"===t||"extend.right"===t)},isFlexionalTypeLink:function(t){return t&&("flexional"===t||"flexional.horizontal"===t||"flexional.vertical"===t)},calculateControlPoint:function(t,e,i,n,o){if("orthogonal.H.V"===t||"orthogonal.V.H"===t)return{x:n.x+n.width/2,y:n.y+n.height/2};if(dt.isExtendTypeLink(t)){var s=Math.min(i.y,n.y),r=Math.min(i.x,n.x),a=Math.max(i.y+i.height,n.y+n.height),h=Math.max(i.x+i.width,n.x+n.width),l=o.getStyle("link.extend");if("extend.top"===t)return{x:(r+h)/2,y:s-l};if("extend.left"===t)return{x:r-l,y:(s+a)/2};if("extend.bottom"===t)return{x:(r+h)/2,y:a+l};if("extend.right"===t)return{x:h+l,y:(s+a)/2}}return(l=dt.isSplitByPercent(t,o)?dt.calculateSplitValueByPercent(t,e,i,n,o.getStyle("link.split.percent")):o.getStyle("link.split.value"))===Number.NEGATIVE_INFINITY||l===Number.POSITIVE_INFINITY?{x:n.x+n.width/2,y:n.y+n.height/2}:0===l?{x:i.x+i.width/2,y:i.y+i.height/2}:e?(e=i.x+i.x+i.width<n.x+n.x+n.width,{x:dt.calculateSplitLocation(e,l,i.x,i.width),y:i.y+i.height/2}):(n=i.y+i.y+i.height<n.y+n.y+n.height,{x:i.x+i.width/2,y:dt.calculateSplitLocation(n,l,i.y,i.height)})},calculateGap:function(t,e,i,n){return Math.max(e,n)-Math.min(t,i)-(e-t+n-i)},calculateXGap:function(t,e){return Math.max(t.x+t.width,e.x+e.width)-Math.min(t.x,e.x)-t.width-e.width},calculateYGap:function(t,e){return Math.max(t.y+t.height,e.y+e.height)-Math.min(t.y,e.y)-t.height-e.height},calculateSplitValueByPercent:function(t,e,i,n,o){return dt.calculateSplitGapByPercent(o,e,i,n)*o},calculateSplitGapByPercent:function(t,e,i,n,o){return e?dt._calculateSplitGapByPercent(t,i.x,i.x+i.width,n.x,n.x+n.width):dt._calculateSplitGapByPercent(t,i.y,i.y+i.height,n.y,n.y+n.height)},_calculateSplitGapByPercent:function(t,e,i,n,o){var s=dt.calculateGap(e,i,n,o),r=e+i<n+o;if(0<s){if(1===t)return s+(o-n)/2;if(0<=t&&t<1)return s;if(t<0)return r?n-e:i-o}return r&&0<t||!r&&t<0?Math.abs(i-o):Math.abs(e-n)},calculateSplitPercentByControlPoint:function(t,e,i,n){return e?dt.calculateSplitPercent(t.x,i.x,i.x+i.width,n.x,n.x+n.width):dt.calculateSplitPercent(t.y,i.y,i.y+i.height,n.y,n.y+n.height)},calculateSplitPercent:function(t,e,i,n,o){if(e<=t&&t<=i)return 0;var s=dt.calculateGap(e,i,n,o);if(0<s&&n<=t&&t<=o)return 1;var r=e+i<n+o;if(0<s){if(t>Math.min(i,o)&&t<Math.max(e,n))return Math.abs(t-(r?i:e))/s;if(r){if(t<e)return(t-e)/(n-e)}else if(i<t)return(i-t)/(i-o)}return i<t?(r?t-i:i-t)/Math.abs(i-o):(r?t-e:e-t)/Math.abs(e-n)},calculateSplitLocation:function(t,e,i,n){return t===0<e?i+n+Math.abs(e):i-Math.abs(e)},calculateAngle:function(t,e){if(0!==t&&0!==e)return Math.atan2(t,e);if(0===t){if(0<e)return 0;if(e<0)return Math.PI}return 0<t?Math.PI/2:-Math.PI/2},drawCorner:function(t,e){var i=t.size();if(!(i<3)){var n=e.getStyle("link.corner");if("none"!==n){for(var o,s,r,a=e.getStyle("link.xradius"),h=e.getStyle("link.yradius"),l=t.get(0),c=t.get(1),d=2;d<i;d++){var u,g=t.get(d),_=c.x-l.x,f=c.y-l.y,A=g.x-c.x,y=g.y-c.y;(0==_&&0==y||0==f&&0==A)&&(u=0==f?(o=Math.min(2===d?Math.abs(_):Math.abs(_)/2,a),s=Math.min(d===i-1?Math.abs(y):Math.abs(y)/2,h),r={x:c.x-(0<_?o:-o),y:c.y},{x:c.x,y:c.y+(0<y?s:-s)}):(o=Math.min(d===i-1?Math.abs(A):Math.abs(A)/2,a),s=Math.min(2===d?Math.abs(f):Math.abs(f)/2,h),r={x:c.x,y:c.y-(0<f?s:-s)},{x:c.x+(0<A?o:-o),y:c.y}),t.remove(c),d--,i--,r.x===l.x&&r.y===l.y||(t.add(r,d),d++,i++),"bevel"===n?(t.add(u,d),d++,i++):"round"===n&&((A=new at).add(c),A.add(u),t.add(A,d),d++,i++)),l=c,c=g}u&&u.x===c.x&&u.y===c.y&&t.remove(c)}}},orthogonal:function(t,e,i,n,o,s){var r,a=s.getStyle("link.control.point"),h=null==a;a?(r=f.unionRect(e,i),f.containsPoint(r,a)||(o=dt.calculateIsHorizontalByControlPoint(a.x,a.y,r.y,r.x,r.y+r.height,r.x+r.width))):a=dt.calculateControlPoint(t,o,e,i,s),o?dt.sideToSide(e,i,a,n,h):dt.topToBottom(e,i,a,n,h)},calculateIsHorizontalByControlPoint:function(t,e,i,n,o,s){return!(e<i&&n-t<i-e&&t-s<i-e||o<e&&n-t<e-o&&t-s<e-o)},contains:function(t,e,i){return e>=t.x&&e<=t.x+t.width&&i>=t.y&&i<=t.y+t.height},topToBottom:function(t,e,i,n,o){var s=Math.max(t.y,e.y),r=Math.min(t.y+t.height,e.y+e.height),a=i?i.y:r+(s-r)/2;s=t.x+t.width/2,r=e.x+e.width/2;!o&&i&&(i.x>=t.x&&i.x<=t.x+t.width&&(s=i.x),i.x>=e.x&&i.x<=e.x+e.width&&(r=i.x)),dt.contains(e,s,a)||dt.contains(t,s,a)||n.add({x:s,y:a}),dt.contains(e,r,a)||dt.contains(t,r,a)||n.add({x:r,y:a}),0===n.size()&&(i?dt.contains(e,i.x,a)||dt.contains(t,i.x,a)||n.add({x:i.x,y:a}):(i=Math.max(t.x,e.x),e=Math.min(t.x+t.width,e.x+e.width),n.add({x:i+(e-i)/2,y:a})))},sideToSide:function(t,e,i,n,o){var s=Math.max(t.x,e.x),r=Math.min(t.x+t.width,e.x+e.width),a=i?i.x:r+(s-r)/2;s=t.y+t.height/2,r=e.y+e.height/2;!o&&i&&(i.y>=t.y&&i.y<=t.y+t.height&&(s=i.y),i.y>=e.y&&i.y<=e.y+e.height&&(r=i.y)),dt.contains(e,a,s)||dt.contains(t,a,s)||n.add({x:a,y:s}),dt.contains(e,a,r)||dt.contains(t,a,r)||n.add({x:a,y:r}),0===n.size()&&(i?dt.contains(e,a,i.y)||dt.contains(t,a,i.y)||n.add({x:a,y:i.y}):(i=Math.max(t.y,e.y),e=Math.min(t.y+t.height,e.y+e.height),n.add({x:a,y:i+(e-i)/2})))},flexionalHorizontal:function(t,e,i,n){var o=e.x+e.width<t.x,s=t.x+t.width<e.x,r=o?t.x:t.x+t.width,a=t.y+t.height/2,h=s?e.x:e.x+e.width,l=e.y+e.height/2;t={x:r+(o?-n:n),y:a},e={x:h+(s?-n:n),y:l};o==s?(n=o?Math.min(r,h)-n:Math.max(r,h)+n,i.add({x:n,y:a}),i.add({x:n,y:l})):(t.x<e.x==o?(a+=(l-a)/2,i.add(t),i.add({x:t.x,y:a}),i.add({x:e.x,y:a})):i.add(t),i.add(e))},flexionalVertical:function(t,e,i,n){var o=e.y+e.height<t.y,s=t.y+t.height<e.y,r=t.x+t.width/2,a=o?t.y:t.y+t.height,h=e.x+e.width/2,l=s?e.y:e.y+e.height;t={x:r,y:a+(o?-n:n)},e={x:h,y:l+(s?-n:n)};o==s?(n=o?Math.min(a,l)-n:Math.max(a,l)+n,i.add({x:r,y:n}),i.add({x:h,y:n})):(t.y<e.y==o?(r+=(h-r)/2,i.add(t),i.add({x:r,y:t.y}),i.add({x:r,y:e.y})):i.add(t),i.add(e))},rectanglePerimeter:function(t,e,i){var n=t.x+t.width/2,o=t.y+t.height/2,s=i.x-n,r=i.y-o,a=Math.atan2(r,s),h={x:0,y:0},l=Math.PI;r=Math.PI/2-a;return a<-l+(s=Math.atan2(t.height,t.width))||l-s<a?(h.x=t.x,h.y=o-t.width*Math.tan(a)/2):a<-s?(h.y=t.y,h.x=n-t.height*Math.tan(r)/2):a<s?(h.x=t.x+t.width,h.y=o+t.width*Math.tan(a)/2):(h.y=t.y+t.height,h.x=n+t.height*Math.tan(r)/2),i.x>=t.x&&i.x<=t.x+t.width?h.x=i.x:i.y>=t.y&&i.y<=t.y+t.height&&(h.y=i.y),i.x<t.x?h.x=t.x:i.x>t.x+t.width&&(h.x=t.x+t.width),i.y<t.y?h.y=t.y:i.y>t.y+t.height&&(h.y=t.y+t.height),h},isSplitTypeLink:function(t){return t&&("orthogonal"===t||"orthogonal.horizontal"===t||"orthogonal.vertical"===t)},isOrthogonalOrFlexionalLink:function(t){return!(t instanceof n.ShapeLink)&&(!t.isLooped()&&(t=t.getStyle("link.type"),dt.isOrthogonalOrFlexionalType(t)))},isOrthogonalLink:function(t){return!(t instanceof n.ShapeLink)&&(!t.isLooped()&&(t=t.getStyle("link.type"),dt.isOrthogonalType(t)))},isOrthogonalOrFlexionalType:function(t){return"orthogonal"===t||"orthogonal.horizontal"===t||"orthogonal.H.V"===t||"orthogonal.vertical"===t||"orthogonal.V.H"===t||"extend.top"===t||"extend.left"===t||"extend.bottom"===t||"extend.right"===t||"flexional"===t||"flexional.horizontal"===t||"flexional.vertical"===t},isOrthogonalType:function(t){return"orthogonal"===t||"orthogonal.horizontal"===t||"orthogonal.H.V"===t||"orthogonal.vertical"===t||"orthogonal.V.H"===t||"extend.top"===t||"extend.left"===t||"extend.bottom"===t||"extend.right"===t},hasControlPoint:function(t){return"orthogonal"===t||"orthogonal.horizontal"===t||"orthogonal.vertical"===t||"extend.bottom"===t||"extend.left"===t||"extend.right"===t||"extend.top"===t},getControlPoint:function(t,e,i){if(!t)throw"link can't be null";var n=t.getStyle("link.type");if(!dt.hasControlPoint(n))return null;var o=t.getStyle("link.control.point");if(o)return o;var s;i=null==e?(s=t.getFromAgent().getRect(),t.getToAgent().getRect()):(s=dt.getLinkSourceBounds(e,i),dt.getLinkTargetBounds(e,i));return null==s||null==i?null:(n=dt.isHorizontal(n,s,i,t),dt.calculateControlPoint(t.getStyle("link.type"),n,s,i,t))},getSplitValueByControlPoint:function(t,e,i,n,o){return"extend.top"===e?Math.min(i.y,n.y)-t.y:"extend.left"===e?Math.min(i.x,n.x)-t.x:"extend.bottom"===e?t.y-Math.max(i.y+i.height,n.y+n.height):"extend.right"===e?t.x-Math.max(i.x+i.width,n.x+n.width):o?0<(s=i.x+i.x+i.width<n.x+n.x+n.width?t.x-i.x+i.width:i.x-t.x)?s:s>-i.width?0:s+i.width:0<(s=i.y+i.y+i.height<n.y+n.y+n.height?t.y-i.y-i.height:i.y-t.y)?s:s>-i.height?0:s+i.height;var s},isHorizontalByControlPoint:function(t,e,i,n,o){var s=f.unionRect(i,n);return f.containsPoint(s,t)?dt.isHorizontal(e,i,n,o):dt.calculateIsHorizontalByControlPoint(t.x,t.y,s.y,s.x,s.y+s.height,s.x+s.width)},setParamsByControlPoint:function(t,e,i,n,o){var s=dt.isHorizontalByControlPoint(t,n,e,i,o),r=o.getStyle("link.control.point");!r&&"orthogonal"!==n&&"orthogonal.horizontal"!==n&&"orthogonal.vertical"!==n||o.setStyle("link.type",s?"orthogonal.horizontal":"orthogonal.vertical"),r?o.setStyle("link.control.point",t):(r=dt.getSplitValueByControlPoint(t,n,e,i,s),dt.isExtendTypeLink(n)?o.setStyle("link.extend",r):dt.isSplitByPercent(n,o)?0!==r?o.setStyle("link.split.percent",dt.calculateSplitPercentByControlPoint(t,s,e,i)):o.setStyle("link.split.percent",0):o.setStyle("link.split.value",r))},getLinkNodeBounds:function(t,e,i,n,o,s){var r,a;return s&&(r=s.getLocationZoom(),s.getSizeZoom(t)),null==t?null:(n?(s?(a=t.getZoomBodyRect()).x+=e:(a=t.getBodyRect()).x+=e,a.y+=i):(i=t.getNetwork().getPosition(o,t,null,e,i),a=s?{x:i.x*r,y:i.y*r,width:1,height:1}:{x:i.x,y:i.y,width:1,height:1}),a)},getLinkSourceBounds:function(t,e){var i=t._element,n=t.getNetwork().getElementUI(i.getFromAgent());if(null==n)return null;var o=i.getStyle("link.from.position"),s=i.getStyle("link.from.xoffset");t=i.getStyle("link.from.yoffset"),i=i.getStyle("link.from.at.edge");return dt.getLinkNodeBounds(n,s,t,i,o,e)},getLinkTargetBounds:function(t,e){var i=t._element,n=t.getNetwork().getElementUI(i.getToAgent());if(null==n)return null;var o=i.getStyle("link.to.position"),s=i.getStyle("link.to.xoffset");t=i.getStyle("link.to.yoffset"),i=i.getStyle("link.to.at.edge");return dt.getLinkNodeBounds(n,s,t,i,o,e)},orthogonalAndFlexional:function(t,e,i){var n=dt.getLinkSourceBounds(t,i);return null==n?null:null==(i=dt.getLinkTargetBounds(t,i))?null:(i=dt.calculateOrthogonalAndFlexionalLinkPoints(e,n,i,t._element),dt.offsetLink(t,i),t.setHotSpot(dt.calculateCenterPoint(i)),"flexional"!==e&&dt.drawCorner(i,t._element),i)},offsetLink:function(t,e){if(!t._element.isBundleAgent()){var i=dt.getBundleGap(t,!1);if(0!==i)for(var n,s=!1,r=!1,a=e.get(0),h=o.clone(a),l=1,c=e.size();l<c;l++){var d=e.get(l),u=d.x-h.x,g=d.y-h.y,_=(h=o.clone(d),dt.calculateAngle(u,g));0===u?((_-n)%Math.PI==0&&(_-n)%(2*Math.PI)!=0&&(s=!s)&&(g=-g),(_-n)%Math.PI!=0&&(a.x+=g<0?i:-i),d.x+=g<0?i:-i):0===g&&((_-n)%Math.PI==0&&(_-n)%(2*Math.PI)!=0&&(r=!r)&&(u=-u),n&&(_-n)%Math.PI==0||(a.y-=u<0?i:-i),d.y-=u<0?i:-i),n=_,a=d}}},_getPointAngleDegree:function(t,e,i,n){return t=(t=Math.atan2(n-e,i-t))/Math.PI*180,(t=parseInt(t)+180)%360}};o.link=dt;var ut={findMoveToBottomDatas:function(t,e,i){for(var n=0;n<i.size();n++){var o=i.get(n);t.contains(o)&&e.add(o)}for(n=0;n<i.size();n++)o=i.get(n),ut.findMoveToBottomDatas(t,e,o.getChildren())},findMoveToTopDatas:function(t,e,i){for(var n=0;n<i.size();n++){var o=i.get(i.size()-1-n);t.contains(o)&&e.add(o)}for(n=0;n<i.size();n++)o=i.get(n),ut.findMoveToTopDatas(t,e,o.getChildren())},findMoveUpDatas:function(t,e,i){for(var n=!1,o=0;o<i.size();o++){var s=i.get(o);t.contains(s)?n&&e.add(s):n=!0}for(o=0;o<i.size();o++)s=i.get(o),ut.findMoveUpDatas(t,e,s.getChildren())},findMoveDownDatas:function(t,e,i){for(var n=!1,o=0;o<i.size();o++){var s=i.get(i.size()-1-o);t.contains(s)?n&&e.add(s):n=!0}for(o=0;o<i.size();o++)s=i.get(o),ut.findMoveDownDatas(t,e,s.getChildren())},doLayout:function(t,e){(e=e||{}).type=e.type||"round",e.animate=e.animate||!0,e.elements=e.elements||new n.List,e.repulsion=e.repulsion||1,e.expandGroup=e.expandGroup||!1,new n.layout.AutoLayouter(t.getElementBox()).getElements=function(){}}};o.box=ut;var gt={scrollLeft:function(){return gt._filterResults(window.pageXOffset||0,l.documentElement?l.documentElement.scrollLeft:0,l.body?l.body.scrollLeft:0)},scrollTop:function(){return gt._filterResults(window.pageYOffset||0,l.documentElement?l.documentElement.scrollTop:0,l.body?l.body.scrollTop:0)},_filterResults:function(t,e,i){return t=t||0,e&&(!t||e<t)&&(t=e),i&&(!t||i<t)?i:t},isSingleTouch:function(t){return t.touches&&1==t.touches.length},isMultiTouch:function(t){return t.touches&&1<t.touches.length},getDistance:function(t){if(!gt.isMultiTouch(t))return 0;var e=t.touches[0];t=t.touches[1];return Math.sqrt(Math.pow(e.clientX-t.clientX,2)+Math.pow(e.clientY-t.clientY,2))},getCenterLocation:function(t){if(!gt.isMultiTouch(t))return 0;var e=t.touches[0];t=t.touches[1];return{x:(e.clientX+t.clientX)/2,y:(e.clientY+t.clientY)/2}}};o.touch=gt;var _t={_string:function(t,e,i,n){(i=i._stringPool.get()).style.whiteSpace="nowrap",i.style.verticalAlign="middle",i.style.padding="0px 2px",o.setText(i,t,n),i.setAttribute("title",t),e.appendChild(i)},_boolean:function(t,e,i){i=i._booleanPool.get(),e._editInfo?(i._editInfo=e._editInfo,delete e._editInfo,i.disabled=!1):i.disabled=!0,i.keepDefault=!0,i.type="checkbox",i.style.margin="0px 2px",i.style.verticalAlign="middle",i.checked=t,e.appendChild(i),""===e.style.textAlign&&(e.style.textAlign="center")},_color:function(t,e,i){(i=i._colorPool.get()).style.width="100%",i.style.height="100%",i.style.backgroundColor=t,i.setAttribute("title",t),e.appendChild(i)},_listPoints:function(t,e,i,n){(i=i._stringPool.get()).style.whiteSpace="nowrap",i.style.verticalAlign="middle",i.style.padding="0px 2px";var s=t._as||t,r="";s.forEach(function(t,e){r+=e==s.length-1?"["+t.x+","+t.y+"]":"["+t.x+","+t.y+"],"}),t=r,o.setText(i,t,n),i.setAttribute("title",t),e.appendChild(i)},render:function(t,e,i,o,s){null!=e&&((t=_t["_"+t])?t(e,i,o,s):"boolean"==typeof e?_t._boolean(e,i,o,s):e instanceof n.List?_t._listPoints(e,i,o,s):_t._string(e,i,o,s))}};o.render=_t;var ft={toolTipDiv:null,getToolTipDiv:function(){var t,e;return ft.toolTipDiv||(ft.toolTipDiv=l.createElement("div"),t=Ee,(e=ft.toolTipDiv.style).position="absolute",e.color=t.TOOLTIP_COLOR,e.background=t.TOOLTIP_BACKGROUND,e.fontSize=t.TOOLTIP_FONT_SIZE,e.padding=t.TOOLTIP_PADDING,e.border=t.TOOLTIP_BORDER,e.borderRadius=t.TOOLTIP_BORDER_RADIUS,e.boxShadow=t.TOOLTIP_BOX_SHADOW,e.zIndex=t.TOOLTIP_ZINDEX,e.setProperty&&e.setProperty("-webkit-box-shadow",t.TOOLTIP_BOX_SHADOW,null)),ft.toolTipDiv},isToolTipVisible:function(){return!!ft.getToolTipDiv().parentNode},hideToolTip:function(){var t;ft._clearTimeout(),ft._clearDismiss(),!ft.isToolTipVisible()||(t=ft.getToolTipDiv()).parentNode&&t.parentNode.removeChild(t)},showToolTip:function(t,e,i){t&&e?ft.isToolTipVisible()||ft._reshow_timeout?ft._showToolTip(t,e,i):(ft._clearTimeout(),ft._show_timeout=setTimeout(function(){ft._showToolTip(t,e,i)},Ee.TOOLTIP_INITIAL_DELAY)):ft.hideToolTip()},_showToolTip:function(t,e,i){var n,o=t.target?(n=t.clientX,t.clientY):(n=t.x,t.y),s=ft.getToolTipDiv();p.clear(s),e instanceof Element?(t=e.cloneNode(!0),s.appendChild(t)):s.innerHTML=e,s.style.left=n+Ee.TOOLTIP_XOFFSET+"px",s.style.top=o+Ee.TOOLTIP_YOFFSET+"px",s.parentNode||l.body.appendChild(s),i&&i(s),ft._clearDismiss(),ft._dismiss_timeout=setTimeout(ft.hideToolTip,Ee.TOOLTIP_DISMISS_DELAY),ft._clearReshow(),ft._reshow_timeout=setTimeout(ft._clearReshow,Ee.TOOLTIP_RESHOW_DELAY)},_clearDismiss:function(){ft._dismiss_timeout&&(clearTimeout(ft._dismiss_timeout),ft._dismiss_timeout=null)},_clearReshow:function(){ft._reshow_timeout&&(clearTimeout(ft._reshow_timeout),ft._reshow_timeout=null)},_clearTimeout:function(){ft._show_timeout&&(clearTimeout(ft._show_timeout),ft._show_timeout=null)},resetToolTip:function(){ft.hideToolTip(),ft.toolTipDiv=null}};o.popup=ft;var At={handleClicked:function(t,e,i){var n;t.isSelectingElement()||!u.isTouchable&&0!==e.button||(i?((n=yt(i))&&n.onClick&&n.onClick(i,t),t.onClickElement(i,e),t.fireInteractionEvent({kind:"clickElement",event:e,element:i})):(t.onClickBackground(e),t.fireInteractionEvent({kind:"clickBackground",event:e})))},handleDoubleClicked:function(t,e,i){var s;!u.isTouchable&&0!==e.button||t.isEditingElement()||(i?((s=yt(i))&&s.onDoubleClick&&s.onDoubleClick(i,t),t.onDoubleClickElement(i,e),t.fireInteractionEvent({kind:"doubleClickElement",event:e,element:i})):(t.onDoubleClickBackground(e),t.fireInteractionEvent({kind:"doubleClickBackground",event:e})),i?i instanceof n.Link&&t.isDoubleClickToLinkBundle()?i.ISubNetwork&&t.isDoubleClickToSubNetwork()&&!o.isCtrlDown(e)?(t.isDoubleClickToEmptySubNetwork()||0<i.getChildrenSize())&&t.setCurrentSubNetwork(i,t.isSubNetworkAnimate(),function(){t.fireInteractionEvent({kind:"enterSubNetwork",event:e,element:i})}):i.reverseBundleExpanded()&&t.fireInteractionEvent({kind:"bundleLink",event:e,element:i}):i.ISubNetwork&&t.isDoubleClickToSubNetwork()?(t.isDoubleClickToEmptySubNetwork()||0<i.getChildrenSize())&&t.setCurrentSubNetwork(i,t.isSubNetworkAnimate(),function(){t.fireInteractionEvent({kind:"enterSubNetwork",event:e,element:i})}):i instanceof Le&&t.isDoubleClickToGroupExpand()&&(i.reverseExpanded(),t.fireInteractionEvent({kind:"expandGroup",event:e,element:i})):t.isDoubleClickToUpSubNetwork()&&t.upSubNetwork(t.isSubNetworkAnimate(),function(){t.fireInteractionEvent({kind:"upSubNetwork",event:e})}))},handleKeyDown:function(t,e){o.isCtrlDown(e)&&65==e.keyCode?(t.isKeyboardSelectEnabled()&&0<t.selectAll().size()&&t.fireInteractionEvent({kind:"selectAll"}),p.preventDefault(e)):46==e.keyCode?(t.isKeyboardRemoveEnabled()&&t.removeSelection()&&t.fireInteractionEvent({kind:"removeElement"}),p.preventDefault(e)):o.showVersion(e)},handleLongClicked:function(t,e,i){var n;!u.isTouchable&&0!==e.button||(i?((n=yt(i))&&n.onLongClick&&n.onLongClick(i,t),t.onLongClickElement(i,e),t.fireInteractionEvent({kind:"longClickElement",event:e,element:i})):(t.onLongClickBackground(e),t.fireInteractionEvent({kind:"longClickBackground",event:e})))}},yt=function(t){if(t&&t._image){if("object"==e(t._image))return t._image;if(t=o.getImageAsset(t._image))return t._image}return null};o.interaction=At;var pt=function(t){return(t.trim()[0].match(/[mlhvcsqta]/i)?Ct:vt)(t)},mt={},vt=function(t){var e=mt[t];return e||(mt[t]=e=[],t.trim().split(" ").forEach(function(t){2===(t=t.split(",")).length?e.push({x:parseFloat(t[0]),y:parseFloat(t[1])}):e.push(t[0])}),e)},xt={},wt=/[mlhvcsqtaz][\d.,\-\s]*/gi,Et=/-?(\d)+(\.(\d)+)?/g,Ct=function(t){var e,i=xt[t];return i||(e=t.trim().match(wt),xt[t]=i=[],e&&e.forEach(function(t){var e,n=t[0],o=t.match(Et),s=o&&o.length;if(i.push(t={c:n}),s)switch(o.forEach(function(t,e){o[e]=parseFloat(t)}),n){case"M":case"m":case"L":case"l":for(e=0;e<s;e+=2)0!==e&&i.push(t={c:"M"===n||"L"===n?"L":"l"}),t.x=o[e],t.y=o[e+1];break;case"H":case"h":for(e=0;e<s;e++)0!==e&&i.push(t={c:n}),t.x=o[e];break;case"V":case"v":for(e=0;e<s;e++)0!==e&&i.push(t={c:n}),t.y=o[e];break;case"C":case"c":for(e=0;e<s;e+=6)0!==e&&i.push(t={c:n}),t.x1=o[e],t.y1=o[e+1],t.x2=o[e+2],t.y2=o[e+3],t.x=o[e+4],t.y=o[e+5];break;case"S":case"s":for(e=0;e<s;e+=4)0!==e&&i.push(t={c:n}),t.x2=o[e],t.y2=o[e+1],t.x=o[e+2],t.y=o[e+3];break;case"Q":case"q":for(e=0;e<s;e+=4)0!==e&&i.push(t={c:n}),t.x1=o[e],t.y1=o[e+1],t.x=o[e+2],t.y=o[e+3];break;case"T":case"t":for(e=0;e<s;e+=2)0!==e&&i.push(t={c:n}),t.x=o[e],t.y=o[e+1]}}),i)},Tt=function(t){return t.replace(/[\s\r\t\n]+/gm," ").trim().replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/).map(function(t){return t.replace(")","").trim().split(/\s*\(\s*|\s+,?\s*|,\s*/).map(function(t,e){return 0===e?t:parseFloat(t)})})},bt=n.Util.drawImage=function(t,i,n,s,r,a,h){var l,c,d,u=1;"object"!=e(i)&&(d=i,i=(l=o.images[i])&&l.getImage()),Vt(i)?t.drawImage(l?l.getImage(n,s.width,s.height):i,s.x,s.y,s.width,s.height):i&&"object"==e(i)&&(t._data=r,t._view=a,d?(c=s.width/(i.w&&Mt(r,i,i,"w")||r.getWidth()),d=s.height/(i.h&&Mt(r,i,i,"h")||r.getHeight()),a&&(u=a.getSizeZoom?a.getSizeZoom()*a.getGraphicsZoom():a.getZoom()),!l._cache||1<Math.max(c*u,d*u)?It(t,i,n,s,r,a,h):t.drawImage(n?l.getImage(n,s.width,s.height):l._cache,s.x,s.y,s.width,s.height)):It(t,i,n,s,r,a,h),t._data=null,t._view=null)},It=function(t,e,i,n,o,s,r){var a,h,l,c,d,u,g,_,f=o&&o.getStyle("image.state"),A=t._vector,y=t._color,p=t._fill,m=t._pattern,v=t._lineWidth,x=t._alpha,w=t._sx,E=t._sy,C=e;if(!1!==Mt(o,C,C,"visible",s)){for(t._color=i,(a=Mt(o,C,C,"v",s))&&a.length,g=C.w&&Mt(o,C,C,"w")||o.getWidth(),_=C.h&&Mt(o,C,C,"h")||o.getHeight(),e=n.width/g,i=n.height/_,!0===r?(t._fill=null,t._pattern=null,t._lineWidth=null,t._alpha=null):(t._sx=e,t._sy=i),t.save(),t.translate(n.x+n.width/2,n.y+n.height/2),1==e&&1==i||t.scale(e,i),C.origin&&t.translate((C.origin.x-.5)*g,(C.origin.y-.5)*_),(t._vector=C).clip&&(t.beginPath(),!0===C.clip?t.rect(-(C.origin?C.origin.x:.5)*g,-(C.origin?C.origin.y:.5)*_,g,_):C.clip.length?C.clip.forEach(function(e){t.drawShape(e)}):t.drawShape(C.clip),t.clip()),Pt(o,C,C,t,s),l=0,h=a.length;l<h;l++)d=a[l],t._shapeData=d,s&&(s._shapeDataIndex=l,d.animate&&Wt(d,C,o,s)),u=Mt(o,C,d,"state",s),!1===Mt(o,C,d,"visible",s)||u&&!(Array.isArray(u)?0<=u.indexOf(f):u===f)||(c=Lt[d.shape])&&(t.save(),"vector"===d.shape||"g"===d.shape?c(t,d,o,s):Pt(o,C,d,t,s,function(){c(t,d,o,s)}),t.restore()),s&&(s._shapeDataIndex=null),t._shapeData=null;t.restore(),t._vector=A,t._shapeData=null,t._color=y,t._fill=p,t._pattern=m,t._lineWidth=v,t._alpha=x,t._sx=w,t._sy=E}},Lt={line:function(t,e,i,n){var o,s,r=Mt(i,t._vector,e,"p1",n),a=Mt(i,t._vector,e,"p2",n);r=r?(o=Ot(r.length?r[0]:r.x,t),Nt(r.length?r[1]:r.y,t)):(o=Mt(i,t._vector,e,"x1",n,!0),Mt(i,t._vector,e,"y1",n,!1)),n=a?(s=Ot(a.length?a[0]:a.x,t),Nt(a.length?a[1]:a.y,t)):(s=Mt(i,t._vector,e,"x2",n,!0),Mt(i,t._vector,e,"y2",n,!1));t.moveTo(o,r),t.lineTo(s,n)},rect:function(t,e,i,n){var o,s,r,a=Mt(i,t._vector,e,"rect",n),h=Mt(i,t._vector,e,"r",n),l=a?(l=Array.isArray(a)?(o=a[0],s=a[1],r=a[2],a[3]):(o=a.x,s=a.y,r=a.w,a.h),o=Ot(o,t),s=Nt(s,t),r=Ot(r,t),Nt(l,t)):(o=Mt(i,t._vector,e,"x",n,!0),s=Mt(i,t._vector,e,"y",n,!1),r=Mt(i,t._vector,e,"w",n,!0),Mt(i,t._vector,e,"h",n,!1));t.drawRoundRect(o,s,r,l,h),(t._gradientFunc||t._pattern)&&(t._rect={x:o,y:s,w:r,h:l})},circle:function(t,e,i,n){var o=Mt(i,t._vector,e,"cx",n,!0),s=Mt(i,t._vector,e,"cy",n,!1),r=t._vector.w&&Mt(i,t._vector,t._vector,"w")||i.getWidth(),a=t._vector.h&&Mt(i,t._vector,t._vector,"h")||i.getHeight(),h=Ft(Mt(i,t._vector,e,"r",n),Math.min(r,a),e,t._vector),l=Mt(i,t._vector,e,"startAngle",n);null==l&&(l=0),null==(r=Mt(i,t._vector,e,"endAngle",n))&&(r=360),null==(a=Mt(i,t._vector,e,"anticlockwise",n))&&(a=!1),(n=Mt(i,t._vector,e,"close",n))&&t.moveTo(o,s),t.arc(o,s,h,l/180*Math.PI,r/180*Math.PI,a),n&&t.closePath(),(t._gradientFunc||t._pattern)&&(t._rect={x:o-h,y:s-h,w:2*h,h:2*h})},ellipse:function(t,e,i,n){var o=Mt(i,t._vector,e,"cx",n,!0),s=Mt(i,t._vector,e,"cy",n,!1),r=Mt(i,t._vector,e,"rx",n,!0),a=Mt(i,t._vector,e,"ry",n,!1),h=Mt(i,t._vector,e,"startAngle",n),l=Mt(i,t._vector,e,"endAngle",n),c=Mt(i,t._vector,e,"anticlockwise",n);null==h&&(h=0),null==l&&(l=360),null==c&&(c=!1),(n=Mt(i,t._vector,e,"close",n))&&t.moveTo(o,s),t.ellipse(o,s,r,a,0,h/180*Math.PI,l/180*Math.PI,c),n&&t.closePath(),(t._gradientFunc||t._pattern)&&(t._rect={x:o-r,y:s-a,w:2*r,h:2*a})},path:function(t,e,i,n){n=Mt(i,t._vector,e,"data",n),t.drawPath(n)},text:function(t,e,i,n){var o,s,r,a,h,l,c=Mt(i,t._vector,e,"text",n),d=Mt(i,t._vector,e,"x",n,!0),u=Mt(i,t._vector,e,"y",n,!1),g=Mt(i,t._vector,e,"w",n,!0);null!=c&&(n=(c=String(c)).split("\n"),o=2*t.measureText("e").width,s=t,r=g,h=a=0,c=(c=c).split("\n"),l=2*s.measureText("e").width,c.forEach(function(t){if(r)for(var e,i,n,o,c=t.split(" "),d=c.length,u="",g=0;g<d;g++)if(e=c[g]+(g===d-1?"":" "),(n=s.measureText(i=u+e).width)<r)u=i;else if(n==r)u="",h+=l;else{for(o=0;o<e.length;o++)if(i=u+e.substr(0,o+1),s.measureText(i).width>r){u=e.substring(o,e.length),h+=l;break}for(;0<u.length&&s.measureText(u).width>r;)for(o=0;o<u.length;o++)if(i=u.substr(0,o+1),s.measureText(i).width>r){u=u.substring(o,u.length),h+=l;break}}else n=s.measureText(t).width,a=a<n?n:a;h+=l}),c={w:a=r||a,h:h},u-=(c.h/o-1)/2*o,n.forEach(function(e){if(g){for(var i,n,s,r,a=e.split(" "),h=a.length,l="",c=0;c<h;c++)if(i=a[c]+(c===h-1?"":" "),(s=t.measureText(n=l+i).width)<g)l=n;else if(s==g)t.fillText(l,d,u),l="",u+=o;else{for(r=0;r<i.length;r++)if(n=l+i.substr(0,r+1),t.measureText(n).width>g){t.fillText(n.substring(0,n.length-1),d,u),l=i.substring(r,i.length),u+=o;break}for(;0<l.length&&t.measureText(l).width>g;)for(r=0;r<l.length;r++)if(n=l.substr(0,r+1),t.measureText(n).width>g){t.fillText(l.substr(0,r),d,u),l=l.substring(r,l.length),u+=o;break}}t.fillText(l,d,u)}else t.fillText(e,d,u);u+=o}))},draw:function(t,e,i,o){var s=e.draw;"function"==typeof(s="string"==typeof s?(e=s.match(Dt))?(e="with(data) { "+e[1]+" }",n.Util.newFunction("g","data","view",e)):Ut[s]:s)&&s.call(t._vector,t,i,o)},vector:function(t,e,i,n){var s,r,a,h,l,c,d,u,g,_=t._vector,f=Mt(i,_,e,"name",n),A=Mt(i,_,e,"x",n,!0),y=Mt(i,_,e,"y",n,!1),p=Mt(i,_,e,"w",n),m=Mt(i,_,e,"h",n),v="string"==typeof f?(l=o.images[f])&&l._image:f;if(v)if(Vt(v))null!=p&&null!=m?t.drawImage(v,A,y,Ot(p,t),Nt(m,t)):t.drawImage(v,A,y);else{for(d=(c=Mt(i,v,v,"v",n))&&c.length,u=v.w&&Mt(i,v,v,"w"),g=v.h&&Mt(i,v,v,"h"),m=null!=p&&null!=m?(p=Ot(p,t),Nt(m,t)):(p=u,g),t.save(),h=t._lineWidth,l=t._fill,f=t._alpha,Pt(i,v,v,t,n),Pt(i,_,e,t,n),t.translate(A,y),t.scale(p/u,m/g),v.origin&&t.translate((v.origin.x-.5)*u,(v.origin.y-.5)*g),v.clip&&(t.beginPath(),!0===v.clip?t.rect(-(v.origin?v.origin.x:.5)*u,-(v.origin?v.origin.y:.5)*g,u,g):v.clip.length?v.clip.forEach(function(e){t.drawShape(e)}):t.drawShape(v.clip),t.clip()),g=t._shapeData,t._vector=v,s=0;s<d;s++)r=c[s],t._shapeData=r,n&&(n._shapeDataIndex.length?n._shapeDataIndex.push(s):n._shapeDataIndex=[n._shapeDataIndex,s],r.animate&&Wt(r,_,i,n)),!1!==Mt(i,v,r,"visible",n)&&(a=Lt[r.shape])&&(t.save(),"vector"===r.shape||"g"===r.shape?a(t,r,i,n):Pt(i,v,r,t,n,function(){a(t,r,i,n)}),t.restore()),n&&n._shapeDataIndex.pop();t._vector=_,t._shapeData=g,t._lineWidth=h,t._fill=l,t._alpha=f,t.restore()}},g:function(t,e,i,n){var o,s,r,a,h,l=Mt(i,t._vector,e,"v",n);l&&l.length&&(t.save(),s=t._lineWidth,r=t._fill,a=t._alpha,h=t._shapeData,Pt(i,t._vector,e,t,n),l.forEach(function(e){!1!==Mt(i,t._vector,e,"visible",n)&&(o=Lt[e.shape])&&(t.save(),"vector"===(t._shapeData=e).shape||"g"===e.shape?o(t,e,i,n):Pt(i,t._vector,e,t,n,function(){o(t,e,i,n)}),t.restore())}),t._lineWidth=s,t._fill=r,t._alpha=a,t._shapeData=h,t.restore())}};Lt.image=Lt.vector;var St=Object.keys(Lt),kt={M:function(t,e){return t.moveTo(e.x,e.y),t._path_start=e,t._rect&&zt(t._rect,e.x,e.y),e},m:function(t,e,i){return i&&(e={x:i.x+e.x,y:i.y+e.y}),t.moveTo(e.x,e.y),t._path_start=e,t._rect&&zt(t._rect,e.x,e.y),e},Z:function(t){return t.closePath(),t._path_start},z:function(t){return t.closePath(),t._path_start},L:function(t,e){return t.lineTo(e.x,e.y),t._rect&&zt(t._rect,e.x,e.y),e},l:function(t,e,i){return e={x:i.x+e.x,y:i.y+e.y},t.lineTo(e.x,e.y),t._rect&&zt(t._rect,e.x,e.y),e},H:function(t,e,i){return i={x:e.x,y:i.y},t.lineTo(i.x,i.y),t._rect&&zt(t._rect,i.x,i.y),i},h:function(t,e,i){return i={x:i.x+e.x,y:i.y},t.lineTo(i.x,i.y),t._rect&&zt(t._rect,i.x,i.y),i},V:function(t,e,i){return e={x:i.x,y:e.y},t.lineTo(e.x,e.y),t._rect&&zt(t._rect,e.x,e.y),e},v:function(t,e,i){return e={x:i.x,y:i.y+e.y},t.lineTo(e.x,e.y),t._rect&&zt(t._rect,e.x,e.y),e},Q:function(t,e){return t._preQ_x=e.x1,t._preQ_y=e.y1,t.quadraticCurveTo(e.x1,e.y1,e.x,e.y),t._rect&&(zt(t._rect,e.x1,e.y1),zt(t._rect,e.x,e.y)),e},q:function(t,e,i){var n={x:i.x+e.x,y:i.y+e.y},o=t._preQ_x=i.x+e.x1;e=t._preQ_y=i.y+e.y1;return t.quadraticCurveTo(o,e,n.x,n.y),t._rect&&(zt(t._rect,o,e),zt(t._rect,n.x,n.y)),n},T:function(t,e,i){var n=t._preQ_x=2*i.x-t._preQ_x;i=t._preQ_y=2*i.y-t._preQ_y;return t.quadraticCurveTo(n,i,e.x,e.y),t._rect&&(zt(t._rect,n,i),zt(t._rect,e.x,e.y)),e},t:function(t,e,i){var n={x:i.x+e.x,y:i.y+e.y};e=t._preQ_x=2*i.x-t._preQ_x,i=t._preQ_y=2*i.y-t._preQ_y;return t.quadraticCurveTo(e,i,n.x,n.y),t._rect&&(zt(t._rect,e,i),zt(t._rect,n.x,n.y)),n},C:function(t,e){return t._preC_x=e.x2,t._preC_y=e.y2,t.bezierCurveTo(e.x1,e.y1,e.x2,e.y2,e.x,e.y),t._rect&&(zt(t._rect,e.x1,e.y1),zt(t._rect,e.x2,e.y2),zt(t._rect,e.x,e.y)),e},c:function(t,e,i){var n={x:i.x+e.x,y:i.y+e.y},o=i.x+e.x1,s=i.y+e.y1,r=t._preC_x=i.x+e.x2;e=t._preC_y=i.y+e.y2;return t.bezierCurveTo(o,s,r,e,n.x,n.y),t._rect&&(zt(t._rect,o,s),zt(t._rect,r,e),zt(t._rect,n.x,n.y)),n},S:function(t,e,i){var n=2*i.x-t._preC_x;i=2*i.y-t._preC_y;return t._preC_x=e.x2,t._preC_y=e.y2,t.bezierCurveTo(n,i,e.x2,e.y2,e.x,e.y),t._rect&&(zt(t._rect,n,i),zt(t._rect,e.x2,e.y2),zt(t._rect,e.x,e.y)),e},s:function(t,e,i){var n={x:i.x+e.x,y:i.y+e.y},o=2*i.x-t._preC_x,s=2*i.y-t._preC_y,r=t._preC_x=i.x+e.x2;e=t._preC_y=i.y+e.y2;return t.bezierCurveTo(o,s,r,e,n.x,n.y),t._rect&&(zt(t._rect,o,s),zt(t._rect,r,e),zt(t._rect,n.x,n.y)),n}},Pt=function(t,i,n,s,r,a){var h,l,c,d,u,g,f,A,y,p,m,v,w,E,C,T,b,I,L,S,k=Mt(t,i,n,"line",r),P=Mt(t,i,n,"fill",r),R=Mt(t,i,n,"fillRule",r)||"nonzero",D=Mt(t,i,n,"gradient",r),B=Mt(t,i,n,"gradientColor",r),M=Mt(t,i,n,"pattern",r),O=Mt(t,i,n,"font",r),N=Mt(t,i,n,"textAlign",r)||"center",F=Mt(t,i,n,"textBaseline",r)||"middle",z=Mt(t,i,n,"translate",r),V=Mt(t,i,n,"rotate",r),U=Mt(t,i,n,"rotateOrigin",r),H=Mt(t,i,n,"scale",r),Z=Mt(t,i,n,"transform",r),W=Mt(t,i,n,"alpha",r),G=s._lineWidth,Y=s._fill,X=s._pattern,j=s._alpha,K=s._gradientFunc;k=k?(h=k.color,l=k.width,c=k.cap,d=k.join,u=k.miterLimit,g=k.dash,k.dashOffset):(h=Mt(t,i,n,"lineColor",r),l=Mt(t,i,n,"lineWidth",r),c=Mt(t,i,n,"lineCap",r),d=Mt(t,i,n,"lineJoin",r),u=Mt(t,i,n,"miterLimit",r),g=Mt(t,i,n,"lineDash",r),Mt(t,i,n,"lineDashOffset",r));null!=h&&(s.strokeStyle=ge(h,s._color)),null!=l&&(s.lineWidth=s._lineWidth=r&&r.getSizeZoom&&!r.zoomManager.sizeChange?l/r.getSizeZoom():l),null!=c&&(s.lineCap=c),null!=d&&(s.lineJoin=d),null!=u&&(s.miterLimit=u),null!=g&&(s.lineDash=g,s.setLineDash(g)),null!=k&&(s.lineDashOffset=k),M?s._pattern=M:(P&&(s.fillStyle=s._fill=ge(P,s._color)),D&&("string"==typeof D?f=x[D]:(f=x[D.type],D.color&&(B=D.color),f||(m=s,(M=(k=D).transform&&Tt(k.transform))&&M.length&&(v=_.identity(),M.forEach(function(t){var e=t[0];"matrix"===e?v.multiply(new _(t[1],t[2],t[3],t[4],t[5],t[6])):"translate"===e?v.translate(t[1]||0,t[2]||0):"scale"===e?v.scale(t[1]||1,t[2]||t[1]||1):"rotate"===e?v.rotate(t[1]||0,t[2]||0,t[3]||0):"skewX"===e?v.skew(t[1]||0,0):"skewY"===e&&v.skew(0,t[1]||0)})),"linear"===k.type?(C=k.x1||0,T=k.y1||0,b=k.x2||0,I=k.y2||0,v&&(C=(w=v.transform(C,T)).x,T=w.y,b=(w=v.transform(b,I)).x,I=w.y),E=m.createLinearGradient(C,T,b,I)):"radial"===k.type&&(M=k.fx||0,C=k.fy||0,T=k.cx||0,b=k.cy||0,I=k.r||0,null==k.fx&&(M=T),null==k.fy&&(C=b),v&&(M=(w=v.transform(M,C)).x,C=w.y,T=(w=v.transform(T,b)).x,b=w.y,I=Math.max(v._m11,v._m22)*I),E=m.createRadialGradient(M,C,0,T,b,I)),E&&k.stop&&k.stop.length&&k.stop.forEach(function(t){E.addColorStop(parseFloat(t.offset),ge(t.color,m._color))}),D=E)),s._gradientFunc=f)),null!=O&&(s.font=O),null!=N&&(s.textAlign=N),null!=F&&(s.textBaseline=F),Rt(t,i,n,s,r),null!=Z?(Z="string"==typeof Z?Tt(Z):Z).length&&Z.forEach(function(t){var e=t[0];"matrix"===e?s.transform(t[1],t[2],t[3],t[4],t[5],t[6]):"translate"===e?s.translate(t[1]||0,t[2]||0):"scale"===e?s.scale(t[1]||1,t[2]||t[1]||1):"rotate"===e?2<t.length?(s.translate(t[2],t[3]),s.rotate(t[1]),s.translate(-t[2],-t[3])):s.rotate(t[1]):"skewX"===e?s.transform(1,0,Math.tan(t[1]*Math.PI/180),1,0,0):"skewY"===e&&s.transform(1,Math.tan(t[1]*Math.PI/180),0,1,0,0)}):(null!=z&&(z=Array.isArray(z)?(p=z[0],z[1]):"object"==e(z)?(p=z.x,z.y):(p=z,0),p=Ot(p,s),z=Nt(z,s),0===p&&0===z||s.translate(p,z)),null!=V&&V%360!=0&&(U&&(Array.isArray(U)?(L=U[0],S=U[1]):"object"==e(U)?(L=U.x,S=U.y):L=S=U,L=Ot(L,s),S=Nt(S,s),0===L&&0===S||s.translate(L,S)),s.rotate(V*Math.PI/180),U&&(0===L&&0===S||s.translate(-L,-S))),null!=H&&(Array.isArray(H)?(A=H[0],y=H[1]):"object"==e(H)?(A=H.x,y=H.y):A=y=H,1===A&&1===y||s.scale(A,y))),null!=W&&(s.globalAlpha=s._alpha=null!=j?j*W:W),a&&(s.beginPath(),a(),n=s._rect||n.rect,s._pattern?(0<s._lineWidth&&s.stroke(),s.clip(),function(t,e,i,n,s){var r,a,h,l,c,d,u,g,_=t._vector,f=_.origin,A=_.w&&Mt(n,_,_,"w")||n.getWidth(),y=_.h&&Mt(n,_,_,"h")||n.getHeight();if("string"==typeof e?(_=o.images[e])&&(h=_.getWidth(),l=_.getHeight()):(h=e.w&&Mt(n,e,e,"w"),l=e.h&&Mt(n,e,e,"h")),h&&l&&i)for(c=i.w/h*t._sx,d=i.h/l*t._sy,r=i.x-A/2*(t._sx-1),a=i.y-y/2*(t._sy-1),f&&(r-=(f.x-.5)*A*(t._sx-1),a-=(f.y-.5)*y*(t._sy-1)),1===t._sx&&1===t._sy||(t.scale(1/t._sx,1/t._sy),r+=((f?f.x:.5)*A+i.x)*(t._sx-1),a+=((f?f.x:.5)*y+i.y)*(t._sy-1)),i={x:0,y:0,width:h,height:l},u=0;u<c;u++)for(g=0;g<d;g++)i.x=u*h+r,i.y=g*l+a,bt(t,e,null,i,n,s,!0)}(s,s._pattern,n,t,r)):((D=f&&n?f(s,ge(P||"#000000",s._color),ge(B||"#FFFFFF",s._color),n.x,n.y,n.w,n.h):D)&&(s.fillStyle=s._fill=D),s._fill&&s.fill(R),0<s._lineWidth&&s.stroke()),s._lineWidth=G,s._fill=Y,s._pattern=X,s._alpha=j,s._gradientFunc=K,s._rect=null)},Rt=function(t,e,i,n,o){var s,r,a,h=Mt(t,e,i,"shadow",o);o=h?(s=h.offsetX,r=h.offsetY,a=h.blur,h.color):(s=Mt(t,e,i,"shadowOffsetX",o),r=Mt(t,e,i,"shadowOffsetY",o),a=Mt(t,e,i,"shadowBlur",o),Mt(t,e,i,"shadowColor",o));null!=s&&(n.shadowOffsetX=s),null!=r&&(n.shadowOffsetY=r),null!=a&&(n.shadowBlur=a),null!=o&&(n.shadowColor=o)},Dt=/<%([\s\S]+?)%>/,Bt=new RegExp([/<%=([\s\S]+?)%>/.source,Dt.source].join("|")),Mt=function t(i,o,s,r,a,h,l){var c,d=s[r],u=e(d);if("string"==u&&(c=d.match(Bt))?(c="with(data) { "+(c[1]?"return "+c[1]:c[2])+" }",d=n.Util.newFunction("data","view",c).call(o,i,a)):"function"==u&&(d=d.call(o,i,a)),!0===h?(u=o.w&&t(i,o,o,"w")||i.getWidth(),(!0===s.rel||void 0===s.rel&&o.rel)&&d<=1&&-1<=d?d*=u:"string"==typeof d&&(d=parseInt(d)/100*u),d=d||0):!1===h&&(h=o.h&&t(i,o,o,"h")||i.getHeight(),(!0===s.rel||void 0===s.rel&&o.rel)&&d<=1&&-1<=d?d*=h:"string"==typeof d&&(d=parseInt(d)/100*h),d=d||0),!1!==l&&a&&i&&s.animate&&i._animates){var g,_=i._animates,f=a._shapeDataIndex;if(f.length)for(var A=0;A<f.length;A++)_=_[g=f[A]];else g=f;var y=_[g][r];if(y)if(Array.isArray(y))for(A=y.length-1;0<=A;A--){var p=y[A];if((p.stopped||0<p.time)&&p.started)return qt(p,d)}else if(y.started)return qt(y,d)}return d},Ot=function(t,e){if(!t)return 0;var i=e._vector.w&&Mt(e._data,e._vector,e._vector,"w")||e._data.getWidth();return(e._shapeData&&!0===e._shapeData.rel||(!e._shapeData||void 0===e._shapeData.rel)&&e._vector.rel)&&t<=1&&-1<=t?t*i:"string"==typeof t?parseInt(t)/100*i:t},Nt=function(t,e){if(!t)return 0;var i=e._vector.h&&Mt(e._data,e._vector,e._vector,"h")||e._data.getHeight();return(e._shapeData&&!0===e._shapeData.rel||(!e._shapeData||void 0===e._shapeData.rel)&&e._vector.rel)&&t<=1&&-1<=t?t*i:"string"==typeof t?parseInt(t)/100*i:t},Ft=function(t,e,i,n){return t?(!0===i.rel||void 0===i.rel&&n.rel)&&t<=1&&-1<=t?t*e:"string"==typeof t?parseInt(t)/100*e:t:0};(h=(window.CanvasRenderingContext2D||r.Context2d).prototype).drawShape=function(t){var e=this,i=e._vector,n=e._shapeData,o=e._data,s=e._view,r=Lt[t.shape];r&&(e.save(),"vector"===(e._shapeData=t).shape||"g"===t.shape?r(e,t,o,s):Pt(o,i,t,e,s,function(){r(e,t,o,s)}),e._shapeData=n,e.restore())},h.drawPath=function(t){var e,i,n,o,s,r,a,h,l,c,d,u,g=this;if(!((l=(t="string"==typeof t?pt(t):t)?t.length:0)<=1)){if((g._gradientFunc||g._pattern)&&(g._rect=c={x:0,y:0,w:0,h:0}),(e=t&&t[0]&&t[0].c)||(i=t&&t[0]&&null!=t[0].x,(n="z"===t[l-1]||"Z"===t[l-1])&&l--),e){for(o=0;o<l;o++)r=t[o],(a=kt[r.c])&&(s=a(g,r,s));g._path_start=null,g._preC_x=null,g._preC_y=null,g._preQ_x=null,g._preQ_y=null}else if(i){for(h=t[0],d=Ot(h.x,g),u=Nt(h.y,g),g.moveTo(d,u),c&&zt(c,d,u),o=1;o<l;o++)h=t[o],d=Ot(h.x,g),u=Nt(h.y,g),g.lineTo(d,u),c&&zt(c,d,u);n&&g.closePath()}else{for(d=Ot(t[0],g),u=Nt(t[1],g),g.moveTo(d,u),c&&zt(c,d,u),o=2;o<l;o+=2)d=Ot(t[o],g),u=Nt(t[o+1],g),g.lineTo(d,u),c&&zt(c,d,u);n&&g.closePath()}return t}};var zt=function(t,e,i){var n=Math.min(t.x,e),o=Math.max(t.x+t.w,e);e=Math.min(t.y,i),i=Math.max(t.y+t.h,i);t.x=n,t.y=e,t.w=o-n,t.h=i-e};h._fillPath=function(t,e){this.beginPath(),this.fillStyle=t,this.drawPath(e),this.fill()},h._fillRect=function(t,e,i,n,o){this.beginPath(),this.fillStyle=t,this.rect(e,i,n,o),this.fill()},h.ellipse||(h.ellipse=function(t,e,i,n){var o=this,s=.5522848*i,r=.5522848*n,a=t+i,h=e+n;i=t-i,n=e-n;o.moveTo(i,e),o.bezierCurveTo(i,e-r,t-s,n,t,n),o.bezierCurveTo(t+s,n,a,e-r,a,e),o.bezierCurveTo(a,e+r,t+s,h,t,h),o.bezierCurveTo(t-s,h,i,e+r,i,e)}),h.drawRoundRect=function(t,e,i,n,o){var s=this;if(o){if(Array.isArray(o))if(1===o.length)l=c=d=r=o[0];else if(2===o.length)l=c=o[0],d=r=o[1];else{if(4!==o.length)return void s.rect(t,e,i,n);l=o[0],c=o[1],d=o[2],r=o[3]}else l=c=d=r=o;var r,a=t+i,h=e+n,l=l<(u=i<n?2*i:2*n)?l:u,c=c<u?c:u,d=d<u?d:u,u=(o=.292893218813453*(r=r<u?r:u),.585786437626905*r);s.moveTo(a,h-r),s.quadraticCurveTo(a,h-u,a-o,h-o),s.quadraticCurveTo(a-u,h,a-r,h),o=.292893218813453*d,u=.585786437626905*d,s.lineTo(t+d,h),s.quadraticCurveTo(t+u,h,t+o,h-o),s.quadraticCurveTo(t,h-u,t,h-d),o=.292893218813453*l,u=.585786437626905*l,s.lineTo(t,e+l),s.quadraticCurveTo(t,e+u,t+o,e+o),s.quadraticCurveTo(t+u,e,t+l,e),o=.292893218813453*c,u=.585786437626905*c,s.lineTo(a-c,e),s.quadraticCurveTo(a-u,e,a-o,e+o),s.quadraticCurveTo(a,e+u,a,e+c),s.lineTo(a,h-r)}else s.rect(t,e,i,n)};var Vt=function(t){return r?t instanceof r||t instanceof c:t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement},Ut={},Ht=function(t,e){"function"==typeof e&&(Ut[t]=e)},Zt=function(t,e){"function"==typeof e&&St.indexOf(t)<0&&(Lt[t]=e)};function Wt(t,e,i,n){var o=t.animate,s=n._now,r=n._shapeDataIndex;if(l=(l=i._animates)||(i._animates={}),r.length)for(var a=0;a<r.length;a++)var h,l=l[h=r[a]]||(l[h]={});else h=r;var c=l[h];c||(c=l[h]={},o.forEach(function(o){var r,a=o.attr,h=c[a];o={attr:a,to:o.to,type:o.type||"number",delay:o.delay||0,dur:o.dur||1e3,interval:o.interval||0,finish:o.finish,repeat:o.repeat||1,reverse:null==o.reverse||o.reverse,onDone:o.onDone,easing:o.easing,trigger:null==o.to,start:s,time:0,total:0,count:0,started:!1,stopped:!1,current:null},Array.isArray(o.dur)&&(o.groupDur=o.dur.slice(0,o.dur.length-1),o.dur=o.dur[o.dur.length-1],o.groupDurTotal=o.groupDur.reduce(function(t,e,i){return o.groupDur[i]=t+e},0),o.groupIndex=0,o.groupTime=0,o.groupStart=s),null==o.finish&&(o.finish=o.delay+o.dur+o.interval),h?Array.isArray(h)?(h.push(o),h=h[h.length-2]):c[a]=[h,o]:(r=Mt(i,e,t,a,n),c[a]=o),h&&(r=h.to,"group_set"===h.type&&(r=r[r.length-1])),o.from=r,o.trigger||(o.started=!0,Jt(o),Qt(o))})),o=c,Object.keys(o).forEach(function(r){var a=o[r];Array.isArray(a)?(r=a[a.length-1]).count+1===r.repeat?a.forEach(function(o){Gt(o,t,e,i,n,!0)}):r.count+1<r.repeat&&(r.total>=r.finish&&a.forEach(function(t){t.trigger||(t.started=!0),t.stopped=!1,t.time=0,t.start=s,t.total=0,"group_set"===t.type&&(t.groupIndex=0,t.groupTime=0,t.groupStart=s)}),a.forEach(function(o){Gt(o,t,e,i,n,!1)})):Gt(a,t,e,i,n,!0)})}function Gt(t,e,i,n,o,s){if(t.trigger){var r=Mt(n,i,e,t.attr,o,null,!1);if(!t.started){if(r===t.from)return;t.started=!0,t.start=o._now,t.to=r,Jt(t),Qt(t)}t.started&&r!==t.to&&(t.start=o._now,t.from=t.current,t.to=r,t.time=0,t.total=0,t.count=0,Jt(t),Qt(t))}t.started&&!t.stopped&&((r=(e=o._now)-t.start)>=t.delay&&(t.total=r,r-=t.delay,t.time=r>t.dur?t.dur:r,"group_set"===t.type&&(t.groupTime=e-t.groupStart,t.groupStart===t.start&&(t.groupTime-=t.delay),t.groupTime>=t.groupDur[t.groupIndex]&&t.groupIndex++,t.groupTime>=t.groupDurTotal&&(t.groupIndex=0,t.groupTime=t.groupTime-t.groupDurTotal,t.groupStart=e)),t.total>=t.finish&&(t.count++,t.type,t.count>=t.repeat?(t.time=t.dur,t.stopped=!0,t.trigger&&(t.from=t.to,t.to=null,t.start=null,t.time=0,t.total=0,t.count=0,t.started=!1,t.stopped=!1),t.onDone&&t.onDone.call(i,n,o)):s&&(t.time=0,t.start=e,t.total=0,t.reverse&&(e=t.from,t.from=t.to,t.to=e,Qt(t))))),o&&!o._invalidate&&(o._invalidate=!0))}!function(){for(var t,e=["webkit","moz"],i=0;i<e.length&&!window.requestAnimationFrame;++i){var n=e[i];window.requestAnimationFrame=window[n+"RequestAnimationFrame"],window.cancelAnimationFrame=window[n+"CancelAnimationFrame"]||window[n+"CancelRequestAnimationFrame"]}!/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)&&window.requestAnimationFrame&&window.cancelAnimationFrame||(t=0,window.requestAnimationFrame=function(e){var i=Date.now(),n=Math.max(t+16,i);return setTimeout(function(){e(t=n)},n-i)},window.cancelAnimationFrame=clearTimeout)}();var Yt=n.Animate=function(t){var e=this;e.type=null==t.type?"number":t.type,e.delay=null==t.delay?0:t.delay,e.dur=null==t.dur?1e3:t.dur,e.interval=null==t.interval?0:t.interval,e.finish=null==t.finish?e.delay+e.dur+e.interval:t.finish,null==t.finish?e.finish=e.delay+e.dur+e.interval:(e.finish=t.finish,e.interval=e.finish-e.delay-e.dur),e.repeat=null==t.repeat?1:t.repeat,e.reverse=null==t.reverse||t.reverse,e.easing=null==t.easing?"easeNone":t.easing,e.onUpdate=t.onUpdate,e.onDone=t.onDone,e.onStop=t.onStop,e.onPlay=t.onPlay,e.attr=t.attr,e.source=t.source,e.filter=t.filter,e.from=t.from,e.to=t.to,e.start=null,e.time=0,e.total=0,e.count=0,e.started=!1,e.stopped=!1,e.paused=!1,e.pausedTime=null,e.pausedTotal=0,e._speed=1,e._oldSpeed=null,e._speedTotal=0,e._speedTime=null,e._percent=0,e._percentSet=null,e._percentDiff=0,e.id=te++};function Xt(t){var e;return $t[t.id]||(ee=!0,null==($t[t.id]=t).from&&t.attr&&t.source&&((e=t.attr.match(/^S[:@](.*)/i))?t.from=t.source.getStyle(e[1]):(e=t.attr.match(/^C[:@](.*)/i))?t.from=t.source.getClient(e[1]):t.from=n.Util.getValue(t.source,t.attr)),Jt(t),Qt(t)),t.resume(),t}function jt(t,e){return $t[t.id]&&((e=null==e||e)&&Kt(t,t.to),t.onStop&&t.onStop(),t.time=0,t.total=0,t.start=null,t.count=0,t.started=!1,t.stopped=!1,t.paused=!1,t.pausedTime=null,t.pausedTotal=0,t._oldSpeed=null,t._speedTotal=0,t._speedTime=null,t._percent=0,t._percentSet=null,t._percentDiff=0,delete $t[t.id]),t}function Kt(t,e){var i;t.started||(t.started=!0,t.onPlay&&t.onPlay()),t.filter&&(e=t.filter(e)),t.attr&&t.source&&((i=t.attr.match(/^S[:@](.*)/i))?t.source.setStyle(i[1],e):(i=t.attr.match(/^C[:@](.*)/i))?t.source.setClient(i[1],e):n.Util.setValue(t.source,t.attr,e)),t.onUpdate&&t.onUpdate(e)}function Jt(t){var e=t.type,i=t.from,n=t.to;"number"===e?(t.from=i||0,t.to=n||0):"point"===e?(i?i.length&&(t.from={x:i[0],y:i[1]}):t.from="scale"===t.attr?{x:1,y:1}:{x:0,y:0},n?n.length&&(t.to={x:n[0],y:n[1]}):t.to="scale"===t.attr?{x:1,y:1}:{x:0,y:0}):"rect"===e?(i?i.length&&(t.from={x:i[0],y:i[1],w:i[2],h:i[3]}):t.from={x:0,y:0,w:0,h:0},n?n.length&&(t.to={x:n[0],y:n[1],w:n[2],h:n[3]}):t.to={x:0,y:0,w:0,h:0}):"color"===e&&(t.from=ue(i),t.to=ue(n)),t.current=t.from}function Qt(t){var e=t.type,i=t.from,n=t.to;"number"===e?t.delta=n-i:"point"===e?t.delta={x:n.x-i.x,y:n.y-i.y}:"rect"===e?t.delta={x:n.x-i.x,y:n.y-i.y,w:n.w-i.w,h:n.h-i.h}:"color"===e&&(t.delta={r:n.r-i.r,g:n.g-i.g,b:n.b-i.b,a:n.a-i.a})}function qt(t,e){var i=t.type,n=t.delta,o=t.from,s=t.time,r=t.dur,a=(a=ie[t.easing||"easeNone"])||ie.easeNone;return"number"===i?e=a(s,o,n,r):"point"===i?e={x:a(s,o.x,n.x,r),y:a(s,o.y,n.y,r)}:"rect"===i?e={x:a(s,o.x,n.x,r),y:a(s,o.y,n.y,r),w:a(s,o.w,n.w,r),h:a(s,o.h,n.h,r)}:"color"===i?e="rgba("+Math.floor(a(s,o.r,n.r,r))+","+Math.floor(a(s,o.g,n.g,r))+","+Math.floor(a(s,o.b,n.b,r))+","+Math.floor(a(s,o.a,n.a,r))+")":"set"===i?t.time&&(e=t.to):"group_set"===i&&(e=t.to[t.groupIndex]),t.current=e}o.ext("b2.Animate",Object,{play:function(){return Xt(this)},stop:function(t){return jt(this,t)},pause:function(){this.stopped||(this.paused=!0)},resume:function(){this.paused&&(this.paused=!1,ee=!0)},isPaused:function(){return this.paused},percent:function(t){return null==t?this._percentSet||this._percent:(this._percentSet=t<0?0:100<t?100:t,this.paused&&(ee=!0),this.started||(this.play(),this.pause()),this)},speed:function(t){return null==t?this._speed:((t=t<0?1:t)!==this.speed&&(this.stopped||(this._oldSpeed=this._speed),this._speed=t),this)},clone:function(){return new Yt(this)},chain:function(t){var e,i=this;return((i.next=t).pre=i).onDone?(e=i.onDone,i.onDone=function(){e.call(i),t.play()}):i.onDone=function(){t.play()},i}});var $t={},te=1,ee=!1;!function t(e){var i;n.animateLoopId=requestAnimationFrame(t),ee&&(ee=!1,i=e,Object.keys($t).forEach(function(t){var e=$t[t];e&&(null==e.start&&(e._speedTime=e.start=i),null!=e._percentSet&&(e._percentDiff+=(e._percentSet-e._percent)*e.finish),e.paused&&(e.pausedTime||(e.pausedTime=i),null==e._percentSet)||(null==e._percentSet&&e.pausedTime&&(e.pausedTotal+=(i-e.pausedTime)*(e._oldSpeed||e._speed),e.pausedTime=null),e._oldSpeed&&!e.pausedTime&&(e._speedTotal=(i-e._speedTime)*e._oldSpeed-e.pausedTotal+e._percentDiff+e._speedTotal,e._percentDiff=0,e.pausedTotal=0,e._speedTime=i,e._oldSpeed=null),e.total=(i-e._speedTime)*e._speed-e.pausedTotal+e._percentDiff+e._speedTotal,null!=e._percentSet&&e.pausedTime&&(e.total-=(i-e.pausedTime)*(e._oldSpeed||e._speed)),e._percent=e.total>=e.finish?1:e.total/e.finish,e.total>e.delay&&(e.time=e.total-e.delay,t=!1,e.time>=e.dur&&(e.time=e.dur,e.total>=e.finish&&(t=!0)),e.stopped||Kt(e,qt(e)),e.stopped=t,e.total>=e.finish&&(e.count++,e.count>=e.repeat?(jt(e,!1),e.onDone&&e.onDone()):(e.time=0,e.total=0,e.start=null,e.stopped=!1,e.reverse&&(t=e.from,e.from=e.to,e.to=t,Qt(e))))),e.paused||(ee=ee||!0),null!=e._percentSet&&(e._percentSet=null)))}))}(0);var ie={easeNone:function(t,e,i,n){return i*t/n+e},easeIn:function(t,e,i,n){return i*(t/=n)*t+e},easeOut:function(t,e,i,n){return-i*(t/=n)*(t-2)+e},easeBoth:function(t,e,i,n){return(t/=n/2)<1?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e},easeInStrong:function(t,e,i,n){return i*(t/=n)*t*t*t+e},easeOutStrong:function(t,e,i,n){return-i*((t=t/n-1)*t*t*t-1)+e},easeBothStrong:function(t,e,i,n){return(t/=n/2)<1?i/2*t*t*t*t+e:-i/2*((t-=2)*t*t*t-2)+e},elasticIn:function(t,e,i,n,o,s){return 0===t?e:1==(t/=n)?e+i:(s=s||.3*n,i=!o||o<Math.abs(i)?(o=i,s/4):s/(2*Math.PI)*Math.asin(i/o),-o*Math.pow(2,10*--t)*Math.sin((t*n-i)*(2*Math.PI)/s)+e)},elasticOut:function(t,e,i,n,o,s){var r;return 0===t?e:1==(t/=n)?e+i:(s=s||.3*n,r=!o||o<Math.abs(i)?(o=i,s/4):s/(2*Math.PI)*Math.asin(i/o),o*Math.pow(2,-10*t)*Math.sin((t*n-r)*(2*Math.PI)/s)+i+e)},elasticBoth:function(t,e,i,n,o,s){var r;return 0===t?e:2==(t/=n/2)?e+i:(s=s||n*(.3*1.5),r=!o||o<Math.abs(i)?(o=i,s/4):s/(2*Math.PI)*Math.asin(i/o),t<1?o*Math.pow(2,10*--t)*Math.sin((t*n-r)*(2*Math.PI)/s)*-.5+e:o*Math.pow(2,-10*--t)*Math.sin((t*n-r)*(2*Math.PI)/s)*.5+i+e)},backIn:function(t,e,i,n,o){return t===n&&(t-=.001),i*(t/=n)*t*(((o=void 0===o?1.70158:o)+1)*t-o)+e},backOut:function(t,e,i,n,o){return i*((t=t/n-1)*t*(((o=void 0===o?1.70158:o)+1)*t+o)+1)+e},backBoth:function(t,e,i,n,o){return void 0===o&&(o=5.70158),(t/=n/2)<1?i/2*(t*t*((1+(o*=1.525))*t-o))+e:i/2*((t-=2)*t*((1+(o*=1.525))*t+o)+2)+e},bounceIn:function(t,e,i,n){return i-ie.bounceOut(n-t,0,i,n)+e},bounceOut:function(t,e,i,n){return(t/=n)<1/2.75?i*(7.5625*t*t)+e:t<2/2.75?i*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?i*(7.5625*(t-=2.25/2.75)*t+.9375)+e:i*(7.5625*(t-=2.625/2.75)*t+.984375)+e},bounceBoth:function(t,e,i,n){return t<n/2?.5*ie.bounceIn(2*t,0,i,n)+e:.5*ie.bounceOut(2*t-n,0,i,n)+.5*i+e}},ne={draw:function(t,e){var i=null==e.getCurrentSubNetwork()?e.getElementBox():e.getCurrentSubNetwork(),n=i.getStyle("background.type");"image"==n?this.drawImage(t,i,e):"vector"==n?this.drawVector(t,i,e):"image.vector"==n?(this.drawImage(t,i,e),this.drawVector(t,i,e)):"vector.image"==n&&(this.drawVector(t,i,e),this.drawImage(t,i,e))},drawImage:function(t,e,i){var n=e.getStyle("background.image"),s=o.getImageAsset(n),r=i.getGraphicsZoom?i.getGraphicsZoom():i.getZoom();if(null!=s){var a=e.getStyle("background.image.scope"),h=i.getScopeRect(a),l=i._dragToPan?0:-h.x/r;n=i._dragToPan?0:-h.y/r;if("rootcanvas"!=a&&"viewport"!=a||(h.x=l,h.y=n),"rootcanvas"==a&&(h.width=Math.max(s.getWidth(),h.width/r),h.height=Math.max(s.getHeight(),h.height/r)),"none"==e.getStyle("background.image.stretch")&&(h.width=s.getWidth(),h.height=s.getHeight()),(r=e.getStyle("background.image.padding"))&&f.grow(h,r,r),"tile"==e.getStyle("background.image.stretch")){if(Vt(s.getImage()))for(var c=0;c<h.width;c+=s.getWidth())for(var d=0;d<h.height;d+=s.getHeight())t.drawImage(s.getImage(),c,d)}else"fill"!=e.getStyle("background.image.stretch")&&"none"!=e.getStyle("background.image.stretch")||bt(t,s.getImage(),null,h,e,i)}},drawVector:function(t,e,i){var n=e.getStyle("background.vector.scope"),o=i.getScopeRect(n),s=i.getGraphicsZoom?i.getGraphicsZoom():i.getZoom(),r=i._dragToPan?0:-o.x/s,a=i._dragToPan?0:-o.y/s;"rootcanvas"!=n&&"viewport"!=n||(o.x=r,o.y=a),"rootcanvas"==n&&(o.width=o.width/s,o.height=o.height/s);var h=e.getStyle("background.outline.width");e.getStyle("background.outline.color"),i=e.getStyle("background.vector.fill"),r=e.getStyle("background.vector.fill.color"),a=e.getStyle("background.vector.padding"),n=e.getStyle("background.vector.shape"),s=e.getStyle("background.vector.pattern");a&&f.grow(o,a,a),a=e.getStyle("background.vector.gradient"),i&&(a?m.fill(t,r,a,e.getStyle("background.vector.gradient.color"),o):t.fillStyle=r,m.drawVector(t,n,s,o),t.fill()),0<h&&(t.lineWidth=h,t.strokeStyle=e.getStyle("background.outline.color"),m.drawVector(t,n,s,o),t.stroke())}},oe={shapeMap:{},init:function(){oe.register("arrow.standard",oe.createStandardArrow()),oe.register("arrow.delta",oe.createDeltaArrow()),oe.register("arrow.diamond",oe.createDiamondArrow()),oe.register("arrow.short",oe.createShortArrow()),oe.register("arrow.slant",oe.createSlantArrow()),oe.register("arrow.doubledelta",oe.createDoubleDeltaArrow()),oe.register("arrow.tee",oe.createTeeArrow()),oe.register("arrow.box",oe.createBoxArrow()),oe.register("arrow.dot",oe.createDotArrow()),oe.register("arrow.tail",oe.createTailArrow())},createStandardArrow:function(){var t=new at;return t.add({x:-1,y:-5/9}),t.add({x:-.75,y:0}),t.add({x:-1,y:5/9}),t.add({x:0,y:0}),t.add({x:-1,y:-5/9}),{points:t}},createDeltaArrow:function(){var t=new at;return t.add({x:-1,y:-5/9}),t.add({x:-1,y:5/9}),t.add({x:0,y:0}),t.add({x:-1,y:-5/9}),{points:t}},createDoubleDeltaArrow:function(){var t=new at;return t.add({x:-1,y:-5/9}),t.add({x:-1,y:5/9}),t.add({x:-.5,y:0}),t.add({x:-.5,y:-5/9}),t.add({x:0,y:0}),t.add({x:-.5,y:5/9}),t.add({x:-.5,y:0}),t.add({x:-1,y:-5/9}),{points:t}},createTeeArrow:function(){var t=new at;return t.add({x:-1/9,y:-5/9}),t.add({x:-1/9,y:5/9}),t.add({x:0,y:5/9}),t.add({x:0,y:-5/9}),t.add({x:-1/9,y:-5/9}),{points:t}},createBoxArrow:function(){var t=new at;return t.add({x:-10/9,y:-5/9}),t.add({x:-10/9,y:5/9}),t.add({x:0,y:5/9}),t.add({x:0,y:-5/9}),t.add({x:-10/9,y:-5/9}),{points:t}},createDotArrow:function(){var t={},e=new n.List;return e.add({x:-.5,y:0}),t.points=e,t.draw=function(t,e){var i;t&&e&&e.points&&!(e.points.size()<=0)&&(i=e.points._as[0],e=Math.min(e.width,e.height)/2,t.save(),t.beginPath(),t.arc(i.x,i.y,e,0,2*Math.PI,!1),t.closePath(),t.restore())},t},createTailArrow:function(){for(var t={},e=new n.List,i=-15;i<15;i++)e.add({x:-i/9,y:0});return t.points=e,t.draw=function(t,e){if(t&&e&&e.points&&!(e.points.size()<=0))for(var i=e.points._as,n=e.shadow,o=(e.shadowColor,e.shadowXOffset),s=e.shadowYOffset,r=e.shadowBlur,a=e.shadowColor,h=i.length-4,l=Math.min(e.width,e.height)/2,c=0;c<h;c++){var d=c/h,u=i[c],g=.4*l;t.save(),t.restore(),t.beginPath(),t.globalAlpha=d*d,n&&(t.shadowOffsetX=o,t.shadowOffsetY=s,t.shadowBlur=r,t.shadowColor=a),t.arc(u.x,u.y,g,0,2*Math.PI,!1),t.closePath(),t.fill()}},t},createDiamondArrow:function(){var t=new at;return t.add({x:-7/12,y:5/9}),t.add({x:-14/12,y:0}),t.add({x:-7/12,y:-5/9}),t.add({x:0,y:0}),t.add({x:-7/12,y:5/9}),{points:t}},createShortArrow:function(){var t=new at;return t.add({x:-8/12,y:6/9}),t.add({x:-5/12,y:0}),t.add({x:-8/12,y:-6/9}),t.add({x:0,y:0}),t.add({x:-8/12,y:6/9}),{points:t}},createSlantArrow:function(){var t=new at;return t.add({x:-1,y:-5/9}),t.add({x:-6.5/12,y:0}),t.add({x:-.75,y:4/9}),t.add({x:0,y:0}),t.add({x:-1,y:-5/9}),{points:t}},register:function(t,e){oe.shapeMap[t]=e},getShape:function(t){if(t)return oe.shapeMap[t];throw"shape type can't be null"},getArrowRect:function(t,e,i,n,o,s,r,a,h){if((n=oe.getShape(n))&&n.points&&!(n.points&&n.points.size()<=0)){0<r&&r<1?r*=(t.getLineLength?t:t._element).getLineLength():t.getLineLength&&(r+=oe.calculateArrowXOffsetAtEdge(e,t,i,h));a=(r=f.calculatePointInfoAlongLine(e,i,r,a)).point,r=r.angle;for(var l,c=n.points._as,d=c.length,u=new at,g=new _(o,0,0,s,a.x,a.y),A=0;A<d;A++)u.add(g.transform(c[A]));for(g=f.createMatrix(r+Math.PI,a.x,a.y),A=0;A<d;A++)(l=(l=u.get(A))instanceof at?l._as:l)instanceof Array?(l[0]=g.transform(l[0]),l[1]=g.transform(l[1])):u.set(A,g.transform(l));return f.getLineRect(u)}},drawArrow:function(t,e,i,n,o,s,r,a,h,l,c,d,u){h=h||0,l=l||0,c=c||0;var g=u._element.getStyle("arrow.from.shadow"),_=u._element.getStyle("arrow.from.shadow.color"),A=u._element.getStyle("arrow.from.shadow.xoffset"),y=u._element.getStyle("arrow.from.shadow.yoffset"),p=u._element.getStyle("arrow.from.shadow.blur");u=0<=c&&d;(r||u)&&(!(s=oe.getShape(s))||!s.points||s.points&&s.points.size()<=0||(l=(h=f.calculatePointInfoAlongLine(n,o,h,l)).point,h=h.angle,r&&(t.fillStyle=a),t.beginPath(),u&&(t.lineWidth=c,t.strokeStyle=d),oe._drawArrow(t,s,h,l,e,i,d,_,g,A,y,p),g&&(t.shadowOffsetX=A,t.shadowOffsetY=y,t.shadowBlur=p,t.shadowColor=_),r&&t.fill(),u&&t.stroke()))},_drawArrow:function(t,e,i,o,s,r,a,h,l,c,d,u){if(e.draw){for(y=new n.List,A=0;A<e.points._as.length;A++)y.add(e.points.get(A));for(y.add({x:-1,y:-.5}),y.add({x:-1,y:.5}),y.add({x:0,y:.5}),y.add({x:0,y:-.5}),v=(y=y._as).length,x=new at,m=new _(s,0,0,r,o.x,o.y),A=0;A<v;A++)x.add(m.transform(y[A]));x=x._as,m=f.createMatrix(i+Math.PI,o.x,o.y);for(var g=new at,A=0;A<v;A++)g.add(m.transform(x[A]));e.draw&&e.draw(t,{points:g,width:s,height:r,shadowColor:h,shadow:l,shadowXOffset:c,shadowYOffset:d,shadowBlur:u})}else{var y,p,m,v=(y=e.points._as).length,x=new at;for(m=new _(s,0,0,r,o.x,o.y),A=0;A<v;A++)x.add(m.transform(y[A]));for(x=x._as,m=f.createMatrix(i+Math.PI,o.x,o.y),o=x[0],o=m.transform(o),t.moveTo(o.x,o.y),A=1;A<v;A++)(p=(p=x[A])instanceof at?p._as:p)instanceof Array?(p[0]=m.transform(p[0]),p[1]=m.transform(p[1]),t.quadraticCurveTo(p[0].x,p[0].y,p[1].x,p[1].y)):(p=m.transform(p),t.lineTo(p.x,p.y))}},drawLinkArrow:function(t,e,i,n){var o;i.size()<2||(o=!!t._element.isBundleAgent&&t._element.isBundleAgent(),t._element.getStyle(o?"arrow.agent.from":"arrow.from")&&oe._drawFromArrow(t,e,i,n),t._element.getStyle(o?"arrow.agent.to":"arrow.to")&&oe._drawToArrow(t,e,i,n))},_drawFromArrow:function(t,e,i,n){var o,s,r,a,h=t._element,l=!!h.isBundleAgent&&h.isBundleAgent(),c=h.getStyle(l?"arrow.agent.from.fill":"arrow.from.fill"),d=h.getStyle(l?"arrow.agent.from.outline.width":"arrow.from.outline.width");h.getStyle(l?"arrow.agent.from.shadow.color":"arrow.from.shadow.color"),(c||0<=d)&&(o=h.getStyle(l?"arrow.agent.from.width":"arrow.from.width"),s=h.getStyle(l?"arrow.agent.from.height":"arrow.from.height"),0<(r=h.getStyle(l?"arrow.agent.from.xoffset":"arrow.from.xoffset"))&&r<1?r*=(t.getLineLength?t:t._element).getLineLength():t.getLineLength&&(r+=oe.calculateArrowXOffsetAtEdge(i,t,!0,n)),a=h.getStyle(l?"arrow.agent.from.yoffset":"arrow.from.yoffset"),n=h.getStyle(l?"arrow.agent.from.shape":"arrow.from.shape"),oe.drawArrow(e,o,s,i,!0,n,c,h.getStyle(l?"arrow.agent.from.color":"arrow.from.color"),r,a,d,h.getStyle(l?"arrow.agent.from.outline.color":"arrow.from.outline.color"),t))},_drawToArrow:function(t,e,i,n){var o,s,r,a,h=t._element,l=!!h.isBundleAgent&&h.isBundleAgent(),c=h.getStyle(l?"arrow.agent.to.fill":"arrow.to.fill"),d=h.getStyle(l?"arrow.agent.to.outline.width":"arrow.to.outline.width");(c||0<=d)&&(o=h.getStyle(l?"arrow.agent.to.width":"arrow.to.width"),s=h.getStyle(l?"arrow.agent.to.height":"arrow.to.height"),0<(r=h.getStyle(l?"arrow.agent.to.xoffset":"arrow.to.xoffset"))&&r<1?r*=(t.getLineLength?t:t._element).getLineLength():t.getLineLength&&(r+=oe.calculateArrowXOffsetAtEdge(i,t,!1,n)),a=h.getStyle(l?"arrow.agent.to.yoffset":"arrow.to.yoffset"),n=h.getStyle(l?"arrow.agent.to.shape":"arrow.to.shape"),oe.drawArrow(e,o,s,i,!1,n,c,h.getStyle(l?"arrow.agent.to.color":"arrow.to.color"),r,a,d,h.getStyle(l?"arrow.agent.to.outline.color":"arrow.to.outline.color"),t))},calculateArrowXOffsetAtEdge:function(t,e,i,n){if(null==t||t.size()<2)return 0;var o,s=e._element;if(!(i?s.getStyle("arrow.from.at.edge"):s.getStyle("arrow.to.at.edge")))return 0;if(!(s=i?e._network.getElementUI(s.getFromAgent()):e._network.getElementUI(s.getToAgent())))return 0;if(null==(o=n?s.getZoomBodyRect():s._bodyRect))return 0;for(var r=f._getPoint(t.get(i?0:t.size()-1)),a=0,h=e.getLineLength();oe._containsByInt(o,Math.floor(r.x),Math.floor(r.y),!1)&&a<h;)r=f.calculatePointInfoAlongLine(t,i,a++).point;return a},_containsByInt:function(t,e,i,n){return(n=void 0===n||n)?e>=Math.floor(t.x)&&e<=Math.floor(t.x+t.width)&&i>=Math.floor(t.y)&&i<=Math.floor(t.y+t.height):e>Math.floor(t.x)&&e<Math.floor(t.x+t.width)&&i>Math.floor(t.y)&&i<Math.floor(t.y+t.height)}};oe.init(),o.arrow=oe;var se={bitsToNum:function(t){return t.reduce(function(t,e){return 2*t+e},0)},byteToBitArr:function(t){for(var e=[],i=7;0<=i;i--)e.push(!!(t&1<<i));return e},lzwDecode:function(t,e){for(var i,n,o=0,s=[],r=1<<t,a=1+r,h=t+1,l=[];;)if(n=i,(i=function(t){for(var i=0,n=0;n<t;n++)e.charCodeAt(o>>3)&1<<(7&o)&&(i|=1<<n),o++;return i}(h))!==r){if(i===a)break;if(i<l.length)n!==r&&l.push(l[n].concat(l[i][0]));else{if(i!==l.length)throw new Error("Invalid LZW code.");l.push(l[n].concat(l[n][0]))}s.push.apply(s,l[i]),l.length===1<<h&&h<12&&h++}else!function(){l=[],h=t+1;for(var e=0;e<r;e++)l[e]=[e];l[r]=[],l[a]=null}();return s}};function re(t){var e,i=t,n=null,o=null,s=null,r=0,a=null,h=null,c=null;this.frames=[],this.size={};var d=this,u=l.createElement("canvas");this.loaded=!1;function g(){}this.doParse=function(){!function(t,e){e||(e={});var i=function(e){for(var i=[],n=0;n<e;n++)i.push(t.readBytes(3));return i},n=function(){var e,i;i="";do{e=t.readByte(),i+=t.read(e)}while(0!==e);return i},o=function o(){var s={};switch(s.sentinel=t.readByte(),String.fromCharCode(s.sentinel)){case"!":s.type="ext",function(i){var o=function(i){t.readByte();var n=se.byteToBitArr(t.readByte());i.reserved=n.splice(0,3),i.disposalMethod=se.bitsToNum(n.splice(0,3)),i.userInput=n.shift(),i.transparencyGiven=n.shift(),i.delayTime=t.readUnsigned(),i.transparencyIndex=t.readByte(),i.terminator=t.readByte(),e.gce&&e.gce(i)};switch(i.label=t.readByte(),i.label){case 249:i.extType="gce",o(i);break;case 254:i.extType="com",function(t){t.comment=n(),e.com&&e.com(t)}(i);break;case 1:i.extType="pte",function(i){t.readByte(),i.ptHeader=t.readBytes(12),i.ptData=n(),e.pte&&e.pte(i)}(i);break;case 255:i.extType="app",function(i){switch(t.readByte(),i.identifier=t.read(8),i.authCode=t.read(3),i.identifier){case"NETSCAPE":!function(i){t.readByte(),i.unknown=t.readByte(),i.iterations=t.readUnsigned(),i.terminator=t.readByte(),e.app&&e.app.NETSCAPE&&e.app.NETSCAPE(i)}(i);break;default:!function(t){t.appData=n(),e.app&&e.app[t.identifier]&&e.app[t.identifier](t)}(i)}}(i);break;default:i.extType="unknown",function(t){t.data=n(),e.unknown&&e.unknown(t)}(i)}}(s);break;case",":s.type="img",function(o){o.leftPos=t.readUnsigned(),o.topPos=t.readUnsigned(),o.width=t.readUnsigned(),o.height=t.readUnsigned();var s=se.byteToBitArr(t.readByte());o.lctFlag=s.shift(),o.interlaced=s.shift(),o.sorted=s.shift(),o.reserved=s.splice(0,2),o.lctSize=se.bitsToNum(s.splice(0,3)),o.lctFlag&&(o.lct=i(1<<o.lctSize+1)),o.lzwMinCodeSize=t.readByte();var r=n();o.pixels=se.lzwDecode(o.lzwMinCodeSize,r),o.interlaced&&(o.pixels=function(t,e){for(var i=new Array(t.length),n=t.length/e,o=function(n,o){var s=t.slice(o*e,(o+1)*e);i.splice.apply(i,[n*e,e].concat(s))},s=[0,4,2,1],r=[8,8,4,2],a=0,h=0;h<4;h++)for(var l=s[h];l<n;l+=r[h])o(l,a),a++;return i}(o.pixels,o.width)),e.img&&e.img(o)}(s);break;case";":s.type="eof",e.eof&&e.eof(s);break;default:throw new Error("Unknown block: 0x"+s.sentinel.toString(16))}"eof"!==s.type&&setTimeout(o,0)};!function(){var n={};if(n.sig=t.read(3),n.ver=t.read(3),"GIF"!==n.sig)throw new Error("Not a GIF file.");n.width=t.readUnsigned(),n.height=t.readUnsigned();var o=se.byteToBitArr(t.readByte());n.gctFlag=o.shift(),n.colorRes=se.bitsToNum(o.splice(0,3)),n.sorted=o.shift(),n.gctSize=se.bitsToNum(o.splice(0,3)),n.bgColor=t.readByte(),n.pixelAspectRatio=t.readByte(),n.gctFlag&&(n.gct=i(1<<n.gctSize+1)),e.hdr&&e.hdr(n)}(),setTimeout(o,0)}(i,f)};var _=function(){h&&d.frames.push({data:h.getImageData(0,0,e.width,e.height),delay:o})},f={hdr:(t=function(t){return function(e){t(e)}})(function(t){e=t,d.size.width=e.width,d.size.height=e.height}),gce:t(function(t){_(),a=s,h=s=o=n=null,n=t.transparencyGiven?t.transparencyIndex:null,o=t.delayTime,s=t.disposalMethod}),com:t(g),app:{NETSCAPE:t(g)},img:t(function(t){h=h||u.getContext("2d");var i=d.frames.length,o=t.lctFlag?t.lct:e.gct;0<i&&(3===a?h.putImageData(d.frames[r].data,0,0):r=i-1,2===a&&(c||h.clearRect(c.leftPos,c.topPos,c.width,c.height)));var s=h.getImageData(t.leftPos,t.topPos,t.width,t.height);t.pixels.forEach(function(t,e){t!==n&&(s.data[4*e+0]=o[t][0],s.data[4*e+1]=o[t][1],s.data[4*e+2]=o[t][2],s.data[4*e+3]=255)}),h.putImageData(s,t.leftPos,t.topPos),c=t}),eof:function(t){_(),d.loaded=!0}}}function ae(t,e,i){var n,o,s,r=l.createElement("canvas");return n=r,o=e.width,s=e.height,n.width=o,n.height=s,n.style.width=o+"px",n.style.height=s+"px",r.getContext("2d").clearRect(0,0,e.width,e.height),r.getContext("2d").putImageData(t[i].data,0,0),r}o.ext(function(t){this.data=t,this.len=this.data.length,this.pos=0},Object,{readByte:function(){if(this.pos>=this.data.length)throw new Error("Attempted to read past end of stream.");return 255&this.data.charCodeAt(this.pos++)},readBytes:function(t){for(var e=[],i=0;i<t;i++)e.push(this.readByte());return e},read:function(t){for(var e="",i=0;i<t;i++)e+=String.fromCharCode(this.readByte());return e},readUnsigned:function(){var t=this.readBytes(2);return(t[1]<<8)+t[0]}}),n.Pool=function(t,e){this.func="string"==typeof t?function(){return l.createElement(t)}:t,this.tagName=t,null!=e&&(this.redundancy=e)},o.ext("b2.Pool",Object,{redundancy:2,currentIndex:-1,get:function(){if(this.currentIndex++,this.currentIndex!==this.size())return this.list.get(this.currentIndex);var t=this.func();return t._pool=this,t.style.margin="0px",t.style.padding="0px",this.list||(this.list=new at),this.list.add(t),t},release:function(t){this.list&&0<=this.list.remove(t)&&(delete t._selectData,delete t._expandData,delete t._checkData,delete t._editInfo,delete t.keepDefault,t.style.margin="0px",t.style.padding="0px",t.style.backgroundColor="",t.removeAttribute("title"),"img"===this.tagName&&t.removeAttribute&&(t.removeAttribute("width"),t.removeAttribute("height"),t.removeAttribute("src")),this.list.add(t),this.currentIndex--)},reset:function(){this.currentIndex=-1},clear:function(){if(this.list)for(;this.redundancy+this.currentIndex<this.list.size()-1;)delete this.list.removeAt(this.list.size()-1)._pool},size:function(){return this.list?this.list.size():0}}),n.EventDispatcher=function(){this._f=0},o.ext("b2.EventDispatcher",null,{contains:function(t,e){if(this._ls)for(var i,n=0,o=this._ls.size();n<o;n++)if(t===(i=this._ls.get(n)).l&&e===i.s)return!0;return!1},add:function(t,e,i){i={l:t,s:e,a:i},this._ls||(this._ls=new at),this._f?(this._addPendings||(this._addPendings=new at),this._addPendings.add(i)):i.a?this._ls.add(i,0):this._ls.add(i)},remove:function(t,e){this._ls&&(this._f?(this._removePendings||(this._removePendings=new at),this._removePendings.add({l:t,s:e})):this._remove(t,e))},_remove:function(t,e){for(var i,n=0,o=this._ls.size();n<o;n++)if((i=this._ls.get(n)).l===t&&i.s===e)return void this._ls.removeAt(n)},fire:function(t){if(this._ls){var e,i,n=this._ls.size();for(this._f++,e=0;e<n;e++)(i=this._ls.get(e)).s?i.l.call(i.s,t):i.l(t);if(this._f--,!this._f){if(this._removePendings){for(n=this._removePendings.size(),e=0;e<n;e++)i=this._removePendings.get(e),this._remove(i.l,i.s);delete this._removePendings}if(this._addPendings){for(n=this._addPendings.size(),e=0;e<n;e++)(i=this._addPendings.get(e)).a?this._ls.add(i,0):this._ls.add(i);delete this._addPendings}}}}}),n.ImageAsset=function(t,i,n,o,s){this._name=t,this._width=n,this._height=o,this._svg=s,this._edgeData,"string"==typeof i?this._src=i:"function"==typeof i?this._func=i:Vt(i)?this._image=i:"object"==e(i)&&(this._image=i,this._width=i.w||i.width,this._height=i.h||i.height,!1!==i.cache&&pe(i)&&(Ae(t,i),this._cache=xe(i)))},o.ext("b2.ImageAsset",Object,{getName:function(){return this._name},getSrc:function(){return this._src},isSvg:function(){return this._svg},getImage:function(t,e,i){if(!t||!this._image)return this._image;this._map||(this._map={});var n=this._svg&&3===arguments.length?t+","+e+","+i:t,o=this._map[n];return o||(o=_e(this._cache||this._image,ue(t),this._svg&&e||this.getWidth(),this._svg&&i||this.getHeight()),this._map[n]=o)},getWidth:function(){return this._width},getHeight:function(){return this._height},getFunction:function(){return this._func},_createEdgeData:function(t,e,i){var n=300/e;i<e&&(n=300/i);var o=Math.floor(e*n),s=Math.floor(i*n);this.tempCanvas||(this.tempCanvas=l.createElement("canvas"),this.ctx=this.tempCanvas.getContext("2d")),this.tempCanvas.width=o,this.tempCanvas.height=s,this.ctx.clearRect(0,0,o,s),this.ctx.drawImage(t,0,0,o,s);var r=this.ctx.getImageData(0,0,o,s),a=!0,h=[],c=0;for(e=o,i=s;c<i;c++)for(var d=0;d<e;d++){var u=4*(c*e+d);(w=a!=(g=this._isTransparentPoint(r.data,u))||!g&&(0==d||d==e-1))&&h.push({x:d-(g?1:0),y:c}),a=g}for(a=!0,d=0,e=o,i=s;d<e;d++)for(c=0;c<i;c++){var g;u=4*(c*e+d);(w=a!=(g=this._isTransparentPoint(r.data,u))||!g&&(0==c||c==i-1))&&h.push({x:d,y:c-(g?1:0)}),a=g}for(var _=e/2,f=i/2,A=[],y=0;y<360;y++)A.push({x:_,y:f,dist:0});y=0;for(var p=h.length;y<p;y++){var m=h[y],v=this._getPointAngleDegree(m.x,m.y,_,f),x=this._getPointDist(m.x,m.y,_,f);A[v].dist<x&&(A[v]={x:m.x,y:m.y,dist:x})}var w;for(y=0,p=A.length;y<p;y++)(w=A[y]).x=w.x/n,w.y=w.y/n,delete w.dist;return A},_isTransparentPoint:function(t,e){return t[e]+t[e+1]+t[e+2]+t[e+3]==0},_getPointAngleDegree:function(t,e,i,n){return t=(t=Math.atan2(n-e,i-t))/Math.PI*180,(t=parseInt(t)+180)%360},_getPointDist:function(t,e,i,n){return t=i-t,e=n-e,Math.sqrt(t*t+e*e)}});var he={};function le(t,e){t&&"string"==typeof t&&(t.match(Bt)||o.images[t]||(fe[t]||(fe[t]=[])).push(e))}(h=p.createCanvas()).width=1,h.height=1;var ce,de=h.getContext("2d"),ue=function(t){var e,i=he[t=t||"black"];return i||(de.clearRect(0,0,1,1),de.fillStyle=t,de.fillRect(0,0,1,1),e=de.getImageData(0,0,1,1).data,i=he[t]={r:e[0],g:e[1],b:e[2],a:e[3]}),i},ge=function(t,e){return e?(e=ue(e),t=ue(t),Ee.PIXEL_FILTER_FUNCTION?"rgba("+(e=Ee.PIXEL_FILTER_FUNCTION(t,e)).r+","+e.g+","+e.b+","+t.a+")":null):t},_e=function(t,e,i,n){var o=p.createCanvas(i,n),s=o.getContext("2d");s.drawImage(t,0,0,i,n);try{for(var r=s.getImageData(0,0,i,n),a=r.data,h=0,l=a.length;h<l;h+=4){var c={r:a[h+0],g:a[h+1],b:a[h+2]},d=Ee.PIXEL_FILTER_FUNCTION(c,e);a[h+0]=d.r,a[h+1]=d.g,a[h+2]=d.b}s.putImageData(r,0,0)}catch(e){return t}return o},fe={},Ae=function(t,e){e.pattern&&le(e.pattern,t),e.v&&e.v.forEach(function(e){e.pattern&&le(e.pattern,t)})},ye=function(t){var e=fe[t];e&&(e.forEach(function(t){(t=o.images[t])._cache=xe(t._image)}),delete fe[t])},pe=function(t){return!(!t.w||!t.h)&&me(t)},me=function t(e){return!Object.keys(e).some(function(i){if(/^on/.test(i))return!1;var n=e[i],s=ve(n);return s||"v"!==i?s:n.some(function(e){if("draw"===e.shape)return!0;if("vector"===e.shape){var i=o.images[e.name];if(i&&!i._cache)return!0}return!!Object.keys(e).some(function(t){return"state"===t||"animate"===t||ve(e[t])})||!("g"!==e.shape||!e.v||!e.v.length)&&!t(e)})})},ve=function(t){var i=e(t);return"string"==i&&t.match(Bt)||"function"==i},xe=function(t){var e=p.createCanvas(t.w,t.h),i=e.getContext("2d");return n.Util.makeHighRes(e),It(i,t,null,{x:0,y:0,width:t.w,height:t.h}),e},we=n.imageUtil={IMAGE_LOAD_COMPLETED:"IMAGE_LOAD_COMPLETED",_dispatcher:new n.EventDispatcher,addEventListener:function(t,e,i){we._dispatcher.add(t,e,i)},removeEventListener:function(t,e){we._dispatcher.remove(t,e)},images:{},registerImageByUrl:function(t,e,i){var n;e=e||we.getImageType(t),i=i||we.getImageName(t),we.images[i]||(we.images[i]=t,(n=new c).src=t,n.onload=function(){o.registerImage(i,n,n.width,n.height,!0===e),n.onload=null,delete we.images[i];var s={type:we.IMAGE_LOAD_COMPLETED,url:t,svg:e,name:i};we._dispatcher.fire(s)})},getImageName:function(t){if("string"!=typeof t)return null;var e=t.lastIndexOf("/"),i=t;return 0<=(e=(i=0<=e?t.substring(e+1):i).lastIndexOf("."))?i.substring(0,e):i},getImageType:function(t){if("string"!=typeof t)return null;var e=t.lastIndexOf("/"),i=t;return 0<=(e=(i=0<=e?t.substring(e+1):i).lastIndexOf("."))?i.substring(e+1):i}},Ee={COLORS:["#6495ED","#FFFF00","#00FFFF","#FF0000","#7FFF00","#E0A580","#5FC0CB","#FA00F0","#A1BC50","#FFD700","#4169E1","#E5A5F5","#1E90FF","#696969","#FF6347","#00BFEF","#FFD700","#80E090","#5F9EA0","#A000FF","#7FAF00","#228BA2","#FF00FF","#7FFFD4","#800000","#0000CD","#20B2AA","#D2691E","#6495BD","#DC143C","#F0A8AF","#008B8B","#800080","#B8860B","#4B0082","#00FF00","#FFA500","#FF4500","#FFFF00","#9ACD32","#00008B","#FF1493","#ADFF2F","#4682B4","#00C0B1"],CALL_LATER_DELAY:17,SCROLL_BAR_WIDTH:17,SELECT_COLOR:"#C2CFF1",FOCUS_ON_CLICK:!0,VIEW_POSITION:"absolute",VIEW_FONT_SIZE:"12px",VIEW_FONT_FAMILY:"arial, tahoma, helvetica, sans-serif",TOOLTIP_BACKGROUND:"lightyellow",TOOLTIP_FONT_SIZE:"12px",TOOLTIP_COLOR:"black",TOOLTIP_PADDING:"4px 8px",TOOLTIP_BORDER:"1px solid gray",TOOLTIP_BORDER_RADIUS:"6px",TOOLTIP_XOFFSET:12,TOOLTIP_YOFFSET:12,TOOLTIP_BOX_SHADOW:"0px 0px 3px #AAA",TOOLTIP_ZINDEX:1e5,TOOLTIP_INITIAL_DELAY:750,TOOLTIP_RESHOW_DELAY:500,TOOLTIP_DISMISS_DELAY:4e3,ZOOM_MAX:5,ZOOM_MIN:.1,ZOOM_INCREMENT:1.3,ZOOM_ANIMATE:!0,COLUMN_INNER_TEXT:!0,COLUMN_WIDTH:80,COLUMN_HORIZONTAL_ALIGN:"",COLUMN_PROPERTY_TYPE:"accessor",COLUMN_VALUE_TYPE:"string",COLUMN_EDITABLE:!1,COLUMN_SORTABLE:!0,COLUMN_VISIBLE:!0,COLUMN_RESIZABLE:!0,COLUMN_MOVABLE:!0,COLUMN_RENDER_CELL:null,COLUMN_RENDER_HEADER:null,COLUMN_RENDER_EDITOR:null,PROPERTY_INNER_TEXT:!0,PROPERTY_HORIZONTAL_ALIGN:"",PROPERTY_PROPERTY_TYPE:"accessor",PROPERTY_VALUE_TYPE:"string",PROPERTY_EDITABLE:!1,PROPERTY_CATEGORY_NAME:null,PROPERTY_RENDER_NAME:null,PROPERTY_RENDER_VALUE:null,PROPERTY_RENDER_EDITOR:null,TAB_WIDTH:100,TAB_CLOSABLE:!1,TAB_RESIZABLE:!0,TAB_MOVABLE:!0,TAB_DISABLED:!1,TAB_VISIBLE:!0,ACCORDION_EXPAND_ICON:"expand_icon",ACCORDION_COLLAPSE_ICON:"collapse_icon",ACCORDION_TITLE_HEIGHT:20,ACCORDION_TITLE_BACKGROUND:"#EBEBEB",ACCORDION_BORDER_BOTTOM_COLOR:"lightgray",ACCORDION_ICON_POSITION:"left",TITLEPANE_TITLE_HEIGHT:20,TITLEPANE_TITLE_BACKGROUND:"#DDD",TITLEPANE_TITLE_HORIZONTAL_ALIGN:"left",BORDERPANE_HGAP:0,BORDERPANE_VGAP:0,CHARTPANE_TITLE_HEIGHT:20,CHARTPANE_TITLE_HORIZONTAL_ALIGN:"center",CHARTPANE_LEGEND_ORIENTATION:"bottom",CHARTPANE_LEGEND_WIDTH:80,LEGENDPANE_ICON_WIDTH:10,LEGENDPANE_ICON_HEIGHT:10,LEGENDPANE_ICON_RADIUS:0,LEGENDPANE_ROW_HEIGHT:20,LEGENDPANE_ORIENTATION:"horizontal",LEGENDPANE_HIDDEN_COLOR:"#BABBBC",LEGENDPANE_SELECT_BACKGROUND_COLOR:"#00007D",LEGENDPANE_SELECT_FOREGROUND_COLOR:"#FFFFFF",CHART_TOOLTIP_ENABLED:!0,CHART_SELECT_TOLERANCE:0,CHART_XGAP:6,CHART_YGAP:6,CHART_XZOOM_ENABLED:!0,CHART_YZOOM_ENABLED:!0,CHART_XTRANSLATE_ENABLED:!0,CHART_YTRANSLATE_ENABLED:!0,CHART_DOUBLE_CLICK_TO_RESET:!0,CHART_VALUE_VISIBLE:!0,CHART_VALUE_FONT:null,CHART_BACKGROUND_VISIBLE:!1,CHART_BACKGROUND_FILL:!0,CHART_BACKGROUND_FILL_COLOR:"rgba(50,50,50,0.11)",CHART_BACKGROUND_OUTLINE_WIDTH:1,CHART_BACKGROUND_OUTLINE_COLOR:"rgba(50,50,50,0.11)",CHART_BACKGROUND_GRADIENT:"linear.north",CHART_BACKGROUND_GRADIENT_COLOR:"#FFFFFF",PIECHART_TYPE:"oval",PIECHART_START_ANGLE:0,PIECHART_SELECT_OFFSET:5,PIECHART_SHADOW_OFFSET:1,PIECHART_SHADOW_COLOR:"#C2CFF1",PIECHART_LINE_RATE:.5,PIECHART_DONUT_RATE:.5,PIECHART_VALUE_POSITION:.5,BARCHART_TYPE:"default",BARCHART_UPPER_LIMIT:null,BARCHART_LOWER_LIMIT:0,BARCHART_XAXIS_LINE_COLOR:"#808080",BARCHART_XAXIS_LINE_WIDTH:1,BARCHART_XAXIS_TEXT_COLOR:"#000000",BARCHART_XAXIS_TEXT_FONT:null,BARCHART_YAXIS_LINE_COLOR:"#808080",BARCHART_YAXIS_LINE_WIDTH:1,BARCHART_YAXIS_TEXT_COLOR:"#000000",BARCHART_YAXIS_TEXT_FONT:null,BARCHART_XSCALE_TEXT_FONT:null,BARCHART_XSCALE_TEXT_COLOR:"#000000",BARCHART_XSCALE_TEXT_ORIENTATION:"horizontal",BARCHART_YSCALE_TEXT_VISIBLE:!0,BARCHART_YSCALE_TEXT_COLOR:"#000000",BARCHART_YSCALE_TEXT_FONT:null,BARCHART_YSCALE_LINE_COLOR:"#808080",BARCHART_YSCALE_LINE_WIDTH:.3,BARCHART_YSCALE_VALUE_GAP:0,BARCHART_YSCALE_PIXEL_GAP:20,BARCHART_YSCALE_MIN_TEXT_VISIBLE:!1,LINECHART_INTERRUPTABLE:!0,LINECHART_UPPER_LIMIT:null,LINECHART_LOWER_LIMIT:null,LINECHART_XAXIS_LINE_COLOR:"#808080",LINECHART_XAXIS_LINE_WIDTH:1,LINECHART_XAXIS_TEXT_COLOR:"#000000",LINECHART_XAXIS_TEXT_FONT:null,LINECHART_YAXIS_LINE_COLOR:"#808080",LINECHART_YAXIS_LINE_WIDTH:1,LINECHART_YAXIS_TEXT_COLOR:"#000000",LINECHART_YAXIS_TEXT_FONT:null,LINECHART_XSCALE_TEXT_FONT:null,LINECHART_XSCALE_TEXT_COLOR:"#000000",LINECHART_XSCALE_TEXT_ORIENTATION:"horizontal",LINECHART_XSCALE_LINE_COLOR:"#808080",LINECHART_XSCALE_LINE_WIDTH:.3,LINECHART_YSCALE_TEXT_VISIBLE:!0,LINECHART_YSCALE_TEXT_COLOR:"#000000",LINECHART_YSCALE_TEXT_FONT:null,LINECHART_YSCALE_LINE_COLOR:"#808080",LINECHART_YSCALE_LINE_WIDTH:.3,LINECHART_YSCALE_VALUE_GAP:0,LINECHART_YSCALE_PIXEL_GAP:20,LINECHART_YSCALE_MIN_TEXT_VISIBLE:!1,LINECHART_VALUESPANCOUNT:1,BUBBLECHART_UPPER_LIMIT:null,BUBBLECHART_LOWER_LIMIT:null,BUBBLECHART_XAXIS_UPPER_LIMIT:null,BUBBLECHART_XAXIS_LOWER_LIMIT:null,BUBBLECHART_XAXIS_LINE_COLOR:"#808080",BUBBLECHART_XAXIS_LINE_WIDTH:1,BUBBLECHART_XAXIS_TEXT_COLOR:"#000000",BUBBLECHART_XAXIS_TEXT_FONT:null,BUBBLECHART_YAXIS_LINE_COLOR:"#808080",BUBBLECHART_YAXIS_LINE_WIDTH:1,BUBBLECHART_YAXIS_TEXT_COLOR:"#000000",BUBBLECHART_YAXIS_TEXT_FONT:null,BUBBLECHART_XSCALE_TEXT_FONT:null,BUBBLECHART_XSCALE_TEXT_COLOR:"#000000",BUBBLECHART_XSCALE_TEXT_ORIENTATION:"horizontal",BUBBLECHART_XSCALE_LINE_COLOR:"#808080",BUBBLECHART_XSCALE_LINE_WIDTH:.3,BUBBLECHART_YSCALE_TEXT_VISIBLE:!0,BUBBLECHART_YSCALE_TEXT_COLOR:"#000000",BUBBLECHART_YSCALE_TEXT_FONT:null,BUBBLECHART_YSCALE_LINE_COLOR:"#808080",BUBBLECHART_YSCALE_LINE_WIDTH:.3,BUBBLECHART_YSCALE_VALUE_GAP:0,BUBBLECHART_YSCALE_PIXEL_GAP:20,BUBBLECHART_YSCALE_MIN_TEXT_VISIBLE:!1,BUBBLECHART_SELECT_SHADOW_COLOR:"#000000",BUBBLECHART_SELECT_SHADOW_OFFSET:3,RADARCHART_AXIS_TEXT_FONT:null,RADARCHART_AXIS_TEXT_COLOR:"#000000",RADARCHART_AXIS_TEXT_VISIBLE:!0,RADARCHART_SCALE_TEXT_FONT:null,RADARCHART_SCALE_TEXT_COLOR:"#000000",RADARCHART_SCALE_TEXT_VISIBLE:!0,RADARCHART_AXIS_VISIBLE:!0,RADARCHART_AXIS_LINE_COLOR:"#808080",RADARCHART_AXIS_LINE_WIDTH:3,RADARCHART_AXIS_START_ANGLE:0,RADARCHART_RING_VISIBLE:!0,RADARCHART_RING_TYPE:"line",RADARCHART_RING_LINE_COLOR:"#808080",RADARCHART_RING_LINE_WIDTH:1,RADARCHART_SCALE_COUNT:5,RADARCHART_SCALE_MAXVALUE:1,RADARCHART_SCALE_MINVALUE:0,RADARCHART_ANCHOR_VISIBLE:!0,RADARCHART_AREA_FILL:!0,RADARCHART_AREA_FILL_ALPHA:.2,RADARCHART_AREA_SELECT_FILL_ALPHA:.5,DIALCHART_UPPER_LIMIT:100,DIALCHART_LOWER_LIMIT:0,DIALCHART_START_ANGLE:0,DIALCHART_END_ANGLE:360,DIALCHART_INNER_RADIUS:.8,DIALCHART_COLOR_RANGE_FILL_COLOR:"#808080",DIALCHART_OUTLINE_WIDTH:0,DIALCHART_OUTLINE_COLOR:"#808080",DIALCHART_SCALE_INSIDE:!0,DIALCHART_MAJOR_SCALE_COUNT:11,DIALCHART_MAJOR_SCALE_LINE_WIDTH:2,DIALCHART_MAJOR_SCALE_LINE_LENGTH:8,DIALCHART_MAJOR_SCALE_LINE_COLOR:"#000000",DIALCHART_MINOR_SCALE_COUNT:4,DIALCHART_MINOR_SCALE_LINE_WIDTH:1,DIALCHART_MINOR_SCALE_LINE_LENGTH:4,DIALCHART_MINOR_SCALE_LINE_COLOR:"#000000",DIALCHART_SCALE_TEXT_VISIBLE:!0,DIALCHART_SCALE_UPPER_LIMIT_TEXT_VISIBLE:!0,DIALCHART_SCALE_LOWER_LIMIT_TEXT_VISIBLE:!0,DIALCHART_SCALE_TEXT_FONT:null,DIALCHART_SCALE_TEXT_COLOR:"#000000",DIALCHART_PIVOT_RADIUS:10,DIALCHART_PIVOT_FILL:!0,DIALCHART_PIVOT_FILL_COLOR:"#808080",DIALCHART_PIVOT_OUTLINE_WIDTH:0,DIALCHART_PIVOT_OUTLINE_COLOR:"#808080",DIALCHART_VALUE_POSITION:.5,DIALCHART_INNER_DARKER_RADIUS:10,DIALCHART_OUTER_BRIGHTER_RADIUS:10,DIALCHART_SELECT_SHADOW_COLOR:"#000000",DIALCHART_SELECT_SHADOW_OFFSET:3,TABPANE_TAB_GAP:1,TABPANE_TAB_RADIUS:0,TABPANE_TAB_HEIGHT:24,TABPANE_TAB_ORIENTATION:"top",TABPANE_RESIZE_TOLERANCE:3,TABPANE_TAB_BACKGROUND:"#EBEBEB",TABPANE_DISABLED_COLOR:"#BABBBC",TABPANE_SELECT_BACKGROUND:"white",TABPANE_MOVE_BACKGROUND:"rgba(184,211,240,0.7)",TABPANE_INSERT_BACKGROUND:"orange",TABPANE_HORIZONTAL_ALIGN:"center",TABPANE_CLOSE_ICON:"close_icon",TABPANE_SELECT_NEXT_ON_CLOSE:!0,TABPANE_SELECT_NEXT_ON_INVISIBLE:!0,LISTBASE_INNER_TEXT:!0,LIST_ROW_HEIGHT:19,LIST_INDENT:2,LIST_ROW_LINE_WIDTH:0,LIST_ROW_LINE_COLOR:"#DDD",LIST_MAKE_VISIBLE_ON_SELECTED:!0,LIST_KEYBOARD_REMOVE_ENABLED:!0,LIST_KEYBOARD_SELECT_ENABLED:!0,TREE_ROW_HEIGHT:19,TREE_INDENT:16,TREE_ROW_LINE_WIDTH:0,TREE_ROW_LINE_COLOR:"#DDD",TREE_MAKE_VISIBLE_ON_SELECTED:!0,TREE_KEYBOARD_REMOVE_ENABLED:!0,TREE_KEYBOARD_SELECT_ENABLED:!0,TREE_EXPAND_ICON:"expand_icon",TREE_COLLAPSE_ICON:"collapse_icon",TREE_LINE_TYPE:"none",TREE_LINE_THICKNESS:2,TREE_LINE_COLOR:"#000000",TREE_LINE_ALPHA:1,TREE_LINE_DASH:[4,2],TABLE_ROW_HEIGHT:19,TABLE_ROW_LINE_WIDTH:1,TABLE_ROW_LINE_COLOR:"#DDD",TABLE_COLUMN_LINE_WIDTH:1,TABLE_COLUMN_LINE_COLOR:"#DDD",TABLE_MAKE_VISIBLE_ON_SELECTED:!0,TABLE_KEYBOARD_REMOVE_ENABLED:!0,TABLE_KEYBOARD_SELECT_ENABLED:!0,TABLE_EDITABLE:!1,TABLEHEADER_HEIGHT:24,TABLEHEADER_RESIZE_TOLERANCE:3,TABLEHEADER_BACKGROUND:"#EBEBEB",TABLEHEADER_MOVE_BACKGROUND:"rgba(184,211,240,0.7)",TABLEHEADER_INSERT_BACKGROUND:"orange",TABLEHEADER_COLUMN_LINE_COLOR:"#DDD",TABLEHEADER_SORT_DESC_ICON:"sort_desc",TABLEHEADER_SORT_ASC_ICON:"sort_asc",TABLEHEADER_SORT_ICON_POSITION:"98% 50%",TREETABLE_ROW_HEIGHT:19,TREETABLE_INDENT:16,TREETABLE_ROW_LINE_WIDTH:1,TREETABLE_ROW_LINE_COLOR:"#DDD",TREETABLE_COLUMN_LINE_WIDTH:1,TREETABLE_COLUMN_LINE_COLOR:"#DDD",TREETABLE_MAKE_VISIBLE_ON_SELECTED:!0,TREETABLE_KEYBOARD_REMOVE_ENABLED:!0,TREETABLE_KEYBOARD_SELECT_ENABLED:!0,TREETABLE_EXPAND_ICON:"expand_icon",TREETABLE_COLLAPSE_ICON:"collapse_icon",TREETABLE_EDITABLE:!1,PROPERTYSHEET_AUTO_ADJUSTABLE:!0,PROPERTYSHEET_INDENT:16,PROPERTYSHEET_ROW_HEIGHT:19,PROPERTYSHEET_ROW_LINE_WIDTH:1,PROPERTYSHEET_COLUMN_LINE_WIDTH:1,PROPERTYSHEET_BORDER_COLOR:"#EBEBEB",PROPERTYSHEET_EXPAND_ICON:"expand_icon",PROPERTYSHEET_COLLAPSE_ICON:"collapse_icon",PROPERTYSHEET_PROPERTY_NAME_WIDTH:100,PROPERTYSHEET_PROPERTY_NAME_HORIZONTAL_ALIGN:"",PROPERTYSHEET_SUM_WIDTH:200,PROPERTYSHEET_RESIZE_TOLERANCE:3,PROPERTYSHEET_EDITABLE:!1,PROPERTYSHEET_CATEGORIZABLE:!0,PROPERTYSHEET_EXPAND_CATEGORY:!0,POPUPMENU_SUBNENU_ENABLE_ICON:"submenu_enable_icon",POPUPMENU_SUBNENU_DISABLE_ICON:"submenu_disable_icon",POPUPMENU_CHECKBOX_SELECTED_ICON:"checkbox_selected_icon",POPUPMENU_CHECKBOX_UNSELECTED_ICON:"checkbox_unselected_icon",POPUPMENU_RADIOBUTTON_SELECTED_ICON:"radiobutton_selected_icon",POPUPMENU_RADIOBUTTON_UNSELECTED_ICON:"radiobutton_unselected_icon",SPLITPANE_ORIENTATION:"horizontal",SPLITPANE_POSITION:.5,SPLITPANE_DIVIDER_WIDTH:6,SPLITPANE_DIVIDER_BACKGROUND:"#CCCCFF",SPLITPANE_DIVIDER_OPACITY:.5,SPLITPANE_MASK_BACKGROUND:"",SPLITPANE_UP_EXPAND_ICON:"up_expand_icon",SPLITPANE_DOWN_EXPAND_ICON:"down_expand_icon",SPLITPANE_LEFT_EXPAND_ICON:"left_expand_icon",SPLITPANE_RIGHT_EXPAND_ICON:"right_expand_icon",NODE_WIDTH:50,NODE_HEIGHT:50,IMAGE_NODE:"node_image",IMAGE_GROUP:"group_image",IMAGE_SUBNETWORK:"subnetwork_image",ICON_DATABOX:"databox_icon",ICON_DATA:"data_icon",ICON_NODE:"node_icon",ICON_LINK:"link_icon",ICON_GROUP:"group_icon",ICON_SUBNETWORK:"subnetwork_icon",ICON_GRID:"grid_icon",ICON_BUS:"bus_icon",ICON_SHAPENODE:"shapenode_icon",ICON_SHAPELINK:"shapelink_icon",ICON_LINKSUBNETWORK:"linksubnetwork_icon",ICON_SHAPESUBNETWORK:"shapesubnetwork_icon",LAYER_DEFAULT_ID:"default",LAYER_DEFAULT_NAME:"default",ATTACHMENT_POINTER_LENGTH:10,ATTACHMENT_POINTER_WIDTH:8,ATTACHMENT_CORNER_RADIUS:5,ATTACHMENT_CONTENT_WIDTH:30,ATTACHMENT_CONTENT_HEIGHT:20,ATTACHMENT_POSITION:"topright.topright",ATTACHMENT_XOFFSET:0,ATTACHMENT_YOFFSET:0,ATTACHMENT_PADDING:0,ATTACHMENT_PADDING_LEFT:0,ATTACHMENT_PADDING_RIGHT:0,ATTACHMENT_PADDING_TOP:0,ATTACHMENT_PADDING_BOTTOM:0,ATTACHMENT_DIRECTION:"right",ATTACHMENT_FILL:!1,ATTACHMENT_FILL_COLOR:"#000000",ATTACHMENT_GRADIENT:null,ATTACHMENT_GRADIENT_COLOR:"#FFFFFF",ATTACHMENT_OUTLINE_WIDTH:-1,ATTACHMENT_OUTLINE_COLOR:"#000000",ATTACHMENT_CAP:"butt",ATTACHMENT_JOIN:"miter",ATTACHMENT_SHADOWABLE:!0,NETWORK_TOOLTIP_ENABLED:!0,NETWORK_SELECT_MODE:"mix",NETWORK_MAKE_VISIBLE_ON_SELECTED:!0,NETWORK_NO_AGENT_LINK_VISIBLE:!1,NETWORK_REMOVE_ELEMENTUI_ON_INVISIBLE:!1,NETWORK_SUBNETWORK_ANIMATE:!0,NETWORK_SENDTOTOP_ON_SELECTED:!0,NETWORK_KEYBOARD_REMOVE_ENABLED:!0,NETWORK_KEYBOARD_SELECT_ENABLED:!0,NETWORK_RECT_SELECT_ENABLED:!0,NETWORK_DOUBLECLICK_TO_SUBNETWORK:!0,NETWORK_DOUBLECLICK_TO_UPSUBNETWORK:!0,NETWORK_DOUBLECLICK_TO_EMPTYSUBNETWORK:!0,NETWORK_DOUBLECLICK_TO_LINKBUNDLE:!0,NETWORK_DOUBLECLICK_TO_GROUPEXPAND:!0,NETWORK_SELECT_OUTLINE_COLOR:"#2877A8",NETWORK_SELECT_OUTLINE_WIDTH:1,NETWORK_SELECT_FILL_COLOR:"rgba(184,211,240,0.4)",NETWORK_LAZYMOVE_OUTLINE_COLOR:"#2877A8",NETWORK_LAZYMOVE_OUTLINE_WIDTH:1,NETWORK_LAZYMOVE_FILL_COLOR:"rgba(184,211,240,0.4)",NETWORK_LAZYMOVE_FILL:!0,NETWORK_LAZYMOVE_ANIMATE:!0,NETWORK_RESIZE_POINT_SIZE:3,NETWORK_RESIZE_POINT_FILL_COLOR:"#FFFFFF",NETWORK_RESIZE_POINT_OUTLINE_COLOR:"#000000",NETWORK_RESIZE_POINT_OUTLINE_WIDTH:1,NETWORK_RESIZE_LINE_COLOR:"#000000",NETWORK_RESIZE_LINE_WIDTH:1,NETWORK_RESIZE_ANIMATE:!0,NETWORK_EDIT_POINT_SIZE:3,NETWORK_EDIT_POINT_FILL_COLOR:"#FFFF00",NETWORK_EDIT_POINT_OUTLINE_COLOR:"#000000",NETWORK_EDIT_POINT_OUTLINE_WIDTH:1,NETWORK_EDIT_LINE_COLOR:"rgba(184,211,240,0.7)",NETWORK_EDIT_LINE_WIDTH:2,NETWORK_ROTATE_POINT_SIZE:5,NETWORK_ROTATE_POINT_FILL_COLOR:"#FFFF00",NETWORK_ROTATE_POINT_OFFSET:15,NETWORK_ROTATE_POINT_OUTLINE_WIDTH:1,NETWORK_ROTATE_POINT_OUTLINE_COLOR:"rgba(0,0,0,1)",NETWORK_ROTATE_SCALE_FILL_COLOR:"rgb(227,166,103)",NETWORK_ROTATE_SCALE_FONT_COLOR:"#FFFFFF",NETWORK_ROTATE_SCALE_WIDTH:30,NETWORK_ROTATE_SCALE_HEIGHT:20,NETWORK_LIMIT_ELEMENT_INPOSITIVE_LOCATION:!0,NETWORK_LINK_FLOW_STEPPING:3,NETWORK_LINK_FLOW_COLOR:"#FF0000",NETWORK_LINK_FLOW_INTERVAL:600,NETWORK_SELECTION_TOLERANCE:2,NETWORK_TRANSPARENT_SELECTION_ENABLE:!1,SHOW_ALARM_IN_ATTACHMENT_DIV:!0,SHOW_LABEL_IN_ATTACHMENT_DIV:!1,SHOW_LABEL2_IN_ATTACHMENT_DIV:!1,SHOW_ICON_IN_ATTACHMENT_DIV:!1,SHOW_EDIT_IN_ATTACHMENT_DIV:!1,OVERVIEW_FILL_COLOR:"rgba(184,211,240,0.4)",OVERVIEW_OUTLINE_COLOR:"#B8D3F0",OVERVIEW_OUTLINE_WIDTH:1,OVERVIEW_SELECT_COLOR:"#0000FF",OVERVIEW_SELECT_WIDTH:1,OVERVIEW_PADDING:1,OVERVIEW_ANIMATE:!0,OVERVIEW_MAX_PACKING_WIDTH:-1,OVERVIEW_MAX_PACKING_HEIGHT:-1,TOUCH_MOVE_THRESHOLD:5,TOUCH_RECT_SELECT_THRESHOLD:20,TOUCH_ZOOM_THRESHOLD:30,LINK_BUNDLE_AGENT_FUNCTION:null,IS_LINK_ADJUSTED_TO_BOTTOM:!1,GROUP_EXPAND_ALIGN:"center",ELEMENTUI_FUNCTION:function(t,e){var i=e.getElementUIClass();return i?new i(t,e):null},CANVASUI_FUNCTION:function(t,e){var i=e.getCanvasUIClass();return i?new i(t,e):null},VECTORUI_FUNCTION:function(t,e){var i=e.getVectorUIClass();return i?new i(t,e):null},KEEP_DEFAULT_FUNCTION:function(t){return!!(t.target.keepDefault||t.target.getAttribute("keepDefault")||t.target.parentNode&&(t.target.parentNode.keepDefault||t.target.parentNode.getAttribute("keepDefault"))||t.shiftKey)},SORT_FUNCTION:function(t,i){if(t===i)return 0;if(null==t&&null!=i)return 1;if(null!=t&&null==i)return-1;if(null==t&&null==i)return 0;var n,o=e(t),s=e(i);return"string"==o&&"string"==s&&(n=t.localeCompare(i)),0<(n=void 0===(n="number"==o&&"number"==s?t-i:n)?(""+t).localeCompare(""+i):n)?1:n<0?-1:0},CENTER_LOCATION:!1,PIXEL_FILTER_FUNCTION:function(t,e){return e?(t=.3*t.r+.59*t.g+.11*t.b,{r:Math.floor(e.r*t/255),g:Math.floor(e.g*t/255),b:Math.floor(e.b*t/255)}):t}};!function(){var t=Ee;if(window.OverridePipelineDefaults)for(var e in OverridePipelineDefaults)t[e]=OverridePipelineDefaults[e];t.VIEW_FONT_SIZE&&t.VIEW_FONT_FAMILY?t.FONT=t.VIEW_FONT_SIZE+" "+t.VIEW_FONT_FAMILY:t.FONT=l.createElement("canvas").getContext("2d").font,t.CHART_VALUE_FONT||(t.CHART_VALUE_FONT="10px "+t.VIEW_FONT_FAMILY),t.BARCHART_XSCALE_TEXT_FONT||(t.BARCHART_XSCALE_TEXT_FONT="10px "+t.VIEW_FONT_FAMILY),t.BARCHART_YSCALE_TEXT_FONT||(t.BARCHART_YSCALE_TEXT_FONT="10px "+t.VIEW_FONT_FAMILY),t.BARCHART_XAXIS_TEXT_FONT||(t.BARCHART_XAXIS_TEXT_FONT="12px "+t.VIEW_FONT_FAMILY),t.BARCHART_YAXIS_TEXT_FONT||(t.BARCHART_YAXIS_TEXT_FONT="12px "+t.VIEW_FONT_FAMILY),t.LINECHART_XSCALE_TEXT_FONT||(t.LINECHART_XSCALE_TEXT_FONT="10px "+t.VIEW_FONT_FAMILY),t.LINECHART_YSCALE_TEXT_FONT||(t.LINECHART_YSCALE_TEXT_FONT="10px "+t.VIEW_FONT_FAMILY),t.LINECHART_XAXIS_TEXT_FONT||(t.LINECHART_XAXIS_TEXT_FONT="12px "+t.VIEW_FONT_FAMILY),t.LINECHART_YAXIS_TEXT_FONT||(t.LINECHART_YAXIS_TEXT_FONT="12px "+t.VIEW_FONT_FAMILY),t.BUBBLECHART_XAXIS_TEXT_FONT||(t.BUBBLECHART_XAXIS_TEXT_FONT="12px "+t.VIEW_FONT_FAMILY),t.BUBBLECHART_YAXIS_TEXT_FONT||(t.BUBBLECHART_YAXIS_TEXT_FONT="12px "+t.VIEW_FONT_FAMILY),t.BUBBLECHART_XSCALE_TEXT_FONT||(t.BUBBLECHART_XSCALE_TEXT_FONT="10px "+t.VIEW_FONT_FAMILY),t.BUBBLECHART_YSCALE_TEXT_FONT||(t.BUBBLECHART_YSCALE_TEXT_FONT="10px "+t.VIEW_FONT_FAMILY),t.RADARCHART_AXIS_TEXT_FONT||(t.RADARCHART_AXIS_TEXT_FONT="12px "+t.VIEW_FONT_FAMILY),t.RADARCHART_SCALE_TEXT_FONT||(t.RADARCHART_SCALE_TEXT_FONT="10px "+t.VIEW_FONT_FAMILY),t.DIALCHART_SCALE_TEXT_FONT||(t.DIALCHART_SCALE_TEXT_FONT="10px "+t.VIEW_FONT_FAMILY)}(),n.Defaults=Ee,o.ext("b2.Defaults",Object,{}),n.SerializationSettings=function(){var t=n.SerializationSettings;this.isDataBoxSerializable=t.isDataBoxSerializable,this.isLayerBoxSerializable=t.isLayerBoxSerializable,this.isStyleSerializable=t.isStyleSerializable,this.isClientSerializable=t.isClientSerializable,this.isImageSerializable=t.isImageSerializable,this._pm=o.clone(t._pm),this._sm=o.clone(t._sm),this._cm=o.clone(t._cm)},(ce=n.SerializationSettings).isDataBoxSerializable=!0,ce.isLayerBoxSerializable=!0,ce.isStyleSerializable=!0,ce.isClientSerializable=!0,ce.isImageSerializable=!0,ce._pm={},ce._sm={},ce._cm={},ce.setPropertyType=function(t,e){ce._pm[t]=e},ce.getPropertyType=function(t){return ce._pm[t]},ce.setStyleType=function(t,e){ce._sm[t]=e},ce.getStyleType=function(t){return ce._sm[t]},ce.setClientType=function(t,e){ce._cm[t]=e},ce.getClientType=function(t){return ce._cm[t]},o.ext("b2.SerializationSettings",Object,{setPropertyType:function(t,e){this._pm[t]=e},getPropertyType:function(t){return console.log(t),this._pm[t]},setStyleType:function(t,e){this._sm[t]=e},getStyleType:function(t){return this._sm[t]},setClientType:function(t,e){this._cm[t]=e},getClientType:function(t){return this._cm[t]}}),n.Colors={orange:"#EC6C00",orange_light:"#EF8200",orange_dark:"#EA5404",gray_light:"#666666",gray_dark:"#242424",green_light:"#57AB9A",green_dark:"#238475",blue_light:"#61B6D8",blue_dark:"#0089C1"};var Ce=n.Styles={_m:{},setStyle:function(t,e){null==e?delete Ce._m[t]:Ce._m[t]=e},getStyle:function(t){return Ce._m[t]},getStyleProperties:function(){return o.keys(n.Styles._m)}};(h=function(t,e){n.SerializationSettings.setPropertyType(t,e)})("name","cdata"),h("name2","cdata"),h("icon","string"),h("toolTip","cdata"),h("parent","data"),h("layerId","string"),h("alarmState","alarmstate"),h("image","string"),h("imageUrl","string"),h("location","point"),h("width","number"),h("height","number"),h("expanded","boolean"),h("host","data"),h("fromNode","data"),h("toNode","data"),h("points","list.point"),h("segments","list.string"),h("angle","number"),h("visible","boolean"),(h=function(t,i,o){null==o&&(o=null!=i?e(i):"string"),n.Styles.setStyle(t,i),n.SerializationSettings.setStyleType(t,o)})("chart.color",null),h("chart.value",0),h("chart.values",null,"list.number"),h("chart.value.color","#000000"),h("chart.value.font",null),h("chart.line.width",2),h("chart.marker.size",6),h("chart.marker.shape","circle"),h("chart.bubble.shape","circle"),h("chart.names",null,"list.string"),h("chart.xaxis.values",null,"list.number"),h("chart.yaxis.values",null,"list.number"),h("dialchart.rear.extension",0),h("dialchart.base.width",5),h("dialchart.top.width",0),h("dialchart.radius",.8),h("inner.color",null),h("outer.shape","rectangle"),h("outer.color",null),h("outer.width",2),h("outer.padding",1),h("outer.padding.left",0),h("outer.padding.right",0),h("outer.padding.top",0),h("outer.padding.bottom",0),h("outer.cap","butt"),h("outer.join","miter"),h("outer.style","border"),h("shadow.color",null),h("shadow.xoffset",3),h("shadow.yoffset",3),h("shadow.blur",6),h("select.style","shadow"),h("select.color","rgba(0, 0, 0, 0.7)"),h("select.shape","rectangle"),h("select.width",2),h("select.padding",2),h("select.padding.left",0),h("select.padding.right",0),h("select.padding.top",0),h("select.padding.bottom",0),h("select.cap","butt"),h("select.join","miter"),h("whole.alpha",1),h("body.type","default"),h("network.label",null,"cdata"),h("image.padding",0),h("image.padding.left",0),h("image.padding.right",0),h("image.padding.top",0),h("image.padding.bottom",0),h("image.state",null),h("vector.shape","rectangle"),h("vector.fill",!0),h("vector.fill.color","#CCCCFF"),h("vector.outline.width",-1),h("vector.outline.pattern",null,"array.number"),h("vector.outline.color","#5B5B5B"),h("vector.gradient","none"),h("vector.gradient.color","#FFFFFF"),h("vector.padding",0),h("vector.padding.left",0),h("vector.padding.right",0),h("vector.padding.top",0),h("vector.padding.bottom",0),h("vector.cap","butt"),h("vector.join","miter"),h("vector.deep",0),h("group.shape","rectangle"),h("group.fill",!0),h("group.fill.color","#CCCCFF"),h("group.outline.width",-1),h("group.outline.color","#5B5B5B"),h("group.gradient","none"),h("group.gradient.color","#FFFFFF"),h("group.padding",5),h("group.padding.left",0),h("group.padding.right",0),h("group.padding.top",0),h("group.padding.bottom",0),h("group.cap","butt"),h("group.join","miter"),h("group.deep",1),h("group.shape.roundrect.radius",-1),h("group.expend.image",null),h("group.expend.image.vector",!1),h("label.alpha",1),h("label.color","#000000"),h("label.font",null),h("label.position","bottom.bottom"),h("label.direction","below"),h("label.corner.radius",0),h("label.pointer.length",0),h("label.pointer.width",8),h("label.xoffset",0),h("label.yoffset",2),h("label.padding",0),h("label.padding.left",0),h("label.padding.right",0),h("label.padding.top",0),h("label.padding.bottom",0),h("label.fill",!1),h("label.fill.color","#C0C0C0"),h("label.gradient","none"),h("label.gradient.color","#FFFFFF"),h("label.outline.width",-1),h("label.outline.color","#000000"),h("label.cap","butt"),h("label.join","miter"),h("label.shadowable",!0),h("label.align","center"),h("label.rotate.angle",0),h("label.maxlength",0),h("link.label.rotatable",!1),h("label.linespacing",15),h("label2.alpha",1),h("label2.color","#000000"),h("label2.font",null),h("label2.position","top.top"),h("label2.direction","below"),h("label2.corner.radius",0),h("label2.pointer.length",0),h("label2.pointer.width",8),h("label2.xoffset",0),h("label2.yoffset",-2),h("label2.padding",0),h("label2.padding.left",0),h("label2.padding.right",0),h("label2.padding.top",0),h("label2.padding.bottom",0),h("label2.fill",!1),h("label2.fill.color","#C0C0C0"),h("label2.gradient","none"),h("label2.gradient.color","#FFFFFF"),h("label2.outline.width",-1),h("label2.outline.color","#000000"),h("label2.cap","butt"),h("label2.join","miter"),h("label2.shadowable",!0),h("label2.align","center"),h("label2.rotate.angle",0),h("label2.maxlength",0),h("label2.linespacing",15),h("link.label2.rotatable",!1),h("icons.names",null,"array.string"),h("icons.colors",null,"array.string"),h("icons.position",null,"array.string"),h("icons.orientation",null,"array.string"),h("icons.xoffset",[0],"array.number"),h("icons.yoffset",[0],"array.number"),h("icons.xgap",[1],"array.number"),h("icons.ygap",[1],"array.number"),h("alarm.alpha",1),h("alarm.color","#000000"),h("alarm.font",null),h("alarm.position","hotspot"),h("alarm.direction","aboveright"),h("alarm.corner.radius",5),h("alarm.pointer.length",10),h("alarm.pointer.width",8),h("alarm.xoffset",0),h("alarm.yoffset",0),h("alarm.padding",0),h("alarm.padding.left",0),h("alarm.padding.right",0),h("alarm.padding.top",0),h("alarm.padding.bottom",0),h("alarm.gradient","none"),h("alarm.gradient.color","#FFFFFF"),h("alarm.outline.width",-1),h("alarm.outline.color","#000000"),h("alarm.cap","butt"),h("alarm.join","miter"),h("alarm.shadowable",!0),h("link.color","#658DC1"),h("link.width",3),h("link.cap","butt"),h("link.join","miter"),h("link.type","arc"),h("link.pattern",null,"array.number"),h("link.extend",20),h("link.control.point",null,"point"),h("link.bundle.id",0),h("link.bundle.enable",!0),h("link.bundle.expanded",!0),h("link.bundle.independent",!1),h("link.bundle.offset",20),h("link.bundle.gap",12),h("link.bundle.group.gap",0),h("link.looped.gap",6),h("link.looped.direction","northwest"),h("link.looped.type","arc"),h("link.from.position","center"),h("link.from.xoffset",0),h("link.from.yoffset",0),h("link.from.percent",null),h("link.from.at.edge",!0),h("link.to.position","center"),h("link.to.xoffset",0),h("link.to.yoffset",0),h("link.to.percent",null),h("link.to.at.edge",!0),h("link.split.by.percent",!0),h("link.split.percent",.5),h("link.split.value",20),h("link.corner","round"),h("link.xradius",8),h("link.yradius",8),h("link.flow",!1),h("link.flow.converse",!1),h("link.flow.offset",0),h("link.handler.alpha",1),h("link.handler.color","#000000"),h("link.handler.font",null),h("link.handler.position","topleft.topleft"),h("link.handler.direction","below"),h("link.handler.corner.radius",0),h("link.handler.pointer.length",0),h("link.handler.pointer.width",8),h("link.handler.xoffset",0),h("link.handler.yoffset",0),h("link.handler.padding",0),h("link.handler.padding.left",0),h("link.handler.padding.right",0),h("link.handler.padding.top",0),h("link.handler.padding.bottom",0),h("link.handler.fill",!1),h("link.handler.fill.color","#C0C0C0"),h("link.handler.gradient","none"),h("link.handler.gradient.color","#FFFFFF"),h("link.handler.outline.width",-1),h("link.handler.outline.color","#000000"),h("link.handler.cap","butt"),h("link.handler.join","miter"),h("link.handler.shadowable",!0),h("link.agent",!1),h("link.agent.color","#658DC1"),h("link.agent.width",3),h("link.agent.cap","butt"),h("link.agent.join","miter"),h("link.agent.type","arc"),h("link.agent.pattern",null,"array.number"),h("link.agent.extend",20),h("link.agent.control.point",null,"point"),h("link.agent.from.position","center"),h("link.agent.from.xoffset",0),h("link.agent.from.yoffset",0),h("link.agent.from.percent",null),h("link.agent.from.at.edge",!0),h("link.agent.to.position","center"),h("link.agent.to.xoffset",0),h("link.agent.to.yoffset",0),h("link.agent.to.percent",null),h("link.agent.to.at.edge",!0),h("link.agent.split.by.percent",!0),h("link.agent.split.percent",.5),h("link.agent.split.value",20),h("link.agent.corner","round"),h("link.agent.xradius",8),h("link.agent.yradius",8),h("link.agent.flow",!1),h("link.agent.flow.converse",!1),h("link.agent.flow.offset",0),h("follower.row.index",0),h("follower.column.index",0),h("follower.row.span",1),h("follower.column.span",1),h("follower.padding",0),h("follower.padding.left",0),h("follower.padding.right",0),h("follower.padding.top",0),h("follower.padding.bottom",0),h("follower.fill.cell",!0),h("follower.cell.position","center"),h("glow.blur",20),h("grid.row.count",1),h("grid.column.count",1),h("grid.row.percents",null,"array.number"),h("grid.column.percents",null,"array.number"),h("grid.border",1),h("grid.border.left",0),h("grid.border.right",0),h("grid.border.top",0),h("grid.border.bottom",0),h("grid.padding",1),h("grid.padding.left",0),h("grid.padding.right",0),h("grid.padding.top",0),h("grid.padding.bottom",0),h("grid.fill",!0),h("grid.fill.color","#C0C0C0"),h("grid.deep",1),h("grid.cell.deep",-1),h("shapelink.type","lineto"),h("shapenode.closed",!1),h("shapenode.pattern",null,"array.number"),h("bus.style","nearby"),h("arrow.from",!1),h("arrow.from.fill",!0),h("arrow.from.shape","arrow.standard"),h("arrow.from.color","#000000"),h("arrow.from.xoffset",0),h("arrow.from.yoffset",0),h("arrow.from.width",12),h("arrow.from.height",9),h("arrow.from.outline.color","#000000"),h("arrow.from.outline.width",-1),h("arrow.from.at.edge",!0),h("arrow.from.shadow",!1),h("arrow.from.shadow.color","#000000"),h("arrow.from.shadow.xoffset",0),h("arrow.from.shadow.yoffset",0),h("arrow.from.shadow.blur",16),h("arrow.to",!1),h("arrow.to.fill",!0),h("arrow.to.shape","arrow.standard"),h("arrow.to.color","#000000"),h("arrow.to.xoffset",0),h("arrow.to.yoffset",0),h("arrow.to.width",12),h("arrow.to.height",9),h("arrow.to.outline.color","#000000"),h("arrow.to.outline.width",-1),h("arrow.to.at.edge",!0),h("arrow.agent.from",!1),h("arrow.agent.from.fill",!0),h("arrow.agent.from.shape","arrow.standard"),h("arrow.agent.from.color","#000000"),h("arrow.agent.from.xoffset",0),h("arrow.agent.from.yoffset",0),h("arrow.agent.from.width",12),h("arrow.agent.from.height",9),h("arrow.agent.from.outline.color","#000000"),h("arrow.agent.from.outline.width",-1),h("arrow.agent.from.at.edge",!0),h("arrow.agent.from.shadow",!1),h("arrow.agent.from.shadow.color","#000000"),h("arrow.agent.from.shadow.xoffset",0),h("arrow.agent.from.shadow.yoffset",0),h("arrow.agent.from.shadow.blur",16),h("arrow.agent.to",!1),h("arrow.agent.to.fill",!0),h("arrow.agent.to.shape","arrow.standard"),h("arrow.agent.to.color","#000000"),h("arrow.agent.to.xoffset",0),h("arrow.agent.to.yoffset",0),h("arrow.agent.to.width",12),h("arrow.agent.to.height",9),h("arrow.agent.to.outline.color","#000000"),h("arrow.agent.to.outline.width",-1),h("arrow.agent.to.at.edge",!0),h("background.image",null),h("background.image.scope","viewport"),h("background.type","none"),h("background.outline.width",-1),h("background.outline.color",null),h("background.vector.padding",0),h("background.image.padding",0),h("background.image.stretch","fill"),h("background.vector.scope","viewport"),h("background.vector.fill",null),h("background.vector.fill.color",null),h("background.vector.gradient",!1),h("background.vector.gradient.color",null),h("background.vector.shape","rectangle"),h("background.outline.pattern",null,"array.number"),h("attachment.label.style","html"),h("attachment.label2.style","html"),h("attachment.alarm.style","html"),h("attachment.htmllabel.hyperlink",!1),h("attachment.htmllabel2.hyperlink",!1),h("attachment.zIndex",1e3),h("attachment.pointer.events","auto"),o.ext("b2.Styles",Object,{}),n.PropertyChangeDispatcher=function(){this._dispatcher=new n.EventDispatcher},o.ext("b2.PropertyChangeDispatcher",Object,{addPropertyChangeListener:function(t,e,i){this._dispatcher.add(t,e,i)},removePropertyChangeListener:function(t,e){this._dispatcher.remove(t,e)},firePropertyChange:function(t,e,i){return e!=i&&(i={property:t,oldValue:e,newValue:i,source:this},this._dispatcher.fire(i),this.onPropertyChanged(i),!0)},onPropertyChanged:function(t){}}),(h=function(t,e,i,o){var s=new c;s.src=o,n.Util.registerImage(t,s,e,i)})("subnetwork_image",64,46,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAuCAYAAACYlx/0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAB1JJREFUeNrkWmtQk1cafr4vUQhEiNeBpkWwXitCqK1WaiU4tCMjlmCnrU4rmE4v2v1Rmf7q7M6is/uj7e4OurMz7fSyiXXVddsasBa0xQawoqiFFPBWJATkVpQSLPdLTt/zkTCgSHVNuISXeZLvnC8JeZ7zvu8578kBRs/UhB0EE6GZwIaBmbCToIEXWSjBcAfCI4GLoZ3QzIX+0RwgpYnUsPT0dGY2m5nDwYagqKiYGQwGlpiYeKsQJvoc1UQjriKYCYwjJiaG5eScYN09fXeF8qsVLDk5hbneT2gWJkpYyARBJQpCMYFNV6nYRx9/wtq7uv8vnD57jkVGRjL+WYRmgsYDg+U+U0ydoiJvNpPjagICA2E6moVlERH39Zkt9hboEuJxobSUN+2iKMR2dPdYxkSAQD+FhoJSxxiLAY9LNsgtBeS6+qYFBuC/piNYGr7MLV/yZksLXkx6FpfKynjTRiJEtbR32EdFgNmB01REeAdjSHFm9N8146Ev8fgTq9zqqr/evImN8XGoq6nhzd1Nv7amelwA9awZOsrQBjizsHLaNCxf8YSEhUseue0L/nT5IgICArAp5RWP5Jeis2fwxpbN0jX3gtobv1g8IkCYOkjFiDiNvI63gx5QQ7/tD1i9Ng5KZcCYJtl3095BdqaJf3NjVX2j3u0CLA4LUTkcDjNzxvfLr24jbIdDmpLH3q7X1yMlKb5/xpGJSTwxOm9ZLldW2+9LgIhF8/vJ05zr76/EO399H0siHh1vawykvf0mSi1Fw9220/1cQRDyCBklV67a7kmA5eFLTNzt/ZVK/Ond3VCHPjwu1xqWwlM4lvnFQLvKehVtra23kyMRKFfsOVdyMfd3BYheHrmV3J4nPPz57/9CcEgoxqsRMdBADbRFQaQ+4HJZCWqrrDhtzkG1zTr49UZC6qnzxfZhBVj75EqVo89RybN9/MZNWLvhuYldg5AaDTVVOPnNURTmmwfCQxTF2O8KCi23CbBO+xQVLSxt+szZSP3LP9DrcHhFGSrQX431CrI/34+6a1VOcUR9tjnfOESAxHVxvD5XPbtZjwWRj8HbzNHTjexDeylELM41hBhlyvpGagibdBv40tYUOGMmknf8ET19ffBGk4si8r76H0rPF0rhIJPJww4czrDLfXx9+bqeprsodHR1w1utF31YGZeAlqYbaGyo4yvbdIJe2KZPLuZbUNoNz2O6ei683dqbfsbxz/e5QiFMrlD4SSs+1aw5cHhJ8hvJlLOCMG/hYtRfq+YZ8C25r59CujHVz9+rQ8Bl3TTIcxeHo7npOp8BtHI/Ig7XBhzDpDDV7GA4eWvkhn37pc650esmRQg4Yx8u3nJrZaV00dbZjclkLt5yV0e1tRwPjtPix6PrA14+0rO2zlaBkHkLJgXpcloROqtAO/eAPC5AydkCPBkXPykE4FydlivnNTOpkVZCNXZXZwf8/JXevRBqa8UZ83EqoQU+8+2V0UODzxS5TibKgnx8fLAoQiOVk96KzH2foOJCKWSiYOvpc2yXkuAUuXwP3TaczMrA07oXoPBSL+Be/n1WJqbK5TT6LLWzpxcyaXXU22tRKnx1zNEbdL2uBo89tVZyEW9CXVUFDO/vAnHkW+pGe1vHe0O2xIJUARpBFHlhhKSt27AmYaPXjHz+14dhMnzY32Ast765JdZ1T+a6aO3sapih9K+Sy2S68pIizJwTBHXo/Akd7/XVVhz453sozMmmmBe5Jxhrm5qTht0Uddl8dbCB3ruVX6+O1yFhy2sTbsQvnj+D77MzYb1UMtDHHCz1al3D7mE3RW+1R8JC0klBfpwFwSFhWP/yqwijCmpckCsqRENVJYLnhsGXCprO9jbUU7ujvRUN1ZVEumzI6xljRsKuS7ZrtuH3De9gkQvn6URBHPhdMJQEWPVMAhZHrRgz8vYbjfgg7W2J9EhGGd5GDxlEfM+P5VbbyBunI9jjSxepyBO4N2wd3B+6aCkio7USRss6O9rw2d92oqF/IG1E7lZiedTH9/1zz124ctc/mt7V+YBoTXgoifAWQUcIdfVvSNmOiFVrRkWAr/Z+iJLTeZIjUNkedaq41OaOz73nEyKxK5drnGJIXrF+y+tYtnK1B0e+HSe+3I/SMyelNidvLvxhbE6IDLb4mGiDS4SlK1YjVrcZvgo/t5JvrK3GsYOfSs/95Jn+WH6B0Z3/477OCCU+rd1JIqTx68AZs6DVbcKCcI0bRr0DRfnfouD4kYH8RyMfeyQnz+JuD7vvQ1LPr39GSyIYXLlhzgMP4dE1cZIQ9+oRLb/cQNm5Avxw8gS6yPWd01gukdd/kfWtzRMh5pZTYi/p1vPZYoczNwwcapxPIoQ8vFASZY76IRJEMeR9P9fWSESvVfyE8rJiNNbVDJ6/eabf9R/TUSM8aG49Jqd/IUkliiIXImXwbHEvRqQtNOJ7/n3osEeJe0SAwbY9ebOGxOBnjGKcYtxJEAsnTfiRkPHBZwdtGEX7TYABAPgBTYK366ChAAAAAElFTkSuQmCC"),h("bus_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAINJREFUeNqkU0EOgCAMo2Y/1P8Y/6NvnBADwTnGzHYiGetKW8DMKVJLChbVAwCNCrrzp5/Zg/4MaH0JMBOEh08o6OtxtgvXvkFuV/vFBeGEm0WZo8GgF+QlIkI2OrZq5WLAFjuy4DvVWXHl2VodyElMjkxAJNFm4EjmFGAqLKLf+RZgAKkFNRwzv7gHAAAAAElFTkSuQmCC"),h("data_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAMZJREFUeNqkU8ENwjAM9KEwWwaAKVA3iMQDtRtUTAEDdLZWMkkhIUljU4n7RInP9p3dgoiYBAzDgHAyfykA1rtzbr2bmpDDk5uBvu+ROO98pvs4FqRL10nCogokBS3UBaXCZg9JQ7JQY5qmZoK1trCQCuQJnoS9CsQZHKsNcOyWvS1ehdGqz8xyZ0BXEHG+PTdvj+uJkFsASsusdN5sQSKHGWgWfDxY1GcQfEIYIn4p+HuN+SqXRtL8+ZAOinwm5V+P8ZcAAwC0T1T5kpEqewAAAABJRU5ErkJggg=="),h("databox_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwMjI+N/BiIBUD0jMp8FpDm4cQ2DvYEiw8EL9/FqBqkBqUc3BGT7/0kbz/6HsXHhS/eewtWBXA7CYAMOX75PlCEgA9ANYYQaADbJVleRAShJ0Csw7+T5G2MaQCpgQReAuQAWqPhokAuYGCgEowZQwwBQuiYn/mGAEZaeYTkSlA6IBeCUCDMA2RBSsjZAgAEAOyp6/CYHWkwAAAAASUVORK5CYII="),h("grid_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAFdJREFUeNpi/P//PwMlgImBQsACIhgZGUl2BtDljCguAHkFhIMb1xBkU9ULjCATQV4A2UAsWFsfAvcCzEn/YQBoEEE2VD1Y76gXhpcXyM0LjJRmZ4AAAwCoyOJjz29PsAAAAABJRU5ErkJggg=="),h("group_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAOFJREFUeNqUUwsOwjAILa67i2fwEMbEnUej55mJO4Rn8DBtglAh6YfOSdJkBfregwEgottiHiAlQuZjh68TQRJzI5L07nSbC//zOrUAmkxAJXBP2VgxRjpDK818z06gZIwrfSACF0iVVZrLiab7ownOl7PTV0QESsRgWqoHt80oD0fpy/BVhuZfsOpkC8LYxAkBw4YedOdDhuRny1UyZEPE334NvbZ6kBYeJGFPKFgp4HsUAqtI9u1AYipJgfQ+GjtQlPvPMkGlBHrLdFjeBeHruE+hYAxSo6C3jb4zyh8BBgBVL19PZ27iaAAAAABJRU5ErkJggg=="),h("group_image",32,29,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAdCAYAAADLnm6HAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABHNJREFUeNqsV1ts21QY/uy4zc1ZnZY2bdbSLMlKxUWkaBJMgJY9gARIax/2NokVofLARWjiBYRY2QMdCGlI440H1ok3btsQ0wAxNdvKpnYdyyYK7UZHVK1L2rRZLo3j2InDOaZD60psp+WXrDjO93/nO7/PfwkDAwu0Nh8jH30wZwc6/f43X9jVJ5gBn/zueJozgaNkUXLtMwLyLt4XDG4Vtj+/B8lMQRf7QLsb079PCpzJnaVnEsmIEeiZgD/Mu5yYT4uYiWd1sW1NTlCsWQGmzC00gOd5lFQVkqLoYiuViobVBNzf3BRaCfUaUyuV2AomXI1sNrmkRUeUZBRlBXJJRVFRdQUoZVXDclvbvUeImn6j3VmAqpjg5ra0xcL2nDwdwW1JQeP2HJLLki7frVQOo+OXwNnttv5fp65vKPSvvLhHmBgf77fV10XqWBaLZPGEgYC0KIFiOYfdBoY8OH72D8QS6ZoX3x1+CFarFZSnxS1gk9OBeUJ+00BAimAolnM6nQDDEDVAHVOpWQBD/Ow2GyhPoyDHWKjYkr+GVrv+GWBmE6BYIsChRYCz0Kt2AWR92GxWUJ7TFy7GWltb9l368ZteM77lcukE53A4tC91VAC7jggwVIANd3h+OHM+Qlj2ktvQv9U0EIAkSZibm7vbNUpcIxxPQsfQV2BhwDHrE2C320F5qPnaPCMkdVel9EdDQ8iLeex/5+27H4dYljnGnRo5B1EUMT1fwI2lUs0CHs9JOD9xGeNjY9i7u9dXkKTovZgvv/j8H+y2njX+3FxiHmKhgHiGhCir1CwgKxawsLgEynP06xO0aO2sxV+rhAopm9migrRUuwCJVDMS8nXXEE2ALMtIF2UskVJaqxWIgIqqrl8ATUGFkNDaLKu174RGjzYWykO9A17P+6pa2WEqhVnmDOfmnUgmk+gN2vBsZ33NAng1DxspIpTH1+H1Pdrz2OCHn34GpaQfFYe1Dm+9+nKY62jzpIcG3xU20gukXAZtzU0Rkoo+mo6/TMZxI6E/Dzz9sFdLXc7jad6pSIW+jQho2OSKjl2djOyiAwmdB8jrLMj6Ka3emQd+Gh2jeUvTp7/aTGBgwyv+cJNm5HLx2plQSmX9AkYuiuXqOUuorKoj1RZ/7fU34PcHMLj/PSwv5/4LMsgy7EtKuTz887kLyMoq7CERi/miroD5TB4Xr/wGrsPT8omqqlV3PjAwgIYGAd9/+xVmrledG46QjhiZjs0iSYtSehk3M6KugAUigGK5rqA/rAc89MEBOJy81qq7u4LVJyYL27eYSkV50hkXxCLmDCKQIhiK5do3e3VL59TUNdrZ0N3dddTgLMQ89zX5XKQtP+m14kGB1QVv4VVMrIwCRn9M6PkAGctN1fjnwk9ddjc2hcxgb6eWov/rWE7tVGS0ZyWjfEYRoxlkVoBAIhE2gYst5vKDpVJ51QR96PBhxONxfHzw4Oo+wFl2mBFAJ1W6+IgR0OGwD2/zda4Z32/99ScpTiU80fPIvT/1/y3AAMOmtJl1Hv9IAAAAAElFTkSuQmCC"),h("link_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAHVJREFUeNqkkwEOgCAIRaEr6nlqdR49I4XTzcqUn39jE5xP1C+LCPkjCl0Kq2NC5fYgRXlMSCw0K6Xozhqaol3ckj+QVwGFNIsI5HPCCunSLZDhGUcQ0033IOb3riE1CLJty/bTVubUBqDyc+Pm01oY8NQpwAAbUwhLBQIWcAAAAABJRU5ErkJggg=="),h("linksubnetwork_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAU5JREFUeNqUUi1Tw0AQ3cukEY0AwdlDM8XRD41ARAAi/RHoCmQ7/QNofkTQFQh8W9kOOtgiQIBImTnuXbs3udAvduZms5t9b/fdrUiHGW2z0cOdLsdJ71GU46yfUrgL/PWx8HLxsUTOI3EE98mp9ZdXie0K8HgydYXtVtN6znHsTQAwdy2DOcY/TMFytkqogqskLIf6qQhYL7q/PI8cOIoiiuO69bvIRf3o5M/YANVqIZ03GjSbz2m5/KGiKDxgp90irbUINzEz2BSQEMKSwJiEwfgONmlFR4AAhg2yV0talWNfAbfJN4s7KHcCCcBPgy7WhobdM7q9uXbd3TPyhvEOwL4/30kpRVJKwrYySZ7nWABlzpsthM49R5lzYUhAruERr/P7CdZNPJJVakUiuOgAw9jSXOyUX8f4ZkCHGzQvAGIw4v9M4E0CMEh/BRgAwM37IYxGnbkAAAAASUVORK5CYII="),h("node_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAGBJREFUeNpiZGBg+M9AJvj//z8jC5RBsmZGRkYwzQITCGlaS7TmNXXBcDYTA4Vg1IDBYAAjJB2Rl5DgKRGWqshyATm2o3uBgcwMBbacBZdmZJfh8CJIASMLodxGCAAEGACTAB0gDBYjygAAAABJRU5ErkJggg=="),h("node_image",30,32,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAgCAYAAAAFQMh/AAAACXBIWXMAAAsTAAALEwEAmpwYAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAO0SURBVHjavJZJaF1lGIaffzzn3pvbxAyYJulgNKJIF7WkuhEHFCy40LpRBLdFcFi4ciOCC9dmU910WbduBEEoRhFEarJw2UaLJXFImya5ubln+AcX5+YG3ZjCaT44cDb/+5zv/Ybzi7npo7Mhhi+886c5hFBaLUshX9dKq8tW2bPjExOHweXW+vpZ7/1lrZWanz52jK+//f5QwC8+8xSrN2/Oa2OM10pJgKwoWd/cRQpRKyzEyMRIk9QatFIYY7xOEou1BoD1zS6ff/kTqbW1grtZyVsvz3N8cgRrDUli0dZabB+kpGSkYdHWUGfOSkT6prLH04m1GFOBBaAkKBkQsU5wACpBYyyJtfSt1hVYVGDZf68rpNjXs1b3rU72rZaAlhFJRMj6wJUm+1bv1diYqrmEFCgJQtaf8Z6gMaaqcbPRpJGmgxprCYhYK1iL/YwbaUqz0UTneUFeusG8uRARNYPLEAn95spLR54X6K+uLDI1NQ3A7e0ey3+UtBJDnfO004vc6WRMjg3zzeIPrK2toje3O6StLWII7GYFt7qOPNS7uTo9x25WEENgY2uLze0Oem9xhOBwwZM5j3WyVnDmPC54QnAoWWlrgBgj3nuc9+yWHq3rBe+Wlbb3nhjjPhiowM7TdQ7t6rW66xzOVeBBpw/AzlM4z3bpkTVnvF1W2t79B1xZXVI4x3bpUfcE7PC+/LfVUgic80giY6lhJDG1gmUESawY/QWhG0aLxBh2dnoMqcBrpyawNWdcuMCQCuzs9EiMoWG00GPDR2QrMVxdWqIsch5L1cCOukJowerKn/x9M6GVGMaGj0hx+uEHrypjzzwwN0cI4Z7et6SU/HbtGr4sftbNVvN9a5NP1m78elpK6a0x9wRalCUhBNUeai0Xhf5ASykXh4fbbxo9+nin2y2v3/i9B3jq29YRUA+dPN5ot1qmdOXS7dvldfHIiRky5wBJt9djfePONHA/4Or6KwJ/TYzet9pqNIBAqjVianSEtY1NgCeBd4FTQBuoq+AS6AC/AAvAj1OjIzAzPoqS8pyAFQHx/x4gzs7OxosXP4ufLizEkydORA5wrv+sKCnPzYyPooFHh5vppQiTB/n8PMt47523Of/qebIsY7fT4eOPPiRJkoMcnxVwCXhOH2kPXWi3WpMH7s48J5Ql1tpq3p3j6Pj44MJ4gJgUUlwQzz5xpgMMHbhFYyRNU55+/gWC93x35Qp5niHu7q60I9545aUeoO5qPkJAqupICOFuoQD+nwEAIKWd899qAZAAAAAASUVORK5CYII="),h("shapelink_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAIJJREFUeNqkUwsOgCAIxeYN5Ty1Og+ekUarzRwQ5tsYDpTPExIzgwY86uWgtSTwIAF6KTvxg/sMliwwCy27mEVr2Xu7+TjaWm4JqxvKpW/iWowQprX2i8RXhS0xXv+WL0xiKIAVxKssa/0hEMuPiB4epNFxnh7lZG1jdCPdABGcAgwAc06H0rgwLSIAAAAASUVORK5CYII="),h("shapenode_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAI9JREFUeNq0UtsNgDAILI0jdZN2Ho3O027SnRA+MNb0QTWS8EPuLncAIKL5UvY5CEdC7h7pjrEtEABgqwucRCBFk7aAfo9uZJtwmXhQCLDyLJlrkSxaMuGgu8QZ8hVhYD8LVgZx9fMO1H9QKXbm+EJvBYwsuSYyFaEmUvyBUkQWCYUDfg5NV8/49xW6dQowAIJydCoPajIHAAAAAElFTkSuQmCC"),h("shapesubnetwork_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAATBJREFUeNpiDG5cw4ALbO/L+I/M9yyawYjMX1MXzMCCT/PXD69RxLgFREFiKIbADSjzlAfTjq6eYFtBmk+dPgNXaGZqAqZhYjA+igtAmmG2ImuG8UFyIFfAvIPTC+ia0Q2BeYehLpiRCeZfkO37d2/HqRmX4Yxc/CJwZ9+6fYeBEPjw4QOYNjczZfj//z8j3AuMjIjAvXnrNoomdTVVFDkonxEjEIEmgg1C1oAuhw5YQKEZGhHzH9kVbcuPoiiqirSGy5UUF8FtBwFwIK5esYQRaIMfyE/Y/A0yEGbopk2b/FACEeQ0mO1Ati+UvQndFciuAVkG5W5GMQDqV1+QAci2oxuAFC5+4MCBGQIzAEKBBbFimBxILc7MhOQiPzTxTcixwYhsOxLwRWJvxicHEGAAkPKxzyGuYWgAAAAASUVORK5CYII="),h("subnetwork_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAOJJREFUeNqkUjsOwjAMzavSBQYY4FDM7SGYOUARHICZQ5SBiUPBAAMLIJk8aFASkoDgSVFlu/68Z6NatCqF3Woqrj2ZreHabVMpnUs+H/eerz8c0+cV0amuTK6XG69bDEWsa5hM0KafU/DZeJRCmBwWsXRUUwEU0Y5tRFLfgHRMARYDeoPRSyy383Zee0nsgO5rcROBzo19FUlOoYG0Bp/0IAW7y4LHQT5GB/UL4F6ie3mX0yFLoTQUTByQxE8lQ51wMRHx1Chd4FtkReQUj3VFktj97ZSDNYkK9h6L/03hLsAAjRx4oMVjqkMAAAAASUVORK5CYII="),(h=function(t,e,i,o){n.Util.registerImage(t,o,e,i)})("expand_icon",16,18,"data:image/gif;base64,R0lGODlhEAASAIcAADFKY0L/QpSlvZylvZytxqW11qm92r3GxrnK5MbGxsbW69jh8efv9+vz/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAMAAAEALAAAAAAQABIAAAhfAAMIHEiwoMGDCBMqXMjQ4AICEAcMECDgwEECDjJmbMAAwEWNDjgi8GgQ40YGCwyQLDjAAYCXL1UeFBAS5QIFBVYSFMBxwU0EOWcyUIDAQIGjOgcegMnUYsOnUKMiDAgAOw=="),h("collapse_icon",16,18,"data:image/gif;base64,R0lGODlhEAASAIcAADFKY0L/QpSlvZylvZytxqW11qm92r3GxrXI48bGxsbS59Te8efv9+vz/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAMAAAEALAAAAAAQABIAAAhhAAMIHEiwoMGDCBMqXMjQ4AICEAcMECDgwEECDjJmbMAAwEWNADgq8GgQY0YADBYYIFlwgAMAMGGuPCjAAUcACxQUYElQAMcFABQg2EmTgVADBZLyHHggplOLDaNKnYowIAA7"),h("close_icon",11,11,"data:image/gif;base64,R0lGODlhCwALAIcAAHd3d319fUD/QIODg4iIiI6Ojq6urri4uNnZ2eHh4eTk5Ofn5/Dw8PT09Pj4+Pn5+fz8/P39/f///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAMAAAIALAAAAAALAAsAAAhdAAUIOECw4AGBAyUoXCjh4AEJDBA4mIiAQcMDERAUKOBgI4IIBCE0IECSZAMIBB8wYDCg5coHBBkkCECTZgIGMQ0AAKBgpwGcBxgsMLCgKFGcA1cqXXlQoMGCAgMCADs="),h("sort_desc",9,5,"data:image/gif;base64,R0lGODlhCQAFAJECAImJiezs7P///wAAACH5BAEAAAIALAAAAAAJAAUAAAIMDI4QYrnC0INxUnYLADs="),h("sort_asc",9,5,"data:image/gif;base64,R0lGODlhCQAFAJECAImJiezs7P///wAAACH5BAEAAAIALAAAAAAJAAUAAAIMlAWnwIrcDJwi2HsLADs="),h("submenu_enable_icon",8,8,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAA7SURBVHjafI9BDgAgDMKqH3c/ryd1iTqOpARARQUYJG0/AWboB2yoAgTG8jtvtXvMSUdVEdXIeN2cAwDPLmAjfDYS7AAAAABJRU5ErkJggg=="),h("submenu_disable_icon",8,8,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAABKSURBVHjafM9BDoAgDETRD1cTz0W9luDZxhUBCjpJkzZ9m0ESkrhLzW0fJ9JjpT4Zl+juBXmwoB0ACH/gOtNhX2B6AjDUtF3NdwAU6zx4LEQe5AAAAABJRU5ErkJggg=="),h("checkbox_selected_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAAflJREFUeNqkk09oE1EQxn+7btyIYBRCbayFtlhEtLeAin+KouDNo548eJHCQkFQC1K0Bw8VqT1EVIqo0IMUvejNg6AIIglSsdSCiA0WolaIOWi3+2fGw242CRFBHPjg8d7MfPO+mTEcxzkNDAF5/s1KwE0cxylWKhX1fV89r44gget6bVhd9bRcLqvjOEULyGezWTwvAMAwjIRCRAnD8I/0nZ05gLwZOTYeVBXQOIGgqgk+flrk3MUxVBWRyMeMw5oCG2eREFVBVZibf8+x4ydZLH9GVRISq5W5uXwhDKPSvnz9xolTZ/A29GNZFiJ1kjhBnVFVEw0a7MrQ8HlqbMZwXeYXlpL7ti/Usbz8Hd8PEBGmHzxk9kMVfI+BrWt4PHM/0abtC67r8vTZC4qlWY4c2s/Azh2MTxQwpIPduzZx99Z1bNtu1yBiFp6/fMXr4ht+/NzI+MQNBg/sxdccPbmAqcI1UqkUEresTQMR5ejhQbb19XJ25BJzC8Lbd3dIp22mCtPY9tokuDmB2VyBqtDb082VyxdYv26JXysrTF4dY0uuI3lvoKWCaOoMA1SF7q4u7t2eZObREw7u25MMTbPF8VGCqHNRB4IgQFXY3t/H6MhwLFirGYZBfeItoFSr1fKZTAbVaPbT6fRf19A0TarVKkDJ+N91/j0A8Y5o3Yt7KRAAAAAASUVORK5CYII="),h("checkbox_unselected_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAiUlEQVR42qXM3QYFIRiF4d3dJpIhI5FKJCOSSHe7f9gn4ztZo3Wwzt6HvTbHfhdCeD8Nvw27Ad57OI4xUsA5BwMpJQpYa2Eg50wBYwwMlFIocJ4nDFzXRQGtNQzUWilwHAcMtNYooJSCgd47BaSUMDDGoIAQAgbmnBTgnMPAWosCcP3fDdjZNvABvRhVEQglsV8AAAAASUVORK5CYII="),h("radiobutton_selected_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAXFJREFUeNrUUz9rwkAUv0syBVxMm01L2lIdilOg4BcQ7eKcIV/AqZAxo1/B2a/QoSSTH6AQCoFMJUSig5C0EiPEv8G+Z604eJNTHxz37vf73Y977+7obrcjlwRHLoyLDYTThWmav6AgKDA9wrg6UF8wvO12O8RFt9s9bwACwvP8U6lUajWbzbYsy/eIR1Hk27b9GgSBlef5O7OEzWZzC5ufNU17gc01gEQcmCOGHGqYJaxWq1qj0WhzHFfwfZ84jrPHVVUliqIUkPM87wOg4KzBcrm8liTpbr1ek8FgQNI03eOz2Yzouk6QQw3zBFmWUewDxnQ6JUmSHHsDRz9qmD0A8ns8HgcortfrRxxzxJBDDfMEi8XC7ff7b4Zh3FSr1UKlUtnjlFI0mCOHGqZBHMd+GIbWZDIROp1OCxqH74HA9Q17vZ7luq4liqJ/uoee/oVyufxX/wPctwqpfKAieB9OsVj8xMVoNDpv8D8/048AAwDskrF8QGeJUgAAAABJRU5ErkJggg=="),h("radiobutton_unselected_icon",16,16,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAATVJREFUeNrUU71qhEAQ9q8S0mhip3C5kCpcFcgjiJfmal/BKr2lr2DtK1wR9BkCaYRUQTzUQtDE5sB/MTOJAQs3jVUGhp2Z75vPnV2XHseRWmMMtdJWC3DzxDTNnyLHbWC5A7+coA/wt77vT5hYlrUsAASKZdkHWZb3mqYdJEm6wXqWZYHneccwDN1hGF6II3Rddw3Nj7quP0HzDko8OsZYQww5RIGmaXaqqh4YhrnA3cwda4ghh3gGdV1fiaK4bdt28cAQQw5RoCxLGr/2lyGHOAKAn0mShDAnteSIIYcoUFWV7zjOM5DPuJPfxik+I4Yc4gh5ngdRFLlpmnKGYew3YFiH6zvZtu36vu/yPB/Me+j5W1AU5XstiuIW7vseQmmCMvg/XgVBeMckjuNlgf/5mL4EGAAhHbltcqEYDQAAAABJRU5ErkJggg=="),h("right_expand_icon",6,11,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAALCAYAAABcUvyWAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6N0ZBRTFFQjJGQjA1MTFFNUE5M0NCMDAwMTJBRUZCNjkiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6N0ZBRTFFQjNGQjA1MTFFNUE5M0NCMDAwMTJBRUZCNjkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpCMzYzQTE5MUZBRkYxMUU1QTkzQ0IwMDAxMkFFRkI2OSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpCMzYzQTE5MkZBRkYxMUU1QTkzQ0IwMDAxMkFFRkI2OSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqPQWR4AAABJSURBVHjaYvT08vrPwMAgCsQM27ZufcMABUxQ+jWI8PL2FkGXwJBElkCRRJeAS2KTAEvikhDFJiGKzSi4f5iwCSLrwPA5QIABAAmgFhOOHdKvAAAAAElFTkSuQmCC"),h("left_expand_icon",6,11,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAALCAYAAABcUvyWAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6N0ZBRTFFQjZGQjA1MTFFNUE5M0NCMDAwMTJBRUZCNjkiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6N0ZBRTFFQjdGQjA1MTFFNUE5M0NCMDAwMTJBRUZCNjkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo3RkFFMUVCNEZCMDUxMUU1QTkzQ0IwMDAxMkFFRkI2OSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo3RkFFMUVCNUZCMDUxMUU1QTkzQ0IwMDAxMkFFRkI2OSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PmpWGHAAAABISURBVHjaYvz//z8DDHh5e4tAma+ZsAmCCCZsgiDAfOr0aQxBuA50QZgEhiBMQhSXBAM2SaZtW7e+wSYJ1oFNEu5BdEmAAAMAvV8Xc/cw3YgAAAAASUVORK5CYII="),h("up_expand_icon",11,6,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAGCAYAAAAVMmT4AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QjM2M0ExOEZGQUZGMTFFNUE5M0NCMDAwMTJBRUZCNjkiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QjM2M0ExOTBGQUZGMTFFNUE5M0NCMDAwMTJBRUZCNjkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpCMzYzQTE4REZBRkYxMUU1QTkzQ0IwMDAxMkFFRkI2OSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpCMzYzQTE4RUZBRkYxMUU1QTkzQ0IwMDAxMkFFRkI2OSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PnCNygcAAABGSURBVHjaYvz//z8DDHh5e4tAma+BWBTE2LZ16xuYPBMOhXAaSRyiGItCBmwaGD29vHApRAaiyM7ApxAuz0SEQrgGgAADALOxFSETkKKwAAAAAElFTkSuQmCC"),h("down_expand_icon",11,6,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAGCAYAAAAVMmT4AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA0xpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QjM2M0ExOENGQUZGMTFFNUE5M0NCMDAwMTJBRUZCNjkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QjM2M0ExOEJGQUZGMTFFNUE5M0NCMDAwMTJBRUZCNjkiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjQ5ZTRmZmE2LTQzNmYtMTE3OS04NThhLTk1ZGZjOWRiNmNiOCIgc3RSZWY6ZG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjQ5ZTRmZmE2LTQzNmYtMTE3OS04NThhLTk1ZGZjOWRiNmNiOCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PtPgXX8AAAA7SURBVHjaYvH08vrPQCRgAmJRItWKMsEYhBSCTd62desbAhrA4iB1TDAGDg2iyPIwZ2DTIIomzgAQYAAmahUFv1Iq6AAAAABJRU5ErkJggg=="),g.__tree=function(t,e){t._rootVisible=!0,t._initTree=function(t){this._rootData=null,this._expandMap={},this._levelMap={}},t.validateModel=function(){this._rowDatas.clear(),this._levelMap={},this._dataRowMap={},this._currentLevel=0,this._rootData?this._rootVisible?this.isVisible(this._rootData)&&this._buildData(this._rootData):this._buildChildren(this._rootData):this._buildChildren(),delete this._currentLevel},t._buildData=function(t){this._dataRowMap[t.getId()]=this._rowDatas.size(),this._rowDatas.add(t),this._levelMap[t.getId()]=this._currentLevel,this.isExpanded(t)&&(this._currentLevel++,this._buildChildren(t),this._currentLevel--)},t._buildChildren=function(t){var e=t?t.getChildren():this._box.getRoots(),i=this.getCurrentSortFunction();i&&this.isChildrenSortable(t)?e.toList(this.isVisible,this).sort(i).forEach(function(t){this._buildData(t)},this):e.forEach(function(t){this.isVisible(t)&&this._buildData(t)},this)},t.getLevel=function(t){return this._levelMap[t.getId()]},t.getToggleImage=function(t){return 0<t.getChildrenSize()?this.isExpanded(t)?this._expandIcon:this._collapseIcon:null},t.isCheckable=function(t){return this.isCheckMode()},t.isCheckMode=function(){return 1===g.__tree._checkMap[this._checkMode]},t.isChildrenSortable=function(t){return!0},t.handleDataBoxChange=function(t){"remove"===t.kind?delete this._expandMap[t.data.getId()]:"clear"===t.kind&&(this._expandMap={}),this.invalidateModel()},t.isExpanded=function(t){return 1===this._expandMap[t.getId()]},t.expand=function(t){if(!this.isExpanded(t)){for(var e=t.getParent();null!=e&&e!==this._rootData;)this._expandMap[e.getId()]=1,e=e.getParent();this._expandMap[t.getId()]=1,this.invalidateModel()}},t.collapse=function(t){this.isExpanded(t)&&(delete this._expandMap[t.getId()],this.invalidateModel())},t.expandAll=function(){this._box.forEach(function(t){this._expandMap[t.getId()]=1},this),this.invalidateModel()},t.collapseAll=function(){this._expandMap={},this.invalidateModel()},t._handleClick=function(t){var e,i;this.isFocusOnClick()&&n.Util.setFocus(this._view),this._isValidating||(t.target._expandData&&!t.target.ableExpand?(e=t.target._expandData,this.isExpanded(e)?(this.collapse(e),this.fireInteractionEvent({kind:"collapse",data:e})):(this.expand(e),this.fireInteractionEvent({kind:"expand",data:e}))):t.target._selectData||t.target.parentNode._selectData?(this._handlePressSelection(t.target._selectData||t.target.parentNode._selectData,t),this.isCheckMode()&&0<=this.getRowIndexAt(t)&&this.__handleClick(t)):this._treeColumn?(e=this.getDataAt(t))&&(this.isCheckMode()?t.target._checkData||this.__handleClick(t):this._handlePressSelection(e,t)):this.isCheckMode()&&!t.target._checkData&&this.__handleClick(t),this._currentEditor&&!this._isCommitting&&(this._isCommitting=!0,this.commitEditValue(this._currentEditor._editInfo,this._currentEditor)),this.updateCurrentEditor&&(i=this,setTimeout(function(){i.updateCurrentEditor(t)},0)))},t.__handleClick=function(t){var e,i=this.getDataAt(t);i&&(e=this.getRowIndexByData(i),this._focusedRow!==e&&(t=this._rowDatas.get(this._focusedRow),this._focusedRow=e,t&&this.invalidateData(t),this.invalidateData(i)))},t._handleDoubleClick=function(t){this.isFocusOnClick()&&n.Util.setFocus(this._view),this._isValidating||t.target.ableExpand&&t.target._expandData&&(t=t.target._expandData,this.isExpanded(t)?(this.collapse(t),this.fireInteractionEvent({kind:"collapse",data:t})):(this.expand(t),this.fireInteractionEvent({kind:"expand",data:t})))},t.handleChange=function(t){if(!(this._isCommitting||this._isCanceling||this._isValidating)){var e=t.target._checkData;if(e){var i,n=this.isSelected(e),s=this.getSelectionModel();if("default"===this._checkMode)n?s.removeSelection(e):s.appendSelection(e);else if("children"===this._checkMode)(i=new at(e)).addAll(e.getChildren());else if("descendant"===this._checkMode)i=new at,o.fillDescendant(e,i);else if("descendantAncestor"===this._checkMode&&(i=new at,o.fillDescendant(e,i),!n))for(var r=e.getParent();r;)i.add(r),r=r.getParent();n?s.removeSelection(i):s.appendSelection(i)}t.target._editInfo&&this.commitEditValue&&(this._isCommitting=!0,this.commitEditValue(t.target._editInfo,t.target))}},t.onLabelRendered=function(t,e,i,n,o,s){},t.onToggleImageRendered=function(t){},t._renderTree=function(t,e,i,n){var s=this._levelMap[e.getId()],r=this.getToggleImage(e),a=this.getLineType(),h=this._indent,l=this.__spanPool.get();l.style.display="inline-block",l.style.position="relative",l.style.verticalAlign="top",l.style.margin="0px 1px 0px 1px",l.style.width=(s+1)*h+"px",t.appendChild(l);var c,d,u=e,g=u.getParent(),_=0;if("dotted"===a||"solid"===a)for(null==g&&(A=this.getIcon(e),this._addLine(l,e,A,!0));null!==g;){var f=u===(f=g.getChildren()).get(f.size()-1),A=this.getIcon(u);u.setClient("isLast",f),0==_&&this._addLine(l,e,A,f),_++,g=(u=g).getParent()}r&&((c=this.__imagePool.get()).setAttribute("src",o.getImageSrc(r)),c.style.verticalAlign="middle",c._expandData=e,c.style.position="absolute",c.style.right="0px",d=this,c.onload=function(){c.style.top=d.getRowHeight()/2-c.height/2+"px"},l.appendChild(c),this.onToggleImageRendered(c)),h=this.isCheckable(e),a="disabled"===this.getUncheckableStyle(),(h||a)&&(this._addCheckBox(t,e,n).disabled=!h),(A=this.getIcon(e))&&(y=this.isCheckMode()||this._treeColumn?null:e,this._addIcon(t,e,A,y));var y=this.getLabel(e);y&&((l=this.__textPool.get()).style.whiteSpace="nowrap",l.style.verticalAlign="middle",l.style.padding="1px 2px 1px 2px",o.setText(l,y,this._treeColumn?this._treeColumn.isInnerText():this._innerText),r&&(l._expandData=e,l.ableExpand=!0),this.isCheckMode()||this._treeColumn?this._focusedRow===i&&(l.style.backgroundColor=this.getSelectColor(e)):(l._selectData=e,l.style.backgroundColor=n?this.getSelectColor(e):""),this.onLabelRendered(l,e,y,i,s,n),t.appendChild(l),t.title=this.getToolTip(e))}},g.__tree._checkMap={default:1,children:1,descendant:1,descendantAncestor:1},n.PropertyPropagator=function(t,e,i){if(!t)throw"dataBox can not be null";if(!e)throw"propertyName can not be null";this._dataBox=t,this._propertyName=e,this._propertyType=i||"accessor","accessor"===this._propertyType&&(this._getter=o.getter(e),this._setter=o.setter(e)),this._enable=!1,this._isPropagating=!1},o.ext("b2.PropertyPropagator",Object,{getDataBox:function(){return this._dataBox},getPropertyType:function(){return this._propertyType},getPropertyName:function(){return this._propertyName},isEnable:function(){return this._enable},setEnable:function(t){this._enable!==t&&(this._enable=t,this._enable?(this._dataBox.addDataBoxChangeListener(this.handleDataBoxChange,this),this._dataBox.addDataPropertyChangeListener(this.handleDataPropertyChange,this),this._dataBox.forEach(function(t){this.propagate(t)},this)):(this._dataBox.removeDataBoxChangeListener(this.handleDataBoxChange,this),this._dataBox.removeDataPropertyChangeListener(this.handleDataPropertyChange,this)))},handleDataBoxChange:function(t){t.data&&this.propagate(t.data)},handleDataPropertyChange:function(t){var e;this.isInterestedProperty(t)?this.propagate(t.source):"parent"===t.property&&((e=t.oldValue)&&this.propagate(e),this.propagate(t.source))},isInterestedProperty:function(t){return"accessor"===this._propertyType&&this._propertyName===t.property||!("style"!==this._propertyType||!t.IElement||"S:"+this._propertyName!==t.property)||"client"===this._propertyType&&"C:"+this._propertyName===t.property},propagate:function(t){t&&!this._isPropagating&&(this._isPropagating=!0,this.propagateToTop(t),this._isPropagating=!1)},propagateToTop:function(t){for(this.propagateToParent(null,t);t&&t.getParent();)this.propagateToParent(t,t.getParent()),t=t.getParent()},propagateToParent:function(t,e){}}),n.animate.Animate=function(){},o.ext("b2.animate.Animate",Object,{current:0,step:8,delay:4,finishFunction:null,shouldBeFinished:!1,getCurrentDelay:function(){return this.delay*this.current+1},action:function(t){}}),n.animate.AnimateProperty=function(t,e,i){this.objects=t,this.newValues=e,this.finishFunction=i,this.oldValues=new at;for(var n=this.objects.size(),o=0;o<n;o++){var s=this.objects.get(o);this.oldValues.add(this.getPropertyValue(s))}},o.ext("b2.animate.AnimateProperty",n.animate.Animate,{action:function(t){for(var e=this.objects.size(),i=0;i<e;i++){var n=this.objects.get(i),o=this.oldValues.get(i),s=this.newValues.get(i);this.currentAction(n,o,s,t)}},getPropertyValue:function(t){},currentAction:function(t,e,i,n){}}),n.animate.AnimateBounds=function(t,e,i){this.node=t,this.newBounds=e,this.oldBounds=t.getRect(),this.finishFunction=i},o.ext("b2.animate.AnimateBounds",n.animate.Animate,{shouldBeFinished:!0,action:function(t){var e=this.oldBounds,i=this.newBounds;this.node.setLocation(e.x+(i.x-e.x)*t,e.y+(i.y-e.y)*t),this.node.setSize(e.width+(i.width-e.width)*t,e.height+(i.height-e.height)*t)}}),n.animate.AnimateCenterLocation=function(t,e,i){n.animate.AnimateCenterLocation.superClass.constructor.call(this,t,e,i)},o.ext("b2.animate.AnimateCenterLocation",n.animate.AnimateProperty,{getPropertyValue:function(t){return t.getCenterLocation()},currentAction:function(t,e,i,n){var o=e.x+(i.x-e.x)*n;n=e.y+(i.y-e.y)*n;t.setCenterLocation(o,n)}}),n.animate.AnimateLocation=function(t,e,i){n.animate.AnimateLocation.superClass.constructor.call(this,t,e,i)},o.ext("b2.animate.AnimateLocation",n.animate.AnimateProperty,{getPropertyValue:function(t){return t.getLocation()},currentAction:function(t,e,i,n){var o=e.x+(i.x-e.x)*n;n=e.y+(i.y-e.y)*n;t.setLocation(o,n)}}),n.animate.AnimateScrollPosition=function(t,e,i){this.view=t,this.oldHorizontalOffset=t.scrollLeft,this.oldVerticalOffset=t.scrollTop,this.newHorizontalOffset=e,this.newVerticalOffset=i},o.ext("b2.animate.AnimateScrollPosition",n.animate.Animate,{action:function(t){this.view.scrollLeft=this.oldHorizontalOffset+(this.newHorizontalOffset-this.oldHorizontalOffset)*t,this.view.scrollTop=this.oldVerticalOffset+(this.newVerticalOffset-this.oldVerticalOffset)*t}}),n.animate.AnimateZoom=function(t,e,i){this.view=t,this.oldZoom=t.getZoom(),this.newZoom=e,this.finishFunction=i},o.ext("b2.animate.AnimateZoom",n.animate.Animate,{shouldBeFinished:!0,action:function(t){this.view.setZoom(this.oldZoom+(this.newZoom-this.oldZoom)*t,!1)}}),n.animate.AnimateXZoom=function(t,e,i){this.view=t,this.oldXZoom=t.getXZoom(),this.newXZoom=e,this.finishFunction=i},o.ext("b2.animate.AnimateXZoom",n.animate.Animate,{shouldBeFinished:!0,action:function(t){this.view.setXZoom(this.oldXZoom+(this.newXZoom-this.oldXZoom)*t,!1)}}),n.animate.AnimateYZoom=function(t,e,i){this.view=t,this.oldYZoom=t.getYZoom(),this.newYZoom=e,this.finishFunction=i},o.ext("b2.animate.AnimateYZoom",n.animate.Animate,{shouldBeFinished:!0,action:function(t){this.view.setYZoom(this.oldYZoom+(this.newYZoom-this.oldYZoom)*t,!1)}}),n.animate.AnimateXYZoom=function(t,e,i,n){this.view=t,this.oldXZoom=t.getXZoom(),this.newXZoom=e,this.oldYZoom=t.getYZoom(),this.newYZoom=i,this.finishFunction=n},o.ext("b2.animate.AnimateXYZoom",n.animate.Animate,{shouldBeFinished:!0,action:function(t){this.view.setXZoom(this.oldXZoom+(this.newXZoom-this.oldXZoom)*t,!1),this.view.setYZoom(this.oldYZoom+(this.newYZoom-this.oldYZoom)*t,!1)}}),n.animate.AnimateSubNetwork=function(t,e,i){this.network=t,this.subNetwork=e,this.finishFunction=i},o.ext("b2.animate.AnimateSubNetwork",n.animate.Animate,{shouldBeFinished:!0,action:function(t){.5<t?(this.network.getView().style.opacity=2*t-1,this.network._setCurrentSubNetwork(this.subNetwork)):this.network.getView().style.opacity=1-2*t}}),n.animate.AnimateManager={timer:null,animate:null,start:function(t,e){var i=n.animate.AnimateManager;t.current<0&&(t.current=0),e?o.callLater(i.startImpl,null,[t],e):i.startImpl(t)},startImpl:function(t){var e=n.animate.AnimateManager;e.animate&&e.endAnimate(),e.animate=t,e.timer=setTimeout(e.tick,t.getCurrentDelay())},tick:function(){var t=n.animate.AnimateManager,e=t.animate;e&&(e.current<0?e.current++:(e.current<e.step&&(e.current++,e.action(e.current/e.step),t.timer=setTimeout(t.tick,e.getCurrentDelay())),e.current>=e.step&&t.endAnimate()))},endAnimate:function(){var t,e=n.animate.AnimateManager;e.animate?(e.animate.shouldBeFinished&&e.animate.current<e.animate.step&&(e.animate.current=e.animate.step,e.animate.action(e.animate.current/e.animate.step)),t=e.animate.finishFunction,e.animate=null,e.timer&&(clearTimeout(e.timer),e.timer=null),t&&t()):e.timer&&(clearTimeout(e.timer),e.timer=null)}},n.DataBox=function(t){n.DataBox.superClass.constructor.apply(this,arguments),1===arguments.length&&(this._name=t),this._dataList=new at,this._dataMap={},this._rootList=new at,this._rootMap={},this._clientMap={},this._dataBoxChangeDispatcher=new n.EventDispatcher,this._dataPropertyChangeDispatcher=new n.EventDispatcher,this._hierarchyChangeDispatcher=new n.EventDispatcher,this._selectionModel=new n.SelectionModel(this)},o.ext("b2.DataBox",n.PropertyChangeDispatcher,{IClient:!0,__client:1,__new:1,_limit:-1,_name:"DataBox",_icon:Ee.ICON_DATABOX,__accessor:["name","icon","toolTip"],getSelectionModel:function(){return this._selectionModel},size:function(){return this._dataList.size()},isEmpty:function(){return this._dataList.isEmpty()},getLimit:function(){return this._limit},setLimit:function(t){var e=this._limit;this._limit=t,this.firePropertyChange("limit",e,t),this._checkLimit()},_checkLimit:function(){0<=this._limit&&this.size()>this._limit&&this.removeFirst(this.size()-this._limit)},removeFirst:function(t){for(0===arguments.length&&(t=1);0<t&&0<this._dataList.size();){var e=this._dataList.get(0);this.remove(e),t--}},getSiblings:function(t){if(!this.contains(t))throw t+" dosen't belong to this dataBox";return(t=t.getParent())?t.getChildren():this._rootList},getRoots:function(){return this._rootList},getSiblingIndex:function(t){return(t.getParent()?t.getParent().getChildren():this._rootList).indexOf(t)},getDatas:function(){return this._dataList},getDataAt:function(t){return this._dataList.get(t)},toDatas:function(t,e){return this._dataList.toList(t,e)},forEach:function(t,e){this._dataList.forEach(t,e)},forEachReverse:function(t,e){this._dataList.forEachReverse(t,e)},forEachByDepthFirst:function(t,e,i){if(e)this._depthFirst(t,e,i);else for(var n=this._rootList.size(),o=0;o<n;o++){var s=this._rootList.get(o);if(!1===this._depthFirst(t,s,i))return}},_depthFirst:function(t,e,i){for(var n=e.getChildrenSize(),o=0;o<n;o++){var s=e.getChildAt(o);if(!1===this._depthFirst(t,s,i))return!1}if(i){if(!1===t.call(i,e))return!1}else if(!1===t(e))return!1},forEachByBreadthFirst:function(t,e,i){var n=new at;for(e?n.add(e):this._rootList.forEach(n.add,n);0<n.size();)if((e=n.removeAt(0)).getChildren().forEach(n.add,n),i){if(!1===t.call(i,e))return}else if(!1===t(e))return},add:function(t,e){if(t){1===arguments.length&&(e=-1);var i=t.getId();if(this._dataMap.hasOwnProperty(i))throw"Data with ID '"+i+"' already exists";this._dataBoxChangeDispatcher.fire({kind:"preAdd",data:t}),this._dataMap[i]=t,this._dataList.add(t),t.getParent()||(this._rootMap[i]=t,0<=e?this._rootList.add(t,e):this._rootList.add(t)),t.addPropertyChangeListener(this.handleDataPropertyChange,this,!0),this._dataBoxChangeDispatcher.fire({kind:"add",data:t}),this._checkLimit()}},addByDescendant:function(t){this.add(t),0<t.getChildren().size()&&t.getChildren().forEach(function(t){this.addByDescendant(t)},this)},remove:function(t){this.removeById(t.getId())},removeSelection:function(){this._selectionModel.toSelection().forEach(function(t){this.remove(t)},this)},removeById:function(t){var e=this.getDataById(t);e&&(this._dataBoxChangeDispatcher.fire({kind:"preRemove",data:e}),e instanceof n.Link&&(e.setFromNode(null),e.setToNode(null)),e instanceof be&&e.getLinks()&&e.getLinks().toList().forEach(function(t){this.remove(t)},this),e instanceof be&&e.getFollowers()&&e.getFollowers().toList().forEach(function(t){t.setHost(null)}),e instanceof n.Follower&&e.getHost()&&e.setHost(null),e.toChildren().forEach(function(t){this.remove(t)},this),e.getParent()&&e.getParent().removeChild(e),this._dataList.remove(e),delete this._dataMap[t],this._rootMap[t]&&(delete this._rootMap[t],this._rootList.remove(e)),this._dataBoxChangeDispatcher.fire({kind:"remove",data:e}),e.removePropertyChangeListener(this.handleDataPropertyChange,this))},clear:function(){var t;0<this._dataList.size()&&(this._dataList.forEach(function(t){t.removePropertyChangeListener(this.handleDataPropertyChange,this)},this),t=this._dataList.toList(),this._dataList.clear(),this._dataMap={},this._rootList.clear(),this._rootMap={},this._dataBoxChangeDispatcher.fire({kind:"clear",datas:t}))},getDataById:function(t){return this._dataMap[t]},containsById:function(t){return this._dataMap.hasOwnProperty(t)},contains:function(t){return!!t&&this._dataMap[t._id]===t},moveTo:function(t,e){if(!this.contains(t))throw t+" dosen't belong to this dataBox";var i=this.getSiblings(t),n=i.indexOf(t);n===e||n<0||0<=e&&e<=i.size()&&(i.remove(t),e>i.size()&&e--,i.add(t,e),this._hierarchyChangeDispatcher.fire({data:t,oldIndex:n,newIndex:e}))},moveUp:function(t){var e=this.getSiblings(t);this.moveTo(t,e.indexOf(t)-1)},moveDown:function(t){var e=this.getSiblings(t);this.moveTo(t,e.indexOf(t)+1)},moveToTop:function(t){this.moveTo(t,0)},moveToBottom:function(t){var e=this.getSiblings(t);this.moveTo(t,e.size())},moveSelectionUp:function(t){t=t||this._selectionModel;var e=new at;ut.findMoveUpDatas(t,e,this._rootList),e.forEach(this.moveUp,this)},moveSelectionDown:function(t){t=t||this._selectionModel;var e=new at;ut.findMoveDownDatas(t,e,this._rootList),e.forEach(this.moveDown,this)},moveSelectionToTop:function(t){t=t||this._selectionModel;var e=new at;ut.findMoveToTopDatas(t,e,this._rootList),e.forEach(this.moveToTop,this)},moveSelectionToBottom:function(t){t=t||this._selectionModel;var e=new at;ut.findMoveToBottomDatas(t,e,this._rootList),e.forEach(this.moveToBottom,this)},handleDataPropertyChange:function(t){var e,i=t.source;"parent"===t.property&&(e=i.getId(),i.getParent()?this._rootMap[e]&&(delete this._rootMap[e],this._rootList.remove(i)):this._rootMap[e]||(this._rootMap[e]=i,this._rootList.add(i))),this.onDataPropertyChanged(i,t),this._dataPropertyChangeDispatcher.fire(t)},onDataPropertyChanged:function(t,e){},addDataBoxChangeListener:function(t,e,i){this._dataBoxChangeDispatcher.add(t,e,i)},removeDataBoxChangeListener:function(t,e){this._dataBoxChangeDispatcher.remove(t,e)},addDataPropertyChangeListener:function(t,e,i){this._dataPropertyChangeDispatcher.add(t,e,i)},removeDataPropertyChangeListener:function(t,e){this._dataPropertyChangeDispatcher.remove(t,e)},addHierarchyChangeListener:function(t,e,i){this._hierarchyChangeDispatcher.add(t,e,i)},removeHierarchyChangeListener:function(t,e){this._hierarchyChangeDispatcher.remove(t,e)},getRandomData:function(t){if(t){for(var e=new n.List,i=0;i<this._dataList.size()-1;i++){var o=this._dataList.get(i);o instanceof t&&e.add(o)}if(0==e.size())return null}return t?e.get(parseInt(n.Util.random()*e.size())):this._dataList.get(parseInt(n.Util.random()*this._dataList.size()))}}),n.ElementBox=function(t){n.ElementBox.superClass.constructor.apply(this,arguments),this._styleMap={},this._alarmBox=new n.AlarmBox(this),this._layerBox=new n.LayerBox(this),this._alarmStatePropagator=new n.AlarmStatePropagator(this),this._alarmStatePropagator.setEnable(!0),this._indexChangeDispatcher=new n.EventDispatcher,this._undoManager=new n.UndoManager(this)},n.ElementBox.IS_INTERESTED_ADJUSTELEMENTINDEX_PROPERTY={fromAgent:1,toAgent:1,expanded:1,parent:1,host:1},o.ext("b2.ElementBox",n.DataBox,{IStyle:!0,__style:1,_name:"ElementBox",add:function(t,e){if(t){if(!t.IElement)throw"Only IElement can be added into ElementBox";n.ElementBox.superClass.add.apply(this,arguments),this.adjustElementIndex(t)}},onDataPropertyChanged:function(t,e){n.ElementBox.IS_INTERESTED_ADJUSTELEMENTINDEX_PROPERTY[e.property]&&this.adjustElementIndex(t),n.ElementBox.superClass.onDataPropertyChanged.apply(this,arguments)},addIndexChangeListener:function(t,e,i){this._indexChangeDispatcher.add(t,e,i)},removeIndexChangeListener:function(t,e){this._indexChangeDispatcher.remove(t,e)},sendToTop:function(t){var e;this.contains(t)&&(t!==this.getDatas().get(this.size()-1)&&(e=this.getDatas().indexOf(t),this.getDatas().removeAt(e),this.getDatas().add(t),this._indexChangeDispatcher.fire({element:t,oldIndex:e,newIndex:this.size()-1})),t instanceof n.Link&&(t.getFromAgent()&&!t.getFromAgent().isAdjustedToBottom()&&this.sendToTop(t.getFromAgent()),t.getToAgent()&&!t.getToAgent().isAdjustedToBottom()&&this.sendToTop(t.getToAgent())),t instanceof be&&t.getFollowers()&&t.getFollowers().forEach(function(e){e.isRelatedTo(t)||t instanceof n.Follower&&e.isLoopedHostOn(t)||this.sendToTop(e)},this),t.ISubNetwork||t instanceof Le&&!t.isExpanded()||t.getChildren().forEach(function(t){t instanceof n.Link||this.sendToTop(t)},this))},sendToBottom:function(t,e){var i,o;t!==e&&this.contains(t)&&(e&&!this.contains(e)||(i=this.getDatas().remove(t),o=0,e&&(o=this.getDatas().indexOf(e)),this.getDatas().add(t,o),i!=o&&(this._indexChangeDispatcher.fire({element:t,oldIndex:i,newIndex:o}),!t.getParent()||t.getParent().ISubNetwork||t.getParent()instanceof n.Link||this.sendToBottom(t.getParent(),t))))},fireIndexChange:function(t,e,i){this._indexChangeDispatcher.fire({element:t,oldIndex:e,newIndex:i})},adjustElementIndex:function(t){this.contains(t)&&(t.isAdjustedToBottom()?(this.sendToBottom(t),t.getChildren().forEach(this.adjustElementIndex,this)):this.sendToTop(t))},forEachByLayer:function(t,e,i){var n=this.size(),o=this.getDatas();if(e)for(var s=0;s<n;s++){var r=o.get(s);if(this._layerBox.getLayerByElement(r)===e)if(i){if(!1===t.call(i,r))return}else if(!1===t(r))return}else this._layerBox.forEachByDepthFirst(function(e){for(var s=0;s<n;s++){var r=o.get(s);if(this._layerBox.getLayerByElement(r)===e)if(i){if(!1===t.call(i,r))return}else if(!1===t(r))return}},null,this)},forEachByLayerReverse:function(t,e,i){var n=new at;this.forEachByLayer(function(t){n.add(t,0)},e),n.forEach(t,i)},getLayerBox:function(){return this._layerBox},getAlarmBox:function(){return this._alarmBox},getAlarmStatePropagator:function(){return this._alarmStatePropagator},startBatch:function(t,e){var i,o;for(o in n._isInitializing=!0,n._bundleLinks={},n._links={},t.call(e),n._links)n._links[o]._checkAgentNodeImpl();for(o in n._bundleLinks)i=n._bundleLinks[o],lt.resetBundleLinks(i[0],i[1]);n._bundleLinks=null,n._links=null,n._isInitializing=!1},getUndoManager:function(){return this._undoManager}}),n.SelectionModel=function(t){n.SelectionModel.superClass.constructor.apply(this,arguments),this._selectionMode="multipleSelection",this._selectionList=new at,this._selectionChangeDispatcher=new n.EventDispatcher,this._selectionMap={},this._setDataBox(t)},o.ext("b2.SelectionModel",n.PropertyChangeDispatcher,{getSelectionMode:function(){return this._selectionMode},setSelectionMode:function(t){var e;this._selectionMode!==t&&("noneSelection"!==t&&"singleSelection"!==t&&"multipleSelection"!==t||(this.clearSelection(),e=this._selectionMode,this._selectionMode=t,this.firePropertyChange("selectionMode",e,this._selectionMode)))},getDataBox:function(){return this._dataBox},_setDataBox:function(t){if(!t)throw"dataBox can not be null";var e;this._dataBox!==t&&(this._dataBox&&(this.clearSelection(),this._dataBox.removeDataBoxChangeListener(this.handleDataBoxChange,this)),e=this._dataBox,this._dataBox=t,this._dataBox.addDataBoxChangeListener(this.handleDataBoxChange,this,!0),this.firePropertyChange("dataBox",e,this._dataBox))},dispose:function(){this.clearSelection(),this._dataBox.removeDataBoxChangeListener(this.handleDataBoxChange,this)},handleDataBoxChange:function(t){var e;"remove"===t.kind?(e=t.data,this.contains(e)&&(this._selectionList.remove(e),delete this._selectionMap[e.getId()],this.fireSelectionChange("remove",new at(e)))):"clear"===t.kind&&this.clearSelection()},getFilterFunction:function(){return this._filterFunction},setFilterFunction:function(t){var e;this._filterFunction!==t&&(this.clearSelection(),e=this._filterFunction,this._filterFunction=t,this.firePropertyChange("filterFunction",e,this._filterFunction))},fireSelectionChange:function(t,e,i){i&&(this._selectionList.forEach(function(t){i.contains(t)?i.remove(t):i.add(t)}),e=i.toList()),this._selectionChangeDispatcher.fire({kind:t,datas:new at(e)})},addSelectionChangeListener:function(t,e,i){this._selectionChangeDispatcher.add(t,e,i)},removeSelectionChangeListener:function(t,e){this._selectionChangeDispatcher.remove(t,e)},_filterList:function(t,e){for(var i=new at(t),n=0;n<i.size();n++){var o=i.get(n);(this._filterFunction&&!this._filterFunction(o)||e&&this.contains(o)||!e&&!this.contains(o)||!this._dataBox.contains(o))&&(i.removeAt(n),n--)}return i},appendSelection:function(t){if("noneSelection"!==this._selectionMode){var e=this._filterList(t,!0);if(!e.isEmpty()){t=null,"singleSelection"===this._selectionMode&&(t=new at(this._selectionList),this._selectionList.clear(),this._selectionMap={},e=new at(e.get(e.size()-1)));for(var i=0;i<e.size();i++){var n=e.get(i);this._selectionList.add(n),this._selectionMap[n.getId()]=n}this.fireSelectionChange("append",e,t)}}},removeSelection:function(t){var e=this._filterList(t);if(0!==e.size()){for(var i=0;i<e.size();i++){var n=e.get(i);this._selectionList.remove(n),delete this._selectionMap[n.getId()]}this.fireSelectionChange("remove",e)}},toSelection:function(t,e){return this._selectionList.toList(t,e)},getSelection:function(){return this._selectionList},setSelection:function(t){if("noneSelection"!==this._selectionMode&&(0!==this._selectionList.size()||null!=t)){var e=new at(this._selectionList);this._selectionList.clear(),this._selectionMap={};var i=this._filterList(t,!0);"singleSelection"===this._selectionMode&&1<i.size()&&(i=new at(i.get(i.size()-1)));for(var n=0;n<i.size();n++){var o=i.get(n);this._selectionList.add(o),this._selectionMap[o.getId()]=o}this.fireSelectionChange("set",null,e)}},clearSelection:function(){var t;0<this._selectionList.size()&&(t=this._selectionList.toList(),this._selectionList.clear(),this._selectionMap={},this.fireSelectionChange("clear",t))},selectAll:function(){if("noneSelection"!==this._selectionMode){var t=this._dataBox.toDatas(),e=0,i=null;if(this._filterFunction)for(e=0;e<t.size();e++)i=t.get(e),this._filterFunction(i)||(t.removeAt(e),e--);var n=new at(this._selectionList);for(this._selectionList.clear(),this._selectionMap={},"singleSelection"===this._selectionMode&&1<t.size()&&(t=new at(t.get(t.size()-1))),e=0;e<t.size();e++)i=t.get(e),this._selectionList.add(i),this._selectionMap[i.getId()]=i;this.fireSelectionChange("all",null,n)}},size:function(){return this._selectionList.size()},contains:function(t){return!!t&&null!=this._selectionMap[t.getId()]},getLastData:function(){return 0<this._selectionList.size()?this._selectionList.get(this._selectionList.size()-1):null},getFirstData:function(){return 0<this._selectionList.size()?this._selectionList.get(0):null},isSelectable:function(t){return!(!t||"noneSelection"===this._selectionMode||this._filterFunction&&!this._filterFunction(t))}}),n.AlarmBox=function(t){if(!t)throw"elementBox can not be null.";n.AlarmBox.superClass.constructor.call(this),this._elementBox=t,this._alarmElementMapping=new n.AlarmElementMapping(this,t),this._elementBox.addDataBoxChangeListener(this.handleElementBoxChange,this,!0),this.addDataBoxChangeListener(this.handleAlarmBoxChange,this,!0),this.addDataPropertyChangeListener(this.handleAlarmPropertyChange,this,!0)},o.ext("b2.AlarmBox",n.DataBox,{__accessor:["removeAlarmWhenElementIsRemoved"],_name:"AlarmBox",_removeAlarmWhenAlarmIsCleared:!1,_removeAlarmWhenElementIsRemoved:!0,getElementBox:function(){return this._elementBox},isRemoveAlarmWhenAlarmIsCleared:function(){return this._removeAlarmWhenAlarmIsCleared},setRemoveAlarmWhenAlarmIsCleared:function(t){var e=this._removeAlarmWhenAlarmIsCleared;this._removeAlarmWhenAlarmIsCleared=t,this.firePropertyChange("removeAlarmWhenAlarmIsCleared",e,t),t&&this.toDatas(function(t){return t.isCleared()}).forEach(this.remove,this)},getAlarmElementMapping:function(){return this._alarmElementMapping},setAlarmElementMapping:function(t){if(!t)throw"alarmElementMapping can not be null";var e;this._alarmElementMapping!==t&&(e=this._alarmElementMapping,this.getDatas().forEach(this._decreaseAlarmState,this),this._alarmElementMapping=t,this.getDatas().forEach(this._increaseAlarmState,this),this.firePropertyChange("alarmElementMapping",e,t))},handleElementBoxChange:function(t){"add"===t.kind?this.handleElementAdded(t.data):"remove"===t.kind?(this.handleElementRemoved(t.data),this._removeAlarmWhenElementIsRemoved&&this.removeAlarmsByElement(t.data)):"clear"===t.kind&&(t.datas.forEach(this.handleElementRemoved,this),this._removeAlarmWhenElementIsRemoved&&this.clear())},handleAlarmBoxChange:function(t){"add"===t.kind?this._increaseAlarmState(t.data):"remove"===t.kind?this._decreaseAlarmState(t.data):"clear"===t.kind&&t.datas.forEach(this._decreaseAlarmState,this)},handleAlarmPropertyChange:function(t){var e=t.source;e.isCleared()||("alarmSeverity"===t.property?this.handleAlarmSeverityChange(e,t):"acked"===t.property&&this.handleAckedChange(e,t)),"cleared"===t.property&&(e.isCleared()?(this._decreaseAlarmState(e,!0),this._removeAlarmWhenAlarmIsCleared&&this.remove(e)):this._increaseAlarmState(e,!0))},handleAckedChange:function(t,e){if(t.getAlarmSeverity()){var i=this.getCorrespondingElements(t);if(i)for(var n=0;n<i.size();n++){var o=i.get(n);e.oldValue?o.getAlarmState().decreaseAcknowledgedAlarm(t.getAlarmSeverity()):o.getAlarmState().decreaseNewAlarm(t.getAlarmSeverity()),e.newValue?o.getAlarmState().increaseAcknowledgedAlarm(t.getAlarmSeverity()):o.getAlarmState().increaseNewAlarm(t.getAlarmSeverity())}}},handleAlarmSeverityChange:function(t,e){var i=e.oldValue,n=e.newValue,o=this.getCorrespondingElements(t);if(o)for(var s=0;s<o.size();s++){var r=o.get(s);i&&(t.isAcked()?r.getAlarmState().decreaseAcknowledgedAlarm(i):r.getAlarmState().decreaseNewAlarm(i)),n&&(t.isAcked()?r.getAlarmState().increaseAcknowledgedAlarm(n):r.getAlarmState().increaseNewAlarm(n))}},getCorrespondingAlarms:function(t){return this._alarmElementMapping.getCorrespondingAlarms(t)},getCorrespondingElements:function(t){return this._alarmElementMapping.getCorrespondingElements(t)},handleElementAdded:function(t){var e=this.getCorrespondingAlarms(t);if(e)for(var i=0;i<e.size();i++){var n,o=e.get(i);o.isCleared()||(n=o.getAlarmSeverity())&&(o.isAcked()?t.getAlarmState().increaseAcknowledgedAlarm(n):t.getAlarmState().increaseNewAlarm(n))}},_increaseAlarmState:function(t,e){if(!t.isCleared()||e){var i=t.getAlarmSeverity();if(i){var n=this.getCorrespondingElements(t);if(n)for(var o=0;o<n.size();o++){var s=n.get(o);t.isAcked()?s.getAlarmState().increaseAcknowledgedAlarm(i):s.getAlarmState().increaseNewAlarm(i)}}}},_decreaseAlarmState:function(t,e){if(!t.isCleared()||e){var i=t.getAlarmSeverity();if(i){var n=this.getCorrespondingElements(t);if(n)for(var o=0;o<n.size();o++){var s=n.get(o);t.isAcked()?s.getAlarmState().decreaseAcknowledgedAlarm(i):s.getAlarmState().decreaseNewAlarm(i)}}}},handleElementRemoved:function(t){var e=this.getCorrespondingAlarms(t);e&&e.forEach(function(e){!e.isCleared()&&e.getAlarmSeverity()&&(e.isAcked()?t.getAlarmState().decreaseAcknowledgedAlarm(e.getAlarmSeverity()):t.getAlarmState().decreaseNewAlarm(e.getAlarmSeverity()))})},removeAlarmsByElement:function(t){(t=this.getCorrespondingAlarms(t))&&t.forEach(this.remove,this)},add:function(t,e){if(!t.IAlarm)throw"Only IAlarm can be added into AlarmBox";this._removeAlarmWhenAlarmIsCleared&&t.isCleared()||n.AlarmBox.superClass.add.apply(this,arguments)}}),n.LayerBox=function(t){n.LayerBox.superClass.constructor.call(this),this._elementBox=t,this._defaultLayer=new n.Layer(Ee.LAYER_DEFAULT_ID,Ee.LAYER_DEFAULT_NAME),this.add(this._defaultLayer)},o.ext("b2.LayerBox",n.DataBox,{_name:"LayerBox",getElementBox:function(){return this._elementBox},getDefaultLayer:function(){return this._defaultLayer},add:function(t,e){if(!t.ILayer)throw"Only ILayer can be added into LayerBox";n.LayerBox.superClass.add.apply(this,arguments)},removeById:function(t){if(t===this._defaultLayer.getId())throw"Cannot remove default layer";n.LayerBox.superClass.removeById.call(this,t)},getLayerByElement:function(t){return t?t._layerId===Ee.LAYER_DEFAULT_ID?this._defaultLayer:(t=this.getDataById(t.getLayerId()))||this._defaultLayer:null},clear:function(){this.toDatas().forEach(function(t){t!=this._defaultLayer&&this.removeById(t.getId())},this)}}),n.ColumnBox=function(t){n.ColumnBox.superClass.constructor.apply(this,arguments)},o.ext("b2.ColumnBox",n.DataBox,{_name:"ColumnBox",add:function(t,e){if(!t.IColumn)throw"Only IColumn can be added into ColumnBox";n.ColumnBox.superClass.add.apply(this,arguments)}}),n.PropertyBox=function(t){n.PropertyBox.superClass.constructor.apply(this,arguments)},o.ext("b2.PropertyBox",n.DataBox,{_name:"PropertyBox",add:function(t,e){if(!t.IProperty)throw"Only IProperty can be added into PropertyBox";n.PropertyBox.superClass.add.apply(this,arguments)}}),n.TabBox=function(t){n.TabBox.superClass.constructor.apply(this,arguments),this.getSelectionModel().setSelectionMode("singleSelection")},o.ext("b2.TabBox",n.DataBox,{_name:"TabBox",add:function(t,e){if(!t.ITab)throw"Only ITab can be added into TabBox";n.TabBox.superClass.add.apply(this,arguments)}}),n.QuickFinder=function(t,e,i,n,s){if(this._map={},!t)throw"dataBox can not be null";if(!e)throw"propertyName can not be null";this._dataBox=t,this._propertyName=e,this._propertyType=i||"accessor","accessor"===this._propertyType&&(this._getter=o.getter(e)),this._valueFunction=n||this.getValue,this._filterFunction=s||this.isInterested,this._dataBox.forEach(this._addData,this),this._dataBox.addDataBoxChangeListener(this.handleDataBoxChange,this,!0),this._dataBox.addDataPropertyChangeListener(this.handleDataPropertyChange,this,!0)},o.ext("b2.QuickFinder",Object,{_NULL_:"b2-null-key",getValueFunction:function(){return this._valueFunction},getFilterFunction:function(){return this._filterFunction},handleDataBoxChange:function(t){"add"===t.kind?this._addData(t.data):"remove"===t.kind?this._removeData(t.data):"clear"===t.kind&&(this._map={})},handleDataPropertyChange:function(t){var e;this._filterFunction.call(this,t.source)&&("accessor"===this._propertyType&&this._propertyName===t.property||"style"===this._propertyType&&t.source.IStyle&&"S:"+this._propertyName===t.property||"client"===this._propertyType&&"C:"+this._propertyName===t.property)&&((e=this._getMap(t.oldValue))&&e.remove(t.source),this._addData(t.source))},_getMap:function(t){return t=null==t?this._NULL_:t,this._map[t]},find:function(t){return(t=this._getMap(t))?t.toList():new at},findFirst:function(t){return!(t=this._getMap(t))||t.isEmpty()?null:t.get(0)},_addData:function(t){var e,i;this._filterFunction.call(this,t)&&(e=this._valueFunction.call(this,t),(i=this._getMap(e))||(i=new at,e=null==e?this._NULL_:e,this._map[e]=i),i.add(t))},_removeData:function(t){var e,i;this._filterFunction.call(this,t)&&(e=this._valueFunction.call(this,t),(i=this._getMap(e))&&(i.remove(t),i.isEmpty()&&(e=null==e?this._NULL_:e,delete this._map[e])))},dispose:function(){this._dataBox.removeDataBoxChangeListener(this.handleDataBoxChange,this),this._dataBox.removeDataPropertyChangeListener(this.handleDataPropertyChange,this),delete this._dataBox},getDataBox:function(){return this._dataBox},getPropertyType:function(){return this._propertyType},getPropertyName:function(){return this._propertyName},isInterested:function(t){return!("style"===this._propertyType&&!t.IStyle||"accessor"===this._propertyType&&this._valueFunction===this.getValue&&!t[this._getter])},getValue:function(t){return"accessor"===this._propertyType?t[this._getter]():"style"===this._propertyType&&t.getStyle?t.getStyle(this._propertyName):"client"===this._propertyType&&t.getClient?t.getClient(this._propertyName):null}});var Te=n.UndoManager=function(t){this._list=[],this._cursor=-1,this._suspended=!1,this._dispatcher=new n.EventDispatcher,this._box=t,this._enabled=!1,this._limit=100};Te._IGNORE_PROPERTIES={alarmState:1,propagateSeverity:1,enablePropagation:1,children:1,fromAgent:1,toAgent:1,bundleLinks:1},o.ext("b2.UndoManager",Object,{setEnabled:function(t){var e=this,i=e._box;e._enabled!=t&&(t?(i.addDataBoxChangeListener(e._handleDataBoxChange,e,!0),i.addDataPropertyChangeListener(e._handleDataPropertyChange,e,!0)):(i.removeDataBoxChangeListener(e._handleDataBoxChange,e),i.removeDataPropertyChangeListener(e._handleDataPropertyChange,e))),e._enabled=t},isEnabled:function(){return this._enabled},undo:function(){var t,e,i=this._list;if(this.canUndo()){if(t=i[this._cursor--],this._suspended=!0,t.length)for(e=t.length-1;0<=e;e--)t[e].undo();else t.undo();this._suspended=!1,this._fire({kind:"undo",action:t})}},redo:function(){var t=this._list;this.canRedo()&&(t=t[++this._cursor],this._suspended=!0,t.length?t.forEach(function(t){t.redo()}):t.redo(),this._suspended=!1,this._fire({kind:"redo",action:t}))},canUndo:function(){return 0<=this._cursor},canRedo:function(){return this._cursor<this._list.length-1},_add:function(t){var e=this._batch,i=this._list;e?e.push(t):(this._cursor!==i.length-1&&i.splice(this._cursor+1,i.length),0!==this._limit&&i.length===this._limit&&i.splice(0,1),i.push(t),this._cursor=i.length-1,this._fire({kind:"add",action:t}))},_handleDataBoxChange:function(t){var e,i,n;this._suspended||(e=this._box,i=t.kind,n=t.data,"add"===i?this._add({undo:function(){this.parent=n.getParent(),this.host=n.getHost&&n.getHost(),n.getFromNode&&(this.fromNode=n.getFromNode(),this.toNode=n.getToNode()),e.remove(n)},redo:function(){this.parent&&n.setParent(this.parent),n.getHost&&this.host&&n.setHost(this.host),n.getFromNode&&(this.fromNode&&n.setFromNode(this.fromNode),this.toNode&&n.setToNode(this.toNode)),e.add(n)}}):"remove"===i&&this._add({undo:function(){e.add(n)},redo:function(){e.remove(n)}}))},_handleDataPropertyChange:function(t){var e,i,n,s,r;this._suspended||(i=(e=t.property).substr(0,2),n=t.source,s=t.oldValue,r=t.newValue,"C:"===i?(e=e.substr(2),this._add({undo:function(){n.setClient(e,s)},redo:function(){n.setClient(e,r)}})):"S:"===i?(e=e.substr(2),this._add({undo:function(){n.setStyle(e,s)},redo:function(){n.setStyle(e,r)}})):Te._IGNORE_PROPERTIES[e]||this._add({undo:function(){n[o.setter(e)](s)},redo:function(){n[o.setter(e)](r)}}))},size:function(){return this._list.length},getCursor:function(){return this._cursor},_fire:function(t){this._dispatcher.fire(t)},on:function(t,e,i){this._dispatcher.add(t,e,i)},off:function(t,e){this._dispatcher.remove(t,e)},isSuspended:function(){return this._suspended},setSuspended:function(t){this._suspended=t},getLimit:function(){return this._limit},setLimit:function(t){var e,i,n=this._list;return(t=t<0?0:t)!==this._limit&&(e=n.length-t,0<t&&0<e&&(i=this._cursor+1,this._cursor-=e,this._cursor<-1&&(this._cursor=-1),0<i&&n.splice(0,i),0<(e-=i)&&n.splice(n.length-e,e)),this._limit=t,this._fire({kind:"change"})),this},clear:function(){return this._list=[],this._cursor=-1,this._fire({kind:"clear"}),this},batch:function(t,e){return this.startBatch(),t.call(e),this.endBatch(),this},startBatch:function(){return this._batch||(this._batch=[]),this},endBatch:function(){var t;return this._batch&&(t=this._batch,this._batch=null,t.length&&this._add(t)),this}}),n.Data=function(t){if(n.Data.superClass.constructor.apply(this,arguments),this._childList=new at,this._childMap={},this._clientMap={},null==t)this._id=o.id();else if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)this._id=t;else{for(var e in t)if("clients"===e)for(var i in t.clients)this._clientMap[i]=t.clients[i];else if("styles"===e)for(var s in t.styles)this._styleMap[s]=t.styles[s];else null!=t[e]&&("id"===e?this._id=t[e]:this[o.setter(e)]&&this[o.setter(e)](t[e]));null==this._id&&(this._id=o.id())}},o.ext("b2.Data",n.PropertyChangeDispatcher,{IData:!0,IClient:!0,__client:1,__new:1,_parent:null,__accessor:["name","name2","icon","toolTip"],_icon:Ee.ICON_DATA,_dragBoundsFunc:null,getId:function(){return this._id},getChildren:function(){return this._childList},getChildrenSize:function(){return this._childList.size()},toChildren:function(t,e){return this._childList.toList(t,e)},addChild:function(t,e){return void 0===e&&(e=this._childList.size()),!(!t||t===this||this._childMap[t.getId()]||this.isDescendantOf(t)||(t.getParent()&&t.getParent().removeChild(t),(e<0||e>this._childList.size())&&(e=this._childList.size()),this._childList.add(t,e),(this._childMap[t._id]=t).setParent(this),this.firePropertyChange("children",null,t),this.onChildAdded(t,e),0))},onChildAdded:function(t,e){},removeChild:function(t){if(!t)return!1;if(!this._childMap[t._id])return!1;var e=this._childList.remove(t);return delete this._childMap[t._id],this.firePropertyChange("children",t,null),t.setParent(null),this.onChildRemoved(t,e),!0},onChildRemoved:function(t,e){},getChildAt:function(t){return this._childList.get(t)},clearChildren:function(){if(0===this._childList.size())return!1;for(var t=this._childList.toArray(),e=t.length,i=0;i<e;i++)this.removeChild(t[i]);return this.onChildrenCleared(t),!0},onChildrenCleared:function(t){},getParent:function(){return this._parent},setParent:function(t){var e;this._isUpdatingParent||this._parent===t||this===t||t&&t.isDescendantOf(this)||(e=this._parent,this._parent=t,this._isUpdatingParent=!0,e&&e.removeChild(this),t&&t.addChild(this),delete this._isUpdatingParent,this.firePropertyChange("parent",e,t),this.onParentChanged(e,t))},onParentChanged:function(t,e){},hasChildren:function(){return 0<this._childList.size()},isRelatedTo:function(t){return!!t&&(this.isDescendantOf(t)||t.isDescendantOf(this))},isParentOf:function(t){return!!t&&null!=this._childMap[t._id]},isDescendantOf:function(t){if(!t)return!1;if(!t.hasChildren())return!1;for(var e=this._parent;e;){if(t===e)return!0;e=e.getParent()}return!1},getDragBoundsFunc:function(){return this._dragBoundsFunc},setDragBoundsFunc:function(t){this._dragBoundsFunc=t},toString:function(){return this.getName()?this.getName():this._id}}),n.Layer=function(t){n.Layer.superClass.constructor.call(this,t)},o.ext("b2.Layer",n.Data,{ILayer:!0,__accessor:["visible","movable","editable","rotatable"],_visible:!0,_movable:!0,_editable:!0,_rotatable:!0,_name:"Default"}),n.Element=function(t){this._styleMap=this._styleMap||{},this._alarmState=new n.AlarmState(this),n.Element.superClass.constructor.call(this,t)},o.ext("b2.Element",n.Data,{IElement:!0,IStyle:!0,__accessor:["layerId"],__bool:["visible","movable"],__style:1,_layerId:Ee.LAYER_DEFAULT_ID,_visible:!0,_movable:!0,getAlarmState:function(){return this._alarmState},isAdjustedToBottom:function(){return!1},getElementUIClass:function(){return null},getCanvasUIClass:function(){return null},getVectorUIClass:function(){return null},s:function(t,e){if(void 0!==e)return this.setStyle(t,e),this;if("string"==typeof t)return this.getStyle(t);var i=this;Object.keys(t).forEach(function(e){i.setStyle(e,t[e])})},c:function(t,e){return void 0===e?this.getClient(t):(this.setClient(t,e),this)}}),n.Dummy=function(t){n.Dummy.superClass.constructor.call(this,t)},o.ext("b2.Dummy",n.Element,{IDummy:!0});var be=function t(e){this._location={x:0,y:0},t.superClass.constructor.call(this,e)};(n.Node=be).IS_INTERESTED_NODE_PROPERTY={location:1,width:1,height:1,expanded:1},o.ext("b2.Node",n.Element,{_icon:Ee.ICON_NODE,_image:Ee.IMAGE_NODE,_imageUrl:null,_angle:0,getLoopedLinks:function(){return this._loopedLinks},getLinks:function(){return this._links},getAgentLinks:function(){return this._agentLinks},getFollowers:function(){return this._followers},_addFollower:function(t){this._followers||(this._followers=new at),this._followers.add(t)},_removeFollower:function(t){this._followers.remove(t),this._followers.isEmpty()&&delete this._followers},getFromLinks:function(){return this._fromLinks},getToLinks:function(){return this._toLinks},_addFromLink:function(t){this._links||(this._links=new at(!1)),this._fromLinks||(this._fromLinks=new at(!1)),this._links.add(t),this._toLinks&&this._toLinks.contains(t)&&(this._loopedLinks||(this._loopedLinks=new at(!1)),this._loopedLinks.add(t)),this._fromLinks.add(t)},_addToLink:function(t){this._links||(this._links=new at(!1)),this._toLinks||(this._toLinks=new at(!1)),this._links.add(t),this._fromLinks&&this._fromLinks.contains(t)&&(this._loopedLinks||(this._loopedLinks=new at(!1)),this._loopedLinks.add(t)),this._toLinks.add(t)},_removeFromLink:function(t){this._links&&this._links.remove(t),this._fromLinks&&this._fromLinks.remove(t),this._loopedLinks&&this._loopedLinks.remove(t)},_removeToLink:function(t){this._links&&this._links.remove(t),this._toLinks&&this._toLinks.remove(t),this._loopedLinks&&this._loopedLinks.remove(t)},hasAgentLinks:function(){return null!=this._agentLinks&&!this._agentLinks.isEmpty()},getFromAgentLinks:function(){return this._fromAgentLinks},getToAgentLinks:function(){return this._toAgentLinks},_addFromAgentLink:function(t){this._fromAgentLinks||(this._fromAgentLinks=new at(!1)),this._agentLinks||(this._agentLinks=new at(!1)),this._fromAgentLinks.add(t),this._agentLinks.add(t)},_addToAgentLink:function(t){this._toAgentLinks||(this._toAgentLinks=new at(!1)),this._agentLinks||(this._agentLinks=new at(!1)),this._toAgentLinks.add(t),this._agentLinks.add(t)},_removeFromAgentLink:function(t){this._fromAgentLinks&&this._fromAgentLinks.remove(t),this._agentLinks&&this._agentLinks.remove(t)},_removeToAgentLink:function(t){this._toAgentLinks&&this._toAgentLinks.remove(t),this._agentLinks&&this._agentLinks.remove(t)},getImage:function(){return this._image},setImage:function(t){var e=this._image,i=this.getWidth(),n=this.getHeight();this._image=t,this.firePropertyChange("image",e,t),this.firePropertyChange("width",i,this.getWidth()),this.firePropertyChange("height",n,this.getHeight())},getImageUrl:function(){return this._imageUrl},setImageUrl:function(t){var e;this._imageUrl!=t&&(e=this._imageUrl,this._imageUrl=t,we.images[t]||n.imageUtil.registerImageByUrl(t,"svg"===n.imageUtil.getImageType(t),t),this.setImage(t),this.firePropertyChange("imageUrl",e,t))},getX:function(){return this._location.x},getY:function(){return this._location.y},setX:function(t){this.setLocation(t,this._location.y)},setY:function(t){this.setLocation(this._location.x,t)},getLocation:function(){return this._location},setLocation:function(t,e){var i,n=2===arguments.length?{x:t,y:e}:t;o.num(n.x)&&o.num(n.y)&&(n.x===this._location.x&&n.y===this._location.y||(this._dragBoundsFunc&&(n=this._dragBoundsFunc(n)),i=this._location,this._location=n,this.firePropertyChange("location",i,n)))},getCenterLocation:function(){return Ee.CENTER_LOCATION?this._location:{x:this.getX()+this.getWidth()/2,y:this.getY()+this.getHeight()/2}},setCenterLocation:function(t,e){var i=2===arguments.length?{x:t,y:e}:o.clone(t);o.num(i.x)&&o.num(i.y)&&(Ee.CENTER_LOCATION||(i.x-=this.getWidth()/2,i.y-=this.getHeight()/2),this.setLocation(i))},translate:function(t,e){this.setLocation(this.getX()+t,this.getY()+e)},getWidth:function(){if(o.num(this._width)&&0<=this._width)return this._width;if("object"!=e(this._image)){var t=o.getImageAsset(this._image);if(t){var i=t.getWidth();return o.num(i)&&0<=i?i:(t=t._image,Mt(this,t,t,"w"))}}else if(this._image)return this._image.w;return Ee.NODE_WIDTH},setWidth:function(t){var e=this._width;this._width=t,this.firePropertyChange("width",e,t)},getHeight:function(){if(o.num(this._height)&&0<=this._height)return this._height;if("object"!=e(this._image)){var t=o.getImageAsset(this._image);if(t){var i=t.getHeight();return o.num(i)&&0<=i?i:(t=t._image,Mt(this,t,t,"h"))}}else if(this._image)return this._image.h;return Ee.NODE_HEIGHT},setHeight:function(t){var e=this._height;this._height=t,this.firePropertyChange("height",e,t)},setSize:function(){2===arguments.length?(this.setWidth(arguments[0]),this.setHeight(arguments[1])):(this.setWidth(arguments[0].width),this.setHeight(arguments[0].height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},getRect:function(){var t=this.getOriginalRect();if(0===this._angle)return t;for(var e=f.createMatrix(this._angle*Math.PI/180,t.x+t.width/2,t.y+t.height/2),i=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}],n=0,o=i.length;n<o;n++)i[n]=e.transform(i[n]);return f.getRect(i)},getOriginalRect:function(){var t=this.getWidth(),e=this.getHeight();return Ee.CENTER_LOCATION?{x:this._location.x-t/2,y:this._location.y-e/2,width:t,height:e}:{x:this.getX(),y:this.getY(),width:t,height:e}},getAngle:function(){return this._angle},setAngle:function(t){var e=this._angle;this._angle=t%360,this.firePropertyChange("angle",e,this._angle)},onParentChanged:function(t,e){be.superClass.onParentChanged.call(this,t,e),this._checkLinkAgent()},_checkLinkAgent:function(){if(n._isInitializing){if(this._links)for(var t=this._links.size(),e=0;e<t;e++)this._links.get(e)._checkAgentNode()}else n.ElementBox.prototype.startBatch(function(){if(this._links)for(var t=this._links.size(),e=0;e<t;e++)this._links.get(e)._checkAgentNode()},this)},onPropertyChanged:function(t){if(be.superClass.onPropertyChanged.call(this,t),this._followers)for(var e=this._followers.toList(),i=e.size(),n=0;n<i;n++)e.get(n).handleHostPropertyChange(t);this.getParent()instanceof Le&&be.IS_INTERESTED_NODE_PROPERTY[t.property]&&this.getParent().updateLocationFromChildren()},getElementUIClass:function(){return n.network.NodeUI},getCanvasUIClass:function(){return n.canvas.NodeUI},getVectorUIClass:function(){return n.vector.NodeUI}}),n.HTMLNode=function t(e){t.superClass.constructor.call(this,e)},o.ext("b2.HTMLNode",n.Node,{getElementUIClass:function(){return n.network.HTMLNodeUI},getCanvasUIClass:function(){return n.canvas.HTMLNodeUI},getVectorUIClass:function(){return n.vector.HTMLNodeUI}}),n.Link=function(t,e,i){n.Link.superClass.constructor.call(this,t instanceof be?null:t),t instanceof be&&(i=e,e=t),e&&this.setFromNode(e),i&&this.setToNode(i)},n.Link.IS_INTERESTED_BUNDLE_STYLE={"link.bundle.enable":1,"link.bundle.id":1,"link.bundle.independent":1},o.ext("b2.Link",n.Element,{_fromNode:null,_toNode:null,_fromAgent:null,_toAgent:null,_icon:Ee.ICON_LINK,getFromNode:function(){return this._fromNode},getToNode:function(){return this._toNode},getFromAgent:function(){return this._fromAgent},getToAgent:function(){return this._toAgent},setFromNode:function(t){var e;this._fromNode!==t&&(e=this._fromNode,this._fromNode=t,e&&e._removeFromLink(this),this._fromNode&&this._fromNode._addFromLink(this),this._checkAgentNode(),this.firePropertyChange("fromNode",e,t))},setToNode:function(t){var e;this._toNode!==t&&(e=this._toNode,this._toNode=t,e&&e._removeToLink(this),this._toNode&&this._toNode._addToLink(this),this._checkAgentNode(),this.firePropertyChange("toNode",e,t))},isLooped:function(){return this._fromNode===this._toNode&&null!=this._fromNode&&null!=this._toNode},_checkAgentNode:function(){n._isInitializing?n._links[this._id]||(n._links[this._id]=this):this._checkAgentNodeImpl()},_checkAgentNodeImpl:function(){var t,e,i=lt.figureFromAgent(this);this._fromAgent!=i&&(t=this._fromAgent,this._fromAgent&&this._fromAgent._removeFromAgentLink(this),this._fromAgent=i,this._fromAgent&&this._fromAgent._addFromAgentLink(this),this.firePropertyChange("fromAgent",t,this._fromAgent),n._isInitializing?(t&&this._toAgent&&(e=t._id+":"+this._toAgent._id,n._bundleLinks[e]||(n._bundleLinks[e]=[t,this._toAgent])),this._fromAgent&&this._toAgent&&(e=this._fromAgent._id+":"+this._toAgent._id,n._bundleLinks[e]||(n._bundleLinks[e]=[this._fromAgent,this._toAgent]))):(lt.resetBundleLinks(t,this._toAgent),lt.resetBundleLinks(this._fromAgent,this._toAgent))),i=lt.figureToAgent(this),this._toAgent!=i&&(t=this._toAgent,this._toAgent&&this._toAgent._removeToAgentLink(this),this._toAgent=i,this._toAgent&&this._toAgent._addToAgentLink(this),this.firePropertyChange("toAgent",t,this._toAgent),n._isInitializing?(t&&this._fromAgent&&(e=t._id+":"+this._fromAgent._id,n._bundleLinks[e]||(n._bundleLinks[e]=[t,this._fromAgent])),this._toAgent&&this._fromAgent&&(e=this._toAgent._id+":"+this._fromAgent._id,n._bundleLinks[e]||(n._bundleLinks[e]=[this._toAgent,this._fromAgent]))):(lt.resetBundleLinks(t,this._fromAgent),lt.resetBundleLinks(this._toAgent,this._fromAgent)))},_setBundleLinks:function(t){this._bundleLinks=t,this.firePropertyChange("bundleLinks",!0,!1)},getBundleLinks:function(){return this._bundleLinks},getBundleCount:function(){return this._bundleLinks?this._bundleLinks.getLinks().size():1},getBundleIndex:function(){return this._bundleLinks?this._bundleLinks.getLinks().indexOf(this):0},reverseBundleExpanded:function(){if(this._bundleLinks&&0<this._bundleLinks.getLinks().size()){for(var t=this._bundleLinks.getLinks(),e=!this.getStyle("link.bundle.expanded"),i=0;i<t.size();i++)t.get(i).setStyle("link.bundle.expanded",e);var n=this._bundleLinks.getSiblings();for(i=0;i<n.size();i++){var o=n.get(i);if(o!=this._bundleLinks){t=o.getLinks();for(var s=0;s<t.size();s++)t.get(s).firePropertyChange("bundleLinks",null,o)}}return!0}return!1},isBundleAgent:function(){return null!=this._bundleLinks&&1<this._bundleLinks.getLinks().size()&&this===this._bundleLinks.getLinks().get(0)&&!this.getStyle("link.bundle.expanded")},onStyleChanged:function(t,e,i){n.Link.superClass.onStyleChanged.call(this,t,e,i),n.Link.IS_INTERESTED_BUNDLE_STYLE[t]&&lt.resetBundleLinks(this._toAgent,this._fromAgent)},getElementUIClass:function(){return n.network.LinkUI},getCanvasUIClass:function(){return n.canvas.LinkUI},getVectorUIClass:function(){return n.vector.LinkUI},isAdjustedToBottom:function(){return Ee.IS_LINK_ADJUSTED_TO_BOTTOM}}),n.HTMLLink=function(t,e,i){n.HTMLLink.superClass.constructor.call(this,t,e,i)},n.Util.ext("b2.HTMLLink",n.Link,{getElementUIClass:function(){return n.network.HTMLLinkUI},getCanvasUIClass:function(){return n.canvas.HTMLLinkUI},getVectorUIClass:function(){return n.vector.HTMLLinkUI}}),n.Follower=function(t){this._isUpdatingFollower=!1,this._isUpdatingLocation=!1,n.Follower.superClass.constructor.call(this,t)},n.Follower.IS_INTERESTED_HOST_GRID_PROPERTY={location:1,width:1,height:1,"S:grid.row.count":1,"S:grid.column.count":1,"S:grid.row.percents":1,"S:grid.column.percents":1,"S:grid.border":1,"S:grid.border.left":1,"S:grid.border.right":1,"S:grid.border.top":1,"S:grid.border.bottom":1,"S:grid.padding":1,"S:grid.padding.left":1,"S:grid.padding.right":1,"S:grid.padding.top":1,"S:grid.padding.bottom":1},n.Follower.IS_INTERESTED_FOLLOWER_STYLE={"follower.row.index":1,"follower.column.index":1,"follower.row.span":1,"follower.column.span":1,"follower.padding":1,"follower.padding.left":1,"follower.padding.right":1,"follower.padding.top":1,"follower.padding.bottom":1},o.ext("b2.Follower",be,{_host:null,getHost:function(){return this._host},setHost:function(t){var e;this!==t&&this._host!==t&&((e=this._host)&&e._removeFollower(this),this._host=t,this._host&&this._host._addFollower(this),this.firePropertyChange("host",e,t),this.onHostChanged(e,t))},onStyleChanged:function(t,e,i){n.Follower.superClass.onStyleChanged.call(this,t,e,i),n.Follower.IS_INTERESTED_FOLLOWER_STYLE[t]&&this.updateFollower(null)},setLocation:function(){this._isUpdatingLocation||(this._isUpdatingLocation=!0,n.Follower.superClass.setLocation.apply(this,arguments),this._isUpdatingLocation=!1)},onHostChanged:function(t,e){this.updateFollower(null)},handleHostPropertyChange:function(t){this.updateFollower(t)},updateFollower:function(t){this._isUpdatingFollower||o.isDeserializing||(this._isUpdatingFollower=!0,this.updateFollowerImpl(t),this._isUpdatingFollower=!1)},updateFollowerImpl:function(t){var e,i,o,s,r,a,h=this.getHost();h instanceof n.Grid?t&&!n.Follower.IS_INTERESTED_HOST_GRID_PROPERTY[t.property]||(e=this.getStyle("follower.row.index"),i=this.getStyle("follower.column.index"),(a=h.getCellRect(e,i))&&(o=this.getStyle("follower.row.span"),s=this.getStyle("follower.column.span"),1==o&&1==s||(s=h.getCellRect(e+o-1,i+s-1))&&(a=f.unionRect(a,s)),f.addPadding(a,this,"follower.padding"),this.getStyle("follower.fill.cell")?(this.setLocation(a.x,a.y),this.setWidth(a.width),this.setHeight(a.height)):(r=this.getStyle("follower.cell.position"),a=y.get(r,a,this.getRect()),this.setLocation(a.x,a.y)))):null!=t&&"location"===t.property&&(r=t.oldValue,a=t.newValue,t=this.getLocation(),this.setLocation(t.x+(a.x-r.x),t.y+(a.y-r.y)))},isHostOn:function(t){if(!t)return!1;for(var e={},i=this._host;i&&i!=this&&!e[i.getId()];){if(i===t)return!0;i=(e[i.getId()]=i)instanceof n.Follower?i.getHost():null}return!1},isLoopedHostOn:function(t){return this.isHostOn(t)&&t.isHostOn(this)}});var Ie,Le=function t(e){this._isUpdatingLocationFromChildren=!1,this._isAdjusting=!1,this._expanded=!1,t.superClass.constructor.call(this,e)};n.Group=Le,o.ext("b2.Group",n.Follower,{_image:Ee.IMAGE_GROUP,_icon:Ee.ICON_GROUP,isAdjustedToBottom:function(){return this.isExpanded()&&lt.hasAgentLinks(this)},onChildAdded:function(t,e){Le.superClass.onChildAdded.apply(this,arguments),this.updateLocationFromChildren()},onChildRemoved:function(t,e){Le.superClass.onChildRemoved.apply(this,arguments),this.updateLocationFromChildren()},updateLocationFromChildren:function(){if(!this._isAdjusting&&!o.isDeserializing){for(var t,e,i=0,n=this.getChildrenSize();i<n;i++)(e=this.getChildAt(i))instanceof be&&(t=f.unionRect(t,this.getChildRect(e)));t&&(this._isUpdatingLocationFromChildren=!0,"lefttop"===Ee.GROUP_EXPAND_ALIGN?this.setLocation(t.x-this.getWidth()/2,t.y-this.getHeight()/2):this.setLocation(t.x+t.width/2-this.getWidth()/2,t.y+t.height/2-this.getHeight()/2),this._isUpdatingLocationFromChildren=!1)}},getChildRect:function(t){var e;return e=t instanceof be?t instanceof Le?(t.isExpanded()&&t.getChildren().forEach(function(i){e=f.unionRect(e,t.getChildRect(i))}),e||t.getRect()):t.getRect():e},setLocation:function(){var t,e,i;this._isAdjusting||(i=2===arguments.length?{x:arguments[0],y:arguments[1]}:arguments[0],o.isDeserializing||this._isUpdatingLocationFromChildren||(this._isAdjusting=!0,t=i.x-this.getX(),e=i.y-this.getY(),lt.moveElements(this.getChildren(),t,e),this._isAdjusting=!1),Le.superClass.setLocation.call(this,i))},reverseExpanded:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._expanded},setExpanded:function(t){var e;this._expanded!==t&&(e=this._expanded,this._expanded=t,this.firePropertyChange("expanded",e,this._expanded),this._checkLinkAgent())},_checkLinkAgent:function(){Le.superClass._checkLinkAgent.call(this);for(var t=this.getChildrenSize(),e=0;e<t;e++){var i=this.getChildAt(e);i instanceof be&&i._checkLinkAgent()}},getElementUIClass:function(){return n.network.GroupUI},getCanvasUIClass:function(){return n.canvas.GroupUI},getVectorUIClass:function(){return n.vector.GroupUI}}),n.SubNetwork=function(t){n.SubNetwork.superClass.constructor.call(this,t)},o.ext("b2.SubNetwork",n.Follower,{ISubNetwork:!0,_image:Ee.IMAGE_SUBNETWORK,_icon:Ee.ICON_SUBNETWORK,_checkLinkAgent:function(){n.SubNetwork.superClass._checkLinkAgent.call(this);for(var t=this.getChildrenSize(),e=0;e<t;e++){var i=this.getChildAt(e);i instanceof be&&i._checkLinkAgent()}}}),n.Grid=function(t){n.Grid.superClass.constructor.call(this,t)},o.ext("b2.Grid",n.Follower,{_icon:Ee.ICON_GRID,_image:null,getCellObject:function(t,e){1===arguments.length&&(e=t.y,t=t.x);for(var i=this.getStyle("grid.row.count"),n=this.getStyle("grid.column.count"),o=0;o<i;o++)for(var s=0;s<n;s++){var r=this.getCellRect(o,s);if(f.containsPoint(r,t,e))return{rowIndex:o,columnIndex:s,rect:r}}return null},getCellRect:function(t,e){var i=this.getStyle("grid.row.count"),n=this.getStyle("grid.column.count");if(i<=0||n<=0)return null;if(t<0||i<=t)return null;if(e<0||n<=e)return null;var o=this.getRect();f.addPadding(o,this,"grid.border");var s=0,r=this.getStyle("grid.row.percents"),a=this.getStyle("grid.column.percents");if(r&&r.length===i){var h=0;for(s=0;s<t;s++)h+=o.height*r[s];o.y+=h,o.height=o.height*r[t]}else o.height=o.height/i,o.y+=o.height*t;if(a&&a.length===n){var l=0;for(s=0;s<e;s++)l+=o.width*a[s];o.x+=l,o.width=o.width*a[e]}else o.width=o.width/n,o.x+=o.width*e;return f.addPadding(o,this,"grid.padding"),o},getElementUIClass:function(){return n.network.GridUI},getCanvasUIClass:function(){return n.canvas.GridUI},getVectorUIClass:function(){return n.vector.GridUI}}),n.ShapeNode=function(t){this._isUpdatingShapeNode=!1,this._points=new at,n.ShapeNode.superClass.constructor.call(this,t)},o.ext("b2.ShapeNode",n.Follower,{_icon:Ee.ICON_SHAPENODE,__accessor:["segments"],getElementUIClass:function(){return n.network.ShapeNodeUI},getCanvasUIClass:function(){return n.canvas.ShapeNodeUI},getVectorUIClass:function(){return n.vector.ShapeNodeUI},getPoints:function(){return this._points},setPoints:function(t){t=t||new at;var e=new at(this._points);this._points=t,this.firePointsChange(e,this._points)},getSegments:function(){return this._segments},setSegments:function(t){t=t||new at;var e=new at(this._segments);this._segments=t,this._reCalculateLineLength(),this.firePropertyChange("segments",e,this._segments)},addPoint:function(t,e){var i=new at(this._points);this._points.add(t,e),this.firePointsChange(i,this._points)},setPoint:function(t,e){var i=new at(this._points);this._points.set(t,e),this.firePointsChange(i,this._points)},removePoint:function(t){var e=new at(this._points);this._points.remove(t),this.firePointsChange(e,this._points)},removeAt:function(t){var e=new at(this._points);this._points.removeAt(t),this.firePointsChange(e,this._points)},setWidth:function(t){if(t<1&&(t=1),!this._isUpdatingShapeNode&&!o.isDeserializing){this._isUpdatingShapeNode=!0;for(var e=new at(this._points),i=0;i<this._points.size();i++){var s=this._points.get(i);s.x=(s.x-this.getX())*t/this.getWidth()+this.getX()}this.firePointsChange(e,this._points),this._isUpdatingShapeNode=!1}n.ShapeNode.superClass.setWidth.apply(this,arguments)},setHeight:function(t){if(t<1&&(t=1),!this._isUpdatingShapeNode&&!o.isDeserializing){this._isUpdatingShapeNode=!0;for(var e=new at(this._points),i=0;i<this._points.size();i++){var s=this._points.get(i);s.y=(s.y-this.getY())*t/this.getHeight()+this.getY()}this.firePointsChange(e,this._points),this._isUpdatingShapeNode=!1}n.ShapeNode.superClass.setHeight.apply(this,arguments)},setLocation:function(){if(!this._isUpdatingShapeNode&&!o.isDeserializing){var t=2===arguments.length?{x:arguments[0],y:arguments[1]}:arguments[0];if(!o.num(t.x)||!o.num(t.y))return;var e=t.x-this.getX(),i=t.y-this.getY();if(0==e&&0==i)return;this._isUpdatingShapeNode=!0;t=new at(this._points);for(var s=0;s<this._points.size();s++){var r=this._points.get(s);r.x+=e,r.y+=i}this.firePointsChange(t,this._points),this._isUpdatingShapeNode=!1}n.ShapeNode.superClass.setLocation.apply(this,arguments)},firePointsChange:function(t,e){var i;this._isUpdatingShapeNode||o.isDeserializing||((i=f.getRect(e))?(this._isUpdatingShapeNode=!0,Ee.CENTER_LOCATION?this.setLocation(i.x+i.width/2,i.y+i.height/2):this.setLocation(i.x,i.y),this.setWidth(i.width),this.setHeight(i.height)):(this._isUpdatingShapeNode=!0,this.setWidth(0),this.setHeight(0)),this._isUpdatingShapeNode=!1),this._reCalculateLineLength(),this.firePropertyChange("points",t,e)},_reCalculateLineLength:function(){null!=this._points&&0<this._points.size()?this._lineLength=f.calculateLineLength(this._points,this._segments):this._lineLength=0},getLineLength:function(){return this._lineLength}}),n.Bus=function(t){this._styleMap={},this._styleMap["vector.fill"]=!1,this._styleMap["shapenode.closed"]=!1,n.Bus.superClass.constructor.call(this,t)},o.ext("b2.Bus",n.ShapeNode,{_icon:Ee.ICON_BUS,firePointsChange:function(t,e){var i=e.size();if(!o.isDeserializing&&2<=i)for(var s=e.get(0),r=1;r<i;r++){var a=e.get(r);Math.abs(a.x-s.x)>Math.abs(a.y-s.y)?a.y=s.y:a.x=s.x,s=a}n.Bus.superClass.firePointsChange.apply(this,arguments)}}),n.ShapeLink=function(t,e,i){this._points=new at,this._styleMap={},this._styleMap["link.bundle.enable"]=!1,n.ShapeLink.superClass.constructor.call(this,t,e,i)},o.ext("b2.ShapeLink",n.Link,{_icon:Ee.ICON_SHAPELINK,getElementUIClass:function(){return n.network.ShapeLinkUI},getCanvasUIClass:function(){return n.canvas.ShapeLinkUI},getVectorUIClass:function(){return n.vector.ShapeLinkUI},getPoints:function(){return this._points},setPoints:function(t){t=t||new at;var e=new at(this._points);this._points=t,this.firePointsChange(e,this._points)},addPoint:function(t,e){var i=new at(this._points);this._points.add(t,e),this.firePointsChange(i,this._points)},setPoint:function(t,e){var i=new at(this._points);this._points.set(t,e),this.firePointsChange(i,this._points)},removePoint:function(t){var e=new at(this._points);this._points.remove(t),this.firePointsChange(e,this._points)},removeAt:function(t){var e=new at(this._points);this._points.removeAt(t),this.firePointsChange(e,this._points)},firePointsChange:function(t,e){this.firePropertyChange("points",t,e)}}),n.ShapeSubNetwork=function(t){n.ShapeSubNetwork.superClass.constructor.call(this,t)},o.ext("b2.ShapeSubNetwork",n.ShapeNode,{ISubNetwork:!0,_icon:Ee.ICON_SHAPESUBNETWORK,_checkLinkAgent:function(){n.ShapeSubNetwork.superClass._checkLinkAgent.call(this);for(var t=this.getChildrenSize(),e=0;e<t;e++){var i=this.getChildAt(e);i instanceof be&&i._checkLinkAgent()}}}),n.LinkSubNetwork=function(){n.LinkSubNetwork.superClass.constructor.apply(this,arguments)},o.ext("b2.LinkSubNetwork",n.Link,{ISubNetwork:!0,_icon:Ee.ICON_LINKSUBNETWORK}),n.ShapeLinkSubNetwork=function(){n.ShapeLinkSubNetwork.superClass.constructor.apply(this,arguments)},o.ext("b2.ShapeLinkSubNetwork",n.ShapeLink,{ISubNetwork:!0,_icon:Ee.ICON_LINKSUBNETWORK}),n.RotatableNode=function(t){n.RotatableNode.superClass.constructor.call(this,t)},o.ext("b2.RotatableNode",n.Follower,{getWidth:function(){return 0==this._angle?this._getOrignalWidth():this._getRotateRect().width},setWidth:function(t){},getHeight:function(){return 0==this._angle?this._getOrignalHeight():this._getRotateRect().height},setHeight:function(t){},getElementUIClass:function(){return n.network.RotatableNodeUI},getCanvasUIClass:function(){return n.canvas.RotatableNodeUI},getVectorUIClass:function(){return n.vector.RotatableNodeUI},_getRotateRect:function(){for(var t=this._getOrignalWidth(),e=this._getOrignalHeight(),i=f.createMatrix(this._angle*Math.PI/180,t/2,e/2),n=[{x:0,y:0},{x:t,y:0},{x:t,y:e},{x:0,y:e}],o=0,s=n.length;o<s;o++)n[o]=i.transform(n[o]);return f.getRect(n)},_getOrignalWidth:function(){return n.RotatableNode.superClass.getWidth.call(this)},_getOrignalHeight:function(){return n.RotatableNode.superClass.getHeight.call(this)}}),n.Column=function(t){n.Column.superClass.constructor.call(this,t)},o.ext("b2.Column",n.Data,{IColumn:!0,__property:1,__accessor:["width","horizontalAlign","valueType","propertyType","propertyName","editable","visible","sortable","resizable","movable","sortDirection","sortFunction","enumInfo"],__bool:["innerText"],_innerText:Ee.COLUMN_INNER_TEXT,_width:Ee.COLUMN_WIDTH,_horizontalAlign:Ee.COLUMN_HORIZONTAL_ALIGN,_propertyName:null,_propertyType:Ee.COLUMN_PROPERTY_TYPE,_valueType:Ee.COLUMN_VALUE_TYPE,_editable:Ee.COLUMN_EDITABLE,_sortable:Ee.COLUMN_SORTABLE,_visible:Ee.COLUMN_VISIBLE,_resizable:Ee.COLUMN_RESIZABLE,_movable:Ee.COLUMN_MOVABLE,_sortDirection:"asc",_sortFunction:Ee.SORT_FUNCTION,_enumInfo:null,renderCell:Ee.COLUMN_RENDER_CELL,renderHeader:Ee.COLUMN_RENDER_HEADER,renderEditor:Ee.COLUMN_RENDER_EDITOR,setParent:function(t){throw"parent not supported"},getEnumInfo:function(){return"object"==e(this._enumInfo)?this._enumInfo:"function"==typeof this._enumInfo?1===arguments.length?this._enumInfo(arguments[0]):this._enumInfo():void 0}}),n.BundleLinks=function(t,e){this._links=t,this._siblings=e;for(var i=Ce._m["link.bundle.expanded"],n=0;n<t.size();n++){var o=t.get(n).getStyle("link.bundle.expanded");if(null!=o){i=o;break}}for(null==i&&(i=!0),Ee.LINK_BUNDLE_AGENT_FUNCTION&&(null==(e=Ee.LINK_BUNDLE_AGENT_FUNCTION(t))?e=t.get(0):e!=t.get(0)&&(t.remove(e),t.add(e,0))),n=0;n<t.size();n++)t.get(n).setStyle("link.bundle.expanded",i)},o.ext("b2.BundleLinks",Object,{getLinks:function(){return this._links},getSiblings:function(){return this._siblings},forEachSiblingLink:function(t,e){this._siblings.forEach(function(i){i.getLinks().forEach(t,e)})}}),n.Property=function(t){n.Property.superClass.constructor.call(this,t)},o.ext("b2.Property",n.Data,{IProperty:!0,__property:1,__accessor:["horizontalAlign","valueType","editable","propertyType","propertyName","categoryName","enumInfo"],__bool:["innerText"],_innerText:Ee.PROPERTY_INNER_TEXT,_horizontalAlign:Ee.PROPERTY_HORIZONTAL_ALIGN,_propertyName:null,_propertyType:Ee.PROPERTY_PROPERTY_TYPE,_valueType:Ee.PROPERTY_VALUE_TYPE,_editable:Ee.PROPERTY_EDITABLE,_categoryName:Ee.PROPERTY_CATEGORY_NAME,_enumInfo:null,renderName:Ee.PROPERTY_RENDER_NAME,renderValue:Ee.PROPERTY_RENDER_VALUE,isVisible:null,renderEditor:Ee.PROPERTY_RENDER_EDITOR,setParent:function(t){throw"parent not supported"},setPropertyName:function(t){var e=this._propertyName;this._propertyName=t,this.firePropertyChange("propertyName",e,t)},setPropertyType:function(t){var e=this._propertyType;this._propertyType=t,this.firePropertyChange("propertyType",e,t)},getEnumInfo:function(){return"object"==e(this._enumInfo)?this._enumInfo:"function"==typeof this._enumInfo?1===arguments.length?this._enumInfo(arguments[0]):this._enumInfo():void 0}}),n.Tab=function(t){n.Tab.superClass.constructor.call(this,t)},o.ext("b2.Tab",n.Data,{ITab:!0,__accessor:["view","width","closable","resizable","movable","disabled","visible"],_icon:null,_width:Ee.TAB_WIDTH,_closable:Ee.TAB_CLOSABLE,_resizable:Ee.TAB_RESIZABLE,_movable:Ee.TAB_MOVABLE,_disabled:Ee.TAB_DISABLED,_visible:Ee.TAB_VISIBLE,setParent:function(t){throw"parent not supported"}}),n.AlarmStatePropagator=function(t){n.AlarmStatePropagator.superClass.constructor.call(this,t,"alarmState")},o.ext("b2.AlarmStatePropagator",n.PropertyPropagator,{handleDataPropertyChange:function(t){"enablePropagation"===t.property?this.propagate(t.source):n.AlarmStatePropagator.superClass.handleDataPropertyChange.call(this,t)},propagateToParent:function(t,e){var i=null;e.getChildren().forEach(function(t){t=t.getAlarmState().getHighestOverallAlarmSeverity(),0<n.AlarmSeverity.compare(t,i)&&(i=t)}),e.getAlarmState().setPropagateSeverity(i)}}),n.AlarmSeverity=function(t,e,i,n,o){this.value=t,this.name=e,this.nickName=i,this.color=n,this.displayName=o},o.ext("b2.AlarmSeverity",Object,{toString:function(){return this.displayName||this.name}}),(Ie=n.AlarmSeverity).severities=new at,Ie._vm={},Ie._nm={},Ie._cp=function(t,e){if(t&&e){var i=t.value-e.value;return 0<i?1:i<0?-1:0}return t&&!e?1:!t&&e?-1:0},Ie.forEach=function(t,e){Ie.severities.forEach(t,e)},Ie.getSortFunction=function(){return Ie._cp},Ie.setSortFunction=function(t){Ie._cp=t,Ie.severities.sort(t)},Ie.add=function(t,e,i,n,o){return o=new Ie(t,e,i,n,o),Ie._vm[t]=o,Ie._nm[e]=o,Ie.severities.add(o),Ie.severities.sort(Ie._cp),o},Ie.remove=function(t){var e=Ie._nm[t];return e&&(delete Ie._nm[t],delete Ie._vm[e.value],Ie.severities.remove(e)),e},Ie.CRITICAL=Ie.add(500,"Critical","C","#FF0000"),Ie.MAJOR=Ie.add(400,"Major","M","#FFA000"),Ie.MINOR=Ie.add(300,"Minor","m","#FFFF00"),Ie.WARNING=Ie.add(200,"Warning","W","#00FFFF"),Ie.INDETERMINATE=Ie.add(100,"Indeterminate","N","#C800FF"),Ie.CLEARED=Ie.add(0,"Cleared","R","#00FF00"),Ie.isClearedAlarmSeverity=function(t){return!!t&&0===t.value},Ie.getByName=function(t){return Ie._nm[t]},Ie.getByValue=function(t){return Ie._vm[t]},Ie.clear=function(){Ie.severities.clear(),Ie._vm={},Ie._nm={}},Ie.compare=function(t,e){return Ie._cp(t,e)},n.AlarmState=function(t){this._e=t,this._nm={},this._am={},this._ps=null,this._haa=null,this._hna=null,this._hoa=null,this._hta=null,this._hls=!1,this._aac=0,this._nac=0},o.ext("b2.AlarmState",Object,{_ep:!0,_f:function(){this._c1(),this._c2(),this._c3(),this._c4(),this._c5(),this._c6(),this._c7(),this._e.firePropertyChange("alarmState",null,this)},getHighestAcknowledgedAlarmSeverity:function(){return this._haa},getHighestNewAlarmSeverity:function(){return this._hna},getHighestOverallAlarmSeverity:function(){return this._hoa},getHighestNativeAlarmSeverity:function(){return this._hta},hasLessSevereNewAlarms:function(){return this._hls},_c1:function(){var t,e=null;for(t in this._am)t=n.AlarmSeverity.getByName(t),n.AlarmSeverity.isClearedAlarmSeverity(t)||0!==this.getAcknowledgedAlarmCount(t)&&(e=e&&0<n.AlarmSeverity.compare(e,t)?e:t);this._haa=e},_c2:function(){var t,e=null;for(t in this._nm)t=n.AlarmSeverity.getByName(t),n.AlarmSeverity.isClearedAlarmSeverity(t)||0!==this.getNewAlarmCount(t)&&(e=e&&0<n.AlarmSeverity.compare(e,t)?e:t);this._hna=e},_c3:function(){if(this._hna){for(var t in this._nm)if(t=n.AlarmSeverity.getByName(t),!n.AlarmSeverity.isClearedAlarmSeverity(t)&&0!==this.getNewAlarmCount(t)&&0<n.AlarmSeverity.compare(this._hna,t))return void(this._hls=!0);this._hls=!1}else this._hls=!1},_c4:function(){var t=this._haa,e=this._hna,i=this._ps;this._hoa=t,0<n.AlarmSeverity.compare(e,this._hoa)&&(this._hoa=e),0<n.AlarmSeverity.compare(i,this._hoa)&&(this._hoa=i)},_c5:function(){var t=this._haa,e=this._hna;this._hta=t,0<n.AlarmSeverity.compare(e,this._hta)&&(this._hta=e)},increaseAcknowledgedAlarm:function(t,e){var i;0!==(e=null==e?1:e)&&(null==(i=this._am[t.name])&&(i=0),this._am[t.name]=i+=e,this._f())},increaseNewAlarm:function(t,e){var i;0!==(e=null==e?1:e)&&(null==(i=this._nm[t.name])&&(i=0),this._nm[t.name]=i+=e,this._f())},decreaseAcknowledgedAlarm:function(t,e){if(0!==(e=null==e?1:e)){var i=this._am[t.name];if(null==i&&(i=0),(i-=e)<0)throw"Alarm count can not be negative";this._am[t.name]=i,this._f()}},decreaseNewAlarm:function(t,e){if(0!==(e=null==e?1:e)){var i=this._nm[t.name];if(null==i&&(i=0),(i-=e)<0)throw"Alarm count can not be negative";this._nm[t.name]=i,this._f()}},acknowledgeAlarm:function(t){this.decreaseNewAlarm(t,1),this.increaseAcknowledgedAlarm(t,1)},acknowledgeAllAlarms:function(t){if(t){var e=this.getNewAlarmCount(t);this.decreaseNewAlarm(t,e),this.increaseAcknowledgedAlarm(t,e)}else for(var i in this._nm)this.acknowledgeAllAlarms(n.AlarmSeverity.getByName(i))},_c6:function(){for(var t in this._aac=0,this._am)t=n.AlarmSeverity.getByName(t),this._aac+=this.getAcknowledgedAlarmCount(t)},getAcknowledgedAlarmCount:function(t){return t?null==(t=this._am[t.name])?0:t:this._aac},getAlarmCount:function(t){return this.getAcknowledgedAlarmCount(t)+this.getNewAlarmCount(t)},_c7:function(){for(var t in this._nac=0,this._nm)t=n.AlarmSeverity.getByName(t),this._nac+=this.getNewAlarmCount(t)},getNewAlarmCount:function(t){return t?null==(t=this._nm[t.name])?0:t:this._nac},setNewAlarmCount:function(t,e){this._nm[t.name]=e,this._f()},removeAllNewAlarms:function(t){t?delete this._nm[t]:this._nm={},this._f()},setAcknowledgedAlarmCount:function(t,e){this._am[t.name]=e,this._f()},removeAllAcknowledgedAlarms:function(t){t?delete this._am[t.name]:this._am={},this._f()},isEmpty:function(){return null==this._hoa},clear:function(){this._am={},this._nm={},this._f()},getPropagateSeverity:function(){return this._ps},setPropagateSeverity:function(t){var e;this._ep||(t=null),this._ps!==t&&(e=this._ps,this._ps=t,this._f(),this._e.firePropertyChange("propagateSeverity",e,t))},isEnablePropagation:function(){return this._ep},setEnablePropagation:function(t){var e=this._ep;this._ep=t,this._e.firePropertyChange("enablePropagation",e,t)&&(t||this.setPropagateSeverity(null))}}),n.AlarmElementMapping=function(t,e){if(!e)throw"ElementBox can not be null";if(!t)throw"AlarmBox can not be null";this._elementBox=e,this._alarmBox=t,this._alarmsFinder=new n.QuickFinder(t,"elementId")},o.ext("b2.AlarmElementMapping",Object,{getCorrespondingAlarms:function(t){return this._alarmsFinder.find(t.getId())},getCorrespondingElements:function(t){return t=this._elementBox.getDataById(t.getElementId()),new at(t)},dispose:function(){this._alarmsFinder.dispose(),delete this._elementBox,delete this._alarmBox,delete this._alarmsFinder}}),n.AlarmStateStatistics=function(t){n.AlarmStateStatistics.superClass.constructor.apply(this,arguments),this.sumNew=0,this.sumAcked=0,this.sumTotal=0,this.severtiyMap={},this.elementMap={},this.setElementBox(t)},o.ext("b2.AlarmStateStatistics",n.PropertyChangeDispatcher,{getElementBox:function(){return this._elementBox},setElementBox:function(t){if(!t)throw"ElementBox can not be null";var e;this._elementBox!==t&&((e=this._elementBox)&&(e.removeDataPropertyChangeListener(this.handleElementPropertyChange,this),e.removeDataBoxChangeListener(this.handleElementBoxChange,this),this.severtiyMap={},this.elementMap={}),this._elementBox=t,this.reset(),t.addDataPropertyChangeListener(this.handleElementPropertyChange,this),t.addDataBoxChangeListener(this.handleElementBoxChange,this),this.firePropertyChange("elementBox",e,t))},dispose:function(){this._elementBox.removeDataPropertyChangeListener(this.handleElementPropertyChange,this),this._elementBox.removeDataBoxChangeListener(this.handleElementBoxChange,this),delete this._elementBox},handleElementPropertyChange:function(t){"alarmState"===t.property&&(this.increase(t.source),this.fireAlarmStateChange())},handleElementBoxChange:function(t){"add"===t.kind?(this.increase(t.data),this.fireAlarmStateChange()):"remove"===t.kind?(this.decrease(t.data),this.fireAlarmStateChange()):"clear"===t.kind&&(this.severtiyMap={},this.elementMap={},this.fireAlarmStateChange())},fireAlarmStateChange:function(){this.sumAcked=0,this.sumNew=0,this.sumTotal=0,n.AlarmSeverity.forEach(function(t){t=this.getSumInfo(t),this.sumAcked+=t.ackedCount,this.sumNew+=t.newCount,this.sumTotal+=t.totalCount},this),this.firePropertyChange("alarmState",!1,!0)},getNewAlarmCount:function(t){return t?this.getSumInfo(t).newCount:this.sumNew},getAcknowledgedAlarmCount:function(t){return t?this.getSumInfo(t).ackedCount:this.sumAcked},getTotalAlarmCount:function(t){return t?this.getSumInfo(t).totalCount:this.sumTotal},getSumInfo:function(t){var e=this.severtiyMap[t.name];return e||(this.severtiyMap[t.name]=e={newCount:0,ackedCount:0,totalCount:0}),e},decrease:function(t){var e=this.elementMap[t.getId()];e&&(delete this.elementMap[t.getId()],n.AlarmSeverity.forEach(function(t){var i=e[t.name];(t=this.getSumInfo(t)).newCount=t.newCount-i.newCount,t.ackedCount=t.ackedCount-i.ackedCount,t.totalCount=t.totalCount-i.totalCount},this))},increase:function(t){var e;this.decrease(t),this._filterFunction&&!this._filterFunction(t)||(e={},this.elementMap[t.getId()]=e,n.AlarmSeverity.forEach(function(i){var n={};n.newCount=t.getAlarmState().getNewAlarmCount(i),n.ackedCount=t.getAlarmState().getAcknowledgedAlarmCount(i),n.totalCount=t.getAlarmState().getAlarmCount(i),e[i.name]=n,(i=this.getSumInfo(i)).newCount=i.newCount+n.newCount,i.ackedCount=i.ackedCount+n.ackedCount,i.totalCount=i.totalCount+n.totalCount},this))},reset:function(){this.severtiyMap={},this.elementMap={},this._elementBox.forEach(this.increase,this),this.fireAlarmStateChange()},setFilterFunction:function(t){var e=this._filterFunction;this._filterFunction=t,this.reset(),this.firePropertyChange("filterFunction",e,t)},getFilterFunction:function(){return _filterFunction}}),n.Alarm=function(t,e,i,o,s){n.Alarm.superClass.constructor.call(this,t),this._elementId=e,this._alarmSeverity=i,this._acked=o||!1,this._cleared=s||!1},o.ext("b2.Alarm",n.Data,{IAlarm:!0,getElementId:function(){return this._elementId},__accessor:["acked","cleared","alarmSeverity"]}),n.controls.ControlBase=function(){n.controls.ControlBase.superClass.constructor.apply(this,arguments),this._pools=new at},o.ext("b2.controls.ControlBase",n.PropertyChangeDispatcher,{_autoAdjustBounds:!1,addPool:function(t){this._pools.contains(t)||this._pools.add(t)},removePool:function(t){this._pools.remove(t)},adjustBounds:function(t){var e=this._view.style;e.position="absolute",e.left=t.x+"px",e.top=t.y+"px",e.width=t.width+"px",e.height=t.height+"px",!0===this._autoAdjustBounds&&(e.left="0px",e.top="0px",e.right="0px",e.bottom="0px"),this.invalidate&&this.invalidate()},setAutoAdjustBounds:function(t){!0===t?p.addEventListener("resize","_handleResize",window,this):p.removeEventListener("resize",window,this),this._autoAdjustBounds=t},isAutoAdjustBounds:function(){return this._autoAdjustBounds},_handleResize:function(t){this.adjustBounds({x:0,y:0,width:l.documentElement.clientWidth,height:l.documentElement.clientHeight})},getView:function(){return this._view},invalidate:function(t){this._invalidate||(this._invalidate=!0,o.callLater(this.validate,this,null,t))},validate:function(){this._invalidate&&(this._invalidate=!1,0===this._view.offsetWidth&&0===this._view.offsetHeight&&null!==this._reinvalidateCount?(void 0===this._reinvalidateCount&&(this._reinvalidateCount=100),0<this._reinvalidateCount?this._reinvalidateCount--:this._reinvalidateCount=null,this.invalidate()):this.validateImpl())},validateImpl:function(){}}),n.controls.ViewBase=function(){n.controls.ViewBase.superClass.constructor.apply(this,arguments),this._interactionDispatcher=new n.EventDispatcher,this._viewDispatcher=new n.EventDispatcher},o.ext("b2.controls.ViewBase",n.controls.ControlBase,{__bool:["focusOnClick"],_focusOnClick:Ee.FOCUS_ON_CLICK,getSelectionModel:function(){return this._selectionModel||this._box.getSelectionModel()},isShareSelectionModel:function(){return null==this._selectionModel},setShareSelectionModel:function(t){var e=null==this._selectionModel;e!==t&&(t?(this._box.getSelectionModel().addSelectionChangeListener(this.handleSelectionChange,this),this._selectionModel.removeSelectionChangeListener(this.handleSelectionChange,this),this._selectionModel.dispose(),this._selectionModel=null):(this._box.getSelectionModel().removeSelectionChangeListener(this.handleSelectionChange,this),this._selectionModel=new n.SelectionModel(this._box),this._selectionModel.addSelectionChangeListener(this.handleSelectionChange,this)),this.onShareSelectionModelChanged(),this.firePropertyChange("shareSelectionModel",e,t))},onShareSelectionModelChanged:function(){},removeSelection:function(){if(0===this.getSelectionModel().size())return null;var t=this.getSelectionModel().toSelection();return this._box._undoManager._enabled&&this._box._undoManager.startBatch(),t.forEach(function(t){this._box.remove(t)},this),this._box._undoManager._enabled&&this._box._undoManager.endBatch(),t},selectAll:function(){var t=new at;return this._box.forEach(function(e){this.isVisible(e)&&t.add(e)},this),this.getSelectionModel().setSelection(t),t},isSelected:function(t){return this.getSelectionModel().contains(t)},isSelectable:function(t){return this.getSelectionModel().isSelectable(t)},getLabel:function(t){return t.getName()},getToolTip:function(t){return t.getToolTip()},getIcon:function(t){return t.getIcon()},getSelectColor:function(t){return Ee.SELECT_COLOR},addViewListener:function(t,e,i){this._viewDispatcher.add(t,e,i)},removeViewListener:function(t,e){this._viewDispatcher.remove(t,e)},fireViewEvent:function(t){this._viewDispatcher.fire(t)},addInteractionListener:function(t,e,i){this._interactionDispatcher.add(t,e,i)},removeInteractionListener:function(t,e){this._interactionDispatcher.remove(t,e)},fireInteractionEvent:function(t){this._interactionDispatcher.fire(t)},invalidate:function(t){this._invalidate||(this._invalidate=!0,this.fireViewEvent({kind:"invalidate"}),o.callLater(this.validate,this,null,t))},validate:function(){this._invalidate&&(this._invalidate=!1,a||0!==this._view.offsetWidth||0!==this._view.offsetHeight||null===this._reinvalidateCount?(this._isValidating=!0,this.fireViewEvent({kind:"validateStart"}),this.validateImpl(),this.fireViewEvent({kind:"validateEnd"}),delete this._isValidating):(void 0===this._reinvalidateCount&&(this._reinvalidateCount=100),0<this._reinvalidateCount?this._reinvalidateCount--:this._reinvalidateCount=null,this.invalidate()))}}),n.controls.View=function(){n.controls.View.superClass.constructor.apply(this,arguments)},o.ext("b2.controls.View",n.controls.ViewBase,{_zoom:1,_maxZoom:Ee.ZOOM_MAX,_minZoom:Ee.ZOOM_MIN,getRootDiv:function(){return this._rootDiv},isValidEvent:function(t){return p.isValidEvent(this._view,t)},getAlarmFillColor:function(t){return t.IElement&&(t=t.getAlarmState().getHighestNewAlarmSeverity())?t.color:null},getInnerColor:function(t){if(t.IElement){var e=t.getAlarmState().getHighestNativeAlarmSeverity();return e?e.color:t.getStyle("inner.color")}return null},getOuterColor:function(t){if(t.IElement){var e=t.getAlarmState().getPropagateSeverity();return e?e.color:t.getStyle("outer.color")}return null},zoomOverview:function(t){var e=Math.min(this._view.clientWidth/this._viewRect.width,this._view.clientHeight/this._viewRect.height);this.setZoom(e,t)},getLogicalPoint:function(t){return p.getLogicalPoint(this._view,t,this.getZoom(),this._rootDiv)},centerByLogicalPoint:function(t,e,i){i&&n.animate.AnimateManager.endAnimate();var o=this._view.scrollWidth-this._view.clientWidth,s=this._view.scrollHeight-this._view.clientHeight;o<(t=(t=(t-this._view.clientWidth/this._zoom/2)*this._zoom)<0?0:t)&&(t=o),s<(e=(e=(e-this._view.clientHeight/this._zoom/2)*this._zoom)<0?0:e)&&(e=s),i?n.animate.AnimateManager.start(new n.animate.AnimateScrollPosition(this._view,t,e)):(this._view.scrollLeft=t,this._view.scrollTop=e)},panByOffset:function(t,e){t*=this.getZoom(),e*=this.getZoom();var i=this._view.scrollLeft+t,n=this._view.scrollTop+e;t=this._view.scrollWidth-this._view.clientWidth;return(e=this._view.scrollHeight-this._view.clientHeight)<(n=n<0?0:n)&&(n=e),t={x:((i=t<(i=i<0?0:i)?t:i)-this._view.scrollLeft)/this.getZoom(),y:(n-this._view.scrollTop)/this.getZoom()},this._view.scrollLeft=i,this._view.scrollTop=n,t},getMaxZoom:function(){return this._maxZoom},setMaxZoom:function(t){var e;t<0||(e=this._maxZoom,this._maxZoom=t,this.firePropertyChange("maxZoom",e,t),this.getZoom()>t&&this.setZoom(t))},getMinZoom:function(){return this._minZoom},setMinZoom:function(t){var e;t<0||(e=this._minZoom,this._minZoom=t,this.firePropertyChange("minZoom",e,t),this.getZoom()<t&&this.setZoom(t,!1))},getZoom:function(){return this._zoom},onZoomChanged:function(t,e){},zoomIn:function(t){this.setZoom(this._zoom*Ee.ZOOM_INCREMENT,t)},zoomOut:function(t){this.setZoom(this._zoom/Ee.ZOOM_INCREMENT,t)},zoomReset:function(t){this.setZoom(1,t)},checkZoom:function(t){return(t=t<this._minZoom?this._minZoom:t)>this._maxZoom?this._maxZoom:t},setZoom:function(t,e){var i,s;!o.num(t)||t<=0||(t=this.checkZoom(t))!==this._zoom&&((e=null==e?Ee.ZOOM_ANIMATE:e)?n.animate.AnimateManager.start(new n.animate.AnimateZoom(this,t)):(i=(this._view.scrollLeft+this._view.clientWidth/2)/this._zoom,s=(this._view.scrollTop+this._view.clientHeight/2)/this._zoom,e=this._zoom,this._zoom=t,p.setZoom(this._rootDiv,t),this.firePropertyChange("zoom",e,t),this.onZoomChanged(e,t),this.centerByLogicalPoint(i,s,!1)))},setTouchZoom:function(t){this.setZoom(t,!1)}}),n.controls.ListBase=function(t){n.controls.ListBase.superClass.constructor.apply(this,arguments),this._invalidate=!1,this._invalidateModel=!1,this._invalidateDisplay=!1,this._invalidateDatas=null,this._rowDatas=new at,this._startRowIndex=0,this._endRowIndex=0,this._renderMap={},this._dataRowMap={},this.__divPool=new n.Pool("div",20),this.__imagePool=new n.Pool("img",20),this.__canvasPool=new n.Pool("canvas",20),this.__spanPool=new n.Pool("span",20),this.__textPool=new n.Pool("span",20),this.__checkBoxPool=new n.Pool("input",20),this.__linePool=new n.Pool("canvas",20),this._pools.add(this.__divPool),this._pools.add(this.__linePool),this._pools.add(this.__imagePool),this._pools.add(this.__canvasPool),this._pools.add(this.__spanPool),this._pools.add(this.__textPool),this._pools.add(this.__checkBoxPool),this._view=p.createView("auto",!0),this._rootDiv=p.createDiv(),this._dataDiv=p.createDiv(),this._dataDiv.style.width="1px",this._view.appendChild(this._rootDiv),this._rootDiv.appendChild(this._dataDiv),this.setDataBox(t||new n.DataBox);var e=this;e.handleChange&&e._view.addEventListener("change",function(t){e.handleChange(t)},!1),u.isTouchable?u.isMSTouchable?new n.controls.ListBaseMSTouchInteraction(this):(new n.controls.ListBaseTouchInteraction(this),new n.controls.ListBaseInteraction(this)):new n.controls.ListBaseInteraction(this)},o.ext("b2.controls.ListBase",n.controls.View,{__bool:["innerText"],_innerText:Ee.LISTBASE_INNER_TEXT,getDataDiv:function(){return this._dataDiv},getStartRowIndex:function(){return this._startRowIndex},getEndRowIndex:function(){return this._endRowIndex},getRowDatas:function(){return this._rowDatas},getRowIndexByData:function(t){return this._dataRowMap[t.getId()]},getRowIndexById:function(t){return this._dataRowMap[t]},getRowSize:function(){return this._rowDatas.size()},getDataBox:function(){return this._box},setDataBox:function(t){if(!t)throw"DataBox can not be null";var e;this._box!==t&&((e=this._box)&&(e.removeDataBoxChangeListener(this.handleDataBoxChange,this),e.removeDataPropertyChangeListener(this.handlePropertyChange,this),e.removeHierarchyChangeListener(this.handleHierarchyChange,this),this._selectionModel||e.getSelectionModel().removeSelectionChangeListener(this.handleSelectionChange,this)),this._box=t,this._box.addDataBoxChangeListener(this.handleDataBoxChange,this),this._box.addDataPropertyChangeListener(this.handlePropertyChange,this),this._box.addHierarchyChangeListener(this.handleHierarchyChange,this),this._selectionModel?this._selectionModel._setDataBox(t):this._box.getSelectionModel().addSelectionChangeListener(this.handleSelectionChange,this),this.invalidateModel(),this.firePropertyChange("dataBox",e,this._box))},onPropertyChanged:function(t){"zoom"===t.property?this.invalidate():this.invalidateModel()},invalidateModel:function(){this._invalidateModel||(this._invalidateModel=!0,this._invalidateDisplay=!0,this._invalidateDatas=null,this.invalidate())},invalidateDisplay:function(){this._invalidateDisplay||(this._invalidateDisplay=!0,this._invalidateDatas=null,this.invalidate())},invalidateData:function(t){this._invalidateDisplay||(this._invalidateDatas||(this._invalidateDatas={}),this._invalidateDatas[t.getId()]=t,this.invalidate())},validateImpl:function(){var t=this._view.scrollLeft,e=this._view.scrollTop;if(this._invalidateModel&&(this._invalidateModel=!1,this.validateModel()),this._invalidateDisplay&&(this._invalidateDisplay=!1,this._renderMap={},p.release(this._dataDiv),this._dataDiv.style.height=this.getRowSize()*this._rowHeight+"px"),this._invalidateDatas){for(u in this._invalidateDatas){var i=this._renderMap[u];i&&(p.release(i),this._dataDiv.removeChild(i),delete this._renderMap[u])}this._invalidateDatas=null}var n=this._view.scrollTop/this._zoom,s=this._view.clientHeight/this._zoom;this._startRowIndex=Math.floor(n/this._rowHeight)-2,this._endRowIndex=Math.ceil((n+s)/this._rowHeight)+2,this._startRowIndex<0&&(this._startRowIndex=0),this._endRowIndex>this._rowDatas.size()&&(this._endRowIndex=this._rowDatas.size());for(var r=this._rowHeight-this._rowLineWidth-2+"px",a=this._rowLineWidth+"px",h=this._startRowIndex;h<this._endRowIndex;h++){var l,c,d=this._rowDatas.get(h),u=d.getId();(l=this._renderMap[u])||((c=(l=this.__divPool.get()).style).position="absolute",c.whiteSpace="nowrap",c.lineHeight=r,c.top=h*this._rowHeight+"px",c.borderStyle="solid",c.borderWidth="0px",c.borderBottomWidth=a,c.borderBottomColor=this._rowLineColor,c.opacity=d.getStyle?d.getStyle("whole.alpha"):1,this._dataDiv.appendChild(l),this._renderMap[u]=l,c=this.isSelected(d),this.renderData(l,d,h,c),this.onDataRendered(l,d,h,c))}this._dataDiv.style.width=this.calculateSumWidth()+"px","0px"===this._dataDiv.style.height&&(this._dataDiv.style.height="1px"),o.keys(this._renderMap).forEach(function(t){var e=this.getRowIndexById(t);(e<this._startRowIndex||e>=this._endRowIndex)&&(e=this._renderMap[t],p.release(e),this._dataDiv.removeChild(e),delete this._renderMap[t])},this),this._pools.forEach(function(t){t.clear()}),this._view.scrollLeft!==t&&(this._view.scrollLeft=t),this._view.scrollTop!==e&&(this._view.scrollTop=e),this.adjustRowSize(),this.onValidated()},adjustRowSize:function(){var t,e,i=this._rowHeight-this._rowLineWidth+"px",n=Math.floor((this._view.scrollLeft+this._view.clientWidth)/this._zoom)+"px";for(t in this._renderMap)(e=this._renderMap[t]).style.height=i,e.style.width=n},onValidated:function(){},onDataRendered:function(t,e,i,n){},calculateSumWidth:function(){return 0},_addCheckBox:function(t,e,i){var n=this.__checkBoxPool.get();return n.keepDefault=!0,n.type="checkbox",n.style.margin="0px 2px",n.style.verticalAlign="middle",n._checkData=e,n.checked=i,n.disabled=!1,t.appendChild(n),n},_addIcon:function(t,e,i,n){var s,r,a,h=o.getImageAsset(i),l=this.getInnerColor(e),c=this.getOuterColor(e),d=this.getAlarmFillColor(e);h&&h.getImage()?(s=h.getWidth(),r=h.getHeight(),(a=this.__canvasPool.get()).style.verticalAlign="middle",a.setAttribute("width",s),a.setAttribute("height",r),(h=a.getContext("2d")).clearRect(0,0,s,r),bt(h,i,l,{x:0,y:0,width:s,height:r},e,this),c&&(h.lineWidth=2,h.strokeStyle=c,h.beginPath(),h.rect(0,0,s,r),h.closePath(),h.stroke()),d&&(h.fillStyle=m.createRadialGradient(h,d,"white",1,r-9,8,8,.75,.25),h.beginPath(),h.arc(5,r-5,4,0,2*Math.PI,!0),h.closePath(),h.fill())):((a=this.__imagePool.get()).style.verticalAlign="middle",a.setAttribute("src",o.getImageSrc(i))),a.style.margin="0px 1px 0px 1px",a._selectData=n,t.appendChild(a)},_addLine:function(t,e,i,n){var s,r,a=this.__linePool.get(),h=o.getImageAsset(i),l=this.getToggleImage(e),c=this._levelMap[e.getId()],d=_=this._indent,u=_;this.isCheckable(e),this.getUncheckableStyle(),h&&(d=h.getWidth(),u=h.getHeight()),s=(c+2-1)*_+d,r=this.getRowHeight(),t.style.width=(c+2-1)*_+d+"px",t.style.height=r+u+"px";var g=this.getLineType(),_=(i=this.getLineColor(),h=this.getLineAlpha(),this.getLineThickness());d=this.getLineDash();o.getImageSrc(l),a.style.verticalAlign="top",a.style.margin="0px 0px 0px 0px",a.style.zIndex=-1,a.setAttribute("width",s),a.setAttribute("height",r);var f=a.getContext("2d");f.lineWidth=_,f.strokeStyle=i,f.globalAlpha=h,"dotted"===g&&f.setLineDash(d);var A=2*(c+2);if(n){var y=(m=e).getParent();f.clearRect(0,0,s,r),null===y&&0!==e.getChildrenSize()&&this.isExpanded(e)&&(f.moveTo((c+2+1)*s/A,r/2+u/2),f.lineTo((c+2+1)*s/A,r),f.stroke());for(var p=2*c-1;1<=p;p-=2){if(m.getClient("isLast")){if(y=(m=y).getParent(),(p+1)/2!=c)continue}else y=(m=y).getParent();p==2*c-1?(f.moveTo((p+2)*s/A,0),f.lineTo((p+2)*s/A,r/2),f.stroke(),f.moveTo((p+2)*s/A,r/2),f.lineTo((p+2+1)*s/A,r/2),f.stroke(),0!==e.getChildrenSize()&&this.isExpanded(e)&&(f.moveTo((p+2+2)*s/A,r/2+u/2),f.lineTo((p+2+2)*s/A,r),f.stroke())):(f.moveTo((p+2)*s/A,0),f.lineTo((p+2)*s/A,r),f.stroke())}}else{var m;y=(m=e).getParent();for(f.clearRect(0,0,s,r),p=2*c-1;1<=p;p-=2){if(m.getClient("isLast")){if(y=(m=y).getParent(),(p+1)/2!=c)continue}else y=(m=y).getParent();f.moveTo((p+2)*s/A,0),f.lineTo((p+2)*s/A,r),f.stroke(),p==2*c-1&&(f.moveTo((p+2)*s/A,r/2),f.lineTo((p+2+1)*s/A,r/2),f.stroke(),0!==e.getChildrenSize()&&this.isExpanded(e)&&(f.moveTo((p+2+2)*s/A,r/2+u/2),f.lineTo((p+2+2)*s/A,r),f.stroke()))}}return t.appendChild(a),a},isVisible:function(t){return!!this._box.contains(t)&&(!this._visibleFunction||this._visibleFunction(t))},handleDataBoxChange:function(t){this.invalidateModel()},handlePropertyChange:function(t){"parent"===t.property?this.invalidateModel():this.invalidateData(t.source)},handleHierarchyChange:function(t){this.invalidateModel()},handleSelectionChange:function(t){t.datas.forEach(function(t){this.invalidateData(t)},this),this.onSelectionChanged(t)},getRowIndexAt:function(t){return(t=this.getLogicalPoint(t))&&0<=(t=parseInt(t.y/this._rowHeight))&&t<this._rowDatas.size()?t:-1},getDataAt:function(t){return 0<=(t=this.getRowIndexAt(t))?this._rowDatas.get(t):null},getCurrentSortFunction:function(){return this._sortFunction},validateModel:function(){this._rowDatas.clear(),this._dataRowMap={},this._buildChildren(this._box.getRoots()),this._rowDatas=this._rowDatas.toList(this.isVisible,this);var t=this.getCurrentSortFunction();t&&this._rowDatas.sort(t);for(var e=this._rowDatas.size(),i=0;i<e;i++)this._dataRowMap[this._rowDatas.get(i).getId()]=i},_buildChildren:function(t){t.forEach(function(t){this._rowDatas.add(t),this._buildChildren(t.getChildren())},this)},_handlePressSelection:function(t,e){var i=this.getSelectionModel();if(o.isCtrlDown(e))i.contains(t)?i.removeSelection(t):i.appendSelection(t);else if(e.shiftKey&&i.getLastData()){var n=i.getLastData(),s=this.getRowIndexByData(n),r=this.getRowIndexByData(t),a=new at;for(a.add(this.getRowDatas().get(s));s!==r;)s+=s<r?1:-1,a.add(this.getRowDatas().get(s));i.setSelection(a)}else 1===i.size()&&i.contains(t)||i.setSelection(t);this.fireInteractionEvent({kind:2===e.detail?"doubleClick":"click",data:t})},_handleDoubleClick:function(t){var e=this.getDataAt(t);this.fireInteractionEvent({kind:2===t.detail?"doubleClick":"click",data:e})},_handleClick:function(t){this.isFocusOnClick()&&n.Util.setFocus(this._view);var e,i,o,s=this.getDataAt(t);s&&(this.isCheckMode()&&!t.target._checkData&&(e=this.getRowIndexByData(s),this._focusedRow!==e&&(i=this._rowDatas.get(this._focusedRow),this._focusedRow=e,i&&this.invalidateData(i),this.invalidateData(s))),this.isCheckMode()||this._handlePressSelection(s,t)),this._currentEditor&&this.commitEditValue(this._currentEditor._editInfo,this._currentEditor),this.updateCurrentEditor&&(o=this,setTimeout(function(){o.updateCurrentEditor(t)},0))},handleChange:function(t){var e,i,n;this._isCanceling||this._isValidating||((e=t.target._checkData)&&(i=this.isSelected(e),n=this.getSelectionModel(),i?n.removeSelection(e):n.appendSelection(e)),t.target._editInfo&&this.commitEditValue&&this.commitEditValue(t.target._editInfo,t.target))},scrollToData:function(t){var e,i;t&&((i=this.getRowIndexById(t.getId()))<0||(t=(e=i*this._rowHeight*this._zoom)+this._rowHeight*this._zoom,i=this._view.scrollTop,this._view.scrollTop>e&&(i=e),this._view.scrollTop+this._view.clientHeight<t&&(i=t-this._view.clientHeight),this._view.scrollTop!=i&&(this._view.scrollTop=i,this.invalidate())))},makeVisible:function(t){this.isVisible(t)&&(this.expand&&this.expand(t),o.callLater(this.scrollToData,this,[t],2*Ee.CALL_LATER_DELAY))},onSelectionChanged:function(t){this._makeVisibleOnSelected&&("append"!==t.kind&&"set"!==t.kind&&"all"!==t.kind||(this.expand&&this.getSelectionModel().getSelection().forEach(function(t){t.getParent()&&this.expand(t.getParent())},this),o.callLater(this.scrollToData,this,[this.getSelectionModel().getLastData()],2*Ee.CALL_LATER_DELAY)))},onShareSelectionModelChanged:function(){this.invalidateModel()}}),n.controls.TableBase=function(t){this._columnBox=new n.ColumnBox,this._columnBox.addDataBoxChangeListener(this.handleColumnBoxChange,this),this._columnBox.addDataPropertyChangeListener(this.handleColumnPropertyChange,this),this._columnBox.addHierarchyChangeListener(this.handleColumnHierarchyChange,this),n.controls.TableBase.superClass.constructor.apply(this,arguments),this._cellPool=new n.Pool("div",20),this._stringPool=new n.Pool("span",20),this._booleanPool=new n.Pool("input",20),this._colorPool=new n.Pool("div",20),this._pools.add(this._cellPool),this._pools.add(this._stringPool),this._pools.add(this._booleanPool),this._pools.add(this._colorPool)},o.ext("b2.controls.TableBase",n.controls.ListBase,{getColumnBox:function(){return this._columnBox},handleColumnBoxChange:function(t){this.invalidateDisplay()},handleColumnPropertyChange:function(t){t.source!==this._sortColumn||"sortDirection"!==t.property&&"sortFunction"!==t.property&&"sortable"!==t.property?this.invalidateDisplay():this.invalidateModel()},handleColumnHierarchyChange:function(t){this.invalidateDisplay()},renderData:function(t,e,i,n){for(var o=this._columnBox.getRoots(),s=o.size(),r=0,a=this._rowHeight-this._rowLineWidth+"px",h=0;h<s;h++){var l=o.get(h),c=l.getWidth();c<0&&(c=0);var d,u,g=Math.min(this._columnLineWidth,c);l.isVisible()&&((u=(d=this._cellPool.get()).style).position="absolute",u.whiteSpace="nowrap",u.verticalAlign="middle",u.textAlign=l.getHorizontalAlign(),u.overflow="hidden",u.textOverflow="ellipsis",u.left=r+"px",u.width=c-g+"px",u.height=a,u.borderStyle="solid",u.borderWidth="0px",u.borderRightWidth=g+"px",u.borderRightColor=this._columnLineColor,0===h?(u.borderLeftWidth=g+"px",u.borderLeftColor=this._columnLineColor):u.borderLeftWidth="0px",t.appendChild(d),l={data:e,value:this.getValue(e,l),div:d,view:this,column:l,rowIndex:i,selected:n},this.renderCell(l),this.onCellRendered(l),r+=c)}(u=t.style).width=r+"px",u.height=a,u.backgroundColor=this.isCheckMode()&&this._focusedRow===i||!this.isCheckMode()&&n?this.getSelectColor(e):""},adjustRowSize:function(){},onCellRendered:function(t){},calculateSumWidth:function(){for(var t=this._columnBox.getRoots(),e=t.size(),i=0,n=0;n<e;n++){var o=t.get(n).getWidth();i+=o=o<0?0:o}return i},getCurrentSortFunction:function(){var t=this._sortColumn;if(t){var e=t.getSortFunction();if(e){var i=this,n="asc"===t.getSortDirection()?1:-1;return function(o,s){var r=i.getValue(o,t),a=i.getValue(s,t);return e.call(i,r,a,o,s)*n}}}return this._sortFunction},renderCell:function(t){var e,i,n=t.column;n.renderCell?n.renderCell(t):(e=t.value,(i=n.getEnumInfo(t.rowIndex))&&!Array.isArray(i)&&(e=i.map[e]),t.view.isCellEditable(t.data,n)&&(t.enumInfo=i,t.div._editInfo=t),_t.render(n.getValueType(),e,t.div,t.view,n.isInnerText()))},getValue:function(t,e){return e.getValue(t,this)},setValue:function(t,e,i){e.setValue(t,i,this)},getColumnAt:function(t){var e=this.getLogicalPoint(t);if(!e)return null;for(var i=this._columnBox.getRoots(),n=0,o=i.size(),s=0;n<o;n++){var r=i.get(n),a=r.getWidth();if(a<0&&(a=0),e.x>s&&e.x<s+a)return r;s+=a}return null},isCellEditable:function(t,e){return this.isEditable()&&e.isEditable()},commitEditValue:function(t,e){if(!this._isCanceling){var i="checkbox"===e.type?e.checked:e.value,o=t.column;if("int"===(e=o.getValueType())&&"string"==typeof i)i=parseInt(i);else if("number"===e&&"string"==typeof i)i=parseFloat(i);else if("list.points"===e){for(var s=i.replace(/\]/g,"").replace(/\[/g,"").split(","),r=new n.List,a=0;a<s.length;a+=2)a+1>=s.length||r.add({x:parseInt(s[a]),y:parseInt(s[a+1])});i=r}this.setValue(t.data,o,i),this._currentEditor&&(o=this._currentEditor.parentNode,i=this._currentEditor,delete this._currentEditor,o&&o.removeChild(i),n.Util.setFocus(this._view)),delete this._isCommitting}},cancelEditing:function(){var t,e;this._currentEditor&&(this._isCanceling=!0,t=this._currentEditor.parentNode,e=this._currentEditor,delete this._currentEditor,t&&t.removeChild(e),n.Util.setFocus(this._view),delete this._isCanceling)},renderEditor:function(t){},onEditorRendered:function(t){},getEditorValue:function(t){var e,i=t.column.getValueType(),n=(t=t.value,"");return"list.points"===i?(e=t._as||t).forEach(function(t,i){n+=i==e.length-1?"["+t.x+","+t.y+"]":"["+t.x+","+t.y+"],"}):n=t,n},updateCurrentEditor:function(t){var e,i,o=t.target;if(o!==this._currentEditor&&o.parentNode!==this._currentEditor){for(;o&&o!==this._view&&!(e=o._editInfo);)o=o.parentNode;e&&o===e.div&&((t=this.renderEditor&&this.renderEditor(e))?(this._currentEditor=t.view,null!=e.value&&(this._currentEditor.value=this.getEditorValue(e))):e.enumInfo?this._currentEditor=p.createSelect(e.enumInfo,e.value):(this._currentEditor=l.createElement("input"),null!=e.value&&(this._currentEditor.value=this.getEditorValue(e))),e.column&&e.column.renderEditor&&(t="function"==typeof e.column.renderEditor?e.column.renderEditor(this,e):e.column.renderEditor)&&(this._currentEditor=t),this._currentEditor&&(t&&t.onKeyDown?(i=t.onKeyDown)&&Array.isArray(i)&&this._currentEditor.addEventListener("keydown",function(t){for(var e=0;e<i.length;e++)if(i[e].combKey){var n=null;switch(i[e].combKey){case"ctrlKey":n=t.ctrlKey;break;case"shiftKey":n=t.shiftKey;break;case"altKey":n=t.altKey}t.keyCode===i[e].keyCode&&n&&i[e].handlerEvent&&i[e].handlerEvent(t)}else t.keyCode===i[e].keyCode&&i[e].handlerEvent&&i[e].handlerEvent(t)}):this._currentEditor.addEventListener("keydown",function(t){var e=t.target._editInfo.view;13===t.keyCode&&t.shiftKey||(13===t.keyCode?e.commitEditValue(t.target._editInfo,t.target):27===t.keyCode&&e.cancelEditing())},!1),this._currentEditor.addEventListener("blur",function(t){var e=t.target._editInfo.view;e._isCanceling||e.commitEditValue(t.target._editInfo,t.target)},!1),this._currentEditor.keepDefault=!0,this._currentEditor._editInfo=e,this._currentEditor.parentNode||((t=this._currentEditor.style).position="absolute",t.margin="0px",t.border="0px",t.padding="0px",t.left=e.div.style.left,t.top=e.div.parentNode.style.top,t.width=e.div.style.width,t.height=e.div.style.height,this._rootDiv.appendChild(this._currentEditor)),n.Util.setFocus(this._currentEditor)))}},onColumnSorted:function(t){},getCurrentEditor:function(){return this._currentEditor}}),n.controls.List=function(t){n.controls.List.superClass.constructor.apply(this,arguments)},o.ext("b2.controls.List",n.controls.ListBase,{__accessor:["rowHeight","indent","rowLineWidth","rowLineColor","sortFunction","visibleFunction"],__bool:["makeVisibleOnSelected","keyboardRemoveEnabled","keyboardSelectEnabled"],_checkMode:!1,_rowHeight:Ee.LIST_ROW_HEIGHT,_indent:Ee.LIST_INDENT,_rowLineWidth:Ee.LIST_ROW_LINE_WIDTH,_rowLineColor:Ee.LIST_ROW_LINE_COLOR,_makeVisibleOnSelected:Ee.LIST_MAKE_VISIBLE_ON_SELECTED,_keyboardRemoveEnabled:Ee.LIST_KEYBOARD_REMOVE_ENABLED,_keyboardSelectEnabled:Ee.LIST_KEYBOARD_SELECT_ENABLED,isCheckMode:function(){return this._checkMode},setCheckMode:function(t){delete this._focusedRow;var e=this._checkMode;this._checkMode=t,this.firePropertyChange("checkMode",e,t)},isCheckable:function(t){return!0===this._checkMode},renderData:function(t,e,i,n){0<this._indent&&((r=this.__spanPool.get()).style.width=this._indent+"px",r.style.display="inline-block",t.appendChild(r)),this.isCheckable(e)&&this._addCheckBox(t,e,n);var s=this.getIcon(e);s&&this._addIcon(t,e,s);var r,a=this.getLabel(e);a&&((s=(r=this.__textPool.get()).style).whiteSpace="nowrap",s.verticalAlign="middle",s.padding="1px 2px 1px 2px",s.display="inline-block",o.setText(r,a,this._innerText),this.onLabelRendered(r,e,a,i,n),t.appendChild(r)),this.isCheckMode()?t.style.backgroundColor=this._focusedRow===i?this.getSelectColor(e):"":t.style.backgroundColor=n?this.getSelectColor(e):""},onLabelRendered:function(t,e,i,n,o){}}),n.controls.ListBaseInteraction=function(t){this.listBase=t,this.view=t._view,this.clickTimer=0,this.doubleClickInterval=300;var e=this;this.view.addEventListener("scroll",function(t){e.handleScroll(t)},!1),this.view.addEventListener("mouseup",function(t){e.handleMouseUp(t)},!1),this.view.addEventListener("keydown",function(t){e.handleKeyDown(t)},!1)},o.ext("b2.controls.ListBaseInteraction",Object,{handleMouseUp:function(t){var e=this.listBase,i=this;t.target!==e._currentEditor&&t.target.parentNode!==e._currentEditor&&(i.clickTimer?(clearTimeout(i.clickTimer),i.clickTimer=0,e._handleDoubleClick(t)):(e._handleClick(t),i.clickTimer=setTimeout(function(){clearTimeout(i.clickTimer),i.clickTimer=0},300)))},handleKeyDown:function(t){var e,i,n,s=this.listBase;s._currentEditor||(o.isCtrlDown(t)&&65==t.keyCode?(s.isKeyboardSelectEnabled()&&0<s.selectAll().size()&&s.fireInteractionEvent({kind:"selectAll"}),p.preventDefault(t)):46==t.keyCode?(s.isKeyboardRemoveEnabled()&&s.removeSelection()&&s.fireInteractionEvent({kind:"removeElement"}),p.preventDefault(t)):s.isCheckMode()||38!==t.keyCode&&40!==t.keyCode&&37!==t.keyCode&&39!==t.keyCode?o.showVersion(t):(e=s.getSelectionModel().getLastData())?38===t.keyCode||40===t.keyCode?(i=s.getRowDatas(),0<=(n=s.getRowIndexByData(e))&&(38===t.keyCode?0!==n&&(e=i.get(n-1),s.getSelectionModel().setSelection(e)):n!==i.size()-1&&(e=i.get(n+1),s.getSelectionModel().setSelection(e)))):!s.expand||37!==t.keyCode&&39!==t.keyCode||e.hasChildren()&&(37===t.keyCode?s.collapse(e):s.expand(e)):0<s.getRowDatas().size()&&(e=s.getRowDatas().get(0),s.getSelectionModel().setSelection(e)))},handleScroll:function(t){this.listBase.invalidate()}}),n.controls.ListBaseTouchInteraction=function(t){this.listBase=t,this.view=t._view,p.addEventListener("touchstart","handleTouchstart",this.view,this)},o.ext("b2.controls.ListBaseTouchInteraction",Object,{handleTouchstart:function(t){p.preventDefault(t),this.startPoint=this.lastPoint=this.listBase.getLogicalPoint(t),p.addEventListener("touchmove","handleTouchmove",this.view,this),p.addEventListener("touchend","handleTouchend",this.view,this),gt.isMultiTouch(t)&&(this.distance=gt.getDistance(t),this.zoom=this.listBase._zoom)},handleTouchmove:function(t){p.preventDefault(t);var e,i,n=this.listBase.getLogicalPoint(t);f.getDistance(this.startPoint,n)<20||(this.moved||(this.moved=!0),gt.isSingleTouch(t)?this.lastPoint&&(e=this.lastPoint.x-n.x,i=this.lastPoint.y-n.y,n=this.listBase.panByOffset(e,i),this.listBase.invalidate(),this.lastPoint.x-=e-n.x,this.lastPoint.y-=i-n.y):this.distance&&(t=gt.getDistance(t)/this.distance,this.listBase.setZoom(this.zoom*t,!1)))},handleTouchend:function(t){p.preventDefault(t),this.moved||t.target===this.listBase._currentEditor||t.target.parentNode===this.listBase._currentEditor||this.listBase._handleClick(t),delete this.startPoint,delete this.lastPoint,delete this.moved,delete this.distance,delete this.zoom,p.removeEventListener("touchmove",this.view,this),p.removeEventListener("touchend",this.view,this)}}),n.controls.ListBaseMSTouchInteraction=function(t){n.controls.ListBaseMSTouchInteraction.superClass.constructor.apply(this,arguments),this._pointerMap={},this._pointerIdArray=[],p.addEventListener("MSPointerDown","handleTouchstart",this.view,this),p.addEventListener("MSPointerMove","handleTouchmove",this.view,this),p.addEventListener("MSPointerUp","handleTouchend",this.view,this),p.addEventListener("MSPointerCancel","handleTouchend",this.view,this),this.superHandleMouseDown=n.controls.ListBaseMSTouchInteraction.superClass.handleMouseDown},o.ext("b2.controls.ListBaseMSTouchInteraction",n.controls.ListBaseInteraction,{handleMouseDown:function(t){},handleTouchstart:function(t){t.isPrimary&&0<this._pointerIdArray.length&&(this._pointerMap={},this._pointerIdArray=[]),this._pointerMap[t.pointerId]||null==this.listBase.getLogicalPoint(t)||(this._pointerIdArray.push(t.pointerId),this._pointerMap[t.pointerId]=t),1==this._pointerIdArray.length&&t.pointerType==t.MSPOINTER_TYPE_MOUSE&&this.superHandleMouseDown(t),1==this._pointerIdArray.length?(this._startTouchPoint=this.listBase.getLogicalPoint(t),this._startTouchTime=new Date):2==this._pointerIdArray.length&&(this._distance=this._getDistance(),this._zoom=this.listBase.getZoom())},handleTouchmove:function(t){var e,i;null==this._startTouchPoint||0==this._pointerIdArray.length||!this._pointerMap[t.pointerId]||f.getDistance({x:this._pointerMap[t.pointerId].pageX,y:this._pointerMap[t.pointerId].pageY},{x:t.pageX,y:t.pageY})<=10||(this._pointerMap[t.pointerId]=t,2==this._pointerIdArray.length?(e=this._getDistance()/this._distance,this.listBase.setZoom(this._zoom*e,!1)):1==this._pointerIdArray.length&&t.pointerType!=t.MSPOINTER_TYPE_MOUSE&&(!this._startTouchPoint||null!=(i=this.listBase.getLogicalPoint(t))&&(e=this._startTouchPoint.x-i.x,t=this._startTouchPoint.y-i.y,i=this.listBase.panByOffset(e,t),this.listBase.invalidate(),this._startTouchPoint.x-=e-i.x,this._startTouchPoint.y-=t-i.y)))},handleTouchend:function(t){var e;!this._startTouchPoint||1!=this._pointerIdArray.length||t.pointerType==t.MSPOINTER_TYPE_MOUSE||(e=this.listBase.getLogicalPoint(t))&&(new Date).getTime()-this._startTouchTime.getTime()<=500&&f.getDistance(this._startTouchPoint,e)<=20&&this.superHandleMouseDown(t),this._pointerMap={},this._pointerIdArray=[]},_getDistance:function(){return f.getDistance({x:this._pointerMap[this._pointerIdArray[0]].pageX,y:this._pointerMap[this._pointerIdArray[0]].pageY},{x:this._pointerMap[this._pointerIdArray[1]].pageX,y:this._pointerMap[this._pointerIdArray[1]].pageY})}}),n.controls.Tree=function(t){this._interactionDispatcher=new n.EventDispatcher,this._initTree(t),n.controls.Tree.superClass.constructor.apply(this,arguments)},o.ext("b2.controls.Tree",n.controls.ListBase,{__tree:1,__accessor:["rootData","sortFunction","visibleFunction","indent","rowHeight","rowLineWidth","rowLineColor","expandIcon","collapseIcon","uncheckableStyle","lineType","lineColor","lineThickness","lineAlpha","lineDash"],__bool:["rootVisible","makeVisibleOnSelected","keyboardRemoveEnabled","keyboardSelectEnabled"],_checkMode:!1,_indent:Ee.TREE_INDENT,_rowHeight:Ee.TREE_ROW_HEIGHT,_rowLineWidth:Ee.TREE_ROW_LINE_WIDTH,_rowLineColor:Ee.TREE_ROW_LINE_COLOR,_makeVisibleOnSelected:Ee.TREE_MAKE_VISIBLE_ON_SELECTED,_keyboardRemoveEnabled:Ee.TREE_KEYBOARD_REMOVE_ENABLED,_keyboardSelectEnabled:Ee.TREE_KEYBOARD_SELECT_ENABLED,_expandIcon:Ee.TREE_EXPAND_ICON,_collapseIcon:Ee.TREE_COLLAPSE_ICON,_uncheckableStyle:"none",_lineType:Ee.TREE_LINE_TYPE,_lineColor:Ee.TREE_LINE_COLOR,_lineThickness:Ee.TREE_LINE_THICKNESS,_lineAlpha:Ee.TREE_LINE_ALPHA,_lineDash:Ee.TREE_LINE_DASH,getCheckMode:function(){return this._checkMode},setCheckMode:function(t){delete this._focusedRow;var e=this._checkMode;this._checkMode=t,this.firePropertyChange("checkMode",e,t)},renderData:function(t,e,i,n){this._renderTree(t,e,i,n)},getToolTip:function(t){return t.getToolTip()||t.getName()}}),n.controls.Table=function(t){this._checkColumn=new n.Column,this._checkColumn.setName("check"),this._checkColumn.setEditable(!0),this._checkColumn.setWidth(40),this._checkColumn.setHorizontalAlign("center"),this._checkColumn.renderCell=this.renderCheckCell;var e=this;this._checkColumn.getValue=function(t,i){return e.isSelected(t)},n.controls.Table.superClass.constructor.apply(this,arguments)},o.ext("b2.controls.Table",n.controls.TableBase,{__accessor:["rowHeight","rowLineWidth","rowLineColor","columnLineWidth","columnLineColor","sortFunction","visibleFunction","sortColumn"],__bool:["editable","makeVisibleOnSelected","keyboardRemoveEnabled","keyboardSelectEnabled"],_editable:Ee.TABLE_EDITABLE,_rowHeight:Ee.TABLE_ROW_HEIGHT,_rowLineWidth:Ee.TABLE_ROW_LINE_WIDTH,_rowLineColor:Ee.TABLE_ROW_LINE_COLOR,_columnLineWidth:Ee.TABLE_COLUMN_LINE_WIDTH,_columnLineColor:Ee.TABLE_COLUMN_LINE_COLOR,_makeVisibleOnSelected:Ee.TABLE_MAKE_VISIBLE_ON_SELECTED,_keyboardRemoveEnabled:Ee.TABLE_KEYBOARD_REMOVE_ENABLED,_keyboardSelectEnabled:Ee.TABLE_KEYBOARD_SELECT_ENABLED,getCheckColumn:function(){return this._checkColumn},isCheckMode:function(){return this._columnBox.contains(this._checkColumn)},setCheckMode:function(t){t!==this.isCheckMode()&&(delete this._focusedRow,t?this._columnBox.add(this._checkColumn,0):this._columnBox.remove(this._checkColumn),this.firePropertyChange("checkMode",!t,t))},renderCheckCell:function(t){var e=t.view._booleanPool.get();e.disabled=!1,e.type="checkbox",e.style.margin="0px 2px",e.style.verticalAlign="middle",e.checked=t.selected;var i=t.div;i.appendChild(e),""===i.style.textAlign&&(i.style.textAlign="center"),e._checkData=t.data}}),n.controls.TableHeader=function(t){n.controls.TableHeader.superClass.constructor.apply(this,arguments),this._invalidateScroll=!1,this._invalidateDisplay=!1,this._divPool=new n.Pool("div"),this._imagePool=new n.Pool("img"),this._textPool=new n.Pool("span"),this._resizePool=new n.Pool("div"),this._pools.add(this._divPool),this._pools.add(this._imagePool),this._pools.add(this._textPool),this._pools.add(this._resizePool),this._table=t,this._tableView=t.getView(),this._columnBox=t.getColumnBox(),this._columnBox.addDataBoxChangeListener(this.handleColumnBoxChange,this),this._columnBox.addDataPropertyChangeListener(this.handleColumnPropertyChange,this),this._columnBox.addHierarchyChangeListener(this.handleColumnHierarchyChange,this);var e=this;t.getView().addEventListener("scroll",function(t){e.invalidateScroll()},!1),t.addPropertyChangeListener(function(t){e.invalidateDisplay()},this),this._view=p.createView("hidden"),this._view.tabIndex=-1,this._view.style.background=Ee.TABLEHEADER_BACKGROUND,this._rootDiv=p.createDiv(),this._view.appendChild(this._rootDiv),this.invalidateDisplay(),u.isTouchable&&new n.controls.TableHeaderTouchInteraction(this),new n.controls.TableHeaderInteraction(this)},o.ext("b2.controls.TableHeader",n.controls.ControlBase,{__accessor:["height","moveBackground","insertBackground","columnLineColor","resizeTolerance","sortDescIcon","sortAscIcon","sortIconPosition"],_height:Ee.TABLEHEADER_HEIGHT,_moveBackground:Ee.TABLEHEADER_MOVE_BACKGROUND,_insertBackground:Ee.TABLEHEADER_INSERT_BACKGROUND,_columnLineColor:Ee.TABLEHEADER_COLUMN_LINE_COLOR,_resizeTolerance:Ee.TABLEHEADER_RESIZE_TOLERANCE,_sortDescIcon:Ee.TABLEHEADER_SORT_DESC_ICON,_sortAscIcon:Ee.TABLEHEADER_SORT_ASC_ICON,_sortIconPosition:Ee.TABLEHEADER_SORT_ICON_POSITION,getRootDiv:function(){return this._rootDiv},handleColumnBoxChange:function(t){this.invalidateDisplay()},handleColumnPropertyChange:function(t){this.invalidateDisplay()},handleColumnHierarchyChange:function(t){this.invalidateDisplay()},onPropertyChanged:function(t){this.invalidateDisplay()},invalidateScroll:function(){this._invalidateScroll||(this._invalidateScroll=!0,this.invalidate())},invalidateDisplay:function(){this._invalidateDisplay||(this._invalidateDisplay=!0,this._invalidateScroll=!0,this.invalidate())},validate:function(){this._invalidate&&(this._invalidate=!1,this._invalidateDisplay&&(this._invalidateDisplay=!1,this.validateDisplay()),this._invalidateScroll&&(this._invalidateScroll=!1,this._rootDiv.style.left=-this._tableView.scrollLeft+"px"))},validateDisplay:function(){p.release(this._rootDiv);for(var t=this._table.getZoom(),e=this.getHeight()+"px",i=this.getHeight()-2+"px",n=this._table.getColumnBox().getRoots(),o=n.size(),s=0,r=this._table._columnLineWidth*t,a=0;a<o;a++){var h,l,c,d,u=n.get(a);u.isVisible()&&((h=u.getWidth()*t)<0&&(h=0),l=Math.min(r,h),(c=this._divPool.get())._column=u,(d=c.style).position="absolute",d.whiteSpace="nowrap",d.lineHeight=i,d.overflow="hidden",d.textOverflow="ellipsis",d.backgroundPosition=this._sortIconPosition||"",d.backgroundRepeat="no-repeat",d.backgroundImage="",d.textAlign=u.getHorizontalAlign(),d.borderStyle="solid",d.borderWidth="0px",d.borderRightWidth=l+"px",d.borderRightColor=this._columnLineColor,0===a?(d.borderLeftWidth=l+"px",d.borderLeftColor=this._columnLineColor):d.borderLeftWidth="0px",d.left=s+"px",d.width=h-l+"px",d.height=e,c._x=s,c._width=h-l,this._rootDiv.insertBefore(c,this._rootDiv.firstChild),this.renderColumn(c,u),this.onColumnRendered(c,u),s+=h,u.isResizable()&&((c=this._resizePool.get())._resizeColumn=u,(d=c.style).position="absolute",d.backgroundColor="white",d.opacity=0,d.left=s-l-this._resizeTolerance+"px",d.width=l+2*this._resizeTolerance+"px",d.height=e,this._rootDiv.appendChild(c)))}this._pools.forEach(function(t){t.clear()}),this._rootDiv.style.width=s+"px",this._rootDiv.style.height=e},renderColumn:function(t,e){var i,n;e.renderHeader?e.renderHeader(t):((i=this._textPool.get()).style.whiteSpace="nowrap",i.style.verticalAlign="middle",i.style.padding="1px 2px 1px 2px",i.innerHTML=e.getName()?e.getName():e.getPropertyName(),i.setAttribute("title",i.innerHTML),t.appendChild(i),u.isOpera&&((n=t.cloneNode(!1)).style.left="0px",n.style.top="0px",n.style.opacity=0,t.appendChild(n))),this._table.getSortColumn()===e&&e.isSortable()&&(n="asc"===e.getSortDirection()?this._sortAscIcon:this._sortDescIcon,e=o.getImageSrc(n),this._sortIconPosition&&""!==this._sortIconPosition?t.style.backgroundImage="url("+e+")":((n=this._imagePool.get()).setAttribute("src",e),n.style.verticalAlign="middle",t.appendChild(n)))},onColumnRendered:function(t,e){}}),n.controls.TableHeaderInteraction=function(t){this.header=t,this.table=t._table,this.view=t._view;var e=this;this.view.addEventListener("mousedown",function(t){e.handleMouseDown(t)},!1),this.view.addEventListener("mousemove",function(t){e.handleMouseMove(t)},!1)},o.ext("b2.controls.TableHeaderInteraction",Object,{handleMouseDown:function(t){0===t.button&&(this.movableDiv?this.handleMouseUp(t):(this.resizeColumn=t.target._resizeColumn,this.resizeColumn||(this.movableDiv=this.getMovableDivAt(t)),this.changeCursor(t),this._startClient=p.getClientPoint(t),this.lastX=this.getX(t),this._startLogicalX=this.lastX,p.handle_mousedown(this,t)))},changeCursor:function(t){var e="";t.target._resizeColumn?e="ew-resize":(t=this.getColumnAt(t))&&(t.isMovable()||t.isSortable())&&(e="pointer"),this.view.style.cursor=e},handleMouseMove:function(t){if(null!=this.lastX){if(p.target===this){var e=this._startLogicalX+t.clientX-this._startClient.x;if(this.resizeColumn){if(null!=this.stopX){if(e<this.stopX)return;delete this.stopX}var i=this.resizeColumn.getWidth()+(e-this.lastX)/this.table.getZoom();i<10&&(i=10,this.stopX=e),this.resizeColumn.setWidth(i),this.lastX=e}else if(this.movableDiv){if(i=e-this.lastX,!this.cloneDiv){if(Math.abs(i)<3)return;this.cloneDiv=this.movableDiv.cloneNode(!0),this.cloneDiv._x=this.movableDiv._x,this.cloneDiv.style.background=this.header.getMoveBackground(),this.insertDiv=p.createDiv(),this.insertDiv.style.width="1px",this.insertDiv.style.height=this.cloneDiv.style.height,this.insertDiv.style.background=this.header.getInsertBackground(),this.movableDiv.parentNode.appendChild(this.cloneDiv),this.movableDiv.parentNode.appendChild(this.insertDiv)}i=this.cloneDiv._x+i,this.cloneDiv.style.left=i+"px",this.cloneDiv._x=i,this.lastX=e,this.columnInfo=this.getColumnInfoAt(t),this.columnInfo&&(this.insertDiv.style.left=this.columnInfo.position)}}}else this.changeCursor(t)},handleMouseUp:function(t){var e,i;0===t.button&&(this.resizeColumn||(this.movableDiv&&this.columnInfo?(e=this.movableDiv._column,i=this.columnInfo.index,this.table.getColumnBox().moveTo(e,i)):(e=this.getColumnAt(t))&&e.isSortable()&&(t=e.getSortDirection(),this.table.getSortColumn()===e?("desc"===t&&this.table.setSortColumn(null),e.setSortDirection("asc"===t?"desc":"asc")):this.table.setSortColumn(e),this.table.onColumnSorted(this.table.getSortColumn()))),this.clear())},clear:function(){this.view.style.cursor="",this.cloneDiv&&this.movableDiv&&this.movableDiv.parentNode.removeChild(this.cloneDiv),this.insertDiv&&this.movableDiv&&this.movableDiv.parentNode.removeChild(this.insertDiv),delete this.movableDiv,delete this.columnInfo,delete this.insertDiv,delete this.cloneDiv,delete this.resizeColumn,delete this.stopX,delete this.lastX,delete this._startClient,delete this._startLogicalX},getColumnAt:function(t){var e;for(t=t.target;t&&t!==this.view&&!(e=t._column);)t=t.parentNode;return e},getMovableDivAt:function(t){var e;for(t=t.target;t&&t!==this.view&&!(e=t._column);)t=t.parentNode;return e&&e.isMovable()?t:null},getX:function(t){return(t=p.getLogicalPoint(this.view,t))?t.x:null},getColumnInfoAt:function(t){for(var e=this._startLogicalX+t.clientX-this._startClient.x+this.table.getView().scrollLeft,i=this.table.getColumnBox().getRoots(),n=i.size(),o=this.table.getZoom(),s=0,r=!1,a=0;a<n;a++){var h=i.get(a);if(h===this.movableDiv._column&&(r=!0),h.isVisible()){var l=h.getWidth()*o;if(!(l<=0)){if(s<=e&&e<=s+l){var c=e<s+l/2;!r||h===this.movableDiv._column&&c||a--;var d=c?s:s+l;return{index:c?Math.max(0,a):Math.min(a+1,n),column:h,position:(d=Math.max(0,d-1))+"px"}}s+=l}}}return this.columnInfo}}),n.controls.TableHeaderTouchInteraction=function(t){this.header=t,this.table=t._table,this.view=t._view,p.addEventListener("touchstart","handleTouchstart",this.view,this)},o.ext("b2.controls.TableHeaderTouchInteraction",Object,{handleTouchstart:function(t){p.preventDefault(t),this.movableDiv?this.handleTouchend(t):(this.resizeColumn=t.target._resizeColumn,this.resizeColumn||(this.movableDiv=this.getMovableDivAt(t)),this.lastX=this.getX(t),p.addEventListener("touchmove","handleTouchmove",this.view,this),p.addEventListener("touchend","handleTouchend",this.view,this))},handleTouchmove:function(t){if(p.preventDefault(t),null!=this.lastX)if(this.resizeColumn){if(e=this.getX(t),null!=this.stopX){if(e<this.stopX)return;delete this.stopX}(i=this.resizeColumn.getWidth()+(e-this.lastX)/this.table.getZoom())<0&&(i=0,this.stopX=e),this.resizeColumn.setWidth(i),this.lastX=e}else if(this.movableDiv){var e,i=(e=this.getX(t))-this.lastX;if(!this.cloneDiv){if(Math.abs(i)<3)return;this.cloneDiv=this.movableDiv.cloneNode(!0),this.cloneDiv._x=this.movableDiv._x,this.cloneDiv.style.background=this.header.getMoveBackground(),this.insertDiv=p.createDiv(),this.insertDiv.style.width="1px",this.insertDiv.style.height=this.cloneDiv.style.height,this.insertDiv.style.background=this.header.getInsertBackground(),this.movableDiv.parentNode.appendChild(this.cloneDiv),this.movableDiv.parentNode.appendChild(this.insertDiv)}i=this.cloneDiv._x+i,this.cloneDiv.style.left=i+"px",this.cloneDiv._x=i,this.lastX=e,this.columnInfo=this.getColumnInfoAt(t),this.columnInfo&&(this.insertDiv.style.left=this.columnInfo.position)}},handleTouchend:function(t){var e,i;p.preventDefault(t),this.resizeColumn||(this.movableDiv&&this.columnInfo?(e=this.movableDiv._column,i=this.columnInfo.index,this.table.getColumnBox().moveTo(e,i)):(e=this.getColumnAt(t))&&e.isSortable()&&(t=e.getSortDirection(),this.table.getSortColumn()===e?("desc"===t&&this.table.setSortColumn(null),e.setSortDirection("asc"===t?"desc":"asc")):this.table.setSortColumn(e))),this.clear(),p.removeEventListener("touchmove",this.view,this),p.removeEventListener("touchend",this.view,this)},clear:function(){this.cloneDiv&&this.movableDiv&&this.movableDiv.parentNode.removeChild(this.cloneDiv),this.insertDiv&&this.movableDiv&&this.movableDiv.parentNode.removeChild(this.insertDiv),delete this.movableDiv,delete this.columnInfo,delete this.insertDiv,delete this.cloneDiv,delete this.resizeColumn,delete this.stopX,delete this.lastX},getColumnAt:function(t){var e;for(t=t.target;t&&t!==this.view&&!(e=t._column);)t=t.parentNode;return e},getMovableDivAt:function(t){var e;for(t=t.target;t&&t!==this.view&&!(e=t._column);)t=t.parentNode;return e&&e.isMovable()?t:null},getX:function(t){return(t=p.getLogicalPoint(this.view,t))?t.x:null},getColumnInfoAt:function(t){for(var e=this.getX(t)+this.table.getView().scrollLeft,i=this.table.getColumnBox().getRoots(),n=i.size(),o=this.table.getZoom(),s=0,r=!1,a=0;a<n;a++){var h=i.get(a);if(h===this.movableDiv._column&&(r=!0),h.isVisible()){var l=h.getWidth()*o;if(!(l<=0)){if(s<=e&&e<=s+l){var c=e<s+l/2;!r||h===this.movableDiv._column&&c||a--;var d=c?s:s+l;return{index:c?Math.max(0,a):Math.min(a+1,n),column:h,position:(d=Math.max(0,d-1))+"px"}}s+=l}}}return this.columnInfo}}),n.controls.TablePane=function(t,e){n.controls.TablePane.superClass.constructor.apply(this,arguments),this.invalidate(),this._table=t,this._tableHeader=e||new n.controls.TableHeader(t),this._view=p.createView("hidden",!0),this._view.tabIndex=-1,this._view.appendChild(this._tableHeader.getView()),this._view.appendChild(this._table.getView());var i=this;this._tableHeader.addPropertyChangeListener(function(t){"height"===t.property&&i.invalidate()})},o.ext("b2.controls.TablePane",n.controls.ControlBase,{onPropertyChanged:function(t){this.invalidate()},getTable:function(){return this._table},getTableHeader:function(){return this._tableHeader},validateImpl:function(){var t=this._view.offsetWidth,e=this._view.offsetHeight,i=this._tableHeader.getHeight();this._tableHeader.adjustBounds({x:0,y:0,width:t,height:i}),this._table.adjustBounds({x:0,y:i,width:t,height:Math.max(0,e-i)})}}),n.controls.TreeTable=function(t){this._treeColumn=new n.Column,this._treeColumn.setName("tree"),this._treeColumn.setWidth(120),this._treeColumn.renderCell=this.renderTreeCell,this._treeColumn.getValue=this.getTreeValue,this._treeColumn.setValue=this.setTreeValue,this._initTree(t),n.controls.TreeTable.superClass.constructor.apply(this,arguments),this._columnBox.add(this._treeColumn)},o.ext("b2.controls.TreeTable",n.controls.TableBase,{__tree:1,__accessor:["sortFunction","visibleFunction","checkMode","rootData","sortColumn","indent","rowHeight","rowLineWidth","rowLineColor","columnLineWidth","columnLineColor","expandIcon","collapseIcon","uncheckableStyle","lineType","lineColor","lineThickness","lineAlpha","lineDash"],__bool:["editable","rootVisible","makeVisibleOnSelected","keyboardRemoveEnabled","keyboardSelectEnabled"],_editable:Ee.TREETABLE_EDITABLE,_indent:Ee.TREETABLE_INDENT,_rowHeight:Ee.TREETABLE_ROW_HEIGHT,_rowLineWidth:Ee.TREETABLE_ROW_LINE_WIDTH,_rowLineColor:Ee.TREETABLE_ROW_LINE_COLOR,_columnLineWidth:Ee.TREETABLE_COLUMN_LINE_WIDTH,_columnLineColor:Ee.TREETABLE_COLUMN_LINE_COLOR,_makeVisibleOnSelected:Ee.TREETABLE_MAKE_VISIBLE_ON_SELECTED,_keyboardRemoveEnabled:Ee.TREETABLE_KEYBOARD_REMOVE_ENABLED,_keyboardSelectEnabled:Ee.TREETABLE_KEYBOARD_SELECT_ENABLED,_expandIcon:Ee.TREETABLE_EXPAND_ICON,_collapseIcon:Ee.TREETABLE_COLLAPSE_ICON,_lineType:Ee.TREE_LINE_TYPE,_lineColor:Ee.TREE_LINE_COLOR,_lineThickness:Ee.TREE_LINE_THICKNESS,_lineAlpha:Ee.TREE_LINE_ALPHA,_lineDash:Ee.TREE_LINE_DASH,getTreeColumn:function(){return this._treeColumn},renderTreeCell:function(t){t.view._renderTree(t.div,t.data,t.rowIndex,t.selected)},getTreeValue:function(t,e){return e.getLabel(t)},setTreeValue:function(t,e,i){t.setName(e)}}),n.controls.PropertySheet=function(t){n.controls.PropertySheet.superClass.constructor.apply(this,arguments),this._currentRowIndex=-1,this._currentEditor=null,this._currentData=null,this._invalidate=!1,this._resizeDiv=p.createDiv(),this._resizeDiv.style.backgroundColor="white",this._resizeDiv.style.opacity=0,this._resizeDiv.style.top="0px",this._categoryList=new at,this._categoryMap={},this._rowList=new at,this._propertyBox=new n.PropertyBox,this._propertyBox.addDataBoxChangeListener(this.invalidatePropertyBox,this),this._propertyBox.addDataPropertyChangeListener(this.invalidatePropertyBox,this),this._propertyBox.addHierarchyChangeListener(this.invalidatePropertyBox,this),this.__divPool=new n.Pool("div",2),this.__cellPool=new n.Pool("div",2),this.__imagePool=new n.Pool("img",2),this.__textPool=new n.Pool("span",2),this._stringPool=new n.Pool("span",2),this._booleanPool=new n.Pool("input",2),this._colorPool=new n.Pool("div",2),this._pools.add(this.__divPool),this._pools.add(this.__cellPool),this._pools.add(this.__imagePool),this._pools.add(this.__textPool),this._pools.add(this._stringPool),this._pools.add(this._booleanPool),this._pools.add(this._colorPool),this._view=p.createView("auto"),this._rootDiv=p.createDiv(),this._dataDiv=p.createDiv(),this._view.appendChild(this._rootDiv),this._rootDiv.appendChild(this._dataDiv),this.setDataBox(t||new n.DataBox);var e=this;this._view.addEventListener("change",function(t){e.handleChange(t)},!1),u.isTouchable?u.isMSTouchable?new n.controls.PropertySheetMSTouchInteraction(this):(new n.controls.PropertySheetTouchInteraction(this),new n.controls.PropertySheetInteraction(this)):new n.controls.PropertySheetInteraction(this)},o.ext("b2.controls.PropertySheet",n.controls.View,{__accessor:["indent","rowHeight","sumWidth","propertyNameWidth","propertyNameHorizontalAlign","autoAdjustable","rowLineWidth","columnLineWidth","borderColor","categorizable","resizeTolerance","editable","selectColor","expandIcon","collapseIcon","sortFunction","visibleFunction"],_autoAdjustable:Ee.PROPERTYSHEET_AUTO_ADJUSTABLE,_selectColor:Ee.SELECT_COLOR,_categorizable:Ee.PROPERTYSHEET_CATEGORIZABLE,_editable:Ee.PROPERTYSHEET_EDITABLE,_propertyNameWidth:Ee.PROPERTYSHEET_PROPERTY_NAME_WIDTH,_propertyNameHorizontalAlign:Ee.PROPERTYSHEET_PROPERTY_NAME_HORIZONTAL_ALIGN,_sumWidth:Ee.PROPERTYSHEET_SUM_WIDTH,_indent:Ee.PROPERTYSHEET_INDENT,_rowHeight:Ee.PROPERTYSHEET_ROW_HEIGHT,_rowLineWidth:Ee.PROPERTYSHEET_ROW_LINE_WIDTH,_columnLineWidth:Ee.PROPERTYSHEET_COLUMN_LINE_WIDTH,_borderColor:Ee.PROPERTYSHEET_BORDER_COLOR,_expandIcon:Ee.PROPERTYSHEET_EXPAND_ICON,_collapseIcon:Ee.PROPERTYSHEET_COLLAPSE_ICON,_resizeTolerance:Ee.PROPERTYSHEET_RESIZE_TOLERANCE,getPropertyBox:function(){return this._propertyBox},getCurrentData:function(){return this._currentData},getDataDiv:function(){return this._dataDiv},getDataBox:function(){return this._box},setDataBox:function(t){if(!t)throw"DataBox can not be null";var e;this._box!==t&&((e=this._box)&&(e.removeDataPropertyChangeListener(this.handlePropertyChange,this),this._selectionModel||e.getSelectionModel().removeSelectionChangeListener(this.handleSelectionChange,this)),this._box=t,this._box.addDataPropertyChangeListener(this.handlePropertyChange,this),this._selectionModel?this._selectionModel._setDataBox(t):this._box.getSelectionModel().addSelectionChangeListener(this.handleSelectionChange,this),this.invalidate(),this.firePropertyChange("dataBox",e,this._box))},invalidatePropertyBox:function(){this._isValidating||this.invalidate()},onPropertyChanged:function(t){"zoom"!==t.property&&this.invalidate()},isVisible:function(t){return!(t.isVisible&&!t.isVisible(this._currentData,this))&&(!this._visibleFunction||this._visibleFunction(t))},handlePropertyChange:function(t){this._currentData===t.source&&this.invalidate()},handleSelectionChange:function(t){this._currentData!==this.getSelectionModel().getLastData()&&(this._currentRowIndex=-1,this.invalidate())},isExpanded:function(t){return!t||((t=this._categoryMap[t])?t.isExpanded:Ee.PROPERTYSHEET_EXPAND_CATEGORY)},expand:function(t){!t||(t=this._categoryMap[t])&&!t.isExpanded&&(t.isExpanded=!0,this.invalidate())},expandAll:function(){for(var t in this._categoryMap)(t=this._categoryMap[t])&&(t.isExpanded=!0);this.invalidate()},collapse:function(t){!t||(t=this._categoryMap[t])&&t.isExpanded&&(t.isExpanded=!1,this.invalidate())},collapseAll:function(){for(var t in this._categoryMap)(t=this._categoryMap[t])&&(t.isExpanded=!1);this.invalidate()},getCategoryName:function(t){return this.isCategorizable()&&(t=t.getCategoryName())||"null"},validateModel:function(){this._rowList.clear(),this._categoryList.clear();for(var t,e,i,n={},o=new at,s=this._currentData?this._propertyBox.getRoots():new at,r=s.size(),a=0;a<r;a++)i=s.get(a),this.isVisible(i)&&(o.add(i),n[e=this.getCategoryName(i)]||(this._categoryList.add(e),n[e]={isExpanded:this.isExpanded(e),properties:new at}));for(this._sortFunction&&o.sort(this._sortFunction),this._categoryMap=n,r=o.size(),a=0;a<this._categoryList.size();a++){"null"!==(e=this._categoryList.get(a))&&this._rowList.add(e);var h=n[e];if(h.isExpanded)for(t=0;t<r;t++)i=o.get(t),this.getCategoryName(i)===e&&(h.properties.add(i),this._rowList.add({view:this,data:this._currentData,property:i,value:this._currentData?this.getValue(this._currentData,i):null}))}},adjustWidth:function(){var t=this._view.offsetWidth,e=this._view.offsetHeight;t<=this._indent||e<=0||(t-=this._indent,this._rowList.size()*this._rowHeight>e&&(t-=Ee.SCROLL_BAR_WIDTH)<=0||(0===this._sumWidth||this._propertyNameWidth>this._sumWidth?this._propertyNameWidth=t/2:this._propertyNameWidth=t*(this._propertyNameWidth/this._sumWidth),this._sumWidth=t,this._view.style.overflowX="hidden",this._view.style.overflowY="auto"))},validateDisplay:function(){var t=this._rowList.size(),e=this._borderColor,i=this._indent,n=this._rowHeight,s=this._propertyNameWidth,r=Math.max(0,this._sumWidth-s),a=this._rowLineWidth,h=this._columnLineWidth,l=n-a+"px",c=n-a-2+"px",d=i+"px",u=s-h+"px",g=r-h+"px",_=s+r+"px",f=a+"px",A=h+"px",y=s+"px",p=this._dataDiv;(E=p.style).height=t*n+"px",E.width=i+s+r+"px";var m=this.__divPool.get();(E=m.style).position="absolute",E.left="0px",E.top="0px",E.width=d,E.height=p.style.height,E.borderWidth="0px",E.backgroundColor=e,p.appendChild(m);for(var v=0;v<t;v++){var x,w,E,C=this._rowList.get(v),T=v*n+"px",b=this.__divPool.get();(E=(C.rowDiv=b).style).position="absolute",E.whiteSpace="nowrap",E.overflow="hidden",E.textOverflow="ellipsis",E.left=d,E.top=T,E.width=_,E.height=l,E.lineHeight=c,E.borderStyle="solid",E.borderWidth="0px",E.borderBottomWidth=f,E.borderBottomColor=e,p.appendChild(b),"string"==typeof C?(E.backgroundColor=e,(E=(m=this.__divPool.get()).style).position="absolute",E.left="0px",E.top=T,E.width=d,E.height=l,E.lineHeight=c,E.borderWidth="0px",p.appendChild(m),w=this.__imagePool.get(),x=this.isExpanded(C)?this._expandIcon:this._collapseIcon,w.setAttribute("src",o.getImageSrc(x)),(E=w.style).verticalAlign="middle",w._expandData=C,m.appendChild(w),this.renderCategory(b,C),this.onCategoryRendered(b,C)):(x=C.property,w=this.__cellPool.get(),E=(C.nameRender=w).style,this._currentRowIndex===v&&(E.backgroundColor=this.getSelectColor()),E.position="absolute",E.verticalAlign="middle",E.textAlign=this._propertyNameHorizontalAlign,E.overflow="hidden",E.textOverflow="ellipsis",E.whiteSpace="nowrap",E.left="0px",E.top="0px",E.width=u,E.height=l,E.borderStyle="solid",E.borderWidth="0px",E.borderRightWidth=A,E.borderRightColor=e,b.appendChild(w),this.renderName(C),this.onNameRendered(C),w=this.__cellPool.get(),(E=(C.valueRender=w).style).position="absolute",E.verticalAlign="middle",E.textAlign=x.getHorizontalAlign(),E.whiteSpace="nowrap",E.overflow="hidden",E.textOverflow="ellipsis",E.left=y,E.top="0px",E.width=g,E.height=l,E.borderStyle="solid",E.borderWidth="0px",E.borderRightWidth=A,E.borderRightColor=e,b.appendChild(w),this.renderValue(C),this.onValueRendered(C))}(E=this._resizeDiv.style).left=i+s-h-this._resizeTolerance+"px",E.width=h+2*this._resizeTolerance+"px",E.height=p.style.height,p.appendChild(this._resizeDiv)},renderCategory:function(t,e){var i=this.__textPool.get(),n=i.style;n.fontWeight="bold",n.whiteSpace="nowrap",n.overflow="hidden",n.textOverflow="ellipsis",n.verticalAlign="middle",n.padding="1px 2px 1px 2px",i.innerHTML=e,i.setAttribute("title",e),t.appendChild(i)},onCategoryRendered:function(t,e){},renderName:function(t){var e,i;t.property.renderName?t.property.renderName(t):((i=(e=this.__textPool.get()).style).fontWeight="",i.whiteSpace="nowrap",i.verticalAlign="middle",i.padding="1px 2px 1px 2px",i=(i=t.property.getName())||t.property.getPropertyName(),e.innerHTML=i,e.setAttribute("title",i),t.nameRender.appendChild(e))},onNameRendered:function(t){},renderValue:function(t){var e,i,n=t.property;n.renderValue?n.renderValue(t):(e=t.value,(i=n.getEnumInfo(this._currentData))&&!Array.isArray(i)&&(e=i.map[e]),t.view.isCellEditable(t.data,n)&&(t.enumInfo=i,t.valueRender._editInfo=t),t.valueRender.innerHTML="",_t.render(n.getValueType(),e,t.valueRender,t.view,n.isInnerText()))},onValueRendered:function(t){},renderEditor:function(t){},onEditorRendered:function(t){},updateCurrentData:function(){this._currentData=this.getSelectionModel().getLastData()},validateImpl:function(){var t=this._view.scrollLeft,e=this._view.scrollTop;p.release(this._dataDiv),this.updateCurrentData(),this.validateModel(),this.isAutoAdjustable()&&this.adjustWidth(),this.validateDisplay(),this._pools.forEach(function(t){t.clear()}),this._view.scrollLeft!==t&&(this._view.scrollLeft=t),this._view.scrollTop!==e&&(this._view.scrollTop=e)},getValue:function(t,e){return t?e.getValue(t,this):null},setValue:function(t,e,i){t&&e.setValue(t,i,this)},isCellEditable:function(t,e){return!!t&&this.isEditable()&&e.isEditable()},getRowIndexAt:function(t){return(t=this.getLogicalPoint(t))&&0<=(t=parseInt(t.y/this._rowHeight))&&t<this._rowList.size()?t:-1},handleChange:function(t){this._isCommitting||this._isCanceling||this._isValidating||t.target._editInfo&&this.commitEditValue&&this.commitEditValue(t.target._editInfo,t.target)},commitEditValue:function(t,e){s="checkbox"===e.type?e.checked:e.value;var i=t.property,o=i.getValueType();if("int"===o&&"string"==typeof s)s=parseInt(s);else if("number"===o&&"string"==typeof s)s=parseFloat(s);else if("array.string"===o)s=s.split(",");else if("array.number"===o)for(var s,r=0,a=(s=s.split(",")).length;r<a;r++)s[r]=parseFloat(s[r]);else if("list.points"===o){var h=s.replace(/\]/g,"").replace(/\[/g,"").split(","),l=new n.List;for(r=0;r<h.length;r+=2)r+1>=h.length||l.add({x:parseInt(h[r]),y:parseInt(h[r+1])});s=l}e._rowInfo&&(e._rowInfo.value=s,this.renderValue(e._rowInfo)),this.setValue(t.data,i,s),n.Util.setFocus(this._view),this._currentEditor&&((i=this._currentEditor.parentNode)&&i.removeChild(this._currentEditor),delete this._currentEditor),delete this._isCommitting},cancelEditing:function(){var t;this._currentEditor&&((t=this._currentEditor.parentNode)&&t.removeChild(this._currentEditor),delete this._currentEditor,delete this._isCanceling)},getEditorValue:function(t){var e,i=t.valueRender._editInfo.property.getValueType(),n=(t=t.valueRender._editInfo.value,"");return"list.points"===i?(e=t._as||t).forEach(function(t,i){n+=i==e.length-1?"["+t.x+","+t.y+"]":"["+t.x+","+t.y+"],"}):n=t,n},updateCurrentRowIndex:function(t){var e,i,o=this._rowList.size(),s=this._currentRowIndex;(t=t<0||o<=t?-1:t)!==s&&(0<=s&&s<o&&(i=this._rowList.get(s)).nameRender&&(i.nameRender.style.backgroundColor=""),this._currentRowIndex=t),0<=t&&(i=this._rowList.get(t)).nameRender&&(i.nameRender.style.backgroundColor=this.getSelectColor(),this._currentEditor||i.valueRender&&i.valueRender._editInfo&&(s=i.valueRender._editInfo,(t=this.renderEditor&&this.renderEditor(i))?(this._currentEditor=t.view,null!=s.value&&(this._currentEditor.value=this.getEditorValue(i))):s.enumInfo?this._currentEditor=p.createSelect(s.enumInfo,s.value):(this._currentEditor=l.createElement("input"),null!=s.value&&(this._currentEditor.value=this.getEditorValue(i))),i.property&&i.property.renderEditor&&(t="function"==typeof i.property.renderEditor?i.property.renderEditor(this,i):i.property.renderEditor)&&(this._currentEditor=t),this._currentEditor&&(t&&t.onKeyDown?(e=t.onKeyDown)&&Array.isArray(e)&&this._currentEditor.addEventListener("keydown",function(t){for(var i=0;i<e.length;i++)if(e[i].combKey){var n=null;switch(e[i].combKey){case"ctrlKey":n=t.ctrlKey;break;case"shiftKey":n=t.shiftKey;break;case"altKey":n=t.altKey}t.keyCode===e[i].keyCode&&n&&e[i].handlerEvent&&e[i].handlerEvent(t)}else t.keyCode===e[i].keyCode&&e[i].handlerEvent&&e[i].handlerEvent(t)}):this._currentEditor.addEventListener("keydown",function(t){var e=t.target._editInfo.view;13===t.keyCode&&t.shiftKey||(13===t.keyCode?e._isCommitting||(e._isCommitting=!0,e.commitEditValue(t.target._editInfo,t.target)):27===t.keyCode&&(e._isCanceling=!0,e.cancelEditing()))},!1),this._currentEditor.addEventListener("blur",function(t){var e=t.target._editInfo.view;e._isCommitting||e._isCanceling||(e._isCommitting=!0,e.commitEditValue(t.target._editInfo,t.target))},!1),this._currentEditor.keepDefault=!0,this._currentEditor._rowInfo=i,this._currentEditor._editInfo=s,this._currentEditor.parentNode||((s=this._currentEditor.style).position="absolute",s.margin="0px",s.border="0px",s.padding="0px",s.left=this._indent+this._propertyNameWidth+"px",s.top=i.rowDiv.style.top,s.width=i.valueRender.style.width,s.height=i.valueRender.style.height,this._rootDiv.appendChild(this._currentEditor)),n.Util.setFocus(this._currentEditor),this.onEditorRendered&&this.onEditorRendered(i))))}}),n.controls.PropertySheetInteraction=function(t){this.sheet=t,this.view=t._view,this.resizeDiv=t._resizeDiv;var e=this;this.view.addEventListener("mousedown",function(t){0===t.button&&e.handleMouseDown(t)},!1),this.view.addEventListener("mousemove",function(t){e.handleMouseMove(t)},!1)},o.ext("b2.controls.PropertySheetInteraction",Object,{minGap:10,handleMouseDown:function(t){var e;t.target!==this.sheet._currentEditor&&t.target.parentNode!==this.sheet._currentEditor&&(this.sheet.isFocusOnClick()&&n.Util.setFocus(this.view),this.sheet._isValidating||(t.target._expandData?(e=t.target._expandData,this.sheet.isExpanded(e)?this.sheet.collapse(e):this.sheet.expand(e)):t.target===this.resizeDiv?(this.lastX=this.getX(t),p.handle_mousedown(this,t)):(this.sheet._currentEditor&&!this.sheet._isCommitting&&(this.sheet._isCommitting=!0,this.sheet.commitEditValue(this.sheet._currentEditor._editInfo,this.sheet._currentEditor)),t=this.sheet.getRowIndexAt(t),this.sheet.updateCurrentRowIndex(t))))},handleMouseMove:function(t){if(null!=this.lastX||p.target){if(p.target===this&&null!=this.lastX){var e=this.getX(t);if(null!=this.stopLeft){if(e<this.stopLeft)return;delete this.stopLeft}if(null!=this.stopRight){if(e>this.stopRight)return;delete this.stopRight}var i=this.sheet.getPropertyNameWidth()+(e-this.lastX);i<this.minGap?(i=this.minGap,this.stopLeft=e):i>this.sheet.getSumWidth()-this.minGap&&(i=this.sheet.getSumWidth()-this.minGap,this.stopRight=e),this.sheet.setPropertyNameWidth(i),this.lastX=e}}else this.changeCursor(t)},handleMouseUp:function(t){0===t.button&&(this.view.style.cursor="default",delete this.stopLeft,delete this.stopRight,delete this.lastX)},changeCursor:function(t){this.view.style.cursor=t.target===this.resizeDiv?"ew-resize":"default"},getX:function(t){return t.clientX/this.sheet.getZoom()}}),n.controls.PropertySheetTouchInteraction=function(t){this.sheet=t,this.view=t._view,this.resizeDiv=t._resizeDiv,p.addEventListener("touchstart","handleTouchstart",this.view,this)},o.ext("b2.controls.PropertySheetTouchInteraction",Object,{minGap:10,handleTouchstart:function(t){p.preventDefault(t),t.target!==this.sheet._currentEditor&&t.target.parentNode!==this.sheet._currentEditor&&(this.sheet.isFocusOnClick()&&n.Util.setFocus(this.view),this.sheet._isValidating||(t.target===this.resizeDiv&&(this.lastX=this.getX(t)),this.lastPoint=this.sheet.getLogicalPoint(t),gt.isMultiTouch(t)&&(this.distance=gt.getDistance(t),this.zoom=this.sheet.getZoom()),p.addEventListener("touchmove","handleTouchmove",this.view,this),p.addEventListener("touchend","handleTouchend",this.view,this)))},handleTouchmove:function(t){if(p.preventDefault(t),this.moved||(this.moved=!0),null!=this.lastX){var e=this.getX(t);if(null!=this.stopLeft){if(e<this.stopLeft)return;delete this.stopLeft}if(null!=this.stopRight){if(e>this.stopRight)return;delete this.stopRight}var i=this.sheet.getPropertyNameWidth()+(e-this.lastX);i<this.minGap?(i=this.minGap,this.stopLeft=e):i>this.sheet.getSumWidth()-this.minGap&&(i=this.sheet.getSumWidth()-this.minGap,this.stopRight=e),this.sheet.setPropertyNameWidth(i),this.lastX=e}else{var n;gt.isSingleTouch(t)?this.lastPoint&&(n=this.sheet.getLogicalPoint(t),i=this.lastPoint.x-n.x,e=this.lastPoint.y-n.y,n=this.sheet.panByOffset(i,e),this.lastPoint.x-=i-n.x,this.lastPoint.y-=e-n.y):this.distance&&(t=gt.getDistance(t)/this.distance,this.sheet.setZoom(this.zoom*t,!1))}},handleTouchend:function(t){var e;p.preventDefault(t),this.moved||(t.target._expandData?(e=t.target._expandData,this.sheet.isExpanded(e)?this.sheet.collapse(e):this.sheet.expand(e)):t.target===this.resizeDiv||(t=this.sheet.getRowIndexAt(t),this.sheet.updateCurrentRowIndex(t))),delete this.stopLeft,delete this.stopRight,delete this.lastX,delete this.lastPoint,delete this.distance,delete this.zoom,delete this.moved,p.removeEventListener("touchmove",this.view,this),p.removeEventListener("touchend",this.view,this)},getX:function(t){return t.changedTouches[0].clientX}}),n.controls.PropertySheetMSTouchInteraction=function(t){this.sheet=t,this.view=t._view,this.resizeDiv=t._resizeDiv,this._pointerMap={},this._pointerIdArray=[],p.addEventListener("MSPointerDown","handleTouchstart",this.view,this),p.addEventListener("MSPointerMove","handleTouchmove",this.view,this),p.addEventListener("MSPointerUp","handleTouchend",this.view,this),p.addEventListener("MSPointerCancel","handleTouchend",this.view,this),this.superHandleMouseDown=n.controls.PropertySheetMSTouchInteraction.superClass.handleMouseDown},o.ext("b2.controls.PropertySheetMSTouchInteraction",n.controls.PropertySheetInteraction,{handleMouseDown:function(t){},handleTouchstart:function(t){t.isPrimary&&0<this._pointerIdArray.length&&(this._pointerMap={},this._pointerIdArray=[]),this._pointerMap[t.pointerId]||null==this.sheet.getLogicalPoint(t)||(this._pointerIdArray.push(t.pointerId),this._pointerMap[t.pointerId]=t),1==this._pointerIdArray.length&&t.pointerType==t.MSPOINTER_TYPE_MOUSE&&this.superHandleMouseDown(t),1==this._pointerIdArray.length?(this._startTouchPoint=this.sheet.getLogicalPoint(t),this._startTouchTime=new Date):2==this._pointerIdArray.length&&(this._distance=this._getDistance(),this._zoom=this.sheet.getZoom())},handleTouchmove:function(t){var e,i;0==this._pointerIdArray.length||!this._pointerMap[t.pointerId]||f.getDistance({x:this._pointerMap[t.pointerId].pageX,y:this._pointerMap[t.pointerId].pageY},{x:t.pageX,y:t.pageY})<=10||(this._pointerMap[t.pointerId]=t,2==this._pointerIdArray.length?(e=this._getDistance()/this._distance,this.sheet.setZoom(this._zoom*e,!1)):1==this._pointerIdArray.length&&t.pointerType!=t.MSPOINTER_TYPE_MOUSE&&(!this._startTouchPoint||null!=(i=this.sheet.getLogicalPoint(t))&&(e=this._startTouchPoint.x-i.x,t=this._startTouchPoint.y-i.y,i=this.sheet.panByOffset(e,t),this._startTouchPoint.x-=e-i.x,this._startTouchPoint.y-=t-i.y)))},handleTouchend:function(t){var e;1==this._pointerIdArray.length&&t.pointerType!=t.MSPOINTER_TYPE_MOUSE&&(e=this.sheet.getLogicalPoint(t),(new Date).getTime()-this._startTouchTime.getTime()<=500&&f.getDistance(this._startTouchPoint,e)<=20&&this.superHandleMouseDown(t)),this._pointerMap={},this._pointerIdArray=[]},_getDistance:function(){return f.getDistance({x:this._pointerMap[this._pointerIdArray[0]].pageX,y:this._pointerMap[this._pointerIdArray[0]].pageY},{x:this._pointerMap[this._pointerIdArray[1]].pageX,y:this._pointerMap[this._pointerIdArray[1]].pageY})}}),n.controls.SplitPane=function(t,e,i,o){n.controls.SplitPane.superClass.constructor.apply(this,arguments),this._view=p.createView("hidden",!0),this._view.tabIndex=-1,this._dividerDiv=p.createDiv(),this._dividerDiv.tabIndex=-1,this._isPercentPosition=!0,this._view.appendChild(this._dividerDiv),t&&this.setFirstView(t),e&&this.setNextView(e),i&&this.setOrientation(i),1<o&&(this._isPercentPosition=!1),null!=o&&this.setPosition(o,this._isPercentPosition),this.setDividerDraggable(!0),this.setExpandable(!1),this.invalidate(),u.isTouchable&&new n.controls.SplitPaneTouchInteraction(this),new n.controls.SplitPaneInteraction(this)},o.ext("b2.controls.SplitPane",n.controls.ControlBase,{__accessor:["orientation","dividerWidth","dividerBackground","dividerOpacity","maskBackground","upExpandIcon","downExpandIcon","leftExpandIcon","rightExpandIcon"],__bool:["dividerDraggable","expandable"],_position:Ee.SPLITPANE_POSITION,_orientation:Ee.SPLITPANE_ORIENTATION,_dividerWidth:Ee.SPLITPANE_DIVIDER_WIDTH,_dividerBackground:Ee.SPLITPANE_DIVIDER_BACKGROUND,_dividerOpacity:Ee.SPLITPANE_DIVIDER_OPACITY,_maskBackground:Ee.SPLITPANE_MASK_BACKGROUND,_upExpandIcon:Ee.SPLITPANE_UP_EXPAND_ICON,_downExpandIcon:Ee.SPLITPANE_DOWN_EXPAND_ICON,_leftExpandIcon:Ee.SPLITPANE_LEFT_EXPAND_ICON,_rightExpandIcon:Ee.SPLITPANE_RIGHT_EXPAND_ICON,onPropertyChanged:function(t){this.invalidate()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(t,e){(t=e&&t<0?0:t)!==this._position&&(e=this._position,this._position=t,this.firePropertyChange("position",e,t),null==this.lastDividerLocation&&(this.lastDividerLocation=t))},setFirstView:function(t){var e;this._firstView!==t&&((e=this._firstView)&&(e.getView?this._view.removeChild(e.getView()):this._view.removeChild(e)),(this._firstView=t)&&(t.getView?this._view.insertBefore(t.getView(),this._dividerDiv):this._view.insertBefore(t,this._dividerDiv)),this.firePropertyChange("firstView",e,t))},getFirstView:function(){return this._firstView},setNextView:function(t){var e;this._nextView!==t&&((e=this._nextView)&&(e.getView?this._view.removeChild(e.getView()):this._view.removeChild(e)),(this._nextView=t)&&(t.getView?this._view.insertBefore(t.getView(),this._dividerDiv):this._view.insertBefore(t,this._dividerDiv)),this.firePropertyChange("nextView",e,t))},getNextView:function(){return this._nextView},validateImpl:function(){var t,e,i,n=this._position,s=this._view.offsetWidth,r=this._view.offsetHeight,a=this._dividerWidth;8<=a||0===a?this._coverDiv&&(this._dividerDiv.removeChild(this._coverDiv),delete this._coverDiv):this._coverDiv||(this._coverDiv=p.createDiv(),this._coverDiv.tabIndex=-1,this._dividerDiv.appendChild(this._coverDiv)),"horizontal"===this._orientation?(i=s-(a=s<a?s:a)-(e=this._isPercentPosition?(s-a)*n:n)+1,o.setViewBounds(this._firstView,{x:0,y:0,width:e,height:r}),o.setViewBounds(this._nextView,{x:e+a,y:0,width:i,height:r}),o.setViewBounds(this._dividerDiv,{x:e,y:0,width:a,height:r}),this._dividerDiv.position=e,this._coverDiv&&o.setViewBounds(this._coverDiv,{x:a/2-4,y:0,width:8,height:r}),this._expandable&&(this._expandCvs1||((t=o.html.createDiv()).tabIndex=-1,o.setViewBounds(t,{x:0,y:0,width:a,height:11}),this._expandCvs1=o.html.createImg(o.getImageSrc(this._leftExpandIcon)),this._expandCvs1.style.left=a/2-3+"px",t.appendChild(this._expandCvs1),this._dividerDiv.appendChild(t)),this._expandCvs2||((t=o.html.createDiv()).tabIndex=-1,o.setViewBounds(t,{x:0,y:15,width:a,height:11}),this._expandCvs2=o.html.createImg(o.getImageSrc(this._rightExpandIcon)),this._expandCvs2.style.left=a/2-3+"px",t.appendChild(this._expandCvs2),this._dividerDiv.appendChild(t)))):(n=r-(a=r<a?r:a)-(r=this._isPercentPosition?(r-a)*n:n),o.setViewBounds(this._firstView,{x:0,y:0,width:s,height:r}),o.setViewBounds(this._nextView,{x:0,y:r+a,width:s,height:n}),o.setViewBounds(this._dividerDiv,{x:0,y:r,width:s,height:a}),this._dividerDiv.position=r,this._coverDiv&&o.setViewBounds(this._coverDiv,{x:0,y:a/2-4,width:s,height:8}),this._expandable&&(this._expandCvs1||((t=o.html.createDiv()).tabIndex=-1,o.setViewBounds(t,{x:0,y:0,width:11,height:a}),this._expandCvs1=o.html.createImg(o.getImageSrc(this._upExpandIcon)),this._expandCvs1.style.top=a/2-3+"px",t.appendChild(this._expandCvs1),this._dividerDiv.appendChild(t)),this._expandCvs2||((t=o.html.createDiv()).tabIndex=-1,o.setViewBounds(t,{x:15,y:0,width:11,height:a}),this._expandCvs2=o.html.createImg(o.getImageSrc(this._downExpandIcon)),this._expandCvs2.style.top=a/2-3+"px",t.appendChild(this._expandCvs2),this._dividerDiv.appendChild(t)))),this._dividerDiv.style.background=this._dividerBackground}}),n.controls.SplitPaneInteraction=function(t){this.splitPane=t,this.view=t._view,this.dividerDiv=t._dividerDiv,this.isPercentPosition=t._isPercentPosition;var e=this;this.view.addEventListener("mousedown",function(t){0===t.button&&e.handleMouseDown(t)},!1),this.view.addEventListener("mousemove",function(t){e.handleMouseMove(t)},!1)},o.ext("b2.controls.SplitPaneInteraction",Object,{handleMouseDown:function(t){if(this.splitPane.isExpandable()){var e,i,n=this.splitPane._dividerWidth;if(t.target===this.splitPane._expandCvs1)return"horizontal"===this.splitPane._orientation?(e=this.view.clientWidth)<n&&(n=e):(i=this.view.clientHeight)<n&&(n=i),void(this.splitPane.lastDividerLocation===this.splitPane.getPosition()?this.splitPane.setPosition(0):this.splitPane.lastDividerLocation<this.splitPane.getPosition()&&(this.splitPane.setPosition(this.splitPane.lastDividerLocation),this.splitPane.lastDividerLocation=this.splitPane.getPosition()));if(t.target===this.splitPane._expandCvs2)return"horizontal"===this.splitPane._orientation?(e=this.view.clientWidth)<n&&(n=e):(i=this.view.clientHeight)<n&&(n=i),void(this.splitPane.lastDividerLocation===this.splitPane.getPosition()?this.splitPane.setPosition(1):this.splitPane.lastDividerLocation>this.splitPane.getPosition()&&(this.splitPane.setPosition(this.splitPane.lastDividerLocation),this.splitPane.lastDividerLocation=this.splitPane.getPosition()))}this.splitPane.isDividerDraggable()&&(this.resizeDiv?this.clear(t):t.target!==this.dividerDiv&&t.target!==this.splitPane._coverDiv||(this.resizeDiv=p.createDiv(),(n=this.resizeDiv.style).left=this.dividerDiv.style.left,n.top=this.dividerDiv.style.top,n.width=this.dividerDiv.style.width,n.height=this.dividerDiv.style.height,n.opacity=this.splitPane.getDividerOpacity(),n.background=this.splitPane.getDividerBackground(),this.resizeDiv.lastPosition="horizontal"===this.splitPane._orientation?t.clientX:t.clientY,this.resizeDiv.maskDiv=p.createDiv(),(n=this.resizeDiv.maskDiv.style).left="0px",n.top="0px",n.width=this.view.clientWidth+"px",n.height=this.view.clientHeight+"px",n.background=this.splitPane.getMaskBackground(),this.view.appendChild(this.resizeDiv.maskDiv),this.view.appendChild(this.resizeDiv),p.handle_mousedown(this,t),t.preventDefault()))},handleMouseMove:function(t){var e;(!this.splitPane.isExpandable()||t.target!==this.splitPane._expandCvs1&&t.target!==this.splitPane._expandCvs2)&&this.splitPane.isDividerDraggable()&&(this.resizeDiv||p.target?this.resizeDiv&&p.target===this&&("horizontal"===this.splitPane._orientation?this.resizeDiv.style.left=this.dividerDiv.position+t.clientX-this.resizeDiv.lastPosition+"px":this.resizeDiv.style.top=this.dividerDiv.position+t.clientY-this.resizeDiv.lastPosition+"px"):(e="horizontal"===this.splitPane._orientation?"ew-resize":"ns-resize",this.view.style.cursor=t.target===this.dividerDiv||t.target===this.splitPane._coverDiv?e:"default"))},handleMouseUp:function(t){(!this.splitPane.isExpandable()||t.target!==this.splitPane._expandCvs1&&t.target!==this.splitPane._expandCvs2)&&this.splitPane.isDividerDraggable()&&0===t.button&&this.clear(t)},clear:function(t){var e,i,n;this.resizeDiv&&(e=this.splitPane._dividerWidth,"horizontal"===this.splitPane._orientation?((n=this.view.clientWidth)<e&&(e=n),i=this.dividerDiv.position+t.clientX-this.resizeDiv.lastPosition,this.isPercentPosition?this.splitPane.setPosition(i/(n-e)):this.splitPane.setPosition(i)):((n=this.view.clientHeight)<e&&(e=n),i=this.dividerDiv.position+t.clientY-this.resizeDiv.lastPosition,this.isPercentPosition?this.splitPane.setPosition(i/(n-e)):this.splitPane.setPosition(i)),this.splitPane.lastDividerLocation=this.splitPane.getPosition(),this.view.removeChild(this.resizeDiv.maskDiv),this.view.removeChild(this.resizeDiv),delete this.resizeDiv)}}),n.controls.SplitPaneTouchInteraction=function(t){this.splitPane=t,this.view=t._view,this.dividerDiv=t._dividerDiv,this.isPercentPosition=t._isPercentPosition,p.addEventListener("touchstart","handleTouchstart",this.view,this)},o.ext("b2.controls.SplitPaneTouchInteraction",Object,{handleTouchstart:function(t){if(p.preventDefault(t),this.splitPane.isExpandable()){var e,i,n=this.splitPane._dividerWidth;if(t.target===this.splitPane._expandCvs1)return"horizontal"===this.splitPane._orientation?(e=this.view.clientWidth)<n&&(n=e):(i=this.view.clientHeight)<n&&(n=i),void(this.splitPane.lastDividerLocation===this.splitPane.getPosition()?this.splitPane.setPosition(0):this.splitPane.lastDividerLocation<this.splitPane.getPosition()&&(this.splitPane.setPosition(this.splitPane.lastDividerLocation),this.splitPane.lastDividerLocation=this.splitPane.getPosition()));if(t.target===this.splitPane._expandCvs2)return"horizontal"===this.splitPane._orientation?(e=this.view.clientWidth)<n&&(n=e):(i=this.view.clientHeight)<n&&(n=i),void(this.splitPane.lastDividerLocation===this.splitPane.getPosition()?this.splitPane.setPosition(1):this.splitPane.lastDividerLocation>this.splitPane.getPosition()&&(this.splitPane.setPosition(this.splitPane.lastDividerLocation),this.splitPane.lastDividerLocation=this.splitPane.getPosition()))}this.resizeDiv?this.clear(t):t.target!==this.dividerDiv&&t.target!==this.splitPane._coverDiv||(this.resizeDiv=p.createDiv(),(n=this.resizeDiv.style).left=this.dividerDiv.style.left,n.top=this.dividerDiv.style.top,n.width=this.dividerDiv.style.width,n.height=this.dividerDiv.style.height,n.opacity=this.splitPane.getDividerOpacity(),n.background=this.splitPane.getDividerBackground(),t=t.changedTouches[0],this.resizeDiv.lastPosition="horizontal"===this.splitPane._orientation?t.clientX:t.clientY,this.resizeDiv.maskDiv=p.createDiv(),(n=this.resizeDiv.maskDiv.style).left="0px",n.top="0px",n.width=this.view.clientWidth+"px",n.height=this.view.clientHeight+"px",n.background=this.splitPane.getMaskBackground(),this.view.appendChild(this.resizeDiv.maskDiv),this.view.appendChild(this.resizeDiv)),p.addEventListener("touchmove","handleTouchmove",this.view,this),p.addEventListener("touchend","handleTouchend",this.view,this)},handleTouchmove:function(t){p.preventDefault(t),(!this.splitPane.isExpandable()||t.target!==this.splitPane._expandCvs1&&t.target!==this.splitPane._expandCvs2)&&this.resizeDiv&&(t=t.changedTouches[0],"horizontal"===this.splitPane._orientation?this.resizeDiv.style.left=this.dividerDiv.position+t.clientX-this.resizeDiv.lastPosition+"px":this.resizeDiv.style.top=this.dividerDiv.position+t.clientY-this.resizeDiv.lastPosition+"px")},handleTouchend:function(t){this.splitPane.isExpandable()&&(t.target===this.splitPane._expandCvs1||t.target===this.splitPane._expandCvs2)||(p.removeEventListener("touchmove",this.view,this),p.removeEventListener("touchend",this.view,this),this.clear(t))},clear:function(t){var e,i,n=t.changedTouches[0];this.resizeDiv&&(t=this.splitPane._dividerWidth,"horizontal"===this.splitPane._orientation?((e=this.view.clientWidth)<t&&(t=e),i=this.dividerDiv.position+n.clientX-this.resizeDiv.lastPosition,this.isPercentPosition?this.splitPane.setPosition(i/(e-t)):this.splitPane.setPosition(i)):((e=this.view.clientHeight)<t&&(t=e),i=this.dividerDiv.position+n.clientY-this.resizeDiv.lastPosition,this.isPercentPosition?this.splitPane.setPosition(i/(e-t)):this.splitPane.setPosition(i)),this.splitPane.lastDividerLocation=this.splitPane.getPosition(),this.view.removeChild(this.resizeDiv.maskDiv),this.view.removeChild(this.resizeDiv),delete this.resizeDiv)}}),n.controls.TabPane=function(){n.controls.TabPane.superClass.constructor.apply(this,arguments),this._tabBox=new n.TabBox,this._tabBox.addDataBoxChangeListener(this.handleTabChange,this),this._tabBox.addDataPropertyChangeListener(this.handleTabChange,this),this._tabBox.addHierarchyChangeListener(this.handleTabChange,this),this._tabBox.getSelectionModel().addSelectionChangeListener(this.handleTabChange,this),this._view=p.createView("hidden",!0),this._tabDiv=p.createDiv(),this._tabDiv.onmousedown=p.preventDefault,this._tabDiv.onkeydown=p.preventDefault,this._contentDiv=p.createDiv(),this._view.appendChild(this._tabDiv),this._view.appendChild(this._contentDiv),this._divPool=new n.Pool("div"),this._iconPool=new n.Pool("img"),this._closePool=new n.Pool("img"),this._textPool=new n.Pool("span"),this._resizePool=new n.Pool("div"),this._pools.add(this._divPool),this._pools.add(this._iconPool),this._pools.add(this._closePool),this._pools.add(this._textPool),this._pools.add(this._resizePool),this.invalidateTab(),u.isTouchable&&new n.controls.TabPaneTouchInteraction(this),new n.controls.TabPaneInteraction(this)},o.ext("b2.controls.TabPane",n.controls.ControlBase,{__accessor:["tabGap","tabRadius","tabHeight","horizontalAlign","tabOrientation","resizeTolerance","tabBackground","selectBackground","moveBackground","insertBackground","closeIcon","disabledColor"],__bool:["selectNextOnClose","selectNextOnInVisible"],_tabGap:Ee.TABPANE_TAB_GAP,_tabRadius:Ee.TABPANE_TAB_RADIUS,_tabHeight:Ee.TABPANE_TAB_HEIGHT,_resizeTolerance:Ee.TABPANE_RESIZE_TOLERANCE,_tabOrientation:Ee.TABPANE_TAB_ORIENTATION,_tabBackground:Ee.TABPANE_TAB_BACKGROUND,_disabledColor:Ee.TABPANE_DISABLED_COLOR,_selectBackground:Ee.TABPANE_SELECT_BACKGROUND,_moveBackground:Ee.TABPANE_MOVE_BACKGROUND,_insertBackground:Ee.TABPANE_INSERT_BACKGROUND,_horizontalAlign:Ee.TABPANE_HORIZONTAL_ALIGN,_closeIcon:Ee.TABPANE_CLOSE_ICON,_selectNextOnClose:Ee.TABPANE_SELECT_NEXT_ON_CLOSE,_selectNextOnInVisible:Ee.TABPANE_SELECT_NEXT_ON_INVISIBLE,onPropertyChanged:function(t){this.invalidateTab()},getTabBox:function(){return this._tabBox},getTabDiv:function(){return this._tabDiv},getContentDiv:function(){return this._contentDiv},handleTabChange:function(t){if(this._selectNextOnInVisible&&"visible"===t.property&&!t.newValue&&this._tabBox.getSelectionModel().contains(t.source)){t=t.source,t=this._tabBox.getRoots().indexOf(t);for(var e,i,n=this._tabBox.getRoots(),o=n.size(),s=t;s<o-1;)if((e=n.get(++s)).isVisible()&&!e.isDisabled()){i=e;break}if(!i)for(s=t;0<s;)if((e=n.get(--s)).isVisible()&&!e.isDisabled()){i=e;break}this._tabBox.getSelectionModel().setSelection(i)}this.invalidateTab()},invalidateTab:function(t){this._invalidateTab||(this._invalidateTab=!0,this.invalidate(t))},validateImpl:function(){this._invalidateTab&&(this._invalidateTab=!1,this.validateTab());var t=this._view.offsetWidth,e=this._view.offsetHeight;e="top"===this._tabOrientation?(this._tabDiv.style.top="0px",{x:0,y:this._tabHeight,width:t,height:Math.max(0,e-this._tabHeight)}):(this._tabDiv.style.top=e-this._tabHeight+"px",{x:0,y:0,width:t,height:Math.max(0,e-this._tabHeight)});this._currentView&&o.setViewBounds(this._currentView,e)},getCurrentTab:function(){return this._currentTab},getCurrentView:function(){return this._currentView},onViewRemoved:function(t){},onViewAdded:function(t){},validateTab:function(){this._currentTab=this._tabBox.getSelectionModel().getLastData();var t,e=this._currentTab?this._currentTab.getView():null;e!==this._currentView&&(this._currentView&&((this._currentView.getView?this._currentView.getView():this._currentView).style.visibility="hidden",this.onViewRemoved(this._currentView)),e&&((t=e.getView?e.getView():e).style.visibility="inherit",t.parentNode||this._contentDiv.appendChild(t),this.onViewAdded(e)),this._currentView=e),p.release(this._tabDiv);for(var i=this._tabBox.getRoots(),n=this._tabHeight+"px",o=this._tabHeight-2+"px",s=this._tabRadius+"px",r=i.size(),a=0,h=0;h<r;h++){var l,c,d,u,g,_=i.get(h);_.isVisible()&&(l=this._currentTab===_,(c=_.getWidth())<0&&(c=0),d=Math.min(this._tabGap,c),(u=this._divPool.get())._tab=_,(g=u.style).position="absolute",g.whiteSpace="nowrap",g.lineHeight=o,g.overflow="hidden",g.textOverflow="ellipsis",g.background=l?this._selectBackground:this._tabBackground,g.textAlign=this._horizontalAlign,"top"===this._tabOrientation?(g.borderTopLeftRadius=s,g.borderTopRightRadius=s,g.borderBottomLeftRadius="0px",g.borderBottomRightRadius="0px"):(g.borderTopLeftRadius="0px",g.borderTopRightRadius="0px",g.borderBottomLeftRadius=s,g.borderBottomRightRadius=s),g.left=a+"px",g.width=c-d+"px",g.height=n,u._x=a,u._width=c-d,this.renderTab(u,_),this.onTabRendered(u,_),this._tabDiv.insertBefore(u,this._tabDiv.firstChild),a+=c,_.isResizable()&&((u=this._resizePool.get())._resizeTab=_,(g=u.style).position="absolute",g.backgroundColor="white",g.opacity=0,g.left=a-d-this._resizeTolerance+"px",g.width=d+2*this._resizeTolerance+"px",g.height=n,this._tabDiv.appendChild(u)))}this._tabDiv.style.left="0px",this._tabDiv.style.width=a+"px",this._tabDiv.style.height=this._tabHeight+"px",this._pools.forEach(function(t){t.clear()})},renderTab:function(t,e){var i,n,s,r;e.renderTab?e.renderTab(t):((n=e.getIcon())&&((r=this._iconPool.get()).setAttribute("src",o.getImageSrc(n)),r.style.paddingLeft="4px",r.style.verticalAlign="middle",t.appendChild(r)),(i=e.getName())&&((n=this._textPool.get()).style.whiteSpace="nowrap",n.style.verticalAlign="middle",n.style.padding="2px 4px",n.innerHTML=i,t.appendChild(n)),u.isOpera&&((s=t.cloneNode(!1)).style.left="0px",s.style.top="0px",s.style.opacity=0,t.appendChild(s))),e.isClosable()&&(s=this._tabRadius/4+2,(r=this._closePool.get())._closeTab=e,r.setAttribute("src",o.getImageSrc(this._closeIcon)),r.style.position="absolute",r.style.top=s+"px",r.style.right=s+"px",t.appendChild(r)),e.isDisabled()?t.style.color=this.getDisabledColor():t.style.color=""},onTabRendered:function(t,e){}}),n.controls.TabPaneInteraction=function(t){this.tabPane=t,this.view=t.getTabDiv();var e=this;this.view.addEventListener("mousedown",function(t){e.handleMouseDown(t)},!1),this.view.addEventListener("mousemove",function(t){e.handleMouseMove(t)},!1)},o.ext("b2.controls.TabPaneInteraction",Object,{handleMouseDown:function(t){0===t.button&&(this.movableDiv?this.handleMouseUp(t):(this.resizeTab=t.target._resizeTab,this.resizeTab||(this.movableDiv=this.getMovableDivAt(t)),this.changeCursor(t),this.lastX=this.getX(t),this._startClient=p.getClientPoint(t),this._startLogicalX=this.lastX,p.handle_mousedown(this,t)))},changeCursor:function(t){var e="";t.target._resizeTab?e="ew-resize":!(t=this.getTabAt(t))||t.isDisabled()&&!t.isMovable()||(e="pointer"),this.view.style.cursor=e},handleMouseMove:function(t){if(null!=this.lastX){if(p.target===this){var e=this._startLogicalX+t.clientX-this._startClient.x;if(this.resizeTab){if(null!=this.stopX){if(e<this.stopX)return;delete this.stopX}var i=this.resizeTab.getWidth()+(e-this.lastX);i<10&&(i=10,this.stopX=e),this.resizeTab.setWidth(i),this.lastX=e}else if(this.movableDiv){if(i=e-this.lastX,!this.cloneDiv){if(Math.abs(i)<3)return;this.cloneDiv=this.movableDiv.cloneNode(!0),this.cloneDiv._x=this.movableDiv._x,this.cloneDiv.style.background=this.tabPane.getMoveBackground(),this.insertDiv=p.createDiv(),this.insertDiv.style.width="1px",this.insertDiv.style.height=this.cloneDiv.style.height,this.insertDiv.style.background=this.tabPane.getInsertBackground(),this.movableDiv.parentNode.appendChild(this.cloneDiv),this.movableDiv.parentNode.appendChild(this.insertDiv)}i=this.cloneDiv._x+i,this.cloneDiv.style.left=i+"px",this.cloneDiv._x=i,this.lastX=e,this.tabInfo=this.getTabInfoAt(t),this.tabInfo&&(this.insertDiv.style.left=this.tabInfo.position)}}}else this.changeCursor(t)},handleMouseUp:function(t){var e,i,n,o;0===t.button&&(this.resizeTab||(this.movableDiv&&this.tabInfo?(o=this.movableDiv._tab,n=this.tabInfo.index,this.tabPane.getTabBox().moveTo(o,n)):(e=this.tabPane.getTabBox(),(o=t.target._closeTab)?this.tabPane.isSelectNextOnClose()&&this.tabPane.getCurrentTab()===o?(n=(i=e.getRoots()).indexOf(o),e.remove(o),0<i.size()&&(n>=i.size()&&(n=i.size()-1),e.getSelectionModel().setSelection(i.get(n)))):e.remove(o):(o=this.getTabAt(t))&&!o.isDisabled()&&e.getSelectionModel().setSelection(o))),this.clear())},clear:function(){this.view.style.cursor="",this.cloneDiv&&this.movableDiv&&this.movableDiv.parentNode.removeChild(this.cloneDiv),this.insertDiv&&this.movableDiv&&this.movableDiv.parentNode.removeChild(this.insertDiv),delete this.movableDiv,delete this.tabInfo,delete this.insertDiv,delete this.cloneDiv,delete this.resizeTab,delete this.stopX,delete this.lastX,delete this._startLogicalX,delete this._startClient},getTabAt:function(t){var e;for(t=t.target;t&&t!==this.view&&!(e=t._tab);)t=t.parentNode;return e},getMovableDivAt:function(t){var e;for(t=t.target;t&&t!==this.view&&!(e=t._tab);)t=t.parentNode;return e&&e.isMovable()?t:null},getX:function(t){return(t=p.getLogicalPoint(this.view,t))?t.x:null},getTabInfoAt:function(t){for(var e=this._startLogicalX+t.clientX-this._startClient.x,i=this.tabPane.getTabBox().getRoots(),n=i.size(),o=0,s=!1,r=0;r<n;r++){var a=i.get(r);if(a===this.movableDiv._tab&&(s=!0),a.isVisible()){var h=a.getWidth();if(!(h<=0)){if(o<=e&&e<=o+h){var l=e<o+h/2;!s||a===this.movableDiv._tab&&l||r--;var c=l?o:o+h;return{index:l?Math.max(0,r):Math.min(r+1,n),tab:a,position:(c=Math.max(0,c-1))+"px"}}o+=h}}}return this.tabInfo}}),n.controls.TabPaneTouchInteraction=function(t){this.tabPane=t,this.view=t.getTabDiv(),p.addEventListener("touchstart","handleTouchstart",this.view,this)},o.ext("b2.controls.TabPaneTouchInteraction",Object,{handleTouchstart:function(t){p.preventDefault(t),this.movableDiv?this.handleTouchend(t):(this.resizeTab=t.target._resizeTab,this.resizeTab||(this.movableDiv=this.getMovableDivAt(t)),this.lastX=this.getX(t),p.addEventListener("touchmove","handleTouchmove",this.view,this),p.addEventListener("touchend","handleTouchend",this.view,this))},handleTouchmove:function(t){if(null!=this.lastX)if(this.resizeTab){var e=this.getX(t);if(null!=this.stopX){if(e<this.stopX)return;delete this.stopX}var i=this.resizeTab.getWidth()+(e-this.lastX);i<0&&(i=0,this.stopX=e),this.resizeTab.setWidth(i),this.lastX=e}else if(this.movableDiv){if(i=(e=this.getX(t))-this.lastX,!this.cloneDiv){if(Math.abs(i)<3)return;this.cloneDiv=this.movableDiv.cloneNode(!0),this.cloneDiv._x=this.movableDiv._x,this.cloneDiv.style.background=this.tabPane.getMoveBackground(),this.insertDiv=p.createDiv(),this.insertDiv.style.width="1px",this.insertDiv.style.height=this.cloneDiv.style.height,this.insertDiv.style.background=this.tabPane.getInsertBackground(),this.movableDiv.parentNode.appendChild(this.cloneDiv),this.movableDiv.parentNode.appendChild(this.insertDiv)}i=this.cloneDiv._x+i,this.cloneDiv.style.left=i+"px",this.cloneDiv._x=i,this.lastX=e,this.tabInfo=this.getTabInfoAt(t),this.tabInfo&&(this.insertDiv.style.left=this.tabInfo.position)}},handleTouchend:function(t){var e,i,n,o;this.resizeTab||(this.movableDiv&&this.tabInfo?(o=this.movableDiv._tab,n=this.tabInfo.index,this.tabPane.getTabBox().moveTo(o,n)):(e=this.tabPane.getTabBox(),(o=t.target._closeTab)?this.tabPane.isSelectNextOnClose()&&this.tabPane.getCurrentTab()===o?(n=(i=e.getRoots()).indexOf(o),e.remove(o),0<i.size()&&(n>=i.size()&&(n=i.size()-1),e.getSelectionModel().setSelection(i.get(n)))):e.remove(o):(o=this.getTabAt(t))&&!o.isDisabled()&&e.getSelectionModel().setSelection(o))),this.clear(),p.removeEventListener("touchmove",this.view,this),p.removeEventListener("touchend",this.view,this)},clear:function(){this.cloneDiv&&this.movableDiv&&this.movableDiv.parentNode.removeChild(this.cloneDiv),this.insertDiv&&this.movableDiv&&this.movableDiv.parentNode.removeChild(this.insertDiv),delete this.movableDiv,delete this.tabInfo,delete this.insertDiv,delete this.cloneDiv,delete this.resizeTab,delete this.stopX,delete this.lastX},getTabAt:function(t){var e;for(t=t.target;t&&t!==this.view&&!(e=t._tab);)t=t.parentNode;return e},getMovableDivAt:function(t){var e;for(t=t.target;t&&t!==this.view&&!(e=t._tab);)t=t.parentNode;return e&&e.isMovable()?t:null},getX:function(t){return(t=p.getLogicalPoint(this.view,t))?t.x:null},getTabInfoAt:function(t){for(var e=this.getX(t),i=this.tabPane.getTabBox().getRoots(),n=i.size(),o=0,s=!1,r=0;r<n;r++){var a=i.get(r);if(a===this.movableDiv._tab&&(s=!0),a.isVisible()){var h=a.getWidth();if(!(h<=0)){if(o<=e&&e<=o+h){var l=e<o+h/2;!s||a===this.movableDiv._tab&&l||r--;var c=l?o:o+h;return{index:l?Math.max(0,r):Math.min(r+1,n),tab:a,position:(c=Math.max(0,c-1))+"px"}}o+=h}}}return this.tabInfo}}),n.controls.TitlePane=function(t,e,i){n.controls.TitlePane.superClass.constructor.apply(this,arguments),this.invalidate(),this._titleDiv=p.createDiv(),this._titleDiv.tabIndex=-1,this._titleDiv.style.verticalAlign="middle",this._titleDiv.style.fontWeight="bold",this._titleDiv.style.textOverflow="ellipsis",this._titleDiv.style.overflow="hidden",this._titleDiv.style.whiteSpace="nowrap",this._titleDiv.onmousedown=p.preventDefault,this._span=l.createElement("span"),this._span.style.verticalAlign="middle",this._span.style.paddingLeft="4px",this._span.style.paddingRight="4px",this._img=l.createElement("img"),this._img.style.verticalAlign="middle",this._img.style.paddingLeft="4px",this._view=p.createView("hidden",!0),this._view.tabIndex=-1,this._view.appendChild(this._titleDiv),e&&this.setTitle(e),t&&this.setContent(t),i&&this.setIcon(i)},o.ext("b2.controls.TitlePane",n.controls.ControlBase,{__accessor:["icon","title","titleHeight","titleHorizontalAlign","titleBackground"],_titleHeight:Ee.TITLEPANE_TITLE_HEIGHT,_titleBackground:Ee.TITLEPANE_TITLE_BACKGROUND,_titleHorizontalAlign:Ee.TITLEPANE_TITLE_HORIZONTAL_ALIGN,onPropertyChanged:function(t){this.invalidate()},getTitleDiv:function(){return this._titleDiv},getContent:function(){return this._content},setContent:function(t){var e;this._content!==t&&((e=this._content)&&(e.getView?this._view.removeChild(e.getView()):this._view.removeChild(e)),(this._content=t)&&(t.getView?this._view.appendChild(t.getView()):this._view.appendChild(t)),this.firePropertyChange("content",e,t))},validateImpl:function(){var t=this._view.offsetWidth,e=this._view.offsetHeight,i=this._titleDiv.style;i.textAlign=this._titleHorizontalAlign,i.lineHeight=this._titleHeight-2+"px",i.background=this._titleBackground,p.clear(this._titleDiv),this._icon&&(this._img.setAttribute("src",o.getImageSrc(this._icon)),this._titleDiv.appendChild(this._img)),this._title&&(this._span.innerHTML=this._title,this._span.setAttribute("title",this._title),this._titleDiv.appendChild(this._span)),(i=this._titleDiv.style).left="0px",i.top="0px",i.width=t+"px",i.height=this._titleHeight+"px",o.setViewBounds(this._content,{x:0,y:this._titleHeight,width:t,height:Math.max(e-this._titleHeight,0)})}}),n.controls.Accordion=function(){n.controls.Accordion.superClass.constructor.apply(this,arguments),this._titleMap={},this._titleList=new at,this._currentTitle=null,this._currentView=null,this._view=p.createView("hidden",!0),this.invalidate();var t=this;this._view.addEventListener("mousedown",function(e){t.handleMouseDown(e)},!1)},o.ext("b2.controls.Accordion",n.controls.ControlBase,{__accessor:["expandIcon","collapseIcon","titleHeight","titleBackground","borderBottomColor","iconPosition"],_expandIcon:Ee.ACCORDION_EXPAND_ICON,_collapseIcon:Ee.ACCORDION_COLLAPSE_ICON,_titleHeight:Ee.ACCORDION_TITLE_HEIGHT,_titleBackground:Ee.ACCORDION_TITLE_BACKGROUND,_borderBottomColor:Ee.ACCORDION_BORDER_BOTTOM_COLOR,_iconPosition:Ee.ACCORDION_ICON_POSITION,onPropertyChanged:function(t){this.invalidate()},handleMouseDown:function(t){var e;0!==t.button||(e=(e=t.target._title)||t.target.parentNode._title)&&(this._currentTitle===e?this.collapse():this.expand(e))},getTitles:function(){return this._titleList},getCurrentTitle:function(){return this._currentTitle},add:function(t,e){if(this._titleMap[t])throw"Title ' + title + ' already exists";var i=p.createDiv();i._title=t,i.onmousedown=p.preventDefault,i.style.cursor="pointer",i.style.textAlign="left",i.style.textOverflow="ellipsis",i.style.whiteSpace="nowrap",i.style.overflow="hidden",i.style.borderBottomWidth="1px",i.style.borderBottomStyle="solid";var n=l.createElement("img");n.style.verticalAlign="middle",n.style.paddingLeft="4px";var o,s,r=l.createElement("span");r.style.verticalAlign="middle",r.style.paddingLeft="4px",r.innerHTML=t,r.setAttribute("title",t),this._view.appendChild(i),i.appendChild(n),i.appendChild(r),"right"==this._iconPosition&&(o=n.style,s=(this._titleHeight-8)/2,o.marginTop=s+"px",o.right="15px",o.position="absolute"),this._titleMap[t]={content:e,titleDiv:i,span:r,img:n},this._titleList.add(t),this.invalidate()},remove:function(t){var e=this._titleMap[t];e&&this._view.removeChild(e.titleDiv),delete this._titleMap[t],this._titleList.remove(t),this.invalidate()},clear:function(){var t=this;Object.keys(t._titleMap).forEach(function(e){t._view.removeChild(t._titleMap[e].titleDiv)}),t._titleMap={},t._titleList.clear(),t.invalidate()},expand:function(t){this._titleMap[t]&&this._currentTitle!==t&&(this._currentTitle=t,this.onExpanded(t),this.invalidate())},onExpanded:function(t){},collapse:function(){this._currentTitle&&(this.onCollapsed(this._currentTitle),this._currentTitle=null,this.invalidate())},onCollapsed:function(t){},validateImpl:function(){var t=this._currentView;this._currentView=null;for(var e=this._view.offsetWidth,i=this._view.offsetHeight,n=this._titleList.size(),s=0,r=0;r<n;r++){var a=this._titleList.get(r),h=this._titleMap[a],l=h.titleDiv.style;l.lineHeight=this._titleHeight-3+"px",l.background=this._titleBackground,l.borderBottomColor=this._borderBottomColor,l.left="0px",l.top=s+"px",l.width=e+"px",l.height=this._titleHeight-1+"px",a=(l=this._currentTitle===a)?this._expandIcon:this._collapseIcon,h.img.setAttribute("src",o.getImageSrc(a)),l?(l=Math.max(0,i-n*this._titleHeight),h.content&&(this._currentView=h.content.getView?h.content.getView():h.content,o.setViewBounds(h.content,{x:0,y:s+this._titleHeight,width:e,height:l}),h.content.style.overflowY="auto"),s+=this._titleHeight+l):s+=this._titleHeight}this._currentView&&this._currentView!==t&&this._view.appendChild(this._currentView),t&&t!==this._currentView&&this._view.removeChild(t)}}),n.controls.BorderPane=function(t,e,i,o,s){n.controls.BorderPane.superClass.constructor.apply(this,arguments),this.invalidate(),this._view=p.createView("hidden",!0),this._view.tabIndex=-1,t&&this.setCenter(t),e&&this.setTop(e),i&&this.setRight(i),o&&this.setBottom(o),s&&this.setLeft(s)},o.ext("b2.controls.BorderPane",n.controls.ControlBase,{__accessor:["hGap","vGap","topHeight","bottomHeight","leftWidth","rightWidth"],_hGap:Ee.BORDERPANE_HGAP,_vGap:Ee.BORDERPANE_VGAP,_topHeight:0,_bottomHeight:0,_leftWidth:0,_rightWidth:0,onPropertyChanged:function(t){this.invalidate()},getCenter:function(){return this._center},setCenter:function(t){this._setContent("center",t)},getTop:function(){return this._top},setTop:function(t){this._setContent("top",t)},getRight:function(){return this._right},setRight:function(t){this._setContent("right",t)},getBottom:function(){return this._bottom},setBottom:function(t){this._setContent("bottom",t)},getLeft:function(){return this._left},setLeft:function(t){this._setContent("left",t)},_setContent:function(t,e){var i,n=this["_"+t];n!==e&&(n&&(i=n.getView?n.getView():n,this._view.contains(i)&&this._view.removeChild(i)),(this["_"+t]=e)&&(e.getView?this._view.appendChild(e.getView()):this._view.appendChild(e)),this.firePropertyChange(t,n,e))},validateImpl:function(){var t=this._view.offsetWidth,e=0,i=0,n=t,s=d=this._view.offsetHeight,r=0,a=0,h=0,l=0;this._top&&(i=(r=this._topHeight||(this._top.getView?this._top.getView():this._top).offsetHeight)+this._vGap),this._bottom&&(s=d-(a=this._bottomHeight||(this._bottom.getView?this._bottom.getView():this._bottom).offsetHeight)-this._vGap),this._left&&(e=(h=this._leftWidth||(this._left.getView?this._left.getView():this._left).offsetWidth)+this._hGap),this._right&&(n=t-(l=this._rightWidth||(this._right.getView?this._right.getView():this._right).offsetWidth)-this._hGap);var c=Math.max(0,n-e),d=Math.max(0,s-i);this._top&&o.setViewBounds(this._top,{x:0,y:0,width:t,height:r}),this._bottom&&o.setViewBounds(this._bottom,{x:0,y:s,width:t,height:a}),this._left&&o.setViewBounds(this._left,{x:0,y:i,width:h,height:d}),this._right&&o.setViewBounds(this._right,{x:n,y:i,width:l,height:d}),this._center&&o.setViewBounds(this._center,{x:e,y:i,width:c,height:d})}}),n.controls.PopupMenu=function(t){this._view=p.createDiv(),this._view.style.zIndex=100001,this._items=[],this._itemsMap={},this.setContextView(t);t=this._view;var e=this;t.addEventListener("mouseover",function(t){e._mouseOver=!0},!1),t.addEventListener("mouseout",function(t){e._mouseOver=!1},!1),t.oncontextmenu=function(t){t.preventDefault()},p.addEventListener("mousedown","_handleClick",t,this)},o.ext("b2.controls.PopupMenu",Object,{_width:200,_xOffset:0,_yOffset:0,_menuItemHeight:25,_background:"#F9F9F9",_border:"2px outset white",_disabledColor:"#BABBBC",_focusColor:"white",_focusBackground:"#C2CFF1",_color:"black",_subMenuEnableIcon:Ee.POPUPMENU_SUBNENU_ENABLE_ICON,_subMenuDisableIcon:Ee.POPUPMENU_SUBNENU_DISABLE_ICON,_checkboxSelectedIcon:Ee.POPUPMENU_CHECKBOX_SELECTED_ICON,_checkboxUnselectedIcon:Ee.POPUPMENU_CHECKBOX_UNSELECTED_ICON,_radiobuttonSelectedIcon:Ee.POPUPMENU_RADIOBUTTON_SELECTED_ICON,_radiobuttonUnselectedIcon:Ee.POPUPMENU_RADIOBUTTON_UNSELECTED_ICON,getView:function(){return this._view},getContextView:function(){return this._contextView},setContextView:function(t){this._removeContextmenuListener(),(this._contextView=t)&&(t=t.getView?t.getView():t,u.isTouchable&&(t.addEventListener("touchstart",this._getTouchStartListener(),!1),t.addEventListener("touchmove",this._getTouchMoveListener(),!1),t.addEventListener("touchend",this._getTouchEndListener(),!1)),p.addEventListener("contextmenu","_handleContextmenu",t,this))},getMenuItems:function(){return this._items},setMenuItems:function(t){if(this._items=[],this._itemsMap={},t)for(var e=0,i=t.length;e<i;e++)this.addMenuItem(t[e])},addMenuItem:function(t){!0!==t.separator&&(this._itemsMap[t.id||t.label]=t),this._items.push(t)},getMenuItem:function(t){return this._itemsMap[t]},addSeparator:function(){this.addMenuItem({separator:!0})},getMenuItemById:function(t){return this._itemsMap[t]},isVisible:function(t){return!1!==t.visible},isEnabled:function(t){return!1!==t.enabled},show:function(t){this.hide();var e,i,n,o=this._view,s=this._view.style;n=u.isTouchable?(i=t.changedTouches&&t.changedTouches[0].clientX||t.clientX,t.changedTouches&&t.changedTouches[0].clientY||t.clientY):(i=t.clientX,t.clientY),p.clear(o),this.renderMenu(o,this._items),0!==this._height&&(u.isTouchable&&p.addEventListener("touchstart","_handleBodyClicked",l.body,this),p.addEventListener("mousedown","_handleBodyClicked",l.body,this),e=p.windowWidth()-this._width-10,n=(n=(t=p.windowHeight()-this._height-10)<n?t:n)<0?0:n,s.left=(i=(i=e<i?e:i)<0?0:i)+gt.scrollLeft()+this._xOffset+"px",s.top=n+gt.scrollTop()+this._yOffset+"px",l.body.appendChild(o))},_showMenuItem:function(t,e){this._hideMenuItem(e);var i=l.createElement("div"),n=(e.menuItem.childrenDiv=i).style;n.color="#000000",n.position="absolute";var o,s,r,a=this._width,h=e.offsetTop,c=e.menuItem.items;this._itemsShow=!0,e._itemsShow=!0,p.clear(i),this.renderMenu(i,c),0!==this._height&&(o=p.windowWidth()-this._width-10,s=p.windowHeight()-10,a=(r=this._getPosition(this._view)).left+this._width>o?-this._width:a,h=r.top+h+c.length*this._menuItemHeight>s?h-(c.length-1)*this._menuItemHeight:h,n.left=a+"px",n.top=h+"px",e.appendChild(i))},hide:function(){l.body.contains(this._view)&&l.body.removeChild(this._view),delete this._mouseOver,delete this._itemsShow,u.isTouchable&&p.removeEventListener("touchstart",l.body,this),p.removeEventListener("mousedown",l.body,this)},_hideMenuItem:function(t){var e=t.menuItem.childrenDiv;e&&t.contains(e)&&t.removeChild(e),this._itemsShow=!1,t._itemsShow=!1},dispose:function(){this._removeContextmenuListener(),this.hide()},onMenuShowing:function(t){return!0},onAction:function(t){},renderMenu:function(t,e){var i=t.style;i.background=this._background,i.border=this._border,i.width=this._width+"px",this._height=0,delete this._separator;for(var n=0,o=(t.menuItems=e).length;n<o;n++){var s,r=e[n];this.isVisible(r)&&(!0===r.separator?this._separator=!0:(s=l.createElement("div"),this.isEnabled(r)&&this._addMouseoverListener(s,r),s._itemsShow=!1,s.menuItem=r,t.appendChild(s),this.renderMenuItem(s,r),this.onMenuItemRendered(s,r),this._separator=!1,this._height+=this._menuItemHeight))}},renderMenuItem:function(t,e){var i=t.style;i.height=this._menuItemHeight+"px",this._separator&&(i.borderTop="1px solid gray"),this.isEnabled(e)||(i.color=this._disabledColor);var n,s=l.createElement("span");(i=s.style).position="absolute",i.width="25px",i.height=this._menuItemHeight+"px",i.lineHeight=this._menuItemHeight+"px",i.textAlign="center",t.appendChild(s),"check"===e.type?n=e.selected?this._checkboxSelectedIcon:this._checkboxUnselectedIcon:"radio"===e.type?n=e.selected?this._radiobuttonSelectedIcon:this._radiobuttonUnselectedIcon:e.icon&&(n=e.icon),n&&((r=new c).src=o.getImageSrc(n),r.style.verticalAlign="middle",s.appendChild(r));var r=l.createElement("label");o.setText(r,e.label,!0),(i=r.style).position="absolute",i.height=this._menuItemHeight+"px",i.lineHeight=this._menuItemHeight+"px",i.left="25px",t.appendChild(r),e.items&&t.parentNode&&(i=(r=l.createElement("img")).style,this.isEnabled(e)?r.setAttribute("src",o.getImageSrc(this._subMenuEnableIcon)):r.setAttribute("src",o.getImageSrc(this._subMenuDisableIcon)),e=(this._menuItemHeight-8)/2,i.marginTop=e+"px",i.right="5px",i.position="absolute",t.appendChild(r))},onMenuItemRendered:function(t,e){},_addMouseoverListener:function(t,e){var i=this;this._contextView,u.isTouchable&&(t.addEventListener("touchstart",function(n){t.style.background=i._focusBackground,t.style.color=i._focusColor,this===n.relatedTarget||this.contains(n.relatedTarget)||e.items&&!i._itemsShow&&t.parentNode==i._view&&i._showMenuItem(n,t)},!1),t.addEventListener("touchend",function(n){var o,s,r;t.style.background=i._background,t.style.color=i._color,this===n.relatedTarget||this.contains(n.relatedTarget)||e.items&&t.parentNode===i._view&&(o=n.clientX,s=n.clientY,r=e.childrenDiv,(o<(n=i._getPosition(r)).left+2||o>n.left+r.offsetWidth-2||s<n.top+2||s>n.top+r.offsetHeight-2)&&i._hideMenuItem(t))},!1)),t.addEventListener("mouseenter",function(n){t.style.background=i._focusBackground,t.style.color=i._focusColor,this===n.relatedTarget||this.contains(n.relatedTarget)||e.items&&!this._itemsShow&&this.parentNode&&i._showMenuItem(n,this)},!1),t.addEventListener("mouseleave",function(t){var n,o,s;this.style.background=i._background,this.style.color=i._color,this===t.relatedTarget||this.contains(t.relatedTarget)||e.items&&this.parentNode&&(n=t.clientX,o=t.clientY,s=e.childrenDiv,(n<(t=i._getPosition(s)).left+2||n>t.left+s.offsetWidth-2||o<t.top+2||o>t.top+s.offsetHeight-2)&&i._hideMenuItem(this))},!1)},_getPosition:function(t){for(var e=0,i=0;t;)i+=t.offsetLeft,e+=t.offsetTop,t=t.offsetParent;return{left:i,top:e}},_removeContextmenuListener:function(){var t=this._contextView;t&&(t=t.getView?t.getView():t,u.isTouchable&&(t.removeEventListener("touchstart",this._getTouchStartListener(),!1),t.removeEventListener("touchmove",this._getTouchMoveListener(),!1),t.removeEventListener("touchend",this._getTouchEndListener(),!1)),p.removeEventListener("contextmenu",t,this))},_handleContextmenu:function(t){!0===this.onMenuShowing(t)&&this.show(t),t.preventDefault()},_handleBodyClicked:function(t){if(u.isTouchable){for(var e=t.target;e&&e!==this._view;)e=e.parentElement;e!==this._view&&this.hide()}else this._mouseOver||this.hide()},_handleClick:function(t){if(0===t.button){for(var e=t.target;!e.menuItem&&e.parentElement;)e=e.parentElement;var i=e?e.menuItem:null;i&&this.isEnabled(i)&&("check"===i.type&&(i.selected=!i.selected),"radio"===i.type&&(i.groupName?(i.selected=!0,this._items.forEach(function(t){i!==t&&t.groupName===i.groupName&&(t.selected=!1),t.items&&t.items.forEach(function(t){i!==t&&t.groupName===i.groupName&&(t.selected=!1)})})):i.selected=!i.selected),i.action&&i.action(i),this.onAction(i),i.items&&0<i.items.length||this.hide())}},_getTouchStartListener:function(){var t;return this._touchStartListener||((t=this)._touchStartListener=function(e){t._touchMoved=!1,t._lastTouch=new Date}),this._touchStartListener},_getTouchMoveListener:function(){var t;return this._touchMoveListener||((t=this)._touchMoveListener=function(e){t._touchMoved=!0}),this._touchMoveListener},_getTouchEndListener:function(){var t;return this._touchEndListener||((t=this)._touchEndListener=function(e){!t._touchMoved&&1e3<(new Date).getTime()-t._lastTouch.getTime()&&t._handleContextmenu(e)}),this._touchEndListener},getWidth:function(){return this._width},setWidth:function(t){this._width=t},getMenuItemHeight:function(){return this._menuItemHeight},setMenuItemHeight:function(t){this._menuItemHeight=t},getBackground:function(){return this._background},setBackground:function(t){this._background=t},getBorder:function(){return this._border},setBorder:function(t){this._border=t},getDisabledColor:function(){return this._disabledColor},setDisabledColor:function(t){this._disabledColor=t},getFocusColor:function(){return this._focusColor},setFocusColor:function(t){this._focusColor=t},getFocusBackground:function(){return this._focusBackground},setFocusBackground:function(t){this._focusBackground=t},getColor:function(){return this._color},setColor:function(t){this._color=t},getSubMenuEnableIcon:function(){return this._subMenuEnableIcon},setSubMenuEnableIcon:function(t){this._subMenuEnableIcon=t},getSubMenuDisableIcon:function(){return this._subMenuDisableIcon},setSubMenuDisableIcon:function(t){this._subMenuDisableIcon=t},getCheckboxSelectedIcon:function(){return this._checkboxSelectedIcon},setCheckboxSelectedIcon:function(t){this._checkboxSelectedIcon=t},getCheckboxUnselectedIcon:function(){return this._checkboxUnselectedIcon},setCheckboxUnselectedIcon:function(t){this._checkboxUnselectedIcon=t},getRadiobuttonSelectedIcon:function(){return this._radiobuttonSelectedIcon},setRadiobuttonSelectedIcon:function(t){this._radiobuttonSelectedIcon=t},getRadiobuttonUnselectedIcon:function(){return this._radiobuttonUnselectedIcon},setRadiobuttonUnselectedIcon:function(t){this._radiobuttonUnselectedIcon=t},getXOffset:function(){return this._xOffset},setXOffset:function(t){this._xOffset=t},getYOffset:function(){return this._yOffset},setYOffset:function(t){this._yOffset=t}});h=function(t,e){o.registerImage(t,e),Se[t]=1};var Se={};h("node_image",{w:32,h:24,origin:{x:0,y:0},v:[{shape:"path",data:"M32,23.5c0,0.276-0.224,0.5-0.5,0.5h-31C0.224,24,0,23.776,0,23.5v-2C0,21.224,0.224,21,0.5,21h31  c0.276,0,0.5,0.224,0.5,0.5V23.5z",gradient:{id:"SVGID_1_",type:"linear",x1:"15.9995",y1:"21",x2:"15.9995",y2:"24",stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"path",data:"M15,22.3c0-0.165-0.134-0.3-0.3-0.3H3.3C3.134,22,3,22.135,3,22.3V24h12V22.3z",gradient:{id:"SVGID_2_",type:"linear",x1:"9",y1:"22",x2:"9",y2:"25",stop:[{offset:"0",color:"#69B4A5"},{offset:"0.1",color:"#61AD9C"}]}},{shape:"path",data:"M31,20H1V1c0-0.553,0.448-1,1-1h28c0.553,0,1,0.447,1,1V20z",gradient:{id:"SVGID_3_",type:"linear",x1:"15.9995",y1:"-0.1221",x2:"15.9995",y2:"19.9471",stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:2,y:1,w:28,h:18,fill:"#FFFFFF"},{shape:"rect",x:3,y:2,w:26,h:16,gradient:{id:"SVGID_4_",type:"linear",x1:"15.9995",y1:"2.0654",x2:"15.9995",y2:"17.3835",stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#0089C1"}]}},{shape:"path",data:"9.649,17.034 6.815,17.034 9.935,2.966 12.768,2.966 z",fill:"#FFFFFF"},{shape:"path",data:"12.065,17.034 10.815,17.034 13.935,2.966 15.185,2.966 z",fill:"#FFFFFF"},{shape:"path",data:"14.065,17.034 13.315,17.034 16.435,2.966 17.185,2.966 z",fill:"#FFFFFF"}]}),h("group_image",{w:32,h:24,origin:{x:0,y:0},v:[{shape:"path",data:"M32,16.5c0,0.276-0.224,0.5-0.5,0.5h-24C7.224,17,7,16.776,7,16.5v-1C7,15.224,7.224,15,7.5,15h24   c0.276,0,0.5,0.224,0.5,0.5V16.5z",gradient:{id:"SVGID_1_",type:"linear",x1:"19.5",y1:"15",x2:"19.5",y2:"17",stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"path",data:"M19,16.5c0-0.277-0.224-0.5-0.5-0.5h-8c-0.276,0-0.5,0.223-0.5,0.5V17h9V16.5z",gradient:{id:"SVGID_2_",type:"linear",x1:"14.4995",y1:"15.9209",x2:"14.4995",y2:"17.0459",stop:[{offset:"0",color:"#58AC9A"},{offset:"1",color:"#248576"}]}},{shape:"path",data:"M31,14H8V1c0-0.553,0.448-1,1-1h21c0.553,0,1,0.447,1,1V14z",gradient:{id:"SVGID_3_",type:"linear",x1:"19.5",y1:"0",x2:"19.5",y2:"14.0005",stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:9,y:1,w:21,h:12,fill:"#FFFFFF"},{shape:"rect",x:10,y:2,w:19,h:10,gradient:{id:"SVGID_4_",type:"linear",x1:"19.5",y1:"1.9619",x2:"19.5",y2:"11.9744",stop:[{offset:"0",color:"#58AC9A"},{offset:"1",color:"#248576"}]}},{shape:"path",data:"M25,23.5c0,0.276-0.224,0.5-0.5,0.5h-24C0.224,24,0,23.776,0,23.5v-1C0,22.224,0.224,22,0.5,22h24   c0.276,0,0.5,0.224,0.5,0.5V23.5z",gradient:{id:"SVGID_5_",type:"linear",x1:"12.4995",y1:"22",x2:"12.4995",y2:"24",stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"path",data:"M12,23.5c0-0.277-0.224-0.5-0.5-0.5h-8C3.224,23,3,23.223,3,23.5V24h9V23.5z",gradient:{id:"SVGID_6_",type:"linear",x1:"7.5",y1:"22.9209",x2:"7.5",y2:"24.0459",stop:[{offset:"0",color:"#58AC9A"},{offset:"1",color:"#248576"}]}},{shape:"path",data:"M24,21H1V8c0-0.553,0.448-1,1-1h21c0.553,0,1,0.447,1,1V21z",gradient:{id:"SVGID_7_",type:"linear",x1:"12.4995",y1:"7",x2:"12.4995",y2:"21.0005",stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:2,y:8,w:21,h:12,fill:"#FFFFFF"},{shape:"rect",x:3,y:9,w:19,h:10,gradient:{id:"SVGID_8_",type:"linear",x1:"12.4995",y1:"8.9619",x2:"12.4995",y2:"18.9749",stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#0089C1"}]}}]}),h("subnetwork_image",{w:32,h:24,origin:{x:0,y:0},v:[{shape:"path",data:"M32,14.499c0,0.276-0.224,0.5-0.5,0.5h-20c-0.276,0-0.5-0.224-0.5-0.5v-1c0-0.276,0.224-0.5,0.5-0.5  h20c0.276,0,0.5,0.224,0.5,0.5V14.499z",gradient:{id:"SVGID_1_",type:"linear",x1:21.5,y1:12.999,x2:21.5,y2:14.9995,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"path",data:"M22,14.499c0-0.277-0.224-0.5-0.5-0.5h-7c-0.276,0-0.5,0.223-0.5,0.5v0.5h8V14.499z",gradient:{id:"SVGID_2_",type:"linear",x1:18,y1:13.9199,x2:18,y2:15.0449,stop:[{offset:"0",color:"#58AC9A"},{offset:"1",color:"#248576"}]}},{shape:"path",data:"M31,11.499c0,0.276-0.224,0.5-0.5,0.5h-18c-0.276,0-0.5-0.224-0.5-0.5v-11c0-0.276,0.224-0.5,0.5-0.5  h18c0.276,0,0.5,0.224,0.5,0.5V11.499z",gradient:{id:"SVGID_3_",type:"linear",x1:21.5,y1:-.9502,x2:21.5,y2:12.5498,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:13,y:.999,w:17,h:10,fill:"#FFFFFF"},{shape:"rect",x:14,y:1.999,w:15,h:8,gradient:{id:"SVGID_4_",type:"linear",x1:21.5,y1:1.9312,x2:21.5,y2:9.6537,stop:[{offset:"0",color:"#58AC9A"},{offset:"1",color:"#248576"}]}},{shape:"path",data:"M21,23.5c0,0.276-0.224,0.5-0.5,0.5h-20C0.224,24,0,23.776,0,23.5v-1C0,22.224,0.224,22,0.5,22h20  c0.276,0,0.5,0.224,0.5,0.5V23.5z",gradient:{id:"SVGID_5_",type:"linear",x1:10.4995,y1:22,x2:10.4995,y2:24,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:22,y:20.5,w:3,h:1.999,gradient:{id:"SVGID_6_",type:"linear",x1:-464.9424,y1:-722.2754,x2:-462.9424,y2:-722.2754,stop:[{offset:"0",color:"#58AC9A"},{offset:"1",color:"#248576"}]}},{shape:"rect",x:28,y:16,w:2,h:3,gradient:{id:"SVGID_7_",type:"linear",x1:29,y1:16,x2:29,y2:19,stop:[{offset:"0",color:"#58AC9A"},{offset:"1",color:"#248576"}]}},{shape:"path",data:"M11,23.5c0-0.277-0.224-0.5-0.5-0.5h-7C3.224,23,3,23.223,3,23.5V24h8V23.5z",gradient:{id:"SVGID_8_",type:"linear",x1:7,y1:22.9209,x2:7,y2:24.0459,stop:[{offset:"0",color:"#58AC9A"},{offset:"1",color:"#248576"}]}},{shape:"path",data:"M20,20.5c0,0.276-0.224,0.5-0.5,0.5h-18C1.224,21,1,20.776,1,20.5v-11C1,9.224,1.224,9,1.5,9h18  C19.776,9,20,9.224,20,9.5V20.5z",gradient:{id:"SVGID_9_",type:"linear",x1:10.4995,y1:8.0508,x2:10.4995,y2:21.5513,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:2,y:10,w:17,h:10,fill:"#FFFFFF"},{shape:"rect",x:3,y:11,w:15,h:8,gradient:{id:"SVGID_10_",type:"linear",x1:10.4995,y1:10.9321,x2:10.4995,y2:18.6551,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#0089C1"}]}},{shape:"path",data:"M32,22.7c0,0.165-0.135,0.3-0.301,0.3h-5.4C26.134,23,26,22.865,26,22.7v-2.4  c0-0.165,0.134-0.3,0.299-0.3h5.4C31.865,20,32,20.135,32,20.3V22.7z",gradient:{id:"SVGID_11_",type:"linear",x1:29,y1:20,x2:29,y2:23,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}}]}),h("bus_icon",{w:16,h:16,origin:{x:0,y:0},v:[{shape:"rect",x:4,y:6,w:1,h:1,fill:"#232424"},{shape:"path",data:"M7,4c0,0.552-0.448,1-1,1H3C2.448,5,2,4.552,2,4V3c0-0.552,0.448-1,1-1h3c0.552,0,1,0.448,1,1V4z",gradient:{id:"SVGID_1_",type:"linear",x1:4.5,y1:2,x2:4.5,y2:5,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:3,y:3,w:3,h:1,fill:"#232424"},{shape:"rect",x:3,y:3,w:3,h:1,fill:"#FFFFFF"},{shape:"path",data:"M6,5.5C6,5.776,5.776,6,5.5,6h-2C3.224,6,3,5.776,3,5.5l0,0C3,5.224,3.224,5,3.5,5h2  C5.776,5,6,5.224,6,5.5L6,5.5z",gradient:{id:"SVGID_2_",type:"linear",x1:4.5,y1:6,x2:4.5,y2:5,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"rect",x:12,y:6,w:1,h:1,fill:"#232424"},{shape:"path",data:"M15,4c0,0.552-0.447,1-1,1h-3c-0.553,0-1-0.448-1-1V3c0-0.552,0.447-1,1-1h3c0.553,0,1,0.448,1,1V4z",gradient:{id:"SVGID_3_",type:"linear",x1:12.5,y1:2,x2:12.5,y2:5,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:11,y:3,w:3,h:1,fill:"#232424"},{shape:"rect",x:11,y:3,w:3,h:1,fill:"#FFFFFF"},{shape:"path",data:"M14,5.5C14,5.776,13.777,6,13.5,6h-2C11.225,6,11,5.776,11,5.5l0,0C11,5.224,11.225,5,11.5,5h2  C13.777,5,14,5.224,14,5.5L14,5.5z",gradient:{id:"SVGID_4_",type:"linear",x1:12.5,y1:6,x2:12.5,y2:5,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"rect",x:8,y:10,w:1,h:1,fill:"#232424"},{shape:"path",data:"M6,13c0-0.553,0.448-1,1-1h3c0.553,0,1,0.447,1,1v1c0,0.553-0.447,1-1,1H7c-0.552,0-1-0.447-1-1V13z",gradient:{id:"SVGID_5_",type:"linear",x1:-1428.3853,y1:-571.5747,x2:-1428.3853,y2:-568.5747,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:7,y:13,w:3,h:1,fill:"#232424"},{shape:"rect",x:7,y:13,w:3,h:1,fill:"#FFFFFF"},{shape:"path",data:"M7,11.5C7,11.223,7.224,11,7.5,11h2c0.277,0,0.5,0.223,0.5,0.5l0,0c0,0.275-0.223,0.5-0.5,0.5h-2  C7.224,12,7,11.775,7,11.5L7,11.5z",gradient:{id:"SVGID_6_",type:"linear",x1:-1428.3862,y1:-567.5737,x2:-1428.3862,y2:-568.5737,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"path",data:"M15,7.5C15,7.776,14.777,8,14.5,8h-12C2.224,8,2,7.776,2,7.5l0,0C2,7.224,2.224,7,2.5,7h12  C14.777,7,15,7.224,15,7.5L15,7.5z",gradient:{id:"SVGID_7_",type:"linear",x1:8.4995,y1:6.1152,x2:8.4995,y2:7.5558,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"path",data:"M15,9.5c0,0.275-0.223,0.5-0.5,0.5h-12C2.224,10,2,9.775,2,9.5l0,0C2,9.223,2.224,9,2.5,9h12  C14.777,9,15,9.223,15,9.5L15,9.5z",gradient:{id:"SVGID_8_",type:"linear",x1:8.4995,y1:8.1147,x2:8.4995,y2:9.556,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}}]}),h("data_icon",{w:16,h:16,origin:{x:0,y:0},v:[{shape:"path",data:"M15,12c0,0.553-0.447,1-1,1H7c-0.552,0-1-0.447-1-1V8c0-0.552,0.448-1,1-1h7c0.553,0,1,0.448,1,1V12   z",gradient:{id:"SVGID_1_",type:"linear",x1:10.5,y1:6.959,x2:10.5,y2:12.2259,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:7,y:8,w:7,h:4,fill:"#FFFFFF"},{shape:"rect",x:8,y:9,w:5,h:2,gradient:{id:"SVGID_2_",type:"linear",x1:10.5,y1:8.6997,x2:10.5,y2:11.0333,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"path",data:"M15,14.5c0,0.275-0.225,0.5-0.5,0.5h-8C6.224,15,6,14.775,6,14.5l0,0C6,14.223,6.224,14,6.5,14h8   C14.775,14,15,14.223,15,14.5L15,14.5z",gradient:{id:"SVGID_3_",type:"linear",x1:10.5,y1:13.125,x2:10.5,y2:14.5518,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:8,y:14,w:1,h:1,gradient:{id:"SVGID_4_",type:"linear",x1:8.4995,y1:14.0049,x2:8.4995,y2:14.9471,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"path",data:"M12,4H6c0,0-0.152-0.275-0.5-1C5.021,2,5.021,2,4,2C3.057,2,2,2,2,2C1.448,2,1,2.448,1,3v8  c0,0.553,0.448,1,1,1h3v-1H2V3h2.387l1.024,1.998L12,5v1h1V5C13,4.448,12.553,4,12,4z",gradient:{id:"SVGID_5_",type:"linear",x1:6.9995,y1:2.0527,x2:6.9995,y2:11.4757,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"path",data:"M12,5L5.411,4.998L4.387,3H2v8h3v-0.645V7.254V7c0-0.552,0.448-1,1-1h0.324h3.032H12V5z",gradient:{id:"SVGID_6_",type:"linear",x1:6.9995,y1:2.9902,x2:6.9995,y2:11.0032,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}}]}),h("grid_icon",{w:16,h:16,origin:{x:0,y:0},v:[{shape:"path",data:"M15,14c0,0.553-0.447,1-1,1H3c-0.552,0-1-0.447-1-1V3c0-0.552,0.448-1,1-1h11c0.553,0,1,0.448,1,1V14  z",gradient:{id:"SVGID_1_",type:"linear",x1:8.4995,y1:2.1255,x2:8.4995,y2:14.909,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:3,y:3,w:11,h:11,fill:"#FFFFFF"},{shape:"rect",x:3,y:5,w:11,h:1,gradient:{id:"SVGID_2_",type:"linear",x1:8.4995,y1:3.209,x2:8.4995,y2:13.8043,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"rect",x:3,y:8,w:11,h:1,gradient:{id:"SVGID_3_",type:"linear",x1:8.4995,y1:3.209,x2:8.4995,y2:13.8043,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"rect",x:3,y:11,w:11,h:1,gradient:{id:"SVGID_4_",type:"linear",x1:8.4995,y1:3.2095,x2:8.4995,y2:13.8048,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"rect",x:11,y:3,w:1,h:11,gradient:{id:"SVGID_5_",type:"linear",x1:11.5,y1:3.209,x2:11.5,y2:13.8048,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"rect",x:8,y:3,w:1,h:11,gradient:{id:"SVGID_6_",type:"linear",x1:8.4995,y1:3.209,x2:8.4995,y2:13.8048,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"rect",x:5,y:3,w:1,h:11,gradient:{id:"SVGID_7_",type:"linear",x1:5.5,y1:3.209,x2:5.5,y2:13.8048,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}}]}),h("databox_icon",{w:16,h:16,origin:{x:0,y:0},v:[{shape:"path",data:"M14.5,6h-12H2v0.5v7C2,13.776,2.224,14,2.5,14h12c0.276,0,0.5-0.224,0.5-0.5v-7V6H14.5z",gradient:{id:"SVGID_1_",type:"linear",x1:8.4995,y1:6.0625,x2:8.4995,y2:14.063,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"path",data:"M14.776,5.553l-1.553-3.105C13.101,2.201,12.775,2,12.5,2h-8C4.225,2,3.899,2.201,3.776,2.447  L2.224,5.553L2,6h0.5h12H15L14.776,5.553z",gradient:{id:"SVGID_2_",type:"linear",x1:8.5005,y1:3.104,x2:8.5005,y2:-5.6467,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"path",data:"12,2 9.5,2 7.5,2 5,2 3,6 7.5,6 9.5,6 14,6 z",gradient:{id:"SVGID_3_",type:"linear",x1:8.5005,y1:9.2295,x2:8.5005,y2:5.4586,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"path",data:"M11.5,9c0,0.276-0.224,0.5-0.5,0.5H6C5.724,9.5,5.5,9.276,5.5,9l0,0c0-0.276,0.224-0.5,0.5-0.5h5  C11.276,8.5,11.5,8.724,11.5,9L11.5,9z",fill:"#FFFFFF"}]}),h("group_icon",{w:16,h:16,origin:{x:0,y:0},v:[{shape:"path",data:"M15,8.5C15,8.776,14.776,9,14.5,9h-10C4.224,9,4,8.776,4,8.5v-7C4,1.224,4.224,1,4.5,1h10    C14.776,1,15,1.224,15,1.5V8.5z",gradient:{id:"SVGID_1_",type:"linear",x1:9.5,y1:.9512,x2:9.5,y2:8.9787,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:5,y:2,w:9,h:6,fill:"#FFFFFF"},{shape:"rect",x:6,y:3,w:7,h:4,gradient:{id:"SVGID_2_",type:"linear",x1:9.5,y1:3.02,x2:9.5,y2:6.9606,stop:[{offset:"0",color:"#58AC9A"},{offset:"1",color:"#248576"}]}},{shape:"path",data:"M16,10.5c0,0.276-0.224,0.5-0.5,0.5h-12C3.224,11,3,10.776,3,10.5l0,0C3,10.224,3.224,10,3.5,10h12    C15.776,10,16,10.224,16,10.5L16,10.5z",gradient:{id:"SVGID_3_",type:"linear",x1:9.5,y1:9.9941,x2:9.5,y2:10.9976,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:6,y:10.001,w:2,h:.999,gradient:{id:"SVGID_4_",type:"linear",x1:7,y1:10.0059,x2:7,y2:10.9472,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"path",data:"M12,12.5c0,0.276-0.224,0.5-0.5,0.5h-10C1.224,13,1,12.776,1,12.5v-7C1,5.224,1.224,5,1.5,5h10    C11.776,5,12,5.224,12,5.5V12.5z",gradient:{id:"SVGID_5_",type:"linear",x1:6.4995,y1:4.9512,x2:6.4995,y2:12.9792,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:2,y:6,w:9,h:6,fill:"#FFFFFF"},{shape:"rect",x:3,y:7,w:7,h:4,gradient:{id:"SVGID_6_",type:"linear",x1:6.4995,y1:7.02,x2:6.4995,y2:10.9611,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"path",data:"M13,14.5c0,0.276-0.224,0.5-0.5,0.5h-12C0.224,15,0,14.776,0,14.5l0,0C0,14.224,0.224,14,0.5,14h12    C12.776,14,13,14.224,13,14.5L13,14.5z",gradient:{id:"SVGID_7_",type:"linear",x1:6.4995,y1:13.9941,x2:6.4995,y2:14.9976,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:3,y:14.001,w:2,h:.999,gradient:{id:"SVGID_8_",type:"linear",x1:4,y1:14.0059,x2:4,y2:14.9472,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}}]}),h("link_icon",{w:16,h:16,origin:{x:0,y:0},v:[{shape:"line",p1:{x:2.5,y:2.5},p2:{x:13.5,y:13.5},lineColor:"url(#SVGID_1_)",lineWidth:1},{shape:"ellipse",cx:13,cy:13,rx:2,ry:2,gradient:{id:"SVGID_2_",type:"linear",x1:11.5371,y1:11.5371,x2:14.2155,y2:14.2155,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"ellipse",cx:13,cy:13,rx:1,ry:1,fill:"#FFFFFF"},{shape:"ellipse",cx:3,cy:3,rx:2,ry:2,gradient:{id:"SVGID_3_",type:"linear",x1:1.4956,y1:1.4956,x2:4.1473,y2:4.1473,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"ellipse",cx:3,cy:3,rx:1,ry:1,fill:"#FFFFFF"}]}),h("linksubnetwork_icon",{w:16,h:16,origin:{x:0,y:0},v:[{shape:"path",data:"M15,7.661c0-1.202-0.642-2.247-1.596-2.835C12.848,3.188,11.314,2,9.486,2  c-1.587,0-2.95,0.902-3.649,2.211C4.573,4.22,3.548,5.194,3.438,6.432C3.389,6.429,3.342,6.417,3.292,6.417  C2.026,6.417,1,7.443,1,8.708C1,9.975,2.026,11,3.292,11h8.371l0,0C13.506,11,15,9.506,15,7.661z",gradient:{id:"SVGID_1_",type:"linear",x1:7.9995,y1:1.959,x2:7.9995,y2:11.0921,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"path",data:"M3.292,10C2.58,10,2,9.42,2,8.708c0-0.712,0.58-1.292,1.292-1.292C3.286,7.422,3.332,7.427,3.379,7.43  l0.969,0.058L4.435,6.52C4.5,5.779,5.106,5.216,5.844,5.211l0.595-0.004l0.28-0.524C7.273,3.645,8.334,3,9.486,3  c1.342,0,2.535,0.863,2.971,2.147l0.116,0.341l0.307,0.189C13.581,6.11,14,6.851,14,7.661C14,8.951,12.951,10,11.661,10H3.292z",fill:"#FFFFFF"},{shape:"path",data:"M3.292,10h8.37c1.11,0,2.04-0.781,2.276-1.821c-0.131-0.615-0.5-1.158-1.058-1.501l-0.307-0.189  l-0.116-0.341C12.021,4.863,10.828,4,9.486,4C8.334,4,7.273,4.645,6.719,5.682l-0.28,0.524L5.844,6.211  C5.106,6.216,4.5,6.779,4.435,7.52L4.349,8.487L3.379,8.43C3.332,8.427,3.286,8.422,3.292,8.417c-0.535,0-0.994,0.328-1.19,0.792  C2.297,9.672,2.757,10,3.292,10z",gradient:{id:"SVGID_2_",type:"linear",x1:8.019,y1:4.084,x2:8.019,y2:9.8062,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"line",p1:{x:8.01,y:8.01},p2:{x:13.186,y:13.186},lineColor:"url(#SVGID_3_)",lineWidth:1},{shape:"ellipse",cx:8,cy:8,rx:2,ry:2,gradient:{id:"SVGID_4_",type:"linear",x1:6.7881,y1:6.7881,x2:9.9924,y2:9.9924,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"ellipse",cx:8,cy:8,rx:1,ry:1,fill:"#FFFFFF"},{shape:"ellipse",cx:13,cy:13,rx:2,ry:2,gradient:{id:"SVGID_5_",type:"linear",x1:11.5791,y1:11.5791,x2:14.3132,y2:14.3132,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"ellipse",cx:13,cy:13,rx:1,ry:1,fill:"#FFFFFF"}]}),h("node_icon",{w:16,h:16,origin:{x:0,y:0},v:[{shape:"path",data:"M15,11.5c0,0.276-0.224,0.5-0.5,0.5h-13C1.224,12,1,11.776,1,11.5v-9C1,2.224,1.224,2,1.5,2h13  C14.776,2,15,2.224,15,2.5V11.5z",gradient:{id:"SVGID_1_",type:"linear",x1:7.9995,y1:1.939,x2:7.9995,y2:11.9739,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:2,y:3,w:12,h:8,fill:"#FFFFFF"},{shape:"rect",x:3,y:4,w:10,h:6,gradient:{id:"SVGID_2_",type:"linear",x1:7.9995,y1:4.0513,x2:7.9995,y2:9.865,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"path",data:"M16,14.5c0,0.276-0.224,0.5-0.5,0.5h-15C0.224,15,0,14.776,0,14.5v-1C0,13.224,0.224,13,0.5,13h15  c0.276,0,0.5,0.224,0.5,0.5V14.5z",gradient:{id:"SVGID_3_",type:"linear",x1:7.9995,y1:13.0508,x2:7.9995,y2:14.9258,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"path",data:"M9,14.5C9,14.224,8.776,14,8.5,14h-5C3.224,14,3,14.224,3,14.5V15h6V14.5z",gradient:{id:"SVGID_4_",type:"linear",x1:5.9995,y1:14.0508,x2:5.9995,y2:15.9258,stop:[{offset:"0",color:"#69B4A5"},{offset:"0.1",color:"#61AD9C"},{offset:"0.4637",color:"#449981"},{offset:"0.7764",color:"#2C8E73"},{offset:"1",color:"#218A6E"}]}}]}),h("shapelink_icon",{w:16,h:16,origin:{x:0,y:0},v:[{shape:"line",p1:{x:7.5,y:2.5},p2:{x:2.5,y:7.5},lineColor:"url(#SVGID_1_)",lineWidth:1},{shape:"line",p1:{x:2.5,y:7.5},p2:{x:8.5,y:13.5},lineColor:"url(#SVGID_2_)",lineWidth:1},{shape:"line",p1:{x:9,y:13.186},p2:{x:13.5,y:6.5},lineColor:"url(#SVGID_3_)",lineWidth:1},{shape:"ellipse",cx:7,cy:3,rx:2,ry:2,gradient:{id:"SVGID_4_",type:"linear",x1:5.5864,y1:1.5864,x2:8.4149,y2:4.4149,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"ellipse",cx:7,cy:3,rx:1,ry:1,fill:"#FFFFFF"},{shape:"ellipse",cx:2,cy:8,rx:2,ry:2,gradient:{id:"SVGID_5_",type:"linear",x1:.5864,y1:6.5864,x2:3.4142,y2:9.4142,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"ellipse",cx:2,cy:8,rx:1,ry:1,fill:"#FFFFFF"},{shape:"ellipse",cx:8,cy:13,rx:2,ry:2,gradient:{id:"SVGID_6_",type:"linear",x1:6.5869,y1:11.5869,x2:9.4147,y2:14.4147,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"ellipse",cx:8,cy:13,rx:1,ry:1,fill:"#FFFFFF"},{shape:"ellipse",cx:13,cy:7,rx:2,ry:2,gradient:{id:"SVGID_7_",type:"linear",x1:11.5859,y1:5.5859,x2:14.4144,y2:8.4144,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"ellipse",cx:13,cy:7,rx:1,ry:1,fill:"#FFFFFF"}]}),h("shapenode_icon",{w:16,h:16,origin:{x:0,y:0},v:[{shape:"path",data:"M14.5,3h-9l-4,4v7h13L9,8.5L14.5,3z M12.086,13H2.5V7.414L5.914,4h6.172l-4.5,4.5L12.086,13z",gradient:{id:"SVGID_1_",type:"linear",x1:7.9995,y1:3.209,x2:7.9995,y2:13.6621,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"ellipse",cx:6,cy:3,rx:2,ry:2,gradient:{id:"SVGID_2_",type:"linear",x1:4.5859,y1:1.5859,x2:7.4151,y2:4.4151,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"ellipse",cx:6,cy:3,rx:1,ry:1,fill:"#FFFFFF"},{shape:"ellipse",cx:13,cy:3,rx:2,ry:2,gradient:{id:"SVGID_3_",type:"linear",x1:11.5869,y1:1.5864,x2:14.4153,y2:4.4149,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"ellipse",cx:13,cy:3,rx:1,ry:1,fill:"#FFFFFF"},{shape:"ellipse",cx:9,cy:8,rx:2,ry:2,gradient:{id:"SVGID_4_",type:"linear",x1:7.5864,y1:6.5864,x2:10.4149,y2:9.4149,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"ellipse",cx:9,cy:8,rx:1,ry:1,fill:"#FFFFFF"},{shape:"ellipse",cx:2,cy:7,rx:2,ry:2,gradient:{id:"SVGID_5_",type:"linear",x1:.5859,y1:5.5859,x2:3.4144,y2:8.4144,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"ellipse",cx:2,cy:7,rx:1,ry:1,fill:"#FFFFFF"},{shape:"ellipse",cx:12.825,cy:13,rx:2,ry:2,gradient:{id:"SVGID_6_",type:"linear",x1:11.4111,y1:11.5869,x2:14.2396,y2:14.4153,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"ellipse",cx:12.825,cy:13,rx:1,ry:1,fill:"#FFFFFF"}]}),h("shapesubnetwork_icon",{w:16,h:16,origin:{x:0,y:0},v:[{shape:"path",data:"M15,6.661c0-1.202-0.642-2.247-1.596-2.835C12.848,2.188,11.314,1,9.486,1  c-1.587,0-2.95,0.902-3.649,2.211C4.573,3.22,3.548,4.194,3.438,5.432C3.389,5.429,3.342,5.417,3.292,5.417  C2.026,5.417,1,6.443,1,7.708S2.026,10,3.292,10h8.371l0,0C13.506,10,15,8.505,15,6.661z",gradient:{id:"SVGID_1_",type:"linear",x1:7.9995,y1:1.3755,x2:7.9995,y2:9.733,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"path",data:"M3.292,9C2.58,9,2,8.42,2,7.708s0.58-1.292,1.292-1.292C3.286,6.422,3.332,6.427,3.379,6.43l0.969,0.058  L4.435,5.52C4.5,4.779,5.106,4.216,5.844,4.211l0.595-0.004l0.28-0.524C7.273,2.645,8.334,2,9.486,2  c1.342,0,2.535,0.863,2.971,2.147l0.116,0.341l0.307,0.189C13.581,5.11,14,5.851,14,6.661C14,7.951,12.951,9,11.661,9H3.292z",fill:"#FFFFFF"},{shape:"path",data:"M3.272,9h8.37c1.11,0,2.039-0.689,2.275-1.729c-0.131-0.615-0.499-1.249-1.057-1.593l-0.307-0.189  l-0.116-0.341C12.002,3.863,10.809,3,9.468,3C8.314,3,7.254,3.645,6.7,4.682L6.42,5.207L5.825,5.211  C5.087,5.216,4.481,5.779,4.416,6.52L4.33,7.487L3.36,7.43C3.313,7.427,3.267,7.422,3.272,7.417c-0.535,0-0.994,0.327-1.19,0.792  C2.278,8.672,2.738,9,3.272,9z",gradient:{id:"SVGID_2_",type:"linear",x1:7.9995,y1:3.459,x2:7.9995,y2:8.4597,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"path",data:"M11.516,7.102h-8l2.469,6h8.5L11.516,7.102z M5.024,8.123h5.905l1.938,3.979H6.662L5.024,8.123z",gradient:{id:"SVGID_3_",type:"linear",x1:7.4443,y1:7.1724,x2:10.1111,y2:12.8383,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"path",data:"5,8.112 10.904,8.112 12.842,12.092 6.638,12.092 z",fill:"#FFFFFF"},{shape:"ellipse",cx:5,cy:8,rx:2,ry:2,gradient:{id:"SVGID_4_",type:"linear",x1:3,y1:8,x2:7,y2:8,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"ellipse",cx:5,cy:8,rx:1,ry:1,fill:"#FFFFFF"},{shape:"ellipse",cx:12,cy:8,rx:2,ry:2,gradient:{id:"SVGID_5_",type:"linear",x1:10,y1:8,x2:14,y2:8,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"ellipse",cx:12,cy:8,rx:1,ry:1,fill:"#FFFFFF"},{shape:"ellipse",cx:7,cy:12,rx:2,ry:2,gradient:{id:"SVGID_6_",type:"linear",x1:5,y1:12,x2:9,y2:12,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"ellipse",cx:7,cy:12,rx:1,ry:1,fill:"#FFFFFF"},{shape:"ellipse",cx:14,cy:12,rx:2,ry:2,gradient:{id:"SVGID_7_",type:"linear",x1:12,y1:12,x2:16,y2:12,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"ellipse",cx:14,cy:12,rx:1,ry:1,fill:"#FFFFFF"}]}),h("subnetwork_icon",{w:16,h:16,origin:{x:0,y:0},v:[{shape:"rect",x:10,y:14.001,w:2,h:1,gradient:{id:"SVGID_1_",type:"linear",x1:11,y1:14.0059,x2:11,y2:14.9481,stop:[{offset:"0",color:"#58AC9A"},{offset:"1",color:"#248576"}]}},{shape:"rect",x:14,y:10.001,w:1,h:2,gradient:{id:"SVGID_2_",type:"linear",x1:14.5,y1:10.0117,x2:14.5,y2:11.8962,stop:[{offset:"0",color:"#58AC9A"},{offset:"1",color:"#248576"}]}},{shape:"path",data:"M16,6.001c0,0.552-0.447,1-1,1H8c-0.552,0-1-0.448-1-1v-4c0-0.552,0.448-1,1-1h7   c0.553,0,1,0.448,1,1V6.001z",gradient:{id:"SVGID_3_",type:"linear",x1:11.5,y1:.96,x2:11.5,y2:6.2265,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:8,y:2.001,w:7,h:4,fill:"#FFFFFF"},{shape:"rect",x:9,y:3.001,w:5,h:2,gradient:{id:"SVGID_4_",type:"linear",x1:11.5,y1:2.7007,x2:11.5,y2:5.0337,stop:[{offset:"0",color:"#58AC9A"},{offset:"1",color:"#248576"}]}},{shape:"path",data:"M16,8.501c0,0.276-0.225,0.5-0.5,0.5h-8c-0.276,0-0.5-0.224-0.5-0.5l0,0c0-0.276,0.224-0.5,0.5-0.5   h8C15.775,8.001,16,8.225,16,8.501L16,8.501z",gradient:{id:"SVGID_5_",type:"linear",x1:11.5,y1:7.126,x2:11.5,y2:8.5535,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:9,y:8.001,w:1,h:.999,gradient:{id:"SVGID_6_",type:"linear",x1:9.5,y1:8.0063,x2:9.5,y2:8.9477,stop:[{offset:"0",color:"#58AC9A"},{offset:"1",color:"#248576"}]}},{shape:"path",data:"M9,12c0,0.553-0.447,1-1,1H1c-0.552,0-1-0.447-1-1V8c0-0.552,0.448-1,1-1h7c0.553,0,1,0.448,1,1V12z   ",gradient:{id:"SVGID_7_",type:"linear",x1:4.4995,y1:6.959,x2:4.4995,y2:12.2259,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:1,y:8,w:7,h:4,fill:"#FFFFFF"},{shape:"rect",x:2,y:9,w:5,h:2,gradient:{id:"SVGID_8_",type:"linear",x1:4.5,y1:8.6997,x2:4.5,y2:11.0333,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"path",data:"M9,14.5C9,14.776,8.775,15,8.5,15h-8C0.224,15,0,14.776,0,14.5l0,0C0,14.224,0.224,14,0.5,14h8   C8.775,14,9,14.224,9,14.5L9,14.5z",gradient:{id:"SVGID_9_",type:"linear",x1:4.4995,y1:13.125,x2:4.4995,y2:14.5518,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}},{shape:"rect",x:2,y:14,w:1,h:1,gradient:{id:"SVGID_10_",type:"linear",x1:2.5,y1:14.0049,x2:2.5,y2:14.9471,stop:[{offset:"0",color:"#61B7D9"},{offset:"1",color:"#005EAD"}]}},{shape:"path",data:"M16,14.501c0,0.276-0.224,0.5-0.5,0.5h-2c-0.276,0-0.5-0.224-0.5-0.5v-1c0-0.276,0.224-0.5,0.5-0.5  h2c0.276,0,0.5,0.224,0.5,0.5V14.501z",gradient:{id:"SVGID_11_",type:"linear",x1:14.5,y1:13.0117,x2:14.5,y2:14.8962,stop:[{offset:"0",color:"#666767"},{offset:"1",color:"#232424"}]}}]});var ke={_hitCanvas:null,getHitCanvas:function(t,e){return null==this._hitCanvas&&(this._hitCanvas=p.createCanvas()),0==arguments.length&&(e=t=2),this._hitCanvas.setAttribute("width",""+t-1),this._hitCanvas.setAttribute("height",""+e-1),this._hitCanvas.setAttribute("width",""+t),this._hitCanvas.setAttribute("height",""+e),this.getCtx(this._hitCanvas).clearRect(0,0,t,e),this._hitCanvas},disposeHitCanvas:function(){this._hitCanvas=null},getCtx:function(t){return t.getContext("2d")},render:function(t,e,i){null!=e&&(t.fillStyle=e,t.fill()),null!=i&&(t.strokeStyle=i,t.stroke())},text:function(t,e,i,n,o,s){t.textAlign="center",t.textBaseline="middle",null!=o&&(t.fillStyle=o,t.fillText(e,i,n)),s&&(t.strokeStyle=s,t.strokeText(e,i,n))},circle:function(t,e,i,n,o,s){t.arc(e,i,n,0,2*Math.PI,!0),t.closePath(),this.render(t,o,s)},rect:function(t,e,i,n,o,s,r){t.rect(e,i,n,o),t.closePath(),this.render(t,s,r)},OUT_LEFT:1,OUT_TOP:2,OUT_RIGHT:4,OUT_BOTTOM:8,outcode:function(t,e,i,n,o,s){var r=0;return o<=0?r|=this.OUT_LEFT|this.OUT_RIGHT:t<i?r|=this.OUT_LEFT:i+o<t&&(r|=this.OUT_RIGHT),s<=0?r|=this.OUT_TOP|this.OUT_BOTTOM:e<n?r|=this.OUT_TOP:n+s<e&&(r|=this.OUT_BOTTOM),r},intersectsLine:function(t,e,i,n,o,s,r,a){var h,l,c;if(0==(l=this.outcode(i,n,o,s,r,a)))return!0;for(;0!=(h=this.outcode(t,e,o,s,r,a));){if(0!=(h&l))return!1;0!=(h&(this.OUT_LEFT|this.OUT_RIGHT))?(c=o,0!=(h&this.OUT_RIGHT)&&(c+=r),e+=(c-t)*(n-e)/(i-t),t=c):(c=s,0!=(h&this.OUT_BOTTOM)&&(c+=a),t+=(c-e)*(i-t)/(n-e),e=c)}return!0}};n.vector={},n.vector.interaction={},n.vector.Network=function(t){n.vector.Network.superClass.constructor.apply(this,arguments),this.zoomManager=new n.vector.PhysicalZoomManager(this),this._view=p.createView("hidden"),this._rootCanvas=p.createCanvas(),this._topCanvas=p.createCanvas(),this._view.appendChild(this._rootCanvas),this._view.appendChild(this._topCanvas),this.realWidth=0,this.realHeight=0,this._unionBounds={x:0,y:0,width:0,height:0},this._zoom=1,this._elementUIMap={},this._zoomMap={},this._viewRectMap={},this.viewRect={x:0,y:0,width:0,height:0},this.state={zooming:!1,panning:!1,autoLayout:!1},this.hScrollBarVisible=!1,this.vScrollBarVisible=!1,this.markerList=new n.List,this._topAttachmentList=new n.List,this._hitTestTopAttachmentList=new n.List,this.setElementBox(t||new n.ElementBox),!u.isTouchable||u.isMSTouchable?this.setDefaultInteractions(!1,!1):this.setTouchInteractions();var e=this;this._flowLink=function(){e.isMovingElement()||e.isSelectingElement()||e.isEditingElement()||e._box._layoutMovingElements||(e._flowLinkQuickFinder||(e._flowLinkQuickFinder=new n.QuickFinder(e._box,"link.flow","style")),e._flowLinkQuickFinder.find(!0).forEach(function(t){t._styleMap["link.flow.offset"]=e.getLinkFlowOffset(t),e.invalidateElementUI(t)}))},this.setToolTipEnabled(n.Defaults.NETWORK_TOOLTIP_ENABLED),this._paintAll=!0,this._dirtyRects=new at,this._invalidateMap={},this._invalidateAll=!0,e._count=0,e._invalidate=!0,function t(i){e._loopId=requestAnimationFrame(t),e._invalidate&&(e._count++,e._now=i,e.validate())}(0),n.imageUtil.addEventListener(this.invalidateElementUIs,this),p.addEventListener("mousemove","handle_mousemove",this._view,this)},o.ext("b2.vector.Network",n.controls.View,{__accessor:["selectMode","makeVisibleOnSelected","movableFunction","editPointSize","editPointFillColor","scrollBarWidth","editPointOutlineWidth","editPointOutlineColor","editLineColor","editLineWidth","resizePointSize","resizePointFillColor","resizePointOutlineWidth","resizePointOutlineColor","resizeLineColor","resizeLineWidth","rotatePointSize","rotatePointFillColor","rotatePointOffset","rotatePointOutlineWidth","rotatePointOutlineColor","rotateScaleFillColor","rotateScaleFontColor","rotateScaleWidth","rotateScaleHeight","selectOutlineColor","selectOutlineWidth","selectFillColor","lazyMoveOutlineColor","lazyMoveOutlineWidth","lazyMoveFillColor","rectSelectFilter","selectionTolerance"],__bool:["doubleClickToUpSubNetwork","doubleClickToSubNetwork","doubleClickToEmptySubNetwork","doubleClickToLinkBundle","doubleClickToGroupExpand","scrollBarVisible","limitViewInCanvas","autoValidateCanvasSize","subNetworkAnimate","lazyMoveAnimate","resizeAnimate","noAgentLinkVisible","keyboardRemoveEnabled","keyboardSelectEnabled","sendToTopOnSelected","lazyMoveFill","editingElement","rotatingElement","movingElement","selectingElement","rectSelectEnabled","limitElementInPositiveLocation","showRotateScale","transparentSelectionEnable","edgeDetect","dragToPan","wheelToZoom","asyncZoomAndViewRect","debug","zoomDivVisible","showShadowInEdit","showAttachOnChg"],_currentSubNetwork:null,_subNetworkAnimate:n.Defaults.NETWORK_SUBNETWORK_ANIMATE,_scrollBarWidth:10,_scrollBarVisible:!0,_limitViewInCanvas:!1,_autoValidateCanvasSize:!0,_makeVisibleOnSelected:n.Defaults.NETWORK_MAKE_VISIBLE_ON_SELECTED,_keyboardRemoveEnabled:n.Defaults.NETWORK_KEYBOARD_REMOVE_ENABLED,_keyboardSelectEnabled:n.Defaults.NETWORK_KEYBOARD_SELECT_ENABLED,_rectSelectEnabled:Ee.NETWORK_RECT_SELECT_ENABLED,_rectSelectFilter:null,_elementUIFunction:n.Defaults.VECTORUI_FUNCTION,_doubleClickToUpSubNetwork:n.Defaults.NETWORK_DOUBLECLICK_TO_UPSUBNETWORK,_doubleClickToSubNetwork:n.Defaults.NETWORK_DOUBLECLICK_TO_SUBNETWORK,_doubleClickToEmptySubNetwork:n.Defaults.NETWORK_DOUBLECLICK_TO_EMPTYSUBNETWORK,_doubleClickToLinkBundle:n.Defaults.NETWORK_DOUBLECLICK_TO_LINKBUNDLE,_doubleClickToGroupExpand:n.Defaults.NETWORK_DOUBLECLICK_TO_GROUPEXPAND,_selectOutlineColor:n.Defaults.NETWORK_SELECT_OUTLINE_COLOR,_selectOutlineWidth:n.Defaults.NETWORK_SELECT_OUTLINE_WIDTH,_selectFillColor:n.Defaults.NETWORK_SELECT_FILL_COLOR,_sendToTopOnSelected:n.Defaults.NETWORK_SENDTOTOP_ON_SELECTED,_lazyMoveOutlineColor:n.Defaults.NETWORK_LAZYMOVE_OUTLINE_COLOR,_lazyMoveOutlineWidth:n.Defaults.NETWORK_LAZYMOVE_OUTLINE_WIDTH,_lazyMoveFillColor:n.Defaults.NETWORK_LAZYMOVE_FILL_COLOR,_lazyMoveFill:n.Defaults.NETWORK_LAZYMOVE_FILL,_lazyMoveAnimate:n.Defaults.NETWORK_LAZYMOVE_ANIMATE,_resizePointSize:n.Defaults.NETWORK_RESIZE_POINT_SIZE,_resizePointFillColor:n.Defaults.NETWORK_RESIZE_POINT_FILL_COLOR,_resizePointOutlineColor:n.Defaults.NETWORK_RESIZE_POINT_OUTLINE_COLOR,_resizePointOutlineWidth:n.Defaults.NETWORK_RESIZE_POINT_OUTLINE_WIDTH,_resizeLineColor:n.Defaults.NETWORK_RESIZE_LINE_COLOR,_resizeLineWidth:n.Defaults.NETWORK_RESIZE_LINE_WIDTH,_resizeAnimate:n.Defaults.NETWORK_RESIZE_ANIMATE,_rotatePointSize:n.Defaults.NETWORK_ROTATE_POINT_SIZE,_rotatePointFillColor:n.Defaults.NETWORK_ROTATE_POINT_FILL_COLOR,_rotatePointOffset:n.Defaults.NETWORK_ROTATE_POINT_OFFSET,_rotatePointOutlineWidth:n.Defaults.NETWORK_ROTATE_POINT_OUTLINE_WIDTH,_rotatePointOutlineColor:n.Defaults.NETWORK_ROTATE_POINT_OUTLINE_COLOR,_rotateScaleWidth:Ee.NETWORK_ROTATE_SCALE_WIDTH,_rotateScaleHeight:Ee.NETWORK_ROTATE_SCALE_HEIGHT,_rotateScaleFillColor:Ee.NETWORK_ROTATE_SCALE_FILL_COLOR,_rotateScaleFontColor:Ee.NETWORK_ROTATE_SCALE_FONT_COLOR,_editPointSize:n.Defaults.NETWORK_EDIT_POINT_SIZE,_editPointFillColor:n.Defaults.NETWORK_EDIT_POINT_FILL_COLOR,_editPointOutlineColor:n.Defaults.NETWORK_EDIT_POINT_OUTLINE_COLOR,_editPointOutlineWidth:n.Defaults.NETWORK_EDIT_POINT_OUTLINE_WIDTH,_editLineColor:n.Defaults.NETWORK_EDIT_LINE_COLOR,_editLineWidth:n.Defaults.NETWORK_EDIT_LINE_WIDTH,_limitElementInPositiveLocation:!1,_linkFlowInterval:Ee.NETWORK_LINK_FLOW_INTERVAL,_selectionTolerance:Ee.NETWORK_SELECTION_TOLERANCE,_invalidateViewRectFlag:!1,_repaintTopFlag:!1,_invalidateCanvasSizeFlag:!1,_isEditingElement:!1,_isRotatingElement:!1,_isMovingElement:!1,_isSelectingElement:!1,_hasEditInteraction:!1,_showRotateScale:!0,_transparentSelectionEnable:n.Defaults.NETWORK_TRANSPARENT_SELECTION_ENABLE,_edgeDetect:!1,_dragToPan:!0,_wheelToZoom:!0,_asyncZoomAndViewRect:!1,_debug:!1,_zoomDivVisible:!0,_showShadowInEdit:!1,_showAttachOnChg:!0,adjustBounds:function(t){var e=!1,i=this._view.style;i.left==t.x+"px"&&i.top==t.y+"px"&&i.width==t.width+"px"&&i.height==t.height+"px"&&(e=!0),n.vector.Network.superClass.adjustBounds.apply(this,arguments),1!=e&&(i=t.width,e=t.height,this._rootCanvas.setAttribute("width",i),this._rootCanvas.setAttribute("height",e),this._topCanvas.setAttribute("width",i),this._topCanvas.setAttribute("height",e),this.setViewRect(this.viewRect.x,this.viewRect.y,i,e),void 0===n.gis&&(n.Util.makeHighRes(this._rootCanvas),n.Util.makeHighRes(this._topCanvas)),this.invalidateElementVisibility())},getLabel:function(t){return t.getStyle("network.label")||t.getName()},getLabel2:function(t){return t.getStyle("network.label")||t.getName2()},setZoomManager:function(t){var e=this.zoomManager;e!=t&&(this.zoomManager=t,this.invalidateElementVisibility(),this.invalidateCanvasSize(),this.validateCanvasSize(),this.invalidateElementUIs(),this.firePropertyChange("zoomManager",e,t))},getZoomManager:function(){return this.zoomManager},getRootCanvas:function(){return this._rootCanvas},getTopCanvas:function(){return this._topCanvas},validateImpl:function(){it.twm(this);for(var t,e,i,n=this.getElementBox().getDatas()._as,s=n.length,r={},a=this._visibleFunction,h=1===this._box._layerBox.size()?this._box._layerBox._defaultLayer:null,l=0;l<s;l++)r[(e=n[l])._id]=this.isVisible(e,a,h);var c=this.getGraphicsZoom(),d=null;c={x:this.viewRect.x/c,y:this.viewRect.y/c,width:this.viewRect.width/c,height:this.viewRect.height/c};if(this._invalidateAll){if(this._visibleMap)for(l=0;l<s;l++)r[(e=n[l])._id]!==this._visibleMap[e._id]&&(i=this._elementUIMap[e._id])&&i.invalidate();for(l=0;l<s;l++)e=n[l],(i=this._elementUIMap[e._id])&&i.validate();this._paintAll=!0}else if(this._paintAll){for(t in this._invalidateMap)(i=this._elementUIMap[t])&&i.invalidate();for(t in this._invalidateMap)(i=this._elementUIMap[t])&&i.validate()}else{for(t in this._invalidateMap)(i=this._elementUIMap[t])&&(this._dirtyRects.add(i.getZoomViewRect(!1)),i.invalidate());for(t in this._invalidateMap)(i=this._elementUIMap[t])&&(i.validate(),this._dirtyRects.add(i.getZoomViewRect(!0)))}d=this._paintAll?c:(this._dirtyRects.forEach(function(t){d=null==d?o.cloneRect(t):f.unionRect(d,t)}),d?(f.grow(d,2,2),f.intersection(d,c)):c),this._visibleMap=r,d&&this.paintRoot(d),this.validateCanvasSize(),1==this._repaintTopFlag&&(this._repaintTopFlag=!1,this.paintTopCanvas())},isLinkFlowEnabled:function(){return!!this._linkFlowEnabled},setLinkFlowEnabled:function(t){t?(this._linkFlowEnabled||(this._linkFlowEnabled=!0,this.firePropertyChange("linkFlowEnabled",!1,!0)),clearInterval(this._linkFlowTimerId),this._linkFlowTimerId=setInterval(this._flowLink,this._linkFlowInterval)):(this._linkFlowEnabled&&(this._linkFlowEnabled=!1,this.firePropertyChange("linkFlowEnabled",!0,!1)),clearInterval(this._linkFlowTimerId),delete this._linkFlowTimerId)},getLinkFlowInterval:function(){return this._linkFlowInterval},setLinkFlowInterval:function(t){var e=this._linkFlowInterval;this._linkFlowInterval=t,this.firePropertyChange("linkFlowInterval",e,t),clearInterval(this._linkFlowTimerId),this.isLinkFlowEnabled()&&(this._linkFlowTimerId=setInterval(this._flowLink,this._linkFlowInterval))},getElementBox:function(){return this._box},setElementBox:function(t){if(!t)throw"ElementBox can not be null";var e;this._box!==t&&((e=this._box)&&(e.removeDataBoxChangeListener(this.handleElementBoxChange,this),e.removeDataPropertyChangeListener(this.handleElementPropertyChange,this),e.removePropertyChangeListener(this.handleElementBoxPropertyChange,this),e.removeIndexChangeListener(this.handleIndexChange,this),e.getLayerBox().removeDataBoxChangeListener(this.handleLayerBoxChange,this),e.getLayerBox().removeDataPropertyChangeListener(this.handleLayerPropertyChange,this),e.getLayerBox().removeHierarchyChangeListener(this.handleLayerHierarchyChange,this),this._selectionModel||e.getSelectionModel().removeSelectionChangeListener(this.handleSelectionChange,this)),this._box=t,this._box.addDataBoxChangeListener(this.handleElementBoxChange,this),this._box.addDataPropertyChangeListener(this.handleElementPropertyChange,this),this._box.addPropertyChangeListener(this.handleElementBoxPropertyChange,this),this._box.addIndexChangeListener(this.handleIndexChange,this),this._box.getLayerBox().addDataBoxChangeListener(this.handleLayerBoxChange,this),this._box.getLayerBox().addDataPropertyChangeListener(this.handleLayerPropertyChange,this),this._box.getLayerBox().addHierarchyChangeListener(this.handleLayerHierarchyChange,this),this._flowLinkQuickFinder&&(this._flowLinkQuickFinder.dispose(),this._flowLinkQuickFinder=new n.QuickFinder(this._box,"link.flow","style")),this._selectionModel?this._selectionModel._setDataBox(t):this._box.getSelectionModel().addSelectionChangeListener(this.handleSelectionChange,this),this._elementUIMap={},this._box.forEach(this.createElementUI,this),this.invalidateElementVisibility(),this.invalidateCanvasSize(),this.firePropertyChange("elementBox",e,this._box))},handleElementBoxChange:function(t){var e=t.data;if("add"===t.kind)this.createElementUI(e),this.invalidateBundleLink(e);else if("remove"===t.kind){var i=this.getElementUI(e);i&&(this._dirtyRects.add(i.getZoomViewRect()),i.dispose(),delete this._elementUIMap[e.getId()]),e===this._currentSubNetwork&&null!=this._currentSubNetwork&&this._setCurrentSubNetwork(null),delete this._invalidateMap[e._id]}else if("clear"===t.kind){for(var n in this._elementUIMap)this._elementUIMap[n]&&this._elementUIMap[n].dispose&&this._elementUIMap[n].dispose();this._elementUIMap={},null!=this._currentSubNetwork&&this._setCurrentSubNetwork(null),this._paintAll=!0}else"layoutEnd"===t.kind?this.state.layouting=!1:"layouting"===t.kind&&(this.state.layouting=!0);this.invalidateElementVisibility(),this.invalidateCanvasSize()},handleElementPropertyChange:function(t){var e=t.source,i=this.getElementUI(e);i&&(this.invalidateElementUI(e),i.handlePropertyChange(t)),this.invalidateBundleLink(e),this.invalidateElementVisibility(),this.invalidateCanvasSize()},handleElementBoxPropertyChange:function(){this.invalidateElementVisibility()},handleIndexChange:function(t){this.invalidateElementVisibility()},handleLayerBoxChange:function(){this.invalidateElementVisibility()},handleLayerPropertyChange:function(t){"editable"===t.property&&this.invalidateSelectedElementUIs(!0),this.invalidateElementVisibility()},handleLayerHierarchyChange:function(){this.invalidateElementVisibility()},handleSelectionChange:function(t){var e=this.getSelectionModel().getLastData();e&&("append"!==t.kind&&"set"!==t.kind||(this.isMakeVisibleOnSelected()&&this.makeVisible(e),this.isSendToTopOnSelected()&&this.sendToTop(e))),t.datas.forEach(function(e){var i=this.getElementUI(e);i&&i.handleSelectionChange(t),this.invalidateElementUI(e)},this),this.invalidateElementVisibility()},sendToTop:function(t){if(this._box.contains(t)){for(var e=t;e._parent&&this.isVisible(e._parent)&&(e=e._parent););e!==t&&this._box.adjustElementIndex(e),this._box.adjustElementIndex(t)}},getScopeRect:function(t){var e=this.getGraphicsZoom();if(this.zoomManager,"viewsize"===t)return{x:this._unionBounds.x-this.viewRect.x,y:this._unionBounds.y-this.viewRect.y,width:this._unionBounds.width,height:this._unionBounds.height};if("viewport"===t){if(this.viewRect)return o.cloneRect(this.viewRect)}else if("rootcanvas"===t)return{x:this.viewRect.x,y:this.viewRect.y,width:(Math.abs(this.viewRect.x-this._unionBounds.x)+this._unionBounds.width)*e,height:(Math.abs(this.viewRect.y-this._unionBounds.y)+this._unionBounds.height)*e};return{x:0,y:0,width:0,height:0}},getViewRect:function(){return this.viewRect?o.cloneRect(this.viewRect):{x:0,y:0,width:0,height:0}},getCanvasSize:function(){return{width:this.realWidth,height:this.realHeight}},setViewOffSet:function(t,e){var i=this.viewRect.x,n=this.viewRect.y,o=this.viewRect.width,s=this.viewRect.height;this.setViewRect(i+t,n+e,o,s)},setViewRect:function(t,e,i,n){1==this.isLimitViewInCanvas()&&(t<0&&(t=0),i>this.realWidth?t=0:t+i>this.realWidth&&(t=this.realWidth-i),e<0&&(e=0),n>this.realHeight?e=0:e+n>this.realHeight&&(e=this.realHeight-n));var o=this.viewRect;null!=this.viewRect&&t==this.viewRect.x&&e==this.viewRect.y&&i==this.viewRect.width&&n==this.viewRect.height||(this.viewRect={x:t,y:e,width:i,height:n},this.firePropertyChange("viewRect",o,this.viewRect),this.invalidateElementVisibility(),this._paintAll=!0)},isHScrollBarVisible:function(){return this.hScrollBarVisible},setHScrollBarVisible:function(t){this.hScrollBarVisible=t},isVScrollBarVisible:function(){return this.vScrollBarVisible},setVScrollBarVisible:function(t){this.vScrollBarVisible=t},setZoomVisibilityThresholds:function(t){var e=this._visibilityThresholds;this._zoomVisibilityThresholds=t,this.firePropertyChange("zoomVisibilityThresholds",e,t),this.invalidateElementVisibility()},getZoomVisibilityThresholds:function(){return this._zoomVisibilityThresholds||{}},invalidateElementVisibility:function(){this.invalidate()},repaintTopCanvas:function(){this._repaintTopFlag||(this._repaintTopFlag=!0,this.invalidate())},invalidateCanvasSize:function(t){this._invalidateCanvasSizeFlag||(this._invalidateCanvasSizeFlag=!0,this.invalidate())},validateCanvasSize:function(){0!=this._invalidateCanvasSizeFlag&&(this._invalidateCanvasSizeFlag=!1,this._validateCanvasSize())},_validateCanvasSize:function(){if(0==this.isAutoValidateCanvasSize())return this.realWidth=0,this.realHeight=0,void(this._unionBounds={x:0,y:0,width:0,height:0});var t,e=this.getElementBox().getDatas(),i=e.size();if(0<i){for(var n=0;n<i;n++){var s=e.get(n);!this._visibleMap[s._id]||(s=this._elementUIMap[s._id])&&(t=t?f.unionRect(t,s.getZoomViewRect(!0)):o.cloneRect(s.getZoomViewRect(!0)))}null==t&&(t={x:0,y:0,width:0,height:0});var r=this.getGraphicsZoom();if(this._unionBounds={x:t.x*r,y:t.y*r,width:t.width*r,height:t.height*r},this.realWidth==(t.x+t.width)*r&&this.realHeight==(t.y+t.height)*r)return;this.realWidth=(t.x+t.width)*r,this.realHeight=(t.y+t.height)*r}else this.realWidth=0,this.realHeight=0,this._unionBounds={x:0,y:0,width:0,height:0};this.setViewRect(this.viewRect.x,this.viewRect.y,this.viewRect.width,this.viewRect.height),this.firePropertyChange("canvasSizeChange",null,this.viewRect)},getElementUI:function(t){return null==t?null:this._elementUIMap[t._id]},getUnionBounds:function(){return this._unionBounds},getZoomBodyRect:function(t){return(t=this.getElementUI(t))?t.getZoomBodyRect():null},getShapeNodeZoomPoints:function(t,e){return t._points&&(t=this.getElementUI(t))?t._getZoomPoints():null},createElementUI:function(t){var e,i=this._elementUIMap[t.getId()];return i||((i=this._elementUIFunction(this,t))||(e=(e=t.getClassName()).substr(e.indexOf(".")+1)+"UI",(e=n.vector[e])&&(i=new e(this,t))),i&&(this._elementUIMap[t.getId()]=i)),this._invalidateMap&&(this._invalidateMap[t._id]=t),i},getElementUIFunction:function(){return this._elementUIFunction},setElementUIFunction:function(t){if(!t)throw"ElementUIFunction can not be null";var e;this._elementUIFunction!==t&&(e=this._elementUIFunction,this._elementUIFunction=t,this.firePropertyChange("elementUIFunction",e,t),this._box.isEmpty()||(this._elementUIMap={},this._box.forEach(this.createElementUI,this),this.invalidateElementVisibility(),this.invalidateCanvasSize()))},invalidateElementUI:function(t,e){var i;this._invalidateAll||(this._invalidateMap[t._id]=t,this.getElementUI(t),t instanceof be&&(null!=(i=t.getAgentLinks())&&i.forEach(this.invalidateElementUI,this),(t=t.getParent())instanceof n.Group&&this.invalidateElementUI(t)),this.invalidateElementVisibility())},invalidateElementUIs:function(t){this._invalidateAll=!0,this._invalidateMap={},this._visibleMap={},this.invalidateElementVisibility(),this.invalidateCanvasSize(),this.invalidate()},invalidateSelectedElementUIs:function(t){this.getSelectionModel().getSelection().forEach(function(e){this.invalidateElementUI(e,t)},this)},invalidateBundleLink:function(t){var e;t instanceof n.Link&&t._bundleLinks&&(e=this._elementUIMap,t._bundleLinks.forEachSiblingLink(function(i){i===t||(i=e[i._id])&&i.invalidate(!1)},this))},paintRoot:function(t){var e=this._rootCanvas.getContext("2d");e.save();var i=this.getGraphicsZoom();e.beginPath(),e.rect(Math.round(t.x*i-this.viewRect.x),Math.round(t.y*i-this.viewRect.y),Math.round(t.width*i),Math.round(t.height*i)),e.clip(),e.clearRect(Math.round(t.x*i-this.viewRect.x),Math.round(t.y*i-this.viewRect.y),Math.round(t.width*i),Math.round(t.height*i)),this.visibleList=new n.List,this._topAttachmentList=new n.List,ne.draw(e,this);var s=this.getElementBox().getDatas()._as,r=s.length;this.zoomManager._zoomGraphicsBegin(e),this.paintBottom(e,t);var a,h,l,c,d,u,g,_,A,y,p=this._box._layerBox,v=(i=this.getGraphicsZoom(),{x:this.viewRect.x/i,y:this.viewRect.y/i,width:this.viewRect.width/i,height:this.viewRect.height/i});if(this.adjustLinkIndex(),1===p.size())for(a=0;a<r;a++)h=s[a],this._visibleMap[h._id]?(l=this._elementUIMap[h._id],this._debug&&m.strokeRect(e,t,"red"),null!=l&&this._isInView(l,t)&&(l.paint(e),l.setAttachmentVisible&&l.setAttachmentVisible(!0)),null!=l&&f.intersects(v,l.getZoomViewRect())?l.setAttachmentVisible&&l.setAttachmentVisible(!0):l.setAttachmentVisible&&l.setAttachmentVisible(!1),this.visibleList.add(h)):(l=this._elementUIMap[h._id])&&l.setAttachmentVisible&&l.setAttachmentVisible(!1);else p.forEachByDepthFirst(function(i){for(a=0;a<r;a++)h=s[a],p.getLayerByElement(h)===i&&this._visibleMap[h._id]?(null!=(l=this._elementUIMap[h._id])&&this._isInView(l,t)&&(l.paint(e),l.setAttachmentVisible&&l.setAttachmentVisible(!0)),null!=l&&f.intersects(v,l.getZoomViewRect())?l.setAttachmentVisible&&l.setAttachmentVisible(!0):l.setAttachmentVisible&&l.setAttachmentVisible(!1),l&&l.validateZIndex&&l.validateZIndex(p.getDatas().indexOf(i)),this.visibleList.add(h)):l=this._elementUIMap[h._id]},null,this);for(r=this._topAttachmentList.size(),a=0;a<r;a++)(c=this._topAttachmentList.get(a)).getElementUI().paintAttachment(e,c);this.paintTop(e,t),void 0!==this._xyz&&(d=(A=this._xyz).markText,u=A.type,A.expired,g=A.innerHTML,_=0,A=this.viewRect,e.translate(this.viewRect.x/this.getZoom(),this.viewRect.y/this.getZoom()),e.scale(1/this.getZoom(),1/this.getZoom()),i=this.getZoom(),y=null!=d&&""!=d||"2"==u?(e.font="15px Arial sans-serif",r=o.g.getTextSize(e.font,g),e.fillStyle="red",_=A.width-r.width,A.height-20):(e.font="10px Arial sans-serif",r=o.g.getTextSize(e.font,g),_=A.width/2-r.width/2,A.height/2),e.fillText(g,_,y)),e.restore(),this._invalidateMap={},this._invalidateAll=!1,this._paintAll=!1,this._dirtyRects=new at},adjustLinkIndex:function(){var t,e,o,s,r=this._box.getDatas()._as;if(this.hasEditInteraction())for(this._hasAdjustedLinks=!1,i=r.length-1;-1<i;i--)(e=r[i])instanceof n.Link&&(this.isEditable(e)&&this.getElementUI(e).isEditable()&&this.isSelected(e)?(t=this._box.getDatas().indexOf(e),this._box.getDatas().removeAt(t),this._box.getDatas().add(e),this._hasAdjustedLinks=!0):(o=e.getToNode(),t=this._box.getDatas().indexOf(o),this._box.getDatas().removeAt(t),this._box.getDatas().add(o),s=e.getFromNode(),t=this._box.getDatas().indexOf(s),this._box.getDatas().removeAt(t),this._box.getDatas().add(s)));else if(this._hasAdjustedLinks){for(i=r.length-1;-1<i;i--)(e=r[i])instanceof n.Link&&(o=e.getToNode(),t=this._box.getDatas().indexOf(o),this._box.getDatas().removeAt(t),this._box.getDatas().add(o),s=e.getFromNode(),t=this._box.getDatas().indexOf(s),this._box.getDatas().removeAt(t),this._box.getDatas().add(s));this._hasAdjustedLinks=!1}},paintBottom:function(t,e){},paintTop:function(t,e){},_isInView:function(t,e){return f.intersects(e,t.getZoomViewRect())},paintTopCanvas:function(){var t=this._topCanvas.getContext("2d");t.clearRect(0,0,this._topCanvas.width,this._topCanvas.height),this.paintMarker(t)},paintMarker:function(t){for(var e=this.markerList.size(),i=0;i<e;i++)this.markerList.get(i).paint(t)},getLayerByElement:function(t){return this._box.getLayerBox().getLayerByElement(t)},getLogicalPoint2:function(t){return this.zoomManager._getLogicalPoint(t)},getLogicalPoint:function(t){return this.zoomManager._getLogicalPoint(t,!0)},getElementAt:function(t){if(null==this.visibleList)return null;var e;if(t.target?e=this.getLogicalPoint2(t):t.event?t.event.target&&(e=this.getLogicalPoint2(t.event)):e=t,null!=this._hitTestTopAttachmentList)for(var i=this._hitTestTopAttachmentList.size()-1;0<=i;i--){var n=this._hitTestTopAttachmentList.get(i);if(n.hit(e.x,e.y))return n.getElement()}if(null!=this.visibleList)for(var o=this.visibleList.size()-1;0<=o;o--){var s=this.visibleList.get(o),r=this.getElementUI(s);if(r&&r.hit(e.x,e.y))return s}return null},getElementsAt:function(t){var e,i=new n.List;if(null==this.visibleList)return null;if(t.target?e=this.getLogicalPoint2(t):t.event?t.event.target&&(e=this.getLogicalPoint2(t.event)):e=t,null!=this._hitTestTopAttachmentList)for(var o=this._hitTestTopAttachmentList.size()-1;0<=o;o--){var s=this._hitTestTopAttachmentList.get(o);s.hit(e.x,e.y)&&i.add(s.getElement())}if(null!=this.visibleList)for(var r=this.visibleList.size()-1;0<=r;r--){var a=this.visibleList.get(r),h=this.getElementUI(a);h&&h.hit(e.x,e.y)&&i.add(a)}return i},hitTest:function(t){var e=this.getElementAt(t);return e&&(e=this.getElementUI(e))?(t=t.target?this.getLogicalPoint2(t):t.event?this.getLogicalPoint2(t.event):t,e.hitTest(t.x,t.y)):null},getElementsAtRect:function(t,e,i,o){var s=new n.List;if(null==this.visibleList)return s;o=void 0===o||o;for(var r=this.visibleList.size()-1;0<=r;r--){var a=this.visibleList.get(r),h=this.getElementUI(a);h&&(!i||i(h._element))&&(o&&this.isSelectable(h._element)||!o)&&(e?h.intersects(t)&&s.add(a):f.contains(t,h.getZoomViewRect(J))&&s.add(a))}return s},getPosition:function(t,e,i,o,s,r){var a,h=e instanceof n.vector.ElementUI?e:this.getElementUI(e);if(h)if("from"===t||"to"===t){if(h.getFromPosition&&(a="from"===t?h.getFromPosition(o,s):h.getToPosition(o,s)))return i?{x:a.x-i.width/2,y:a.y-i.height/2}:a}else a="hotspot"===t?r?h.getZoomHotSpot(this.zoomManager):h.getHotSpot():y.get(t,r?h.getZoomBodyRect():h.getBodyRect(),i);if(a=!a&&e.getRect?y.get(t,e.getRect(),i):a)return{x:a.x+o,y:a.y+s};throw"position '"+t+"' object '"+e+"'"},isValidEvent:function(t){if(!t)return!1;var e;if(t.currentTarget===this._view){if(t=u.isFirefox?(e=t.layerX,t.layerY):(e=t.offsetX,t.offsetY),1==this.isHScrollBarVisible()&&t>=this.viewRect.height-this.getScrollBarWidth())return!1;if(1==this.isVScrollBarVisible()&&e>=this.viewRect.width-this.getScrollBarWidth())return!1}return!0},addMarker:function(t){this.markerList.add(t),this.repaintTopCanvas()},removeMarker:function(t){this.markerList.remove(t),this.repaintTopCanvas()},clearMarker:function(){this.markerList.clear(),this.repaintTopCanvas()},isMovable:function(t){return!!this._box.contains(t)&&!!t.isMovable()&&!(this._movableFunction&&!this._movableFunction(t))&&this.getLayerByElement(t).isMovable()},hasMovableSelectedElements:function(){for(var t=this.getSelectionModel().getSelection(),e=0;e<t.size();e++){var i=t.get(e);if(this.isMovable(i))return!0}return!1},getMovableSelectedElements:function(){return this.getSelectionModel().toSelection(function(t){return this.isMovable(t)},this)},moveSelectedElements:function(t,e,i,o){var s;0===t&&0===e||null!=(s=this.getMovableSelectedElementsRect())&&(this._limitElementInPositiveLocation&&(s.x+t<0&&(t=-s.x),s.y+e<0&&(e=-s.y)),n.Util.moveElements(this.getMovableSelectedElements(),t,e,i,o,this))},getMovableSelectedElementsRect:function(){var t=this.getMovableSelectedElements();if(0===t.size())return null;for(var e=null,i=0,n=t.size();i<n;i++){var o=t.get(i);o instanceof be&&(o=this.getElementUI(o))&&(e=f.unionRect(e,o.getViewRect()))}return e},isVisibleAttachment:function(t){return!this.state.zooming&&!this.state.panning&&!this.state.layouting},isVisible:function(t,e,i){if(!this._box.contains(t))return!1;if(!t.isVisible())return!1;if((e=3!==arguments.length?this._visibleFunction:e)&&!e(t))return!1;if(!(i||this._box._layerBox.getLayerByElement(t))._visible)return!1;if(lt.getSubNetwork(t)!==this._currentSubNetwork)return!1;if(!this.zoomManager.isElementVisible(t))return!1;if(t instanceof n.Link){if(!this._noAgentLinkVisible){if(!t._fromAgent||!t._toAgent)return!1;if(!this.isVisible(t._fromAgent,e,i)||!this.isVisible(t._toAgent,e,i))return!1}if(0<t.getBundleIndex()&&1<t.getBundleCount()&&!t.getStyle("link.bundle.expanded"))return!1}else for(var o=t._parent;o&&!o.ISubNetwork;){if(o instanceof n.Group&&(!o.isExpanded()||!this.isVisible(o,e,i)))return!1;o=o._parent}return!t.IDummy},getVisibleFunction:function(){return this._visibleFunction},setVisibleFunction:function(t){var e=this._visibleFunction;this._visibleFunction=t,this.firePropertyChange("visibleFunction",e,t),this.invalidateElementVisibility()},isEditable:function(t){return!!this._box.contains(t)&&!(this._editableFunction&&!this._editableFunction(t))&&this.getLayerByElement(t).isEditable()},getEditableFunction:function(){return this._editableFunction},setEditableFunction:function(t){var e=this._editableFunction;this._editableFunction=t,this.firePropertyChange("editableFunction",e,t),this.invalidateSelectedElementUIs(!0)},isRotatable:function(t){return!(this._rotatableFunction&&!this._rotatableFunction(t))},getRotatableFunction:function(){return this._rotatableFunction},setRotatableFunction:function(t){var e=this._rotatableFunction;this._rotatableFunction=t,this.firePropertyChange("rotatableFunction",e,t),this.invalidateSelectedElementUIs(!0)},isLinkable:function(t,e){return null==this._linkableFunction||this._linkableFunction(t,e)},getLinkableFunction:function(){return this._linkableFunction},setLinkableFunction:function(t){var e=this._linkableFunction;this._linkableFunction=t,this.firePropertyChange("linkableFunction",e,t),this.invalidateSelectedElementUIs(!0)},onShareSelectionModelChanged:function(){this.invalidateElementUIs()},getShadowColor:function(t){var e=t.getStyle("shadow.color");return!e&&this.isSelected(t)&&"shadow"===t.getStyle("select.style")?t.getStyle("select.color"):e},getSelectColor:function(t){return t.getStyle("select.color")},getAlarmLabel:function(t){var e=t.getAlarmState().getHighestNewAlarmSeverity();return e?(e=t.getAlarmState().getNewAlarmCount(e)+e.nickName,t.getAlarmState().hasLessSevereNewAlarms()&&(e+="+"),e):null},getLinkHandlerLabel:function(t){return t.isBundleAgent()?"+("+t.getBundleCount()+")":null},setInteractions:function(t){var e=this._interactions;e&&e.forEach(function(t){t.tearDown()}),(this._interactions=t)&&t.forEach(function(t){t.setUp()}),this.invalidateSelectedElementUIs(!0),this.firePropertyChange("interactions",e,t)},getInteractions:function(){return this._interactions},setDefaultInteractions:function(t,e){var i=[new n.vector.interaction.DefaultInteraction(this,t)];e&&i.push(new n.vector.interaction.MoveLinkInteraction(this,t)),this.setInteractions(i)},setTouchInteractions:function(){this.setInteractions([new n.vector.interaction.DefaultInteraction(this,!1),new n.vector.interaction.TouchInteraction(this)])},setMSTouchInteractions:function(){this.setInteractions([new n.vector.interaction.MSTouchInteraction(this)])},setEditInteractions:function(t,e){var i=[new n.vector.interaction.EditInteraction(this,t),new n.vector.interaction.DefaultInteraction(this)];e&&i.push(new n.vector.interaction.MoveLinkInteraction(this,t)),this.setInteractions(i)},setCreateElementInteractions:function(t){this.setInteractions([new n.vector.interaction.CreateElementInteraction(this,t),new n.vector.interaction.DefaultInteraction(this)])},setCreateLinkInteractions:function(t){this.setInteractions([new n.vector.interaction.CreateLinkInteraction(this,t),new n.vector.interaction.DefaultInteraction(this)])},setCreateShapeLinkInteractions:function(t){this.setInteractions([new n.vector.interaction.CreateShapeLinkInteraction(this,t),new n.vector.interaction.DefaultInteraction(this)])},setCreateShapeNodeInteractions:function(t){this.setInteractions([new n.vector.interaction.CreateShapeNodeInteraction(this,t),new n.vector.interaction.DefaultInteraction(this)])},setMagnifyInteractions:function(){this.setInteractions([new n.vector.interaction.DefaultInteraction(this),new n.vector.interaction.MagnifyInteraction(this)])},hasEditInteraction:function(){return this._hasEditInteraction},setHasEditInteraction:function(t){var e=this._hasEditInteraction;this._hasEditInteraction=t,this.firePropertyChange("hasEditInteraction",e,t)},addElementByInteraction:function(t){t.getParent()||t.setParent(this._currentSubNetwork),this._box.add(t),this.getSelectionModel().setSelection(t),this.fireInteractionEvent({kind:"createElement",element:t})},getToolTip:function(t){if(t){var e=t.getToolTip();return e||t.getName()}return null},isToolTipEnabled:function(){return!!this._toolTipEnabled},setToolTipEnabled:function(t){var e;(this._toolTipEnabled=t)?this._toolTipListener||((e=this)._toolTipListener=function(t){var i;e.isMovingElement()?ft.hideToolTip():(i=e.getElementAt(t),e._preElement!==i&&((e._preElement=i)?(i=e.getToolTip(i),ft.showToolTip({x:t.pageX,y:t.pageY},i,function(t){var i=e._view.getBoundingClientRect(),n=t.getBoundingClientRect();n.width+n.left>i.width+i.left&&(t.style.left=i.width+i.left-n.width+(l.documentElement.scrollLeft||l.body.scrollLeft)+"px"),n.height+n.top>i.height+i.top&&(t.style.top=i.height+i.top-n.height+(l.documentElement.scrollTop||l.body.scrollTop)+"px")})):ft.hideToolTip()))},this._view.addEventListener("mousemove",this._toolTipListener,!1),this.firePropertyChange("toolTipEnabled",!1,!0)):this._toolTipListener&&(ft.hideToolTip(),this._view.removeEventListener("mousemove",this._toolTipListener,!1),delete this._toolTipListener,this.firePropertyChange("toolTipEnabled",!0,!1))},setZoom:function(t,e){var i,n,o,s,r;(t=this.checkZoom(t))!=(i=this.isAsyncZoomAndViewRect()?this._zoomMap[this._currentSubNetwork].zoom:this._zoom)&&(n=this.getViewRect(),e=e||{x:n.width/2,y:n.height/2},o=this.viewRect,n=e.x-(e.x+o.x)*t/i,o=e.y-(e.y+o.y)*t/i,this.isAsyncZoomAndViewRect()?this._zoomMap[this._currentSubNetwork].zoom=t:this._zoom=t,this._paintAll=!0,this.invalidateElementVisibility(),this.invalidateCanvasSize(),this.zoomManager._invalidateZoom(),this.setViewRect(-n,-o,this.viewRect.width,this.viewRect.height),this._asyncZoomAndViewRect?this.firePropertyChange("zoom",i,this._zoomMap[this._currentSubNetwork].zoom):this.firePropertyChange("zoom",i,this._zoom),this.state.zooming=!0,r=this,(s=null)?clearTimeout(s):s=setTimeout(function(){s=null,r.state.zooming=!1,r.invalidateElementUIs(!0)},100))},getZoom:function(){return this.isAsyncZoomAndViewRect()?(this._zoomMap[this._currentSubNetwork]||(this._zoomMap[this._currentSubNetwork]={zoom:1}),this._zoomMap[this._currentSubNetwork].zoom):this._zoom},getSizeZoom:function(t){return this.zoomManager.getSizeZoom(t)},getLocationZoom:function(){return this.zoomManager.getLocationZoom()},getGraphicsZoom:function(){return this.zoomManager.getGraphicsZoom()},zoomOverview:function(t){var e,i,n,o,s,r;this._unionBounds.width<=0||this._unionBounds.width<=0||(e=this.getZoom(),n=(i=this._unionBounds).width/e,o=i.height/e,i=this.viewRect.width/n,n=this.viewRect.height/o,o=Math.min(i,n),this.setZoom(o),i=this.getZoom(),n=this.viewRect.width/2-this._unionBounds.width/2*i/e,o=this.viewRect.height/2-this._unionBounds.height/2*i/e,this.setViewRect(this._unionBounds.x*i/e-n,this._unionBounds.y*i/e-o,this.viewRect.width,this.viewRect.height),1==this.getLocationZoom()||0<(s=null==arguments[1]?5:arguments[1])&&(s--,r=this,setTimeout(function(){r.zoomOverview(t,s)},25)))},zoomReset:function(t){this.setZoom(1,t)},zoomIn:function(t){this.setZoom(1.2*this.getZoom(),t)},zoomOut:function(t){this.setZoom(this.getZoom()/1.2,t)},upSubNetwork:function(t,e){this._currentSubNetwork&&this.setCurrentSubNetwork(lt.getSubNetwork(this._currentSubNetwork),t,e)},getCurrentSubNetwork:function(){return this._currentSubNetwork},setCurrentSubNetwork:function(t,e,i){if(n.animate.AnimateManager.endAnimate(),e){if(this._currentSubNetwork!==t){if(t&&!this._box.contains(t))throw t+" is not contained in this network's elementBox";e=new n.animate.AnimateSubNetwork(this,t,i),n.animate.AnimateManager.start(e)}}else this._setCurrentSubNetwork(t),i&&i()},_setCurrentSubNetwork:function(t){if(this._currentSubNetwork!==t){if(t&&!this._box.contains(t))throw t+" is not contained in this network's elementBox";this.isAsyncZoomAndViewRect()&&(e=this._viewRectMap[this._currentSubNetwork],this._viewRectMap[this._currentSubNetwork]=e?this.viewRect:this.viewRect||{x:0,y:0,width:this.viewRect.width,height:this.viewRect.height});var e,i=this._currentSubNetwork;this._currentSubNetwork=t,this.firePropertyChange("currentSubNetwork",i,t),this.isAsyncZoomAndViewRect()&&(this._viewRectMap[this._currentSubNetwork]||(this._viewRectMap[this._currentSubNetwork]={x:0,y:0,width:this.viewRect.width,height:this.viewRect.height}),e=this._viewRectMap[this._currentSubNetwork],this.setViewRect(e.x,e.y,e.width,e.height),this.invalidateElementUIs()),this.invalidateElementVisibility(),this.invalidateCanvasSize(),this._paintAll=!0}},makeVisible:function(t){var e=this.getElementUI(t);if(e){var i=lt.getSubNetwork(t);if(i===this._currentSubNetwork){for(var s=t;(s=s.getParent())&&s!==i;)s instanceof n.Group&&s.setExpanded(!0);var r=e.getViewRect();r&&(e=e.getZoomViewRect(this.zoomManager),e=r.x==e.x&&r.y==e.y&&r.width==e.width&&r.height==e.height?{x:r.x*this.getGraphicsZoom(),y:r.y*this.getGraphicsZoom(),width:r.width*this.getGraphicsZoom(),height:r.height*this.getGraphicsZoom()}:e,f.intersects(this.viewRect,e)||this.isVisible(t)&&o.callLater(this.centerByLogicalPoint,this,[e.x+e.width/2,e.y+e.height/2]))}else{var a=this;this.setCurrentSubNetwork(i,this.isSubNetworkAnimate(),function(){o.callLater(a.makeVisible,a,[t])})}}},centerByLogicalPoint:function(t,e,i){t-=this.viewRect.width/2,e-=this.viewRect.height/2,this.setViewRect(t,e,this.viewRect.width,this.viewRect.height)},panByOffset:function(t,e){this.setViewOffSet(t,e)},getIconsNames:function(t){return t.getStyle("icons.names")},getIconsColors:function(t){return t.getStyle("icons.colors")},getLinkFlowStepping:function(t){return parseInt(t.getStyle("link.flow.stepping"))||Ee.NETWORK_LINK_FLOW_STEPPING},getLinkFlowOffset:function(t){var e=t.getStyle("link.flow.offset");return(e=isNaN(e)?0:e)+this.getLinkFlowStepping(t)},toCanvas:function(t,e,i,o,s,r){(i=i||p.createCanvas()).setAttribute("width",t),i.setAttribute("height",e),i._viewRect?(i._viewRect.width=t,i._viewRect.height=e):i._viewRect={x:0,y:0,width:t,height:e};var a=i.getContext("2d");if(a.translate(-s,-r),a.clearRect(0,0,t,e),ne.draw(a,this),0===this._view.clientWidth||0===this._view.clientHeight)return i;this.realWidth,this.getGraphicsZoom(),this.realHeight,this.getGraphicsZoom(),a.scale(o,o);var h=this.getElementBox().getDatas()._as,l=h.length;this._topAttachmentList=new n.List;var c,d,u,g,_,f,A=this.getElementBox().getLayerBox(),y=A.getRoots(),m=y.size();if(this.adjustLinkIndex(),1===m)for(u=0;u<l;u++)g=h[u],this._visibleMap[g._id]&&null!=(_=this._elementUIMap[g._id])&&_.paint(a);else for(c=0;c<m;c++)for(d=y.get(c),u=0;u<l;u++)g=h[u],A.getLayerByElement(g)===d&&this._visibleMap[g._id]&&null!=(_=this._elementUIMap[g._id])&&_.paint(a);for(l=this._topAttachmentList.size(),u=0;u<l;u++)(f=this._topAttachmentList.get(u)).getElementUI().paintAttachment(a,f);return i},toCanvasByRegion:function(t,e,i){i=i||p.createCanvas();var o=t.width*e,s=t.height*e;i.setAttribute("width",o),i.setAttribute("height",s),i._viewRect?(i._viewRect.width=o,i._viewRect.height=s):i._viewRect={x:0,y:0,width:o,height:s};var r=i.getContext("2d");if(r.clearRect(0,0,o,s),ne.draw(r,this),0===this._view.clientWidth||0===this._view.clientHeight)return i;r.save(),r.scale(e,e),r.beginPath(),r.translate(-t.x,-t.y);var a=this.getElementBox().getDatas()._as,h=a.length;this._topAttachmentList=new n.List;var l,c,d,u,g,_,A=this.getElementBox().getLayerBox(),y=A.getRoots(),m=y.size();if(this.adjustLinkIndex(),1===m)for(d=0;d<h;d++)u=a[d],this._visibleMap[u._id]&&null!=(g=this._elementUIMap[u._id])&&f.intersects(t,g.getZoomViewRect())&&g.paint(r);else for(l=0;l<m;l++)for(c=y.get(l),d=0;d<h;d++)u=a[d],A.getLayerByElement(u)===c&&this._visibleMap[u._id]&&null!=(g=this._elementUIMap[u._id])&&f.intersects(t,g.getZoomViewRect())&&g.paint(r);for(h=this._topAttachmentList.size(),d=0;d<h;d++)(_=this._topAttachmentList.get(d)).getElementUI().paintAttachment(r,_);return r.restore(),i},getGroupChildrenRects:function(t){return this.zoomManager._getGroupChildrenRects(t)},convertPointFromView:function(t){return this.zoomManager._convertPointFromView(t)},getOffset:function(t,e){return this.zoomManager._getOffset(t,e)},panToCenter:function(){this.setViewRect((this.realWidth-this.viewRect.width)/2,(this.realHeight-this.viewRect.height)/2,this.viewRect.width,this.viewRect.height)},moveElementsToCenter:function(){var t,e,i;this._limitViewInCanvas?(t=this.viewRect,i=this._unionBounds,e=t.x+t.width/2-i.x-i.width/2,i=t.y+t.height/2-i.y-i.height/2,n.Util.moveElements(this._box.toDatas(),e,i)):(e=this.viewRect.width/2-this._unionBounds.width/2,i=this.viewRect.height/2-this._unionBounds.height/2,this.setViewRect(this._unionBounds.x-e,this._unionBounds.y-i,this.viewRect.width,this.viewRect.height))},getLinkPathFunction:function(){return this._linkPathFunction},setLinkPathFunction:function(t){var e=this._linkPathFunction;this._linkPathFunction=t,this.firePropertyChange("linkPathFunction",e,t),this.invalidateElementUIs()},invalidate:function(){this._invalidate||(this._invalidate=!0,this.fireViewEvent({kind:"invalidate"}))},validate:function(){this._invalidate&&(!a&&0===this._view.offsetWidth&&0===this._view.offsetHeight||(this._invalidate=!1,this._isValidating=!0,this.fireViewEvent({kind:"validateStart"}),this.validateImpl(),this.fireViewEvent({kind:"validateEnd"}),this._isValidating=!1))},onClickElement:function(t,e){},onClickBackground:function(t){},onDoubleClickElement:function(t,e){},onDoubleClickBackground:function(t){},onLongClickElement:function(t,e){},onLongClickBackground:function(t){},onMouseMove:function(t,e){},onMouseEnter:function(t,e){},onMouseLeave:function(t,e){},setMovingElement:function(t){var e;t!=this._movingElement&&(e=this._movingElement,this._movingElement=t,this.firePropertyChange("movingElement",e,t),this._box._undoManager._enabled&&(t?this._box._undoManager.startBatch():this._box._undoManager.endBatch()))},setEditingElement:function(t){var e;t!=this._editingElement&&(e=this._editingElement,this._editingElement=t,this.firePropertyChange("editingElement",e,t),this._box._undoManager._enabled&&(t?this._box._undoManager.startBatch():this._box._undoManager.endBatch()))},dispose:function(){n.imageUtil.removeEventListener(this.invalidateElementUIs,this),this.setInteractions(null),cancelAnimationFrame(this._loopId)},handle_mousemove:function(t){var e=this.getElementAt(t),i=this.__preElement,n=yt(i),o=yt(e);i!==e&&(i&&(n&&n.onMouseLeave&&n.onMouseLeave(i,this),this.onMouseLeave(i,t)),e&&(o&&o.onMouseEnter&&o.onMouseEnter(e,this),this.onMouseEnter(e,t))),e&&o&&o.onMouseMove&&o.onMouseMove(e,this),this.onMouseMove(e,t),this.__preElement=e}}),n.vector.Overview=function(t){n.vector.Overview.superClass.constructor.apply(this,t),this._view=p.createView(),this._rootDiv=p.createDiv(),this._imageCanvas=p.createCanvas(),this._imageDiv=p.createDiv(),this._maskCanvas=p.createCanvas(),this._selectDiv=p.createDiv(),this._isNetworkDirty=!1,this._isMaskDirty=!1,p.setVisible(this._selectDiv,!1),this._view.appendChild(this._rootDiv),this._rootDiv.appendChild(this._imageDiv),this._rootDiv.appendChild(this._maskCanvas),this._rootDiv.appendChild(this._selectDiv),this._imageDiv.appendChild(this._imageCanvas),this._exportImageCanvas=p.createCanvas(),this._imageCtx=this._imageCanvas.getContext("2d"),this.setNetwork(t),u.isTouchable?u.isMSTouchable?new n.vector.OverviewMSTouchInteraction(this):(new n.vector.OverviewTouchInteraction(this),new n.vector.OverviewInteraction(this)):new n.vector.OverviewInteraction(this)},o.ext("b2.vector.Overview",n.controls.ControlBase,{__accessor:["fillColor","outlineColor","outlineWidth","selectColor","selectWidth","padding","maxPackingWidth","maxPackingHeight"],__bool:["animate"],_fillColor:Ee.OVERVIEW_FILL_COLOR,_outlineColor:Ee.OVERVIEW_OUTLINE_COLOR,_outlineWidth:Ee.OVERVIEW_OUTLINE_WIDTH,_selectColor:Ee.OVERVIEW_SELECT_COLOR,_selectWidth:Ee.OVERVIEW_SELECT_WIDTH,_padding:Ee.OVERVIEW_PADDING,_animate:Ee.OVERVIEW_ANIMATE,_maxPackingWidth:Ee.OVERVIEW_MAX_PACKING_WIDTH,_maxPackingHeight:Ee.OVERVIEW_MAX_PACKING_HEIGHT,getNetwork:function(){return this._network},onPropertyChanged:function(t){this._invalidateMask()},setNetwork:function(t){t!==this._network&&(this._network&&(this._network.removePropertyChangeListener(this._handleNetworkPropertyChange,this),this._network.removeViewListener(this._handleNetworkViewChange,this),p.removeEventListener("scroll","_handleScrollChange",this._network.getView(),this)),this._network=t,this._network&&(this._network.addPropertyChangeListener(this._handleNetworkPropertyChange,this),this._network.addViewListener(this._handleNetworkViewChange,this),p.addEventListener("scroll","_handleScrollChange",this._network.getView(),this)),this.invalidate())},_handleNetworkPropertyChange:function(t){"zoom"!==t.property&&"currentSubNetwork"!==t.property&&"elementBox"!==t.property&&"dataBox"!==t.property&&"canvasSizeChange"!==t.property||this.invalidate()},_handleNetworkViewChange:function(t){"validateEnd"===t.kind&&this.invalidate()},_handleScrollChange:function(){this._invalidateMask()},invalidate:function(t){this._isNetworkDirty&&this._isMaskDirty||(this._isNetworkDirty||(this._isNetworkDirty=!0),this._isMaskDirty||(this._isMaskDirty=!0),o.callLater(this.validate,this,null,t))},_invalidateMask:function(){this._isMaskDirty||(this._isMaskDirty=!0,o.callLater(this.validate,this,[],100))},validate:function(){var t,e,i,n,o,s,r,a,h,l,c,d,u;(this._isMaskDirty||this._isNetworkDirty)&&this._network&&(0<this._maxPackingWidth&&0<this._maxPackingHeight||0<this._view.clientWidth&&0<this._view.clientHeight)&&0!==this._network.getViewRect().width&&0!==this._network.getViewRect().height&&!this._network._invalidate?(h=(n=0<this._maxPackingWidth&&0<this._maxPackingHeight)?{x:0,y:0,width:this._maxPackingWidth,height:this._maxPackingHeight}:{x:0,y:0,width:this._view.clientWidth,height:this._view.clientHeight},f.grow(h,-this._padding,-this._padding),n&&(p.setDiv(this._view,{x:0,y:0,width:this._imageDiv._viewRect.width,height:this._imageDiv._viewRect.height},null,0,null),h.width=this._imageDiv._viewRect.width,h.height=this._imageDiv._viewRect.height),s=this._network.getGraphicsZoom(),a=this._network._unionBounds,a={x:(a=f.unionRect(a,{x:0,y:0,width:a.x,height:a.y})).x/s,y:a.y/s,width:a.width/s,height:a.height/s},t=this._network.viewRect.x/s,e=this._network.viewRect.y/s,c=this._network.viewRect.width/s,d=this._network.viewRect.height/s,l=a,u=Math.min(h.width/l.width,h.height/l.height),r=h.x+(h.width-(o=i=l.width*u))/2,a=h.y+(h.height-(s=n=l.height*u))/2,this._isNetworkDirty&&(h={x:r,y:a,width:o,height:s},this._network.toCanvas(i,n,this._exportImageCanvas,u,l.x*u,l.y*u),this._imageCanvas.setAttribute("width",o),this._imageCanvas.setAttribute("height",s),this._imageCtx.drawImage(this._exportImageCanvas,0,0,i,n),p.setDiv(this._imageDiv,h,null,0,null),this._network.getElementBox&&(this._imageDiv.style.backgroundColor=(this._network.getCurrentSubNetwork()||this._network.getElementBox()).getStyle("background.color")||""),this._isNetworkDirty=!1),this._isMaskDirty&&(l={x:(t-l.x)*u,y:(e-l.y)*u,width:c*u,height:d*u},(c=p.setCanvas(this._maskCanvas,r,a,o,s)).lineWidth=0,c.fillStyle=this._fillColor,m.drawVector(c,"rectangle",null,r,a,o,s),c.closePath(),c.fill(),c.stroke(),c.clearRect(r+l.x,a+l.y,l.width,l.height),c.lineWidth=this._outlineWidth,c.strokeStyle=this._outlineColor,d=l.width-2*this._outlineWidth,u=l.height-2*this._outlineWidth,d=Math.min(d,o-2-l.x-this._outlineWidth),u=Math.min(u,s-2-l.y-this._outlineWidth),m.drawVector(c,"rectangle",null,r+l.x+this._outlineWidth,a+l.y+this._outlineWidth,d,u),c.closePath(),c.stroke(),this._isMaskDirty=!1)):(this._isNetworkDirty=!1,this._isMaskDirty=!1)},getLogicalPoint:function(t){return p.getLogicalPoint(this._view,t,1,this._rootDiv)},centerNetwork:function(t,e){var i,n,o,s=this._imageDiv._viewRect;f.containsPoint(s,t)&&(i=this._network.getGraphicsZoom(),n=this._network._unionBounds,n={x:(n=f.unionRect(n,{x:0,y:0,width:n.x,height:n.y})).x/i,y:n.y/i,width:n.width/i,height:n.height/i},o={x:this._network.viewRect.x/i,y:this._network.viewRect.y/i,width:this._network.viewRect.width/i,height:this._network.viewRect.height/i},o=f.unionRect(n,o),this._network.centerByLogicalPoint((o.x+(t.x-s.x)/s.width*o.width)*i,(o.y+(t.y-s.y)/s.height*o.height)*i,e),this._invalidateMask())}}),n.vector.OverviewTouchInteraction=function(t){this.overview=t,this.network=t.getNetwork(),this.view=t._view,p.addEventListener("touchstart","handleTouchstart",this.view,this)},o.ext("b2.vector.OverviewTouchInteraction",Object,{handleTouchstart:function(t){p.preventDefault(t),this.clear(),this.endPoint=this.overview.getLogicalPoint(t),gt.isMultiTouch(t)&&(this.distance=gt.getDistance(t),this.zoom=this.network.getZoom()),p.addEventListener("touchmove","handleTouchmove",this.view,this),p.addEventListener("touchend","handleTouchend",this.view,this)},handleTouchmove:function(t){this.moved||(this.moved=!0),this.endPoint=this.overview.getLogicalPoint(t),gt.isSingleTouch(t)?this.overview.centerNetwork(this.endPoint,!1):this.distance&&(t=gt.getDistance(t)/this.distance,this.network.setZoom(this.zoom*t,!1))},handleTouchend:function(t){this.moved||(this.endPoint=this.overview.getLogicalPoint(t),(t=this.lastPoint&&this.lastTouchStartTime&&(new Date).getTime()-this.lastTouchStartTime.getTime()<=300&&Math.abs(this.endPoint.x-this.lastPoint.x)<=10&&Math.abs(this.endPoint.y-this.lastPoint.y)<=10)?(this.lastPoint=null,this.lastTouchStartTime=null):(this.lastPoint=this.endPoint,this.lastTouchStartTime=new Date),t?o.callLater(this.network.zoomReset,this.network,[this.overview._animate]):this.overview.centerNetwork(this.endPoint,this.overview._animate)),this.clear()},clear:function(){this.endPoint&&(this.endPoint=null,p.removeEventListener("touchmove",this.view,this),p.removeEventListener("touchend",this.view,this)),this.moved=!1}}),n.vector.OverviewMSTouchInteraction=function(t){this.overview=t,this.network=t.getNetwork(),this.view=t._view,this._pointerMap={},this._pointerIdArray=[],p.addEventListener("MSPointerDown","handleTouchstart",this.view,this),p.addEventListener("MSPointerMove","handleTouchmove",this.view,this),p.addEventListener("MSPointerUp","handleTouchend",this.view,this),p.addEventListener("MSPointerCancel","handleTouchend",this.view,this)},o.ext("b2.vector.OverviewMSTouchInteraction",Object,{handleTouchstart:function(t){p.preventDefault(t),t.isPrimary&&0<this._pointerIdArray.length&&(this._pointerMap={},this._pointerIdArray=[]),!this._pointerMap[t.pointerId]&&this.overview.getLogicalPoint(t)&&(this._pointerIdArray.push(t.pointerId),this._pointerMap[t.pointerId]=t),1==this._pointerIdArray.length?(this._startTouchPoint=this.overview.getLogicalPoint(t),this._startTouchTime=new Date):2==this._pointerIdArray.length&&(this._distance=this._getDistance(),this._zoom=this.network.getZoom())},handleTouchmove:function(t){var e;0==this._pointerIdArray.length||!this._pointerMap[t.pointerId]||f.getDistance({x:this._pointerMap[t.pointerId].pageX,y:this._pointerMap[t.pointerId].pageY},{x:t.pageX,y:t.pageY})<=10||(this._pointerMap[t.pointerId]=t,2==this._pointerIdArray.length?(e=this._getDistance()/this._distance,this.network.setZoom(this._zoom*e,!1)):1==this._pointerIdArray.length&&(!this._startTouchPoint||null!=(t=this.overview.getLogicalPoint(t))&&(this._startTouchPoint=t,this.overview.centerNetwork(this._startTouchPoint,!1))))},handleTouchend:function(t){var e=this.overview.getLogicalPoint(t);1==this._pointerIdArray.length&&e&&((t=this._endTouchPoint&&this._endTouchTime&&(new Date).getTime()-this._endTouchTime.getTime()<=500&&f.getDistance(this._endTouchPoint,e)<=10)?(this._endTouchPoint=null,this._endTouchTime=null):(this._endTouchPoint=e,this._endTouchTime=new Date),t?o.callLater(this.network.zoomReset,this.network,[this.overview._animate]):this.overview.centerNetwork(this._endTouchPoint,this.overview._animate)),this._pointerMap={},this._pointerIdArray=[]},_getDistance:function(){return f.getDistance({x:this._pointerMap[this._pointerIdArray[0]].pageX,y:this._pointerMap[this._pointerIdArray[0]].pageY},{x:this._pointerMap[this._pointerIdArray[1]].pageX,y:this._pointerMap[this._pointerIdArray[1]].pageY})}}),n.vector.OverviewInteraction=function(t){this.overview=t,this.network=t.getNetwork(),this.view=t._view,p.addEventListener("mousedown","handleMousedown",this.view,this)},o.ext("b2.vector.OverviewInteraction",Object,{handleMousedown:function(t){this.clear(),this.endPoint=this.overview.getLogicalPoint(t),o.isCtrlDown(t)&&(this.startPoint=this.endPoint,p.setVisible(this.overview._selectDiv,!0)),p.addEventListener("mousemove","handleMousemove",this.view,this),p.addEventListener("mouseup","handleMouseup",l,this)},handleMouseup:function(t){var e,i,n,s;this.endPoint=this.overview.getLogicalPoint(t),"detail"in t&&2===t.detail?o.callLater(this.network.zoomReset,this.network,[this.endPoint,this.overview._animate]):p.isVisible(this.overview._selectDiv)&&this.startPoint?(s=this.overview._imageDiv._viewRect,n=this.overview._selectDiv._viewRect.x,e=this.overview._selectDiv._viewRect.y,i=s.width/this.overview._selectDiv._viewRect.width,t=s.height/this.overview._selectDiv._viewRect.height,t=Math.min(i,t),this.network.setZoom(t*Math.min(this.network.getViewRect().width/this.network.getCanvasSize().width,this.network.getViewRect().height/this.network.getCanvasSize().height)*this.network.getZoom(),!1),n=this.network.getCanvasSize().width*((n-s.x+this.overview._selectDiv._viewRect.width/2)/s.width),s=this.network.getCanvasSize().height*((e-s.y+this.overview._selectDiv._viewRect.height/2)/s.height),o.callLater(this.network.centerByLogicalPoint,this.network,[n,s,this.overview._animate]),p.setVisible(this.overview._selectDiv,!1),p.setDiv(this.overview._selectDiv,{x:0,y:0,width:0,height:0},null,0,null),this.startPoint=null):this.overview.centerNetwork(this.endPoint,this.overview._animate),this.clear()},handleMousemove:function(t){var e,i,n,o,s=this.overview.getLogicalPoint(t);this.endPoint=s,p.isVisible(this.overview._selectDiv)&&this.startPoint?(e=(s.x>this.startPoint.x?this.startPoint:s).x,i=(s.x>this.startPoint.x?this.startPoint:s).y,s.x>this.startPoint.x&&s.y<this.startPoint.y&&(i=s.y),s.x<this.startPoint.x&&s.y>this.startPoint.y&&(i=this.startPoint.y),(e=e<(n=this.overview._imageDiv._viewRect).x?n.x:e)>n.x+n.width&&(e=n.x+n.width),(i=i<n.y?n.y:i)>n.y+n.height&&(i=n.y+n.height),o=Math.abs(s.x-this.startPoint.x),t=Math.abs(s.y-this.startPoint.y),e+o>n.x+n.width&&(o=n.x+n.width-e),i+t>n.y+n.height&&(t=n.y+n.height-i),p.setDiv(this.overview._selectDiv,{x:e,y:i,width:o,height:t},null,this.overview._selectWidth,this.overview._selectColor)):this.overview.centerNetwork(s,!1)},clear:function(){this.endPoint&&(this.endPoint=null,p.removeEventListener("mousemove",this.view,this),p.removeEventListener("mouseup",this.view,this))}}),n.vector.ElementUI=function(t,e){this._network=t,this._element=e,this._attachments=new n.List,this._bodyBounds=new n.List,this._hitTest=!1,this._hitTest=!1,this._intersectTest=!1,this.invalidate(!0)},o.ext("b2.vector.ElementUI",Object,{getElement:function(){return this._element},getNetwork:function(){return this._network},handlePropertyChange:function(t){},handleSelectionChange:function(t){},invalidate:function(t){(t=void 0===t||t)&&(this._invalidateAttachmentsFlag=!0),this._invalidateFlag||(this._hotSpot=null,this._bodyRect=null,this._invalidateFlag=!0,this.invalidateZoom(),this.setAttachmentVisible&&this.setAttachmentVisible(!1))},invalidateZoom:function(){this._zoomBodyRect=null,this._zoomViewRect=null,this._zoomHotSpot=null},updateStyle:function(){this._innerColor=this._network.getInnerColor(this._element),this._outerColor=this._network.getOuterColor(this._element),this._glowBlur=this._element.getStyle("glow.blur"),this._shadowColor=this._network.getShadowColor(this._element),this._shadowXOffset=this._element.getStyle("shadow.xoffset"),this._shadowYOffset=this._element.getStyle("shadow.yoffset"),this._shadowBlur=this._element.getStyle("shadow.blur"),this._wholeAlpha=this._element.getStyle("whole.alpha")},validate:function(){var t,e=this;0!=this._invalidateFlag&&(this._bodyBounds.clear(),this._invalidateAttachmentsFlag&&(this._invalidateAttachmentsFlag=!1,this.checkAttachments()),this._invalidateFlag=!1,this.updateStyle(),this.validateImpl(),this._attachments.forEach(function(t){t.validate()}),this._bodyBounds.forEach(function(e){t=f.unionRect(t,e)}),null==t&&((t=o.cloneRect(this._element.getLocation())).width=0,t.height=0),this._unionBodyBounds={x:t.x,y:t.y,width:t.width,height:t.height},this._attachments.forEach(function(i){t=i instanceof n.vector.EditAttachment?i.getElementUI()instanceof n.vector.LinkUI?f.unionRect(t,i._viewRect):f.unionRect(t,e._network.zoomManager._reverseElementZoomRect(e,i._viewRect)):i.getElementUI()instanceof n.vector.LinkUI||i.getElementUI()instanceof n.vector.GroupUI&&i.getElementUI()._shapeRect&&!(i instanceof n.vector.IconsAttachment)?f.unionRect(t,e._network.zoomManager._getAttachmentZoomOutLineRect(i,i._viewRect)):f.unionRect(t,i._viewRect)}),this._viewRect=t)},validateImpl:function(){},setGlow:function(t,e){"glow"===this._element.getStyle("outer.style")&&(e.shadowColor=this._outerColor,e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowBlur=this._glowBlur)},clearGlow:function(t){0==t.shadowOffsetX&&0==t.shadowOffsetY&&0==t.shadowBlur||(t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowBlur=0)},setShadow:function(t,e){var i=this._network.zoomManager;t=t.isShadowable()&&this._shadowColor&&!this._editAttachment;return e.shadowOffsetX===this._shadowXOffset&&e.shadowOffsetY===this._shadowYOffset&&e.shadowBlur===this._shadowBlur||(t||this._network._showShadowInEdit)&&(t=i.getGraphicsZoom(),i=i.getSizeZoom(),e.shadowOffsetX=this._shadowXOffset*(t=1<(t*=i)?1:t),e.shadowOffsetY=this._shadowYOffset*t,e.shadowBlur=this._shadowBlur*t,e.shadowColor=this._shadowColor),e},clearShadow:function(t){0==t.shadowOffsetX&&0==t.shadowOffsetY&&0==t.shadowBlur||(t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowBlur=0)},appendShadowBound:function(t,e){var i;return t.isShadowable()&&this._shadowColor&&!this._editAttachment&&(t=(i=this._network.zoomManager).getGraphicsZoom(),1<(t*=i.getSizeZoom())&&(t=1),0<this._shadowXOffset?e.width+=this._shadowXOffset:(e.x+=this._shadowXOffset,e.width+=-this._shadowXOffset),0<this._shadowYOffset?e.height+=this._shadowYOffset:(e.y+=this._shadowYOffset,e.height+=-this._shadowYOffset),i=this._shadowBlur,i=Math.ceil(i/t),f.grow(e,i+1,i+1)),e},appendGlowBound:function(t,e){var i,n;"glow"===this._element.getStyle("outer.style")&&(i=(n=this._network.zoomManager).getGraphicsZoom(),1<(i*=n.getSizeZoom())&&(i=1),n=this._glowBlur,n=Math.ceil(n/i),f.grow(e,n+1,n+1))},isShadowable:function(){return!(!this._shadowColor||!this._network.isSelected(this._element)||"shadow"!==this._element.getStyle("select.style"))},addAttachment:function(t){this._attachments.add(t),this.invalidate(!1)},removeAttachment:function(t){this._attachments.remove(t),this._network._hitTestTopAttachmentList.remove(t),this.invalidate(!1)},getAttachments:function(){return this._attachments},checkAttachments:function(){this.checkLabelAttachment(),this.checkLabel2Attachment(),this.checkAlarmAttachment(),this.checkIconsAttachment(),this.checkEditAttachment()},checkLabelAttachment:function(){var t=this._network.getLabel(this._element);null!=t&&""!==t?this._labelAttachment||(this._labelAttachment=new n.vector.LabelAttachment(this,Ee.SHOW_LABEL_IN_ATTACHMENT_DIV),this.addAttachment(this._labelAttachment)):this._labelAttachment&&(this.removeAttachment(this._labelAttachment),this._labelAttachment=null)},checkLabel2Attachment:function(){var t=this._network.getLabel2(this._element);null!=t&&""!==t?this._label2Attachment||(this._label2Attachment=new n.vector.Label2Attachment(this,Ee.SHOW_LABEL2_IN_ATTACHMENT_DIV),this.addAttachment(this._label2Attachment)):this._label2Attachment&&(this.removeAttachment(this._label2Attachment),this._label2Attachment=null)},checkAlarmAttachment:function(){var t=this._network.getAlarmLabel(this._element);null!=t&&""!==t?this._alarmAttachment||(this._alarmAttachment=new n.vector.AlarmAttachment(this,Ee.SHOW_ALARM_IN_ATTACHMENT_DIV),this.addAttachment(this._alarmAttachment)):this._alarmAttachment&&(this.removeAttachment(this._alarmAttachment),this._alarmAttachment=null)},checkIconsAttachment:function(){var t=this._network.getIconsNames(this._element);t&&0<t.length?this._iconsAttachment||(this._iconsAttachment=new n.vector.IconsAttachment(this,Ee.SHOW_ICON_IN_ATTACHMENT_DIV),this.addAttachment(this._iconsAttachment)):this._iconsAttachment&&(this.removeAttachment(this._iconsAttachment),this._iconsAttachment=null)},checkEditAttachment:function(){this._network.hasEditInteraction()&&this._network.isSelected(this._element)&&this._network.isEditable(this._element)&&this.isEditable()?this._editAttachment||(this._editAttachment=new n.vector.EditAttachment(this,Ee.SHOW_EDIT_IN_ATTACHMENT_DIV),this.addAttachment(this._editAttachment)):this._editAttachment&&(this.removeAttachment(this._editAttachment),this._editAttachment=null)},getLabelAttachment:function(){return this._labelAttachment},getAlarmAttachment:function(){return this._alarmAttachment},getIconsAttachment:function(){return this._iconsAttachment},getEditAttachment:function(){return this._editAttachment},isEditable:function(){return!0},getInnerColor:function(){return this._innerColor},getOuterColor:function(){return this._outerColor},getShadowColor:function(){return this._shadowColor},getDyeColor:function(t){return this._innerColor||this.getStyle(t)},getStyle:function(t){return this._element.getStyle(t)},getFont:function(t){return(t=this._element.getStyle(t))||n.Defaults.FONT},paint:function(t){t.save(),t.globalAlpha=this._wholeAlpha,t.beginPath(),this.paintBody(t),this.clearShadow(t),this.clearGlow(t),t.closePath(),t.beginPath(),this.paintAttachments(t),t.closePath(),t.restore(),this._network._debug&&m.strokeRect(t,this.getZoomBodyRect(),"orange")},paintBody:function(t){},getZoomBodyRect:function(t){return this._network.zoomManager._getElementZoomRect(this,this.getBodyRect())},getZoomHotSpot:function(){return this._zoomHotSpot||(this._zoomHotSpot=this._network.zoomManager._getZoomHotSpot(this,this._hotSpot)),o.clone(this._zoomHotSpot)},getZoomPointers:function(t,e){return this._network.zoomManager._getZoomPointers(t,this,e)},_getZoomViewRect:function(t,e,i){var n=this._network.zoomManager;if(e)return o.cloneRect(n._getAttachmentZoomRect(e,t));var s=n.getLocationZoom(),r=n.getSizeZoom(this);e=this._bodyRect||this.getBodyRect();return t=t||{x:e.x,y:e.y,width:0,height:0},n=e.x+e.width/2,e=e.y+e.height/2,{x:n*s+(t.x-n)*r,y:e*s+(t.y-e)*r,width:t.width*r,height:t.height*r}},getZoomViewRect:function(t){var e,i=this._network.zoomManager,s=i.getLocationZoom();return i.getGraphicsZoom(),1==s?o.cloneRect(this._viewRect):(this._zoomViewRect&&!t||(t=this._getZoomViewRect(o.cloneRect(this._unionBodyBounds),!1),e=f.unionRect(e,t),this._attachments.forEach(function(t){e=t instanceof n.vector.EditAttachment?f.unionRect(e,t._viewRect):f.unionRect(e,t.getZoomViewRect())}),this._zoomViewRect=e),o.cloneRect(this._zoomViewRect))},paintAttachments:function(t){t.beginPath();for(var e=this._attachments.size(),i=0;i<e;i++){var n=this._attachments.get(i);(this._network.isShowAttachOnChg()||this._network.isVisibleAttachment(n))&&(1==this._hitTest&&0==n.isShowOnTop()&&this.paintAttachment(t,n),1==this._intersectTest&&this.paintAttachment(t,n),0==this._hitTest&&0==this._intersectTest&&(n.isShowOnTop()?this._network._topAttachmentList.add(n):this.paintAttachment(t,n)))}},paintAttachment:function(t,e){var i=this._network.zoomManager;i.isAttachmentVisible(this._element)&&(e!=this._labelAttachment&&e!=this._label2Attachment||i.isLabelVisible(this._element))&&(e==this._alarmAttachment&&!i.isAlarmBalloonVisible(this._element)||(t.beginPath(),e.paint(t),this.clearShadow(t)))},getViewRect:function(){return o.cloneRect(this._viewRect)},getUnionBodyBounds:function(){return o.cloneRect(this._unionBodyBounds)},addBodyBounds:function(t){t&&this._bodyBounds.add(t)},getBodyRect:function(t){return null==t&&(t=!0),this._bodyRect||(this._bodyRect=this.createBodyRect()),t?o.cloneRect(this._bodyRect):this._bodyRect},getHotSpot:function(){return this._hotSpot?o.clone(this._hotSpot):{x:0,y:0}},setHotSpot:function(t){this._hotSpot=t},hit:function(t,e){return!1},intersects:function(t){return!!f.contains(t,this.getZoomViewRect())},hitCanvasRectAtBody:function(t){t.width<1&&(t.width=1),t.height<1&&(t.height=1);var e=ke.getHitCanvas(t.width,t.height),i=ke.getCtx(e);if(i.save(),i.translate(-t.x,-t.y),this._element.getImage&&(e=o.getImageAsset(this._element.getImage()))&&e.getImage()instanceof re)return 1;this.paintBody(i);try{for(var n=i.getImageData(0,0,t.width,t.height),s=n.data,r=0;r<n.width;r++)for(var a=0;a<n.height;a++)if(0!==s[3+4*(a*n.width+r)])return i.restore(),1}catch(e){if(ke.disposeHitCanvas(),f.contains(this.getUnionBodyBounds(),t))return 0}return i.restore(),-1},hitCanvasRectAtAttachments:function(t){var e=ke.getHitCanvas(t.width,t.height),i=ke.getCtx(e);i.save(),i.translate(-t.x,-t.y),this.paintAttachments(i);try{for(var n=i.getImageData(0,0,t.width,t.height),o=n.data,s=0;s<n.width;s++)for(var r=0;r<n.height;r++)if(0!==o[3+4*(r*n.width+s)])return i.restore(),1}catch(t){ke.disposeHitCanvas()}return i.restore(),-1},hitCanvasRect:function(t){this._intersectTest=!0,1==this._hitTest&&(this._intersectTest=!1);var e=f.intersection(t,this.getZoomViewRect());return 1==(t=this.hitCanvasRectAtBody(e))||1==this.hitCanvasRectAtAttachments(e)?!(this._intersectTest=!1):(this._intersectTest=!1,0==t)},hitCanvasPoint:function(t,e){return t={x:t,y:e,width:0,height:0},(e=this._network.getSelectionTolerance())&&0<e&&f.grow(t,e,e),!!f.intersects(this.getZoomViewRect(),t)&&(this._hitTest=!0,t=this.hitCanvasRect(t),this._hitTest=!1,t)},hitTest:function(t,e){var i={x:t,y:e,width:0,height:0},n=this._network.getSelectionTolerance();if(n&&0<n&&f.grow(i,n,n),!f.intersects(this.getZoomViewRect(),i))return null;i=f.intersection(i,this.getZoomViewRect());for(var o=this._attachments.size(),s=0;s<o;s++){var r=this._attachments.get(s);if(r.hit(t,e))return r}return 1==(i=this.hitCanvasRectAtBody(i))||0==i?this:null},dispose:function(){this._attachments.forEach(function(t){t.dispose()}),this._attachments.clear()}}),n.vector.NodeUI=function(t,e){n.vector.NodeUI.superClass.constructor.call(this,t,e)},o.ext("b2.vector.NodeUI",n.vector.ElementUI,{invalidate:function(t){this.curInterval&&clearInterval(this.curInterval),n.vector.NodeUI.superClass.invalidate.call(this,t)},createBodyRect:function(){return this._element.getRect()},validateImpl:function(){n.vector.NodeUI.superClass.validateImpl.call(this);var t=this.getStyle("vector.shape"),e=this.getBodyRect();this._hotSpot=f.getHotSpot(e.x,e.y,e.width,e.height,t),this.validateBodyBounds()},validate:function(){0!=this._invalidateFlag&&n.vector.NodeUI.superClass.validate.call(this)},validateBodyBounds:function(){var t=this.getStyle("body.type");"default"===t?this.addBodyBounds(this.getDefaultBodyRect()):"vector"===t?this.addBodyBounds(this.getVectorBody()):"default.vector"===t?(this.addBodyBounds(this.getVectorBody()),this.addBodyBounds(this.getDefaultBodyRect())):"vector.default"===t&&(this.addBodyBounds(this.getDefaultBodyRect()),this.addBodyBounds(this.getVectorBody())),this._outerColor&&"border"===this.getStyle("outer.style")&&this.addBodyBounds(this.getOuterBorderRect()),!this._editAttachment&&"border"===this.getStyle("select.style")&&this._network.isSelected(this._element)&&this.addBodyBounds(this.getSelectBorderRect())},getDefaultBodyRect:function(){var t=this._element,e=this.getBodyRect();return!t.getImage()||"string"==typeof t.getImage()&&!o.getImageAsset(t.getImage())?e:(f.addPadding(e,this._element,"image.padding",1),t=o.cloneRect(e),this.appendGlowBound(this,t),this.appendShadowBound(this,t),t)},getVectorBody:function(){return this.getPathRect("vector")},getOuterBorderRect:function(){return this._getBorderRect("outer")},getSelectBorderRect:function(){return this._getBorderRect("select")},_getBorderRect:function(t){var e=this._element,i=e.getStyle(t+".width"),n=e.getStyle("select.physicalZoom")?1:this._network.getGraphicsZoom();if(0<i){i="select"===t?i/n:i;var s=this.getBodyRect();return f.addPadding(s,e,t+".padding","select"===t?1/n:1),s=o.cloneRect(s),f.grow(s,2*i,2*i),s}return null},getPathRect:function(t,e){var i=this._element,n=this.getBodyRect();this._network.zoomManager.getSizeZoom(),e&&f.addPadding(n,i,t+".padding",1);n=o.cloneRect(n);var s=i.getStyle(t+".outline.width");if(0<s)if(this._getZoomPoints){for(var r,a,h=this._element._points,l=h.size(),c=0,d=0;d<l;d++){g=0==d?(r=h.get(d),a=h.get(l-1),h.get(d+1)):d==l-1?(r=h.get(d),a=h.get(d-1),h.get(0)):(r=h.get(d),a=h.get(d-1),h.get(d+1));var u=f.getCenterPoint(a,g),g=f.getAngle(u,r);c=(c=c<(u=Math.abs(5*(s+1)*Math.sin(g)))?u:c)<(u=Math.abs(5*(s+1)*Math.cos(g)))?u:c}f.grow(n,c,c)}else f.grow(n,s/2,s/2);return this.appendGlowBound(this,n),this.appendShadowBound(this,n),n},getZoomPathRect:function(t,e){var i=this._element,n=this.getZoomBodyRect();this._network.zoomManager.getSizeZoom(),e&&f.addPadding(n,i,t+".padding",1);n=o.cloneRect(n);var s=i.getStyle(t+".outline.width");if(0<s)if(this._getZoomPoints){for(var r,a,h=this._getZoomPoints(),l=h.size(),c=0,d=0;d<l;d++){g=0==d?(r=h.get(d),a=h.get(l-1),h.get(d+1)):d==l-1?(r=h.get(d),a=h.get(d-1),h.get(0)):(r=h.get(d),a=h.get(d-1),h.get(d+1));var u=f.getCenterPoint(a,g),g=f.getAngle(u,r);c=(c=c<(u=Math.abs(5*(s+1)*Math.sin(g)))?u:c)<(u=Math.abs(5*(s+1)*Math.cos(g)))?u:c}f.grow(n,c,c)}else f.grow(n,s/2,s/2);return this.appendGlowBound(this,n),this.appendShadowBound(this,n),n},paintBody:function(t){this.curInterval&&clearInterval(this.curInterval);var e=this.getStyle("body.type");"default"===e?this.drawDefaultBody(t):"vector"===e?this.drawVectorBody(t):"default.vector"===e?(this.drawVectorBody(t),this.drawDefaultBody(t)):"vector.default"===e&&(this.drawDefaultBody(t),this.drawVectorBody(t)),this._outerColor&&"border"===this.getStyle("outer.style")&&this.drawOuterBorder(t),"border"===this.getStyle("select.style")&&this._network.isSelected(this._element)&&this.drawSelectBorder(t)},drawOuterBorder:function(t){var e,i=this._element,n=i.getStyle("outer.width");0<n&&(e=this.getZoomBodyRect(),f.addPadding(e,i,"outer.padding",1),t.lineWidth=n,t.lineCap=i.getStyle("outer.cap"),t.lineJoin=i.getStyle("outer.join"),t.strokeStyle=this._outerColor,m.drawVector(t,i.getStyle("outer.shape"),null,e),t.stroke())},drawDefaultBody:function(t){var e,i,s,r,a,h,l=this._element;l.getImage()&&("string"!=typeof l.getImage()||(e=o.getImageAsset(l.getImage())))&&(this._shapeRect&&(!l.getStyle("group.expend.image")||"string"==typeof l.getStyle("group.expend.image")&&!(e=o.getImageAsset(l.getStyle("group.expend.image"))))||(i=this.getZoomBodyRect(),f.addPadding(i,this._element,"image.padding",1),0!=l.getAngle()&&(t.save(),i=l.getOriginalRect(),i=this._network.zoomManager._getElementZoomRect(this,i),n.Util.rotateCanvas(t,i,l.getAngle())),this.setGlow(this,t),this.setShadow(this,t),e&&e.getImage()instanceof re?(s=e.getImage().frames,r=e.getImage().size,h=ae(s,r,a=0),t.drawImage(h,i.x,i.y,i.width,i.height),this.curInterval=setInterval(function(){a=(a+s.length)%s.length,h=ae(s,r,a),t.drawImage(h,i.x,i.y,i.width,i.height),a++},100)):this._shapeRect?bt(t,l.getStyle("group.expend.image"),this.getInnerColor(),i,l,this._network):bt(t,l.getImage(),this.getInnerColor(),i,l,this._network),0!=l.getAngle()&&t.restore()))},drawSelectBorder:function(t){this.clearGlow(t);var e,i,n=this._element,s=n.getStyle("select.width");0<s&&(e=this.getZoomBodyRect(),e=o.cloneRect(e),i=n.getStyle("select.physicalZoom")?1:this._network.getGraphicsZoom(),f.addPadding(e,n,"select.padding",1/i),f.grow(e,s/2/i,s/2/i),t.lineWidth=s/i,t.lineCap=n.getStyle("select.cap"),t.lineJoin=n.getStyle("select.join"),t.strokeStyle=n.getStyle("select.color"),m.drawVector(t,n.getStyle("select.shape"),null,e),t.stroke())},drawVectorBody:function(t){this.drawPath(t,"vector",!0,this._element.getStyle("vector.outline.pattern"));var e,i,o,s=this.getStyle("vector.deep"),r=this.getStyle("vector.fill.color");0!==s&&r&&"rectangle"===this.getStyle("vector.shape")&&(e=this.getZoomBodyRect(),0!=(i=this._element.getAngle())&&(t.save(),o=this._element.getOriginalRect(),o=this._network.zoomManager._getElementZoomRect(this,o),n.Util.rotateCanvas(t,o,i)),m.draw3DRect(t,r,s,e),0!=i&&t.restore())},drawPath:function(t,e,i,o,s,r,a){var h=this._network.zoomManager,l=this._element,c=null;c="group"==e?this._shapeRect:this.getZoomBodyRect();i&&f.addPadding(c,l,e+".padding",1),i=l.getStyle(e+".outline.width"),this.setGlow(this,t),this.setShadow(this,t),0!=l.getAngle()&&(l instanceof Le||(c=l.getOriginalRect(),c=h._getElementZoomRect(this,c)),t.save(),n.Util.rotateCanvas(t,c,l.getAngle())),(h=l.getStyle(e+".fill"))&&(u=this._innerColor&&!lt.hasDefault(this._element)?this._innerColor:l.getStyle(e+".fill.color"),(d=l.getStyle(e+".gradient"))?m.fill(t,u,d,l.getStyle(e+".gradient.color"),c):t.fillStyle=u);var d=l.getStyle(e+".shape"),u=l.getStyle("group.shape.roundrect.radius");u<0&&(u=10),h&&(t.beginPath(),s?m.drawLinePoints(t,s,null,r,a):"roundrect"===d&&"group"===e?m.drawVector(t,d,null,c,u):m.drawVector(t,d,null,c),t.fill()),0<i&&(t.lineWidth=i,t.lineCap=l.getStyle(e+".cap"),t.lineJoin=l.getStyle(e+".join"),t.strokeStyle=l.getStyle(e+".outline.color"),t.beginPath(),s?m.drawLinePoints(t,s,o,r,a):"roundrect"===d&&"group"===e?m.drawVector(t,d,o,c,u):m.drawVector(t,d,o,c),t.stroke()),0!=l.getAngle()&&t.restore()},hit:function(t,e){var i={x:t,y:e,width:0,height:0},n=this._network.getSelectionTolerance();return n&&0<n&&f.grow(i,n,n),!(!this._network._transparentSelectionEnable||(n=this.getBodyRect(),!o.math.intersects(n,i)))||!!f.intersects(this.getZoomViewRect(),i)&&this.hitCanvasPoint(t,e)},intersects:function(t){if(1==n.vector.NodeUI.superClass.intersects.apply(this,arguments))return!0;if(this._network._transparentSelectionEnable){var e=this.getBodyRect();if(o.math.intersects(e,t))return!0}return!!f.intersects(t,this.getZoomViewRect())&&this.hitCanvasRect(t)}}),n.vector.LinkUI=function(t,e){n.vector.LinkUI.superClass.constructor.call(this,t,e)},o.ext("b2.vector.LinkUI",n.vector.ElementUI,{isEditable:function(){return!0},invalidate:function(t){this._linkPoints=null,this._fromPoint=null,this._toPoint=null,this._angle=null,n.vector.LinkUI.superClass.invalidate.call(this,t)},invalidateZoom:function(){this._fromPoint=null,this._toPoint=null,this._linkPoints=null,n.vector.LinkUI.superClass.invalidateZoom.call(this)},validateImpl:function(){this.validateBodyBounds(),n.vector.LinkUI.superClass.validateImpl.call(this)},validateBodyBounds:function(){var t,e,i,n=this.getLinkPoints();!n||n.size()<2||(t=this._element,e=f.getLineRect(n),i=t.getStyle("link.width"),this._outerColor&&(i+=2*t.getStyle("outer.width")),!this._editAttachment&&"border"===t.getStyle("select.style")&&this._network.isSelected(this._element)&&(i+=2*t.getStyle("select.width")),f.grow(e,i/2,i/2),t.getStyle("arrow.from")&&(e=this._network._edgeDetect?(this._network._debug&&(this._arrowFromRect=oe.getArrowRect(this,n,!0,t.getStyle("arrow.from.shape"),t.getStyle("arrow.from.width"),t.getStyle("arrow.from.height"),0,0,this._network.zoomManager)),f.unionRect(e,oe.getArrowRect(this,n,!0,t.getStyle("arrow.from.shape"),t.getStyle("arrow.from.width"),t.getStyle("arrow.from.height"),0,0,this._network.zoomManager))):(this._network._debug&&(this._arrowFromRect=oe.getArrowRect(this,n,!0,t.getStyle("arrow.from.shape"),t.getStyle("arrow.from.width"),t.getStyle("arrow.from.height"),t.getStyle("arrow.from.xoffset"),t.getStyle("arrow.from.yoffset"),this._network.zoomManager)),f.unionRect(e,oe.getArrowRect(this,n,!0,t.getStyle("arrow.from.shape"),t.getStyle("arrow.from.width"),t.getStyle("arrow.from.height"),t.getStyle("arrow.from.xoffset"),t.getStyle("arrow.from.yoffset"),this._network.zoomManager)))),t.getStyle("arrow.to")&&(e=this._network._edgeDetect?(this._network._debug&&(this._arrowToRect=oe.getArrowRect(this,n,!1,t.getStyle("arrow.to.shape"),t.getStyle("arrow.to.width"),t.getStyle("arrow.to.height"),0,0,this._network.zoomManager)),f.unionRect(e,oe.getArrowRect(this,n,!1,t.getStyle("arrow.to.shape"),t.getStyle("arrow.to.width"),t.getStyle("arrow.to.height"),0,0,this._network.zoomManager))):(this._network._debug&&(this._arrowToRect=oe.getArrowRect(this,n,!1,t.getStyle("arrow.to.shape"),t.getStyle("arrow.to.width"),t.getStyle("arrow.to.height"),t.getStyle("arrow.to.xoffset"),t.getStyle("arrow.to.yoffset"),this._network.zoomManager)),f.unionRect(e,oe.getArrowRect(this,n,!1,t.getStyle("arrow.to.shape"),t.getStyle("arrow.to.width"),t.getStyle("arrow.to.height"),t.getStyle("arrow.to.xoffset"),t.getStyle("arrow.to.yoffset"),this._network.zoomManager)))),this.appendShadowBound(this,e),this.addBodyBounds(e),this._growLinkJoinBounds(e,i))},_growLinkJoinBounds:function(t,e){},createBodyRect:function(){var t=this.getHotSpot();return t?{x:t.x-1,y:t.y-1,width:2,height:2}:null},paintBody:function(t){var e,i,o,s,r,a,h,l=this.getLinkPoints();!l||l.size()<2||(s=o=(i=(e=this._element).isBundleAgent()&&e.getStyle("link.agent"))?e.getStyle("link.agent.width"):e.getStyle("link.width"),this._outerColor&&"border"===this.getStyle("outer.style")&&(s+=2*(r=e.getStyle("outer.width"))),(a=!this._editAttachment&&"border"===e.getStyle("select.style")&&this._network.isSelected(this._element))&&(s+=2*e.getStyle("select.width")),this.setGlow(this,t),this.setShadow(this,t),t.lineCap=i?e.getStyle("link.agent.cap"):e.getStyle("link.cap"),t.lineJoin=i?e.getStyle("link.agent.join"):e.getStyle("link.join"),h=i?e.getStyle("link.agent.pattern"):e.getStyle("link.pattern"),a&&this.drawLinePoints(t,l,s,e.getStyle("select.color"),h),this._outerColor&&"border"===this.getStyle("outer.style")&&this.drawLinePoints(t,l,o+2*r,this._outerColor,h),this.drawLinePoints(t,l,o,this._innerColor||(i?e.getStyle("link.agent.color"):e.getStyle("link.color")),h),oe.drawLinkArrow(this,t,l,this._network.zoomManager),this._network._debug&&(m.strokeRect(t,this._arrowToRect,n.Util.randomColor()),m.strokeRect(t,this._arrowFromRect,n.Util.randomColor())))},drawLinePoints:function(t,e,i,n,o){t.lineWidth=i,t.strokeStyle=n;var s,r=this._element.isBundleAgent()&&this._element.getStyle("link.agent");!0===this._element.getStyle(r?"link.agent.flow":"link.flow")&&o&&1<o.length?(s=new ht(t,o[0],o[1]),i=this._element.getStyle(r?"link.agent.flow.offset":"link.flow.offset"),2<(n=Math.floor(i/(o[0]+o[1])))&&(i-=(o[0]+o[1])*n),this._element.getStyle(r?"link.agent.flow.converse":"link.flow.converse")?i<o[0]?s.overflow=o[0]-i:i>=o[0]&&i<=o[0]+o[1]?(s.overflow=o[1]-(i-o[0]),s.overflow&&(s.isLine=!1)):(i-=o[0]+o[1],s.overflow=o[0]-i):i<=o[1]?(s.overflow=i)&&(s.isLine=!1):i>o[1]&&i<=o[0]+o[1]?s.overflow=i-o[1]:((i-=o[0]+o[1])&&(s.isLine=!1),s.overflow=i),this._element._styleMap[r?"link.agent.flow.offset":"link.flow.offset"]=i,t.beginPath(),m._drawLine(e,t),t.stroke(),t.shadowColor="transparent",t.beginPath(),r=(r=this._element.getStyle(r?"link.agent.flow.color":"link.flow.color"))||Ee.NETWORK_LINK_FLOW_COLOR,t.strokeStyle=r,m._drawLine(e,s),t.stroke(),t.shadowColor=this._shadowColor):(t.beginPath(),m.drawLinePoints(t,e,o),t.stroke())},getLinkPoints:function(){return this._linkPoints||(this._linkPoints=this.createLinkPoints(),this._lineLength=f.calculateLineLength(this._linkPoints)),this._linkPoints},getFromPosition:function(t,e){var i=this.getFromPoint();return i?{x:i.x+t,y:i.y+e}:null},getToPosition:function(t,e){var i=this.getToPoint();return i?{x:i.x+t,y:i.y+e}:null},getFromPoint:function(){return this._fromPoint||(this._fromPoint=dt.createFromPoint(this,this._network.zoomManager)),this._fromPoint},getToPoint:function(){return this._toPoint||(this._toPoint=dt.createToPoint(this,this._network.zoomManager)),this._toPoint},getZoomBodyRect:function(){return this.getBodyRect()},getZoomViewRect:function(){return this._viewRect},createLinkPoints:function(){var t=this._network.zoomManager,e=this.getStyle("link.type"),i=new n.List;if(dt.isOrthogonalOrFlexionalLink(this._element))i=dt.orthogonalAndFlexional(this,e,t);else if(this._element.isLooped()){null!=(s=this._network.getElementUI(this._element.getFromAgent()))&&(this._hotSpot=dt.fillLoopedPoints(this,s.getZoomBodyRect(),i))}else{if("arc"!==e&&"triangle"!==e&&"parallel"!==e)throw"Can not resolve link type '"+e+"'";var o=this.getFromPoint(),s=this.getToPoint();this._hotSpot=dt.fillBundlePoints(this,e,o,s,i,t)}return!this._network._linkPathFunction||(t=this._network._linkPathFunction(this,i))&&(i=t),i},checkAttachments:function(){n.vector.LinkUI.superClass.checkAttachments.call(this),this.checkLinkHandlerAttachment()},checkLinkHandlerAttachment:function(){var t=this._network.getLinkHandlerLabel(this._element);null!=t&&""!==t?this._linkHandlerAttachment||(this._linkHandlerAttachment=new n.vector.LinkHandlerAttachment(this),this.addAttachment(this._linkHandlerAttachment)):this._linkHandlerAttachment&&(this.removeAttachment(this._linkHandlerAttachment),this._linkHandlerAttachment=null)},getLinkHandlerAttachment:function(){return this._linkHandlerAttachment},getControlPoint:function(){return dt.getControlPoint(this._element,this,this._network.zoomManager)},setControlPoint:function(t){var e,i,n;t&&(e=this.getStyle("link.type"),dt.hasControlPoint(e)&&(i=dt.getLinkSourceBounds(this,this._network.zoomManager),n=dt.getLinkTargetBounds(this,this._network.zoomManager),dt.setParamsByControlPoint(t,i,n,e,this._element)))},getLineLength:function(){return this._lineLength},hit:function(t,e){var i={x:t,y:e,width:0,height:0},n=this._network.getSelectionTolerance();return n&&0<n&&f.grow(i,n,n),!!f.intersects(this._viewRect,i)&&this.hitCanvasPoint(t,e)},intersects:function(t){if(1==n.vector.NodeUI.superClass.intersects.apply(this,arguments))return!0;if(0==f.intersects(t,this._viewRect))return!1;var e=this.getLinkPoints(),i=e.size();if(2==i)for(var o=0;o<i;o+=2){var s=e.get(o);if(o+1<i){var r=e.get(o+1);if(ke.intersectsLine(s.x,s.y,r.x,r.y,t.x,t.y,t.width,t.height))return!0}}return this.hitCanvasRect(t)},getAngle:function(){return!this._angle&&this._fromPoint&&this._toPoint&&(this._angle=f.getAngle(this._fromPoint,this._toPoint)),this._angle||0},getAbsoluteAngle:function(){var t=this._fromPoint,e=this._toPoint,i=e.x-t.x,n=e.y-t.y;n=180*Math.acos((10*i+0*n)/(Math.sqrt(100)*Math.sqrt(i*i+n*n)))/Math.PI;return(n=t.y<=e.y?n:360-n)%360*Math.PI/180},appendShadowBound:function(t,e){return t.isShadowable()&&this._shadowColor&&!this._editAttachment&&(0<this._shadowXOffset?e.width+=this._shadowXOffset:(e.x+=this._shadowXOffset,e.width+=-this._shadowXOffset),0<this._shadowYOffset?e.height+=this._shadowYOffset:(e.y+=this._shadowYOffset,e.height+=-this._shadowYOffset),t=this._shadowBlur,f.grow(e,t+1,t+1)),e}}),n.vector.GroupUI=function(t,e){n.vector.GroupUI.superClass.constructor.call(this,t,e)},o.ext("b2.vector.GroupUI",n.vector.NodeUI,{isEditable:function(){return!this._element.isExpanded()},paintBody:function(t){this._shapeRect?this._element.getStyle("group.expend.image")?(n.vector.GroupUI.superClass.paintBody.apply(this,arguments),this._element.getStyle("group.expend.image.vector")&&this.drawExpandedGroup(t)):this.drawExpandedGroup(t):n.vector.GroupUI.superClass.paintBody.apply(this,arguments)},validateBodyBounds:function(){var t,e;this.getBodyRect(),this._shapeRect?(t=this.getPathRect("group",!1),e=this.getStyle("group.deep"),f.grow(t,e+1,e+1),this.addBodyBounds(t)):n.vector.GroupUI.superClass.validateBodyBounds.call(this)},getZoomBodyRect:function(){return this._element.isExpanded()?this.getBodyRect():n.vector.GroupUI.superClass.getZoomBodyRect.call(this)},getZoomViewRect:function(){return this._element.isExpanded()?this.getViewRect():n.vector.GroupUI.superClass.getZoomViewRect.call(this)},drawExpandedGroup:function(t){this.drawPath(t,"group",!1,this._element.getStyle("vector.outline.pattern"));var e=this.getStyle("group.deep"),i=this.getStyle("group.fill.color");0!==e&&i&&"rectangle"===this.getStyle("group.shape")&&m.draw3DRect(t,i,e,this._shapeRect)},getChildrenRects:function(){return this._network.getGroupChildrenRects(this._element)},createBodyRect:function(){this._shapeRect=null;var t=this._element,e=this._network;if(t.isExpanded()){t.getChildren().forEach(function(t){(t=e.getElementUI(t))&&t.validate()});var i=this.getChildrenRects();if(!i.isEmpty()){var o=t.getStyle("group.shape"),s=A[o];if(!s)throw"Can not resolve group shape '"+o+"'";this._shapeRect=s(i)}}return this._shapeRect?(f.addPadding(this._shapeRect,t,"group.padding",1),this._shapeRect):n.vector.GroupUI.superClass.createBodyRect.call(this)},appendShadowBound:function(t,e){return t.isShadowable()&&this._shadowColor&&!this._editAttachment&&(0<this._shadowXOffset?e.width+=this._shadowXOffset:(e.x+=this._shadowXOffset,e.width+=-this._shadowXOffset),0<this._shadowYOffset?e.height+=this._shadowYOffset:(e.y+=this._shadowYOffset,e.height+=-this._shadowYOffset),t=this._shadowBlur,f.grow(e,t+1,t+1)),e}}),n.vector.ShapeNodeUI=function(t,e){n.vector.ShapeNodeUI.superClass.constructor.call(this,t,e)},o.ext("b2.vector.ShapeNodeUI",n.vector.NodeUI,{getDefaultBodyRect:function(){return this._element._points.size()<2?null:this._reverseZoomPathRect()},drawDefaultBody:function(t){this._element._points.size()<2||(this.drawPath(t,"vector",!0,this._element.getStyle("vector.outline.pattern"),this._getZoomPoints(),this._element._segments,this._element.getStyle("shapenode.closed")),oe.drawLinkArrow(this,t,f.getPointObject(this._element._points,this._element._segments)))},invalidateZoom:function(){this._zoomPoints=null,n.vector.LinkUI.superClass.invalidateZoom.call(this)},_getZoomPoints:function(){return this._zoomPoints=this._network.zoomManager._getShapeNodeZoomPoints(this,this._element._points),this._zoomPoints},_reverseZoomPathRect:function(){return this._network.zoomManager._reverseElementZoomRect(this,this.getZoomPathRect("vector",!0))}}),n.vector.ShapeLinkUI=function(t,e){n.vector.ShapeLinkUI.superClass.constructor.call(this,t,e)},o.ext("b2.vector.ShapeLinkUI",n.vector.LinkUI,{isEditable:function(){return!0},createLinkPoints:function(){var t,e,i,s,r,a=this.getFromPoint(),h=this.getToPoint(),l=new n.List,c=this.getStyle("shapelink.type");if(l.add(a),null!=this._element._points&&0<this._element._points.size()&&l.addAll(this._network.zoomManager._getShapeLinkZoomPoints(this._element._points)),l.add(h),"lineto"!==c)if("quadto"===c){for(t=new n.List(l.get(0)),e=1,pointCount=l.size();e<pointCount;e++)e<pointCount-1?t.add(new n.List([l.get(e++),l.get(e)])):t.add(l.get(e));l=t}else if("cubicto"===c){for(t=new n.List(l.get(0)),e=1,pointCount=l.size();e<pointCount;e++)e<pointCount-2?t.add(new n.List([l.get(e++),l.get(e++),l.get(e)])):e<pointCount-1?t.add(new n.List([l.get(e++),l.get(e)])):t.add(l.get(e));l=t}else{if("orthogonalto"!==c)throw"Can not resolve shapelink type '"+c+"'";for(i=l.get(0),t=new n.List(i),e=1,pointCount=l.size();e<pointCount;e++)e<pointCount-1?(s=(d=o.clone(l.get(e))).x,r=d.y,g=s-i.x,_=r-i.y,Math.abs(g)>Math.abs(_)?(d.x=s,d.y=i.y):(d.x=i.x,d.y=r),i=d,t.add(i)):t.add(l.get(e));l=t}for(var d,u,g,_,A,y,p,m,v=f.calculateLineLength(l)/2,x=l.size(),w=0,E=0,C=0;C<x;C++)d=l.get(C),0!=C?(m=(p=(p=d)instanceof at?p._as:p)instanceof Array?(u=f.calculateCurveLength(m,p,1),p[p.length-1]):(_=d.y-m.y,g=d.x-m.x,u=Math.sqrt(g*g+_*_),p),E+=u,w<=v&&v<=E&&(y=v-w,(A=l.get(C-1))instanceof at&&(A=A._as)instanceof Array&&(A=A[A.length-1]),p=l.get(C),y=f.getPathInfo(p,A,y,0,-1).point,this._hotSpot=o.clone(y)),w=E):m=d;return l},_growLinkJoinBounds:function(t,e){f.grow(t,3*e,3*e)}}),n.vector.GridUI=function(t,e){n.vector.GridUI.superClass.constructor.call(this,t,e)},o.ext("b2.vector.GridUI",n.vector.NodeUI,{drawDefaultBody:function(t){this._element.getImage()?n.vector.GridUI.superClass.drawDefaultBody.apply(this,arguments):this.drawGridBody(t)},validateBodyBounds:function(){var t,e;this._element.getImage()?n.vector.GridUI.superClass.validateBodyBounds.call(this):(e=this.getBodyRect(),t=o.clone(e),e=this._element.getStyle("outer.width"),f.grow(t,e,e),this.appendShadowBound(this,t),this.addBodyBounds(t))},_getZoomCellRect:function(t,e){var i=this._element.getCellRect(t,e),n=(o=this._element.getRect()).x+o.width/2,o=(t=o.y+o.height/2,(e=this.getZoomBodyRect()).width/o.width);e=e.x+e.width/2;return{x:n*(e=0==n?1:e/n)+(i.x-n)*o,y:t*e+(i.y-t)*o,width:i.width*o,height:i.height*o}},drawGridBody:function(t){var e=this.getStyle("grid.fill"),i=this.getStyle("grid.deep"),n=this.getStyle("grid.cell.deep");if(e||0!==i||0!==n){t.beginPath();var o=this.getZoomBodyRect(),s=this.getDyeColor("grid.fill.color");if(this.setGlow(this,t),this.setShadow(this,t),e&&(t.fillStyle=s,t.rect(o.x,o.y,o.width,o.height),t.fill()),t.closePath(),this.clearShadow(t),t.beginPath(),0!=i&&m.draw3DRect(t,s,i,o.x,o.y,o.width,o.height),t.closePath(),0!=n)for(var r=this.getStyle("grid.row.count"),a=this.getStyle("grid.column.count"),h=0;h<r;h++)for(var l=0;l<a;l++){var c=this._getZoomCellRect(h,l);null!=c&&(t.beginPath(),m.draw3DRect(t,s,n,c.x,c.y,c.width,c.height),t.closePath())}}}}),n.vector.RotatableNodeUI=function(t,e){n.vector.RotatableNodeUI.superClass.constructor.call(this,t,e)},o.ext("b2.vector.RotatableNodeUI",n.vector.NodeUI,{isEditable:function(){return!1},getDefaultBodyRect:function(){var t=this._element,e=o.getImageAsset(t.getImage());t=this.getBodyRect();return e&&f.addPadding(t,this._element,"image.padding",1),t},drawDefaultBody:function(t){var e=this._element,i=o.getImageAsset(e.getImage());if(i){var n=this.getBodyRect();if(f.addPadding(n,this._element,"image.padding",1),i.getImage()){var s=this._element._getOrignalWidth(),r=this._element._getOrignalHeight(),a=this._element._getRotateRect();t.save(),t.translate(n.x-a.x+s/2,n.y-a.y+r/2),t.rotate(this._element._angle*Math.PI/180),t.drawImage(i.getImage(this._innerColor),-s/2,-r/2,s,r),t.restore()}else if(!i.getSrc()&&!i.getFunction())throw"ImageAsset '"+e.getImage()+" ' is empty"}}}),n.vector.HTMLNodeUI=function(t,e){n.vector.HTMLNodeUI.superClass.constructor.call(this,t,e)},o.ext("b2.vector.HTMLNodeUI",n.vector.NodeUI,{checkAttachments:function(){n.vector.NodeUI.prototype.checkAttachments.call(this)},checkLabelAttachment:function(){var t=this._element.getStyle("attachment.label.style");t&&"none"===t?n.vector.HTMLNodeUI.superClass.checkLabelAttachment.call(this):null!=(t=this._network.getLabel(this._element))&&""!==t?this._labelAttachment||(this._labelAttachment=new n.vector.HTMLLabelAttachment(this,Ee.SHOW_LABEL_IN_ATTACHMENT_DIV),this.addAttachment(this._labelAttachment)):this._labelAttachment&&(this.removeAttachment(this._labelAttachment),this._labelAttachment=null)},checkLabel2Attachment:function(){var t=this._element.getStyle("attachment.label2.style");t&&"none"===t?n.vector.HTMLNodeUI.superClass.checkLabel2Attachment.call(this):null!=(t=this._network.getLabel2(this._element))&&""!==t?this._label2Attachment||(this._label2Attachment=new n.vector.HTMLLabel2Attachment(this,Ee.SHOW_LABEL_IN_ATTACHMENT_DIV),this.addAttachment(this._label2Attachment)):this._label2Attachment&&(this.removeAttachment(this._label2Attachment),this._label2Attachment=null)},checkAlarmAttachment:function(){var t=this._element.getStyle("attachment.alarm.style");t&&"none"===t?n.vector.HTMLNodeUI.superClass.checkAlarmAttachment.call(this):null!=(t=this._network.getAlarmLabel(this._element))&&""!==t?this._alarmAttachment||(this._alarmAttachment=new n.vector.HTMLAlarmAttachment(this,!1),this.addAttachment(this._alarmAttachment)):this._alarmAttachment&&(this.removeAttachment(this._alarmAttachment),this._alarmAttachment=null)},setAttachmentVisible:function(t){t?(this._labelAttachment&&this._labelAttachment.setVisibility("visible"),this._label2Attachment&&this._label2Attachment.setVisibility("visible"),this._alarmAttachment&&this._alarmAttachment.setVisibility("visible")):(this._labelAttachment&&this._labelAttachment.setVisibility("hidden"),this._label2Attachment&&this._label2Attachment.setVisibility("hidden"),this._alarmAttachment&&this._alarmAttachment.setVisibility("hidden"))},validateZIndex:function(t){this._labelAttachment&&this._labelAttachment.validateZIndex(t)}}),n.vector.HTMLLinkUI=function(t,e){n.vector.HTMLLinkUI.superClass.constructor.call(this,t,e)},o.ext("b2.vector.HTMLLinkUI",n.vector.LinkUI,{checkAttachments:function(){n.vector.LinkUI.prototype.checkAttachments.call(this)},checkLabelAttachment:function(){var t=this._element.getStyle("attachment.label.style");t&&"none"===t?n.vector.HTMLLinkUI.superClass.checkLabelAttachment.call(this):null!=(t=this._network.getLabel(this._element))&&""!==t?this._labelAttachment||(this._labelAttachment=new n.vector.HTMLLabelAttachment(this,Ee.SHOW_LABEL_IN_ATTACHMENT_DIV),this.addAttachment(this._labelAttachment)):this._labelAttachment&&(this.removeAttachment(this._labelAttachment),this._labelAttachment=null)},checkLabel2Attachment:function(){var t=this._element.getStyle("attachment.label2.style");t&&"none"===t?n.vector.HTMLNodeUI.superClass.checkLabelAttachment.call(this):null!=(t=this._network.getLabel2(this._element))&&""!==t?this._label2Attachment||(this._label2Attachment=new n.vector.HTMLLabel2Attachment(this,Ee.SHOW_LABEL_IN_ATTACHMENT_DIV),this.addAttachment(this._label2Attachment)):this._label2Attachment&&(this.removeAttachment(this._label2Attachment),this._label2Attachment=null)},checkAlarmAttachment:function(){var t=this._element.getStyle("attachment.alarm.style");t&&"none"===t?n.vector.HTMLLinkUI.superClass.checkAlarmAttachment.call(this):null!=(t=this._network.getAlarmLabel(this._element))&&""!==t?this._alarmAttachment||(this._alarmAttachment=new n.vector.HTMLAlarmAttachment(this,!1),this.addAttachment(this._alarmAttachment)):this._alarmAttachment&&(this.removeAttachment(this._alarmAttachment),this._alarmAttachment=null)},setAttachmentVisible:function(t){t?(this._labelAttachment&&this._labelAttachment.setVisibility("visible"),this._label2Attachment&&this._label2Attachment.setVisibility("visible"),this._alarmAttachment&&this._alarmAttachment.setVisibility("visible")):(this._labelAttachment&&this._labelAttachment.setVisibility("hidden"),this._label2Attachment&&this._label2Attachment.setVisibility("hidden"),this._alarmAttachment&&this._alarmAttachment.setVisibility("hidden"))}}),n.vector.Attachment=function(t,e){this._ui=t,this._element=this._ui.getElement(),this._network=t.getNetwork(),(this._showOnTop=e)&&this._network._hitTestTopAttachmentList.add(this)},o.ext("b2.vector.Attachment",Object,{getElement:function(){return this._element},getElementUI:function(){return this._ui},getNetwork:function(){return this._network},isShowOnTop:function(){return!0===this._showOnTop},setShowOnTop:function(t){this._showOnTop=t},getStyle:function(t){return this._ui.getStyle(t)},getFont:function(t){return this._ui.getFont(t)},getViewRect:function(){return o.clone(this._viewRect)},getAlpha:function(){return 1},validate:function(){},paint:function(t){},getZoomViewRect:function(){return this._network.zoomManager._getAttachmentZoomOutLineRect(this,this._viewRect)},hit:function(t,e){return!!f.containsPoint(this.getZoomViewRect(),t,e)&&this.hitCanvasRect({x:t-1,y:e-1,width:2,height:2})},hitCanvasRect:function(t){var e=ke.getHitCanvas(t.width,t.height),i=ke.getCtx(e);i.save(),i.translate(-t.x,-t.y),this.paint(i);try{for(var n=i.getImageData(0,0,t.width,t.height),o=n.data,s=0;s<n.width;s++)for(var r=0;r<n.height;r++)if(0!==o[3+4*(r*n.width+s)])return i.restore(),!0}catch(t){ke.disposeHitCanvas()}return i.restore(),!1},dispose:function(){this._network._hitTestTopAttachmentList.remove(this)},_rotatePoint:function(t,e,i){return f.createMatrix(e*Math.PI/180,i.x+i.width/2,i.y+i.height/2).transform(t)},_rotatePointList:function(t,e,i){var o=this,s=new n.List;return t.forEach(function(t){s.add(o._rotatePoint(t,e,i))}),s}}),n.vector.BasicAttachment=function(t,e){n.vector.BasicAttachment.superClass.constructor.call(this,t,e),this._roundRect={x:0,y:0,width:0,height:0},this._contentRect={x:0,y:0,width:0,height:0}},o.ext("b2.vector.BasicAttachment",n.vector.Attachment,{paint:function(t){n.vector.BasicAttachment.superClass.paint.apply(this,arguments);var e=this.isFill(),i=this.getOutlineWidth(),o=this._network.zoomManager._getAttachmentZoomOutLineRect(this,this._roundRect);this.getElementUI().setGlow(this,t),this.getElementUI().setShadow(this,t),(0<i||e)&&(m.drawRoundRect(t,o.x,o.y,o.width,o.height,this.getCornerRadius()),this._network._debug&&m.strokeRect(t,o,"#C71585"),this._pointers&&(o=this._ui.getZoomPointers(this,this._pointers),t.moveTo(o[0].x,o[0].y),t.lineTo(o[1].x,o[1].y),t.lineTo(o[2].x,o[2].y)),t.closePath(),0<i&&(t.lineWidth=i,t.strokeStyle=this.getOutlineColor(),t.lineCap=this.getCap(),t.lineJoin=this.getJoin(),t.stroke()),e&&(i=this.getFillColor(),(e=this.getGradient())?m.fill(t,i,e,this.getGradientColor(),this._viewRect):t.fillStyle=i,t.fill()))},validate:function(){n.vector.BasicAttachment.superClass.validate.call(this),this.calculateMeasure();var t,e,i=this.getOutlineWidth();(null==i||i<=0)&&(i=1),this._viewRect=f.getRect(this._pointers),this._viewRect=f.unionRect(this._viewRect,this._roundRect),0<i&&f.grow(this._viewRect,2*i,2*i),this._viewRect=this._ui.appendShadowBound(this,this._viewRect),this._element instanceof n.Link&&this._element.getStyle("link.label.rotatable")&&(t=this._viewRect.x+this._viewRect.width/2,e=this._viewRect.y+this._viewRect.height/2,i=Math.sqrt(this._viewRect.height*this._viewRect.height+this._viewRect.width*this._viewRect.width),this._viewRect={x:t-i,y:e-i,width:2*i,height:2*i})},calculateMeasure:function(){var t,e=this.getContentWidth(),i=this.getContentHeight(),o=this.getCornerRadius(),s=this.getPointerLength(),r=this.getPointerWidth(),a=this.getPosition(),h=this.getXOffset(),l=this.getYOffset(),c=this._roundRect;if(c.width=e+o,c.height=i,this._ui._element instanceof n.Link&&(t=this._ui.getLinkPoints(),u=(this._ui.getLineLength?this._ui:this._ui._element).getLineLength(),0<Math.abs(h)&&Math.abs(h)<1?"from"===a?h*=u:"to"===a?h=u*(1-h):(h/=2,h+=.5,h*=u):"from"===a||("to"===a?h=u-h:h+=u/2),t=(u=f.calculatePointInfoAlongLine(t,!0,h,l)).point,u.angle,u="from"===a?this._ui.getFromPoint():"to"===a?this._ui.getToPoint():this._ui._hotSpot,h=t.x-u.x,l=t.y-u.y),0<s){var d,u=this.getDirection(),g=this._network.getPosition(a,this._ui,null,h,l,!1);if("aboveleft"===u)c.y=g.y-s-c.height,c.x=g.x-(c.width-o),d=Math.max(g.x-r,g.x-(c.width-o)+o/2),this._pointers=[g,{x:g.x,y:g.y-s},{x:d,y:g.y-s}];else if("aboveright"===u)c.y=g.y-s-c.height,c.x=g.x-o,d=Math.min(g.x+r,g.x-o+c.width-o/2),this._pointers=[g,{x:g.x,y:g.y-s},{x:d,y:g.y-s}];else if("belowleft"===u)c.y=g.y+s,c.x=g.x-(c.width-o),d=Math.max(g.x-r,g.x-(c.width-o)+o/2),this._pointers=[g,{x:g.x,y:g.y+s},{x:d,y:g.y+s}];else if("belowright"===u)c.y=g.y+s,c.x=g.x-o,d=Math.min(g.x+r,g.x-o+c.width-o/2),this._pointers=[g,{x:g.x,y:g.y+s},{x:d,y:g.y+s}];else if("leftabove"===u)c.y=g.y+o-c.height,c.x=g.x-s-c.width,d=Math.max(g.y-r,g.y+o-c.height+o/2),this._pointers=[g,{x:g.x-s,y:g.y},{x:g.x-s,y:d}];else if("leftbelow"===u)c.y=g.y-o,c.x=g.x-s-c.width,d=Math.min(g.y+r,g.y-o+c.height-o/2),this._pointers=[g,{x:g.x-s,y:g.y},{x:g.x-s,y:d}];else if("rightabove"===u)c.y=g.y+o-c.height,c.x=g.x+s,d=Math.max(g.y-r,g.y+o-c.height+o/2),this._pointers=[g,{x:g.x+s,y:g.y},{x:g.x+s,y:d}];else if("rightbelow"===u)c.y=g.y-o,c.x=g.x+s,d=Math.min(g.y+r,g.y-o+c.height-o/2),this._pointers=[g,{x:g.x+s,y:g.y},{x:g.x+s,y:d}];else if("above"===u)c.y=g.y-s-c.height,c.x=g.x-c.width/2,d=Math.min(e/2,r/2),this._pointers=[g,{x:g.x-d,y:g.y-s},{x:g.x+d,y:g.y-s}];else if("below"===u)c.y=g.y+s,c.x=g.x-c.width/2,d=Math.min(e/2,r/2),this._pointers=[g,{x:g.x-d,y:g.y+s},{x:g.x+d,y:g.y+s}];else if("left"===u)c.y=g.y-c.height/2,c.x=g.x-s-c.width,d=Math.min(i/2,r/2),this._pointers=[g,{x:g.x-s,y:g.y+d},{x:g.x-s,y:g.y-d}];else{if("right"!==u)throw"Can not resolve '"+u+"' attachment direction";c.y=g.y-c.height/2,c.x=g.x+s,d=Math.min(i/2,r/2),this._pointers=[g,{x:g.x+s,y:g.y+d},{x:g.x+s,y:g.y-d}]}}else g=this._network.getPosition(a,this._ui,{width:c.width,height:c.height},h,l,!1),c.x=g.x,c.y=g.y,this._pointers=null;this._contentRect.x=c.x+(c.width-e)/2,this._contentRect.y=c.y+(c.height-i)/2,this._contentRect.width=e,this._contentRect.height=i,0!=(i=this.getPadding())&&f.grow(c,i,i),0!=(i=this.getPaddingLeft())&&(c.x-=i,c.width+=i),0!=(i=this.getPaddingRight())&&(c.width+=i),0!=(i=this.getPaddingTop())&&(c.y-=i,c.height+=i),0!=(i=this.getPaddingBottom())&&(c.height+=i),c.width<0&&(c.width=c.width,c.x-=c.width),c.height<0&&(c.height=-c.height,c.y-=c.height)},getContentWidth:function(){return n.Defaults.ATTACHMENT_CONTENT_WIDTH},getContentHeight:function(){return n.Defaults.ATTACHMENT_CONTENT_HEIGHT},getCornerRadius:function(){return n.Defaults.ATTACHMENT_CORNER_RADIUS},getPointerLength:function(){return n.Defaults.ATTACHMENT_POINTER_LENGTH},getPointerWidth:function(){return n.Defaults.ATTACHMENT_POINTER_WIDTH},getPosition:function(){return n.Defaults.ATTACHMENT_POSITION},getXOffset:function(){return n.Defaults.ATTACHMENT_XOFFSET},getYOffset:function(){return n.Defaults.ATTACHMENT_YOFFSET},getPadding:function(){return n.Defaults.ATTACHMENT_PADDING},getPaddingLeft:function(){return n.Defaults.ATTACHMENT_PADDING_LEFT},getPaddingRight:function(){return n.Defaults.ATTACHMENT_PADDING_RIGHT},getPaddingTop:function(){return n.Defaults.ATTACHMENT_PADDING_TOP},getPaddingBottom:function(){return n.Defaults.ATTACHMENT_PADDING_BOTTOM},getDirection:function(){return n.Defaults.ATTACHMENT_DIRECTION},isFill:function(){return n.Defaults.ATTACHMENT_FILL},getFillColor:function(){return n.Defaults.ATTACHMENT_FILL_COLOR},getGradient:function(){return n.Defaults.ATTACHMENT_GRADIENT},getGradientColor:function(){return n.Defaults.ATTACHMENT_GRADIENT_COLOR},getOutlineWidth:function(){return n.Defaults.ATTACHMENT_OUTLINE_WIDTH},getOutlineColor:function(){return n.Defaults.ATTACHMENT_OUTLINE_COLOR},getCap:function(){return n.Defaults.ATTACHMENT_CAP},getJoin:function(){return n.Defaults.ATTACHMENT_JOIN},isShadowable:function(){return n.Defaults.ATTACHMENT_SHADOWABLE},getRoundRect:function(){return o.clone(this._roundRect)},getContentRect:function(){return o.clone(this._contentRect)}}),n.vector.LabelAttachment=function(t,e){n.vector.LabelAttachment.superClass.constructor.call(this,t,e)},o.ext("b2.vector.LabelAttachment",n.vector.BasicAttachment,{paint:function(t){var e=this._element instanceof n.Link&&this._element.getStyle("link.label.rotatable");e&&(t.save(),s=(o=this.getZoomViewRect()).x+o.width/2,r=o.y+o.height/2,t.translate(s,r),t.rotate(this._network.getElementUI(this._element).getAngle()),t.translate(-s,-r)),n.vector.LabelAttachment.superClass.paint.apply(this,arguments);var i=this._network.zoomManager,o=i._getAttachmentZoomRect(this,this._contentRect),s=this._element.getStyle("label.align"),r=this._element&&this._element.getStyle("label.rotate.angle");0!==r&&(t.save(),n.Util.rotateCanvas(t,this._contentRect,r)),i._drawText(this,t,this.text,o,this.font,this.getStyle("label.color"),s,this.getStyle("label.linespacing")),!e&&0===r||t.restore(),this._network._debug&&(r=this._viewRect,m.strokeRect(t,r,"#AAABBB"))},validate:function(){this.font=this.getFont("label.font");var t=this.getLabel(),e=o.g.getTextSize(this.font,t),i=this.getMaxLength();0!==i&&e.width>i?(this.text=o.g.getCollapseTextInLength(this.font,t,i),this._textSize=o.g.getTextSize(this.font,this.text)):(this.text=t,this._textSize=e),n.vector.LabelAttachment.superClass.validate.call(this),i=this._viewRect,0!==(t=this._element&&this._element.getStyle("label.rotate.angle"))&&((e=new n.List).add({x:i.x,y:i.y}),e.add({x:i.x+i.width,y:i.y}),e.add({x:i.x+i.width,y:i.y+i.height}),e.add({x:i.x,y:i.y+i.height}),e=this._rotatePointList(e,t,i),e=n.Util.getRect(e),this._viewRect=e)},getLabel:function(){return this._network.getLabel(this._element)},getContentWidth:function(){return this._textSize?this._textSize.width:0},getContentHeight:function(){return this._textSize?this._textSize.height:0},getCornerRadius:function(){return this.getStyle("label.corner.radius")},getPointerLength:function(){return this.getStyle("label.pointer.length")},getPointerWidth:function(){return this.getStyle("label.pointer.width")},getPosition:function(){return this.getStyle("label.position")},getXOffset:function(){return this.getStyle("label.xoffset")},getYOffset:function(){return this.getStyle("label.yoffset")},getPadding:function(){return this.getStyle("label.padding")},getPaddingLeft:function(){return this.getStyle("label.padding.left")},getPaddingRight:function(){return this.getStyle("label.padding.right")},getPaddingTop:function(){return this.getStyle("label.padding.top")},getPaddingBottom:function(){return this.getStyle("label.padding.bottom")},getDirection:function(){return this.getStyle("label.direction")},isFill:function(){return this.getStyle("label.fill")},getFillColor:function(){return this.getStyle("label.fill.color")},getGradient:function(){return this.getStyle("label.gradient")},getGradientColor:function(){return this.getStyle("label.gradient.color")},getOutlineWidth:function(){return this.getStyle("label.outline.width")},getOutlineColor:function(){return this.getStyle("label.outline.color")},getCap:function(){return this.getStyle("label.cap")},getJoin:function(){return this.getStyle("label.join")},getAlpha:function(){return this.getStyle("label.alpha")},getMaxLength:function(){return this.getStyle("label.maxlength")},isShadowable:function(){return this.getStyle("label.shadowable")}}),n.vector.Label2Attachment=function(t,e){n.vector.Label2Attachment.superClass.constructor.call(this,t,e)},o.ext("b2.vector.Label2Attachment",n.vector.BasicAttachment,{paint:function(t){var e=this._element instanceof n.Link&&this._element.getStyle("link.label.rotatable");e&&(t.save(),s=(o=this.getZoomViewRect()).x+o.width/2,r=o.y+o.height/2,t.translate(s,r),t.rotate(this._network.getElementUI(this._element).getAngle()),t.translate(-s,-r)),n.vector.Label2Attachment.superClass.paint.apply(this,arguments);var i=this._network.zoomManager,o=i._getAttachmentZoomRect(this,this._contentRect),s=this._element.getStyle("label.align"),r=this._element&&this._element.getStyle("label2.rotate.angle");0!==r&&(t.save(),n.Util.rotateCanvas(t,this._contentRect,r)),i._drawText(this,t,this.text,o,this.font,this.getStyle("label2.color"),s,this.getStyle("label2.linespacing")),!e&&0===r||t.restore(),this._network._debug&&(i=i.getAttachmentSizeZoom(this),(o=o).width*=i,o.height*=i,m.strokeRect(t,o,"#AAABBB"))},validate:function(){this.font=this.getFont("label2.font");var t=this.getLabel(),e=o.g.getTextSize(this.font,t),i=this.getMaxLength();0!==i&&e.width>i?(this.text=o.g.getCollapseTextInLength(this.font,t,i),this._textSize=o.g.getTextSize(this.font,this.text)):(this.text=t,this._textSize=e),n.vector.LabelAttachment.superClass.validate.call(this),i=this._viewRect,0!==(t=this._element&&this._element.getStyle("label2.rotate.angle"))&&((e=new n.List).add({x:i.x,y:i.y}),e.add({x:i.x+i.width,y:i.y}),e.add({x:i.x+i.width,y:i.y+i.height}),e.add({x:i.x,y:i.y+i.height}),e=this._rotatePointList(e,t,i),e=n.Util.getRect(e),this._viewRect=e)},getLabel:function(){return this._network.getLabel2(this._element)},getContentWidth:function(){return this._textSize?this._textSize.width:0},getContentHeight:function(){return this._textSize?this._textSize.height:0},getCornerRadius:function(){return this.getStyle("label2.corner.radius")},getPointerLength:function(){return this.getStyle("label2.pointer.length")},getPointerWidth:function(){return this.getStyle("label2.pointer.width")},getPosition:function(){return this.getStyle("label2.position")},getXOffset:function(){return this.getStyle("label2.xoffset")},getYOffset:function(){return this.getStyle("label2.yoffset")},getPadding:function(){return this.getStyle("label2.padding")},getPaddingLeft:function(){return this.getStyle("label2.padding.left")},getPaddingRight:function(){return this.getStyle("label2.padding.right")},getPaddingTop:function(){return this.getStyle("label2.padding.top")},getPaddingBottom:function(){return this.getStyle("label2.padding.bottom")},getDirection:function(){return this.getStyle("label2.direction")},isFill:function(){return this.getStyle("label2.fill")},getFillColor:function(){return this.getStyle("label2.fill.color")},getGradient:function(){return this.getStyle("label2.gradient")},getGradientColor:function(){return this.getStyle("label2.gradient.color")},getOutlineWidth:function(){return this.getStyle("label2.outline.width")},getOutlineColor:function(){return this.getStyle("label2.outline.color")},getCap:function(){return this.getStyle("label2.cap")},getJoin:function(){return this.getStyle("label2.join")},getAlpha:function(){return this.getStyle("label2.alpha")},getMaxLength:function(){return this.getStyle("label2.maxlength")},isShadowable:function(){return this.getStyle("label2.shadowable")}}),n.vector.AlarmAttachment=function(t,e){n.vector.AlarmAttachment.superClass.constructor.call(this,t,e)},o.ext("b2.vector.AlarmAttachment",n.vector.BasicAttachment,{paint:function(t){n.vector.AlarmAttachment.superClass.paint.apply(this,arguments);var e=this._network.zoomManager,i=e._getAttachmentZoomRect(this,this._contentRect);e._drawText(this,t,this.text,i,this.font,this.getStyle("alarm.color"))},validate:function(){this.font=this.getFont("alarm.font"),this.text=this._network.getAlarmLabel(this._element),this._textSize=m.getTextSize(this.font,this.text),this._fillColor=this._network.getAlarmFillColor(this._element),n.vector.AlarmAttachment.superClass.validate.call(this)},getContentWidth:function(){return this._textSize?this._textSize.width:0},getContentHeight:function(){return this._textSize?this._textSize.height:0},getCornerRadius:function(){return this.getStyle("alarm.corner.radius")},getPointerLength:function(){return this.getStyle("alarm.pointer.length")},getPointerWidth:function(){return this.getStyle("alarm.pointer.width")},getPosition:function(){return this.getStyle("alarm.position")},getXOffset:function(){return this.getStyle("alarm.xoffset")},getYOffset:function(){return this.getStyle("alarm.yoffset")},getPadding:function(){return this.getStyle("alarm.padding")},getPaddingLeft:function(){return this.getStyle("alarm.padding.left")},getPaddingRight:function(){return this.getStyle("alarm.padding.right")},getPaddingTop:function(){return this.getStyle("alarm.padding.top")},getPaddingBottom:function(){return this.getStyle("alarm.padding.bottom")},getDirection:function(){return this.getStyle("alarm.direction")},isFill:function(){return null!=this._fillColor},getFillColor:function(){return this._fillColor},getGradient:function(){return this.getStyle("alarm.gradient")},getGradientColor:function(){return this.getStyle("alarm.gradient.color")},getOutlineWidth:function(){return this.getStyle("alarm.outline.width")},getOutlineColor:function(){return this.getStyle("alarm.outline.color")},getCap:function(){return this.getStyle("alarm.cap")},getJoin:function(){return this.getStyle("alarm.join")},getAlpha:function(){return this.getStyle("alarm.alpha")},isShadowable:function(){return this.getStyle("alarm.shadowable")}}),n.vector.LinkHandlerAttachment=function(t,e){n.vector.LinkHandlerAttachment.superClass.constructor.call(this,t,e)},o.ext("b2.vector.LinkHandlerAttachment",n.vector.BasicAttachment,{paint:function(t){var e=this._network.zoomManager;n.vector.LinkHandlerAttachment.superClass.paint.apply(this,arguments);var i=e._getAttachmentZoomRect(this,this._contentRect);e._drawText(this,t,this.linkHandlerLabel,i,this.linkHandlerFont,this.getStyle("link.handler.color"))},validate:function(){this.linkHandlerFont=this.getFont("link.handler.font"),this.linkHandlerLabel=this._network.getLinkHandlerLabel(this._element),this._textSize=m.getTextSize(this.linkHandlerFont,this.linkHandlerLabel),n.vector.LinkHandlerAttachment.superClass.validate.call(this)},getContentWidth:function(){return this._textSize?this._textSize.width:0},getContentHeight:function(){return this._textSize?this._textSize.height:0},getCornerRadius:function(){return this.getStyle("link.handler.corner.radius")},getPointerLength:function(){return this.getStyle("link.handler.pointer.length")},getPointerWidth:function(){return this.getStyle("link.handler.pointer.width")},getPosition:function(){return this.getStyle("link.handler.position")},getXOffset:function(){return this.getStyle("link.handler.xoffset")},getYOffset:function(){return this.getStyle("link.handler.yoffset")},getPadding:function(){return this.getStyle("link.handler.padding")},getPaddingLeft:function(){return this.getStyle("link.handler.padding.left")},getPaddingRight:function(){return this.getStyle("link.handler.padding.right")},getPaddingTop:function(){return this.getStyle("link.handler.padding.top")},getPaddingBottom:function(){return this.getStyle("link.handler.padding.bottom")},getDirection:function(){return this.getStyle("link.handler.direction")},isFill:function(){return this.getStyle("link.handler.fill")},getFillColor:function(){return this.getStyle("link.handler.fill.color")},getGradient:function(){return this.getStyle("link.handler.gradient")},getGradientColor:function(){return this.getStyle("link.handler.gradient.color")},getOutlineWidth:function(){return this.getStyle("link.handler.outline.width")},getOutlineColor:function(){return this.getStyle("link.handler.outline.color")},getCap:function(){return this.getStyle("link.handler.cap")},getJoin:function(){return this.getStyle("link.handler.join")},getAlpha:function(){return this.getStyle("link.handler.alpha")},isShadowable:function(){return this.getStyle("link.handler.shadowable")}}),n.vector.IconsAttachment=function(t,e){n.vector.IconsAttachment.superClass.constructor.call(this,t,e)},o.ext("b2.vector.IconsAttachment",n.vector.Attachment,{isShadowable:function(){return n.Defaults.ATTACHMENT_SHADOWABLE},validate:function(){if(n.vector.IconsAttachment.superClass.validate.call(this),this.iconsNames=this._network.getIconsNames(this._element),this.iconsNames&&0!=this.iconsNames.length){var t,e,o=this._makeGroup(this.iconsNames),s=this._makeGroup(this._network.getIconsColors(this._element)),r=this._network.zoomManager;for(len=o.length,this.iconsOrientation=this._makeArray(this._element.getStyle("icons.orientation"),len,"right"),this.iconsPosition=this._makeArray(this._element.getStyle("icons.position"),len,"topleft.bottomright"),this.iconsXoffset=this._makeArray(this._element.getStyle("icons.xoffset"),len,0),this.iconsYoffset=this._makeArray(this._element.getStyle("icons.yoffset"),len,0),this.iconsXgap=this._makeArray(this._element.getStyle("icons.xgap"),len,1),this.iconsYgap=this._makeArray(this._element.getStyle("icons.ygap"),len,1),this.locations=[],this.iconsSizes=[],this.iconsOrientations=[],i=0;i<len;i++){var a,h,l=o[i],c=this.iconsOrientation[i]||"right",d=this.iconsPosition[i]||"topleft.bottomright",u=this.iconsXgap[i]||1,g=this.iconsYgap[i]||1,_=this.iconsXoffset[i]||0,A=this.iconsYoffset[i]||0;this._ui._element instanceof n.Link&&(a=this._ui.getLinkPoints(),h=(this._ui.getLineLength?this._ui:this._ui._element).getLineLength(),0<Math.abs(_)&&Math.abs(_)<1?"from"===d?_*=h:"to"===d?_=h*(1-_):(_/=2,_+=.5,_*=h):"from"===d||("to"===d?_=h-_:_+=h/2),a=(h=f.calculatePointInfoAlongLine(a,!0,_,A)).point,h.angle,h="from"===d?this._ui.getFromPoint():"to"===d?this._ui.getToPoint():this._ui._hotSpot,_=a.x-h.x,A=a.y-h.y),e=null,(t=this._getIconsSize(l,c,u,g,r))&&(e=this._network.getPosition(d,this._ui,t,_,A),this._iconLocation=e,"top"===c?e.y+=t.height:"left"===c&&(e.x+=t.width)),this.locations.push(e),this.iconsSizes.push(t),this.iconsOrientations.push(c)}var y=null;for(i=0;i<this.locations.length;i++)e=this.locations[i],t=this.iconsSizes[i],c=this.iconsOrientations[i],null!=e&&(y=null==y?"top"===c?{x:e.x,y:e.y-t.height,width:t.width,height:t.height}:"left"===c?{x:e.x-t.width,y:e.y,width:t.width,height:t.height}:{x:e.x,y:e.y,width:t.width,height:t.height}:"top"===c?f.unionRect(y,{x:e.x,y:e.y-t.height,width:t.width,height:t.height}):"left"===c?f.unionRect(y,{x:e.x-t.width,y:e.y,width:t.width,height:t.height}):f.unionRect(y,{x:e.x,y:e.y,width:t.width,height:t.height}));this._viewRect=r?y||this.getElementUI().getViewRect():y||{x:this._element.getLocation().x,y:this._element.getLocation().y,width:0,height:0},this.iconsGroups=o,this.colorGroups=s;var p,m,v,x=this._element instanceof n.Link&&this._element.getStyle("link.icons.rotatable");for(i=0;i<len;i++)x instanceof Array&&x[i]&&this._viewRect&&(p=this._viewRect.x+this._viewRect.width/2,m=this._viewRect.y+this._viewRect.height/2,v=Math.sqrt(this._viewRect.height*this._viewRect.height+this._viewRect.width*this._viewRect.width),this._viewRect={x:p-v/2,y:m-v/2,width:v,height:v})}},_makeGroup:function(t){if(!Array.isArray(t))return[[t]];for(var e,i=[],n=!1,o=t.length,s=0;s<o;s++)e=t[s],Array.isArray(e)?(n=!0,i.push(e)):i.push([e]);return n||(i.length=0,i.push(t)),i},_makeArray:function(t,e,i){if(Array.isArray(t))return t;for(var n=[],o=0;o<e;o++)n.push(t||i);return n},paint:function(t){if(n.vector.IconsAttachment.superClass.paint.apply(this,arguments),this.iconsNames&&0!=this.iconsNames.length&&this.locations)for(var e,i,s,r,a,h,l,c=this._network.zoomManager,d=0;d<this.iconsGroups.length;d++)if(e=this.locations[d])for(var u in y=e.x,p=e.y,s=this.iconsGroups[d],r=this.colorGroups[d],a=this.iconsOrientation[d],h=this.iconsXgap[d]||1,l=this.iconsYgap[d]||1,i=0,s){var g=null,_=null;r&&r.length>i&&(_=r[i++]);var f=o.getImageAsset(s[u]);if(null!=f){if(c&&this._ui instanceof n.vector.GroupUI&&this._ui._shapeRect){var A=c.getAttachmentSizeZoom(this);u=f.getWidth()*A,A=f.getHeight()*A;if("right"===a)y+=(g={x:y,y:p,width:u,height:A}).width+h;else if("left"===a)y-=(g={x:y-u,y:p,width:u,height:A}).width+h;else if("top"===a)p-=(g={x:y,y:p-A,width:u,height:A}).height+l;else{if("bottom"!==a)throw"Can not resolve '"+a+"' orientation";p+=(g={x:y,y:p,width:u,height:A}).height+l}}else{if("right"===a)y+=(g={x:y,y:p,width:f.getWidth(),height:f.getHeight()}).width+h;else if("left"===a)y-=(g={x:y-f.getWidth(),y:p,width:f.getWidth(),height:f.getHeight()}).width+h;else if("top"===a)p-=(g={x:y,y:p-f.getHeight(),width:f.getWidth(),height:f.getHeight()}).height+l;else{if("bottom"!==a)throw"Can not resolve '"+a+"' orientation";p+=(g={x:y,y:p,width:f.getWidth(),height:f.getHeight()}).height+l}g=c._getAttachmentZoomOutLineRect(this,g)}var y,p;(A=this._element instanceof n.Link&&this._element.getStyle("link.icons.rotatable"))instanceof Array&&A[d]?(t.save(),y=(A=g).x+A.width/2,p=A.y+A.height/2,t.translate(y,p),t.rotate(this._network.getElementUI(this._element).getAbsoluteAngle()),t.translate(-y,-p),bt(t,f.getImage(_,g.width,g.height),_,g,this._element,this._network),t.restore()):bt(t,f.getImage(_,g.width,g.height),_,g,this._element,this._network),this._network._debug&&(g=this._viewRect,m.strokeRect(t,g,"#FCFC00",1),m.strokeRect(t,g,"#FCFC00",1))}}},_getIconsSize:function(t,e,i,s,r){var a,h=0,l=0,c=null,d=null,u=null;for(a in t)if(d=o.getImageAsset(t[a])){if("right"===e)h+=(c={x:h,y:l,width:d.getWidth(),height:d.getHeight()}).width+i;else if("left"===e)h-=(c={x:h-d.getWidth(),y:l,width:d.getWidth(),height:d.getHeight()}).width+i;else if("top"===e)l-=(c={x:h,y:l-d.getHeight(),width:d.getWidth(),height:d.getHeight()}).height+s;else{if("bottom"!==e)throw"Can not resolve '"+e+"' orientation";l+=(c={x:h,y:l,width:d.getWidth(),height:d.getHeight()}).height+s}u=null==u?o.clone(c):f.unionRect(u,c)}return u?r&&this._ui instanceof n.vector.GroupUI&&this._ui._shapeRect?{width:Math.abs(u.width)*r.getAttachmentSizeZoom(this),height:Math.abs(u.height)*r.getAttachmentSizeZoom(this)}:{width:Math.abs(u.width),height:Math.abs(u.height)}:null}}),n.vector.EditAttachment=function(t,e){n.vector.EditAttachment.superClass.constructor.call(this,t,e)},o.ext("b2.vector.EditAttachment",n.vector.Attachment,{paint:function(t){n.vector.EditAttachment.superClass.paint.apply(this,arguments),this.paintResizingPoints(t),this.paintEditPoints(t),this.paintRotatePoints(t)},paintResizingPoints:function(t){var e=this.resizingPoints.size();if(!(e<=0)){var i=this._element.getStyle("edit.physicalZoom")?1:this._network.getGraphicsZoom(),o=this.resizePointSize/i,s=2*o,r=2*o,a=this._network.getResizePointFillColor(),h=this._network.getResizePointOutlineWidth()/i,l=this._network.getResizePointOutlineColor(),c=this._element.getAngle(),d=(i=this._network.zoomManager)._getElementZoomRect(this.getElementUI(),this._element.getOriginalRect());t.lineWidth=h;for(var u=this.resizingPoints,g=0;g<e;g++){var _={x:(_=u.get(g)).x-o,y:_.y-o,width:2*o,height:2*o};_=this._getRotateRect(_,c,{x:d.x+d.width/2,y:d.y+d.height/2});t.save(),n.Util.rotateCanvas(t,_,c),ke.rect(t,_.x,_.y,s,r),t.restore()}t.fillStyle=a,t.strokeStyle=l,t.fill(),t.stroke(),this._network._debug&&(l=this.getViewRect("resize"),m.strokeRect(t,l,"#CCDDCC"),l=i._getElementZoomRect(this.getElementUI(),this.getElementUI()._viewRect),m.strokeRect(t,l,"#FD7766"))}},paintEditPoints:function(t){var e=this.editPoints.size();if(!(e<=0)){var i=this._element.getStyle("edit.physicalZoom")?1:this._network.getGraphicsZoom(),n=this._network.getEditPointOutlineColor(),o=this._network.getEditPointFillColor();i=this._network.getEditPointOutlineWidth()/i;t.beginPath(),t.lineWidth=i;for(var s=this.editPoints,r=0;r<e;r++){var a=s.get(r);t.beginPath(),ke.circle(t,a.x,a.y,this.editPointSize,o,n),t.closePath()}this._network._debug&&(i=this.getViewRect("edit"),m.strokeRect(t,i,"#AAABBC"))}},paintRotatePoints:function(t){var e=this.rotatePoints.size();if(!(e<=0)){var i=this._element.getStyle("edit.physicalZoom")?1:this._network.getGraphicsZoom(),n=this._network.getRotatePointOutlineColor(),o=this._network.getRotatePointFillColor(),s=this._network.getRotatePointOutlineWidth()/i;t.beginPath(),t.lineWidth=s;for(var r=this.rotatePoints,a=0;a<e;a++){var h=r.get(a);t.beginPath(),ke.circle(t,h.x,h.y,this.rotatePointSize/i,o,n),t.closePath(),t.beginPath()}this._network._debug&&(s=this.getViewRect("rotate"),m.strokeRect(t,s,"green"))}},getViewRect:function(t){if(t){if("resize"===t)return this._resizeRect;if("rotate"===t)return this._rotateRect;if("edit"===t)return this._editRect}return this._viewRect||{x:0,y:0,width:0,height:0}},validate:function(){n.vector.EditAttachment.superClass.validate.call(this);var t=this._network.getGraphicsZoom();this.editPointSize=this._network.getEditPointSize(),this.resizePointSize=this._network.getResizePointSize(),this.rotatePointSize=this._network.getRotatePointSize(),this.resizingPoints=new n.List,this.editPoints=new n.List,this.rotatePoints=new n.List,this._element instanceof n.Node&&this._addResizingPoint(this._element),!(this._network.isRotatable(this._element)&&this._element instanceof be)||this._element instanceof n.ShapeNode||this._element instanceof n.Grid||this._element instanceof n.Group||this._addRotatePoint(this._element),this._element instanceof n.ShapeNode&&(this._addResizingPoint(this._element),this._addShapeNodePoint(this._element)),this._ui instanceof n.vector.ShapeLinkUI&&this._addShapeLinkPoints(this._element),this._ui instanceof n.vector.LinkUI&&this._addLinkControlPoint(this._ui);var e=this._network.getResizePointOutlineWidth()/t,i=this.getElementUI().getZoomBodyRect(),o=2*Math.sqrt(2);this._resizeOffset=(this.resizePointSize+e+1)*o,f.grow(i,this._resizeOffset,this._resizeOffset),this._resizeRect=i,e=this._network.getEditPointOutlineWidth()/t,0<this.editPoints.size()&&(s=f.getRect(this.editPoints),f.grow(s,2*this.editPointSize+2*e),i=f.unionRect(i,s)),this._editRect=s;e=this._network.getRotatePointOutlineWidth()/t;var s=this.rotatePointSize;0<this.rotatePoints.size()&&(e={x:(t=this.rotatePoints.get(0)).x-s-e-1,y:t.y-s-e-1,width:2*s+2*e+2,height:2*s+2*e+2},i=f.unionRect(i,e),this._rotateRect=e),this._viewRect=i},_addResizingPoint:function(t){var e,i,n,o=this._network.zoomManager._getElementZoomRect(this.getElementUI(),t.getOriginalRect());o&&(this._network.getResizePointSize()<=0||(e=new at([{x:o.x,y:o.y},{x:o.x+o.width/2,y:o.y},{x:o.x+o.width,y:o.y},{x:o.x,y:o.y+o.height/2},{x:o.x+o.width,y:o.y+o.height/2},{x:o.x,y:o.y+o.height},{x:o.x+o.width/2,y:o.y+o.height},{x:o.x+o.width,y:o.y+o.height}]),i=this._network.getResizePointOutlineWidth(),n=this._network.getResizePointOutlineColor(),o=this._network.getResizePointFillColor(),this._addPoints(t.getRect(),e,i,n,o,!0)))},_addRotatePoint:function(t){var e,i,o,s=this._network.zoomManager._getElementZoomRect(this.getElementUI(),t.getOriginalRect());s&&((i=this._network.getRotatePointSize()/this._network.getGraphicsZoom())<=0||(o=2*i,e=new n.List([{x:s.x+s.width/2,y:s.y-this._network.getRotatePointOffset()/this._network.getGraphicsZoom()-i}]),i={x:(i=(e=0!=(i=t.getAngle())?this._rotatePointList(e,i,s):e).get(0)).x-o/2,y:i.y-o/2,width:o,height:o},o=this._network.getRotatePointOutlineWidth(),o=this.rotatePointSize+o,f.grow(s,o,o),f.unionRect(t.getRect(),i),this.rotatePoints=e))},_addShapeNodePoint:function(t){t=this._network.zoomManager._getShapeNodeZoomPoints(this.getElementUI(),t.getPoints()),this._addEditPoints(t)},_addShapeLinkPoints:function(t){t=this._network.zoomManager._getShapeLinkZoomPoints(t.getPoints()),this._addEditPoints(t)},_addLinkControlPoint:function(t){var e=new n.List,i=t._element.getFromAgent()?t._element.getFromAgent():t._element.getFromNode(),o=t._element.getStyle("link.from.xoffset"),s=t._element.getStyle("link.from.yoffset"),r=(i=(r=this._network.getElementUI(i).getZoomBodyRect()).x+r.width/2,r.y+r.height/2);e.add({x:i+o,y:r+s}),i=t._element.getToAgent()?t._element.getToAgent():t._element.getToNode(),o=t._element.getStyle("link.to.xoffset"),r=t._element.getStyle("link.to.yoffset"),i=(s=this._network.getElementUI(i).getZoomBodyRect()).x+s.width/2,s=s.y+s.height/2,e.add({x:i+o,y:s+r}),dt.isOrthogonalLink(t._element)&&t.getControlPoint()&&(t=t.getControlPoint())&&e.add(t);var a=this.editPoints.size();if(0<a)for(var h=0;h<a;h++)e.add(this.editPoints.get(h));this._addEditPoints(e)},_addEditPoints:function(t){var e,i=f.getRect(t);i&&(this._network.getEditPointSize()<=0||(e=this._network.getEditPointOutlineWidth(),this._addPoints(i,t,e,!1)))},_addPoints:function(t,e,i,n,o,s){var r=s?this._network.getResizePointSize():this._network.getEditPointSize();r<0||(f.grow(t,i=r+i,i),1==s?this.resizingPoints=e:this.editPoints=e)},_rotatePoint:function(t,e,i){return f.createMatrix(e*Math.PI/180,i.x+i.width/2,i.y+i.height/2).transform(t)},_rotatePointList:function(t,e,i){var o=this,s=new n.List;return t.forEach(function(t){s.add(o._rotatePoint(t,e,i))}),s},_getRotateRect:function(t,e,i){return e=f.createMatrix(e*Math.PI/180,i.x,i.y),i={x:t.x+t.width/2,y:t.y+t.height/2},i=e.transform(i),t=new n.List([{x:i.x-t.width/2,y:i.y-t.height/2},{x:i.x+t.width/2,y:i.y-t.height/2},{x:i.x+t.width/2,y:i.y+t.height/2},{x:i.x-t.width/2,y:i.y+t.height/2}]),f.getRect(t)}}),n.vector.HTMLLabelAttachment=function(t,e){n.vector.HTMLLabelAttachment.superClass.constructor.call(this,t,e),this._triangleDiv=n.Util.createDiv(),this._roundDiv=n.Util.createDiv(),this._contentDiv=n.Util.createDiv(),this._network.getView().appendChild(this._roundDiv),this._roundDiv.appendChild(this._contentDiv)},o.ext("b2.vector.HTMLLabelAttachment",n.vector.LabelAttachment,{validate:function(){var t=this._element.getStyle("attachment.zIndex");this.validateZIndex(t),t=this._element.getStyle("attachment.pointer.events"),n.Util.setCSSStyle(this._triangleDiv,"pointer-events",t),n.Util.setCSSStyle(this._contentDiv,"pointer-events",t),n.Util.setCSSStyle(this._triangleDiv,"border-style","solid"),n.Util.setCSSStyle(this._contentDiv,"white-space","nowrap"),this.getFont("label.font"),(t=this.getLabel())!==this.text&&(this.text&&("object"==e(this.text)?window.jquery?window.jquery(this.text).remove():this._contentDiv.removeChild(this.text):this._contentDiv.innerHTML=""),t&&("object"==e(t)?window.jquery?window.jquery(this._contentDiv).append(t):this._contentDiv.appendChild(t):this._contentDiv.innerHTML=t),this.text=t),this._contentDiv.style.visibility="hidden",n.vector.HTMLLabelAttachment.superClass.validate.call(this)},validateZIndex:function(t){this._roundDiv.style.zIndex=t+this._network.getElementBox().getDatas().indexOf(this._element)},getContentWidth:function(){return this._contentDiv.scrollWidth||parseInt(n.Util.getCSSStyle(this._contentDiv.firstChild,"width"))},getContentHeight:function(){return this._contentDiv.scrollHeight||parseInt(n.Util.getCSSStyle(this._contentDiv.firstChild,"height"))},paint:function(t){var e=this.isFill(),i=this.getOutlineWidth(),o=this._contentRect;this.getElementUI().setGlow(this,t),this.getElementUI().setShadow(this,t),(0<i||e)&&(m.drawRoundRect(t,o.x,o.y,o.width,o.height,this.getCornerRadius()),this._pointers&&(s=this._ui.getZoomPointers(this,this._pointers),t.moveTo(s[0].x,s[0].y),t.lineTo(s[1].x,s[1].y),t.lineTo(s[2].x,s[2].y)),t.closePath(),0<i&&(t.lineWidth=i,t.strokeStyle=this.getOutlineColor(),t.lineCap=this.getCap(),t.lineJoin=this.getJoin(),t.stroke()),e&&(a=this.getFillColor(),(r=this.getGradient())?m.fill(t,a,r,this.getGradientColor(),this._viewRect):t.fillStyle=a,t.fill())),this.getFont("label.font"),this.getLabel();var s=this._network.getViewRect().x,r=(i=this._network.getViewRect().y,e=this._network.getZoom(),this._contentRect.x+this._contentRect.width/2),a=this._contentRect.y+this._contentRect.height/2;s=r*e-s-this._contentDiv.offsetWidth/2*e+"px",i=a*e-i-this._contentDiv.offsetHeight/2*e+"px";this._contentDiv.style.left=s,this._contentDiv.style.top=i,u.isFirefox?(n.Util.setCSSStyle(this._contentDiv,"-moz-transform","scale("+e+")"),n.Util.setCSSStyle(this._contentDiv,"-moz-transform-origin","0 0")):u.isOpera?(n.Util.setCSSStyle(this._contentDiv,"-o-transform","scale("+e+")"),n.Util.setCSSStyle(this._contentDiv,"-o-transform-origin","0 0")):u.isChrome||u.isSafari?(n.Util.setCSSStyle(this._contentDiv,"-webkit-transform","scale("+e+")"),n.Util.setCSSStyle(this._contentDiv,"-webkit-transform-origin","0 0")):u.isIE?(n.Util.setCSSStyle(this._contentDiv,"-ms-transform","scale("+e+")"),n.Util.setCSSStyle(this._contentDiv,"-ms-transform-origin","0 0")):(n.Util.setCSSStyle(this._contentDiv,"transform","scale("+e+")"),n.Util.setCSSStyle(this._contentDiv,"transform-origin","0 0")),this._network._debug&&(m.strokeRect(t,this._contentRect,"blue"),m.strokeRect(t,this._roundRect,"red"),m.strokeRect(t,this._viewRect,"green")),this._element instanceof n.Link&&this._element.getStyle("link.label.rotatable")&&((t=this.getZoomViewRect()).x,t.width,t.y,t.height,t=180*this._network.getElementUI(this._element).getAbsoluteAngle()/Math.PI,this._contentDiv.offsetWidth,this._contentDiv.offsetHeight,u.isFirefox?n.Util.setCSSStyle(this._contentDiv,"-moz-transform","translate(0px,0px) rotate("+t+"deg) scale("+e+")"):u.isOpera?n.Util.setCSSStyle(this._contentDiv,"-o-transform","translate(0px,0px) rotate("+t+"deg) scale("+e+")"):u.isChrome||u.isSafari?n.Util.setCSSStyle(this._contentDiv,"-webkit-transform","translate(0px, 0px) rotate("+t+"deg) scale("+e+")"):u.isIE?n.Util.setCSSStyle(this._contentDiv,"-ms-transform","translate(0px,0px) rotate("+t+"deg) scale("+e+")"):n.Util.setCSSStyle(this._contentDiv,"transform","translate(0px,0px) rotate("+t+"deg) scale("+e+")"))},setVisibility:function(t){this._contentDiv.style.visibility=t},dispose:function(){this._network.getView().removeChild(this._roundDiv)},getView:function(){return this._roundDiv}}),n.vector.HTMLLabel2Attachment=function(t,e){n.vector.HTMLLabel2Attachment.superClass.constructor.call(this,t,e),this._triangleDiv=n.Util.createDiv(),this._roundDiv=n.Util.createDiv(),this._contentDiv=n.Util.createDiv(),this._network.getView().appendChild(this._roundDiv),this._roundDiv.appendChild(this._contentDiv)},o.ext("b2.vector.HTMLLabel2Attachment",n.vector.LabelAttachment,{validate:function(){var t=this._element.getStyle("attachment.zIndex");this.validateZIndex(t),t=this._element.getStyle("attachment.pointer.events"),n.Util.setCSSStyle(this._triangleDiv,"pointer-events",t),n.Util.setCSSStyle(this._contentDiv,"pointer-events",t),n.Util.setCSSStyle(this._triangleDiv,"border-style","solid"),n.Util.setCSSStyle(this._contentDiv,"white-space","nowrap"),this.getFont("label2.font"),(t=this.getLabel())!==this.text&&(this.text&&("object"==e(this.text)?window.jquery?window.jquery(this.text).remove():this._contentDiv.removeChild(this.text):this._contentDiv.innerHTML=""),t&&("object"==e(t)?window.jquery?window.jquery(this._contentDiv).append(t):this._contentDiv.appendChild(t):this._contentDiv.innerHTML=t),this.text=t),this._contentDiv.style.visibility="hidden",n.vector.HTMLLabelAttachment.superClass.validate.call(this)},validateZIndex:function(t){this._roundDiv.style.zIndex=t+this._network.getElementBox().getDatas().indexOf(this._element)},getContentWidth:function(){return this._contentDiv.scrollWidth||parseInt(n.Util.getCSSStyle(this._contentDiv.firstChild,"width"))},getContentHeight:function(){return this._contentDiv.scrollHeight||parseInt(n.Util.getCSSStyle(this._contentDiv.firstChild,"height"))},paint:function(t){var e=this.isFill(),i=this.getOutlineWidth(),o=this._contentRect;this.getElementUI().setGlow(this,t),this.getElementUI().setShadow(this,t),(0<i||e)&&(m.drawRoundRect(t,o.x,o.y,o.width,o.height,this.getCornerRadius()),this._pointers&&(s=this._ui.getZoomPointers(this,this._pointers),t.moveTo(s[0].x,s[0].y),t.lineTo(s[1].x,s[1].y),t.lineTo(s[2].x,s[2].y)),t.closePath(),0<i&&(t.lineWidth=i,t.strokeStyle=this.getOutlineColor(),t.lineCap=this.getCap(),t.lineJoin=this.getJoin(),t.stroke()),e&&(a=this.getFillColor(),(r=this.getGradient())?m.fill(t,a,r,this.getGradientColor(),this._viewRect):t.fillStyle=a,t.fill())),this.getFont("label2.font"),this.getLabel();var s=this._network.getViewRect().x,r=(i=this._network.getViewRect().y,e=this._network.getZoom(),this._contentRect.x+this._contentRect.width/2),a=this._contentRect.y+this._contentRect.height/2;s=r*e-s-this._contentDiv.offsetWidth/2*e+"px",i=a*e-i-this._contentDiv.offsetHeight/2*e+"px";this._contentDiv.style.left=s,this._contentDiv.style.top=i,this._contentDiv.style.setProperty("-webkit-transform","scale("+e+")",null),this._contentDiv.style.setProperty("-webkit-transform-origin","0 0",null),this._network._debug&&(m.strokeRect(t,this._contentRect,"blue"),m.strokeRect(t,this._roundRect,"red"),m.strokeRect(t,this._viewRect,"green")),this._element instanceof n.Link&&this._element.getStyle("link.label2.rotatable")&&((t=this.getZoomViewRect()).x,t.width,t.y,t.height,t=180*this._network.getElementUI(this._element).getAbsoluteAngle()/Math.PI,this._contentDiv.offsetWidth,this._contentDiv.offsetHeight,u.isFirefox?n.Util.setCSSStyle(this._contentDiv,"-moz-transform","translate(0px,0px) rotate("+t+"deg) scale("+e+")"):u.isOpera?n.Util.setCSSStyle(this._contentDiv,"-o-transform","translate(0px,0px) rotate("+t+"deg) scale("+e+")"):u.isChrome||u.isSafari?n.Util.setCSSStyle(this._contentDiv,"-webkit-transform","translate(0px, 0px) rotate("+t+"deg) scale("+e+")"):u.isIE?n.Util.setCSSStyle(this._contentDiv,"-ms-transform","translate(0px,0px) rotate("+t+"deg) scale("+e+")"):n.Util.setCSSStyle(this._contentDiv,"transform","translate(0px,0px) rotate("+t+"deg) scale("+e+")"))},setVisibility:function(t){this._contentDiv.style.visibility=t},dispose:function(){this._network.getView().removeChild(this._roundDiv)},getView:function(){return this._roundDiv},getLabel:function(){return this._network.getLabel2(this._element)},getCornerRadius:function(){return this.getStyle("label2.corner.radius")},getPointerLength:function(){return this.getStyle("label2.pointer.length")},getPointerWidth:function(){return this.getStyle("label2.pointer.width")},getPosition:function(){return this.getStyle("label2.position")},getXOffset:function(){return this.getStyle("label2.xoffset")},getYOffset:function(){return this.getStyle("label2.yoffset")},getPadding:function(){return this.getStyle("label2.padding")},getPaddingLeft:function(){return this.getStyle("label2.padding.left")},getPaddingRight:function(){return this.getStyle("label2.padding.right")},getPaddingTop:function(){return this.getStyle("label2.padding.top")},getPaddingBottom:function(){return this.getStyle("label2.padding.bottom")},getDirection:function(){return this.getStyle("label2.direction")},isFill:function(){return this.getStyle("label2.fill")},getFillColor:function(){return this.getStyle("label2.fill.color")},getGradient:function(){return this.getStyle("label2.gradient")},getGradientColor:function(){return this.getStyle("label2.gradient.color")},getOutlineWidth:function(){return this.getStyle("label2.outline.width")},getOutlineColor:function(){return this.getStyle("label2.outline.color")},getCap:function(){return this.getStyle("label2.cap")},getJoin:function(){return this.getStyle("label2.join")},getAlpha:function(){return this.getStyle("label2.alpha")},isShadowable:function(){return this.getStyle("label2.shadowable")}}),n.vector.HTMLAlarmAttachment=function(t,e){n.vector.HTMLAlarmAttachment.superClass.constructor.call(this,t,e),this._triangleDiv=n.Util.createDiv(),this._roundDiv=n.Util.createDiv(),this._contentDiv=n.Util.createDiv(),n.Util.setCSSStyle(this._triangleDiv,"border-style","solid"),n.Util.setCSSStyle(this._triangleDiv,"pointer-events","none"),n.Util.setCSSStyle(this._contentDiv,"white-space","nowrap"),n.Util.setCSSStyle(this._contentDiv,"pointer-events","none"),this._network.getView().appendChild(this._roundDiv),this._roundDiv.appendChild(this._contentDiv)},o.ext("b2.vector.HTMLAlarmAttachment",n.vector.AlarmAttachment,{validate:function(){this.getFont("alarm.font");var t=this._network.getAlarmLabel(this._element);this._contentDiv.innerHTML=t,this._contentDiv.style.visibility="hidden",n.vector.HTMLAlarmAttachment.superClass.validate.call(this)},getContentWidth:function(){return this._contentDiv.scrollWidth||parseInt(n.Util.getCSSStyle(this._contentDiv.firstChild,"width"))},getContentHeight:function(){return this._contentDiv.scrollHeight||parseInt(n.Util.getCSSStyle(this._contentDiv.firstChild,"height"))},paint:function(t){var e=this.isFill(),i=this.getOutlineWidth(),o=this._contentRect;this.getElementUI().setShadow(this,t),(0<i||e)&&(m.drawRoundRect(t,o.x,o.y,o.width,o.height,this.getCornerRadius()),this._pointers&&(s=this._ui.getZoomPointers(this,this._pointers),t.moveTo(s[0].x,s[0].y),t.lineTo(s[1].x,s[1].y),t.lineTo(s[2].x,s[2].y)),t.closePath(),0<i&&(t.lineWidth=i,t.strokeStyle=this.getOutlineColor(),t.lineCap=this.getCap(),t.lineJoin=this.getJoin(),t.stroke()),e&&(a=this.getFillColor(),(r=this.getGradient())?m.fill(t,a,r,this.getGradientColor(),this._viewRect):t.fillStyle=a,t.fill())),this.getFont("alarm.font"),this._network.getAlarmLabel(this._element);var s=this._network.getViewRect().x,r=(i=this._network.getViewRect().y,e=this._network.getZoom(),this._contentRect.x+this._contentRect.width/2),a=this._contentRect.y+this._contentRect.height/2;s=r*e-s-this._contentDiv.offsetWidth/2*e+"px",i=a*e-i-this._contentDiv.offsetHeight/2*e+"px";this._contentDiv.style.left=s,this._contentDiv.style.top=i,this._contentDiv.style.setProperty("-webkit-transform","scale("+e+")",null),this._contentDiv.style.setProperty("-webkit-transform-origin","0 0",null),this._network._debug&&m.strokeRect(t,this._contentRect,"#DDDDDD"),n.vector.AlarmAttachment.superClass.paint.apply(this,arguments)},setVisibility:function(t){this._contentDiv.style.visibility=t},dispose:function(){this._network.getView().removeChild(this._roundDiv)},getView:function(){return this._roundDiv}}),n.vector.BaseZoomManager=function(t){this.network=t,this.visibilityThresholds=t.visibilityThresholds},o.ext("b2.vector.BaseZoomManager",Object,{getZoom:function(){return this.network.getZoom()},getGraphicsZoom:function(){return 1},getSizeZoom:function(t){return 1},getAttachmentSizeZoom:function(t){return t=t.getElementUI(),this.getSizeZoom(t)},getLocationZoom:function(t){return 1},_getZoomVisibilityThresholds:function(){return this.network.getZoomVisibilityThresholds()},_convertPointFromView:function(t){return{x:t.x*this.getGraphicsZoom()-this.network.getViewRect().x,y:t.y*this.getGraphicsZoom()-this.network.getViewRect().y}},_getElementViewRect:function(t,e){var i=this.getLocationZoom(t),n=this.getSizeZoom(t);if(1==i&&1==n)return e;t=(o=this._getZoomPoint(t)).x;var o=o.y;return null==e&&console.log("View rect is null"),{x:t*i+(e.x-t)*n,y:o*i+(e.y-o)*n,width:e.width*n,height:e.height*n}},_invalidateZoom:function(){this.network.invalidateElementUIs()},_getGroupChildrenRects:function(t){var e=new at;return t.getChildren().forEach(function(t){t instanceof be&&(!(t=this.network.getElementUI(t))||(t=t.getZoomViewRect(this))&&e.add(t))},this),e},_zoomGraphicsBegin:function(t){var e=this.network,i=this.getGraphicsZoom();t.scale(i,i),t.translate(-e.viewRect.x/i,-e.viewRect.y/i)},_getEditZoomPoints:function(t,e){var i=this.getLocationZoom(t),o=this.getSizeZoom(t);if(1==i&&1==o||t instanceof n.vector.LinkUI&&!(t instanceof n.vector.ShapeLinkUI))return e;var s=(t=t instanceof n.vector.ShapeLinkUI?f.getCenterPoint(f.getRect(e)):this._getZoomPoint(t)).x,r=t.y;if(e.forEach){var a,h=new at;return e.forEach(function(t){t instanceof at?(a=new at,t.forEach(function(t){a.add({x:s*i+(t.x-s)*o,y:r*i+(t.y-r)*o})}),h.add(a)):h.add({x:s*i+(t.x-s)*o,y:r*i+(t.y-r)*o})}),h}return e.x?{x:s*i+(e.x-s)*o,y:r*i+(e.y-r)*o}:void 0},_getShapeNodeZoomPoints:function(t,e,i){var n=this.getLocationZoom(t),o=this.getSizeZoom(t);if(1==n&&1==o)return e;i&&(n=1/n,o=1/o);var s,r=(i=f.getRect(e)).x+i.width/2,a=i.y+i.height/2,h=new at;return e.forEach(function(t){t instanceof at?(s=new at,t.forEach(function(t){s.add({x:r*n+(t.x-r)*o,y:a*n+(t.y-a)*o})}),h.add(s)):h.add({x:r*n+(t.x-r)*o,y:a*n+(t.y-a)*o})}),h},_getShapeLinkZoomPoints:function(t,e){var i=this.getLocationZoom(),n=i;if(1==i&&1==n)return t;e&&(i=1/i,n=1/n);var o,s=(e=f.getRect(t)).x+e.width/2,r=e.y+e.height/2,a=new at;return t.forEach(function(t){t instanceof at?(o=new at,t.forEach(function(t){o.add({x:s*i+(t.x-s)*n,y:r*i+(t.y-r)*n})}),a.add(o)):a.add({x:s*i+(t.x-s)*n,y:r*i+(t.y-r)*n})}),a},_getLogicalPoint:function(t,e){var i=e?this.getZoom():this.getGraphicsZoom(),n=this.network;if(u.isTouchable&&t.changedTouches&&0<t.changedTouches.length){var o=n._view.getBoundingClientRect(),s=t.changedTouches[0],r=u.isAndroid?0:gt.scrollLeft();e=u.isAndroid?0:gt.scrollTop();return{x:(s.clientX+n.viewRect.x-o.left-r)/i,y:(s.clientY+n.viewRect.y-o.top-e)/i}}return u.isFirefox?{x:(t.layerX+n.viewRect.x)/i,y:(t.layerY+n.viewRect.y)/i}:{x:(t.offsetX+n.viewRect.x)/i,y:(t.offsetY+n.viewRect.y)/i}},_getVisibleRect:function(t){return t},_getElementZoomRect:function(t,e){var i=this.getLocationZoom(t),n=this.getSizeZoom(t);if(1==i&&1==n)return o.cloneRect(e);t=(s=null!=t?this._getZoomPoint(t):{x:e.x+e.width/2,y:e.y+e.height/2}).x;var s=s.y;return{x:t*i+(e.x-t)*n,y:s*i+(e.y-s)*n,width:e.width*n,height:e.height*n}},_reverseElementZoomRect:function(t,e){var i=this.getLocationZoom(t),n=this.getSizeZoom(t);if(1==i&&1==n)return o.cloneRect(e);t=(s=null!=t?this._getZoomPoint(t):{x:e.x+e.width/2,y:e.y+e.height/2}).x;var s=s.y;return{x:t+(e.x-t*i)/n,y:s+(e.y-s*i)/n,width:e.width/n,height:e.height/n}},_getZoomContentRect:function(t,e,i,o,s,r){var a=this.getSizeZoom(t.getElementUI()),h=this.getAttachmentSizeZoom(t),l=t.getElementUI();return null==r?l instanceof n.vector.GroupUI&&l._shapeRect?{x:o.x*s+(e.x-o.x)+(i.x-e.x)*h,y:o.y*s+(e.y-o.y)+(i.y-e.y)*h,width:i.width,height:i.height}:{x:o.x*s+(e.x-o.x)*a+(i.x-e.x)*h,y:o.y*s+(e.y-o.y)*a+(i.y-e.y)*h,width:i.width,height:i.height}:{x:o.x*s+(e.x-o.x)*a+(i.x-e.x)*h,y:o.y*s+(e.y-o.y)*a+(i.y-e.y)*h+r*(t.textHeight-4)*h,width:i.width,height:t.textHeight}},_getAttachmentZoomRect:function(t,e,i){var o=this.getLocationZoom(t.getElementUI()),s=(t.getElementUI(),this.getSizeZoom(t.getElementUI())),r=this.getAttachmentSizeZoom(t),a=t._pointers;if(1==o&&1==r&&1==s)return null==i?e:{x:e.x,y:e.y+i*(t.textHeight-4),width:e.width,height:t.textHeight};var h=t.getElementUI();(r=this._getZoomPoint(h,t)).x,r.y,s=t.getPosition?t.getPosition():"center",s=a?a[0]:Pe.get(s,e);return null==i?h instanceof n.vector.LinkUI||h instanceof n.vector.GroupUI&&h._shapeRect?this._getZoomContentRect(t,s,e,r,1):this._getZoomContentRect(t,s,e,r,o):this._getZoomContentRect(t,s,e,r,o,i)},_getZoomPoint:function(t,e){var i,o=t._element;if(o instanceof n.Follower&&o.getHost()&&o.getHost()instanceof n.Grid)return{x:(i=o.getHost().getRect()).x+i.width/2,y:i.y+i.height/2};if(i=t.getBodyRect(),t instanceof n.vector.LinkUI&&e&&e.getPosition){if(e.getXOffset(),e.getYOffset(),"from"===e.getPosition())return t._fromPoint;if("to"===e.getPosition())return t._toPoint}return{x:i.x+i.width/2,y:i.y+i.height/2}},_getZoomPointers:function(t,e,i){if(i){var o=this._getZoomPoint(e),s=this.getLocationZoom(e),r=this.getSizeZoom(e),a=this.getAttachmentSizeZoom(t);t=i[0];return e instanceof n.vector.LinkUI?[{x:o.x+(t.x-o.x)*r,y:o.y+(t.y-o.y)*r},{x:o.x+(t.x-o.x)*r+(i[1].x-t.x)*a,y:o.y+(t.y-o.y)*r+(i[1].y-t.y)*a},{x:o.x+(t.x-o.x)*r+(i[2].x-t.x)*a,y:o.y+(t.y-o.y)*r+(i[2].y-t.y)*a}]:e instanceof n.vector.GroupUI&&e._shapeRect?[{x:o.x+(t.x-o.x),y:o.y+(t.y-o.y)},{x:o.x+(t.x-o.x)+(i[1].x-t.x)*a,y:o.y+(t.y-o.y)+(i[1].y-t.y)*a},{x:o.x+(t.x-o.x)+(i[2].x-t.x)*a,y:o.y+(t.y-o.y)+(i[2].y-t.y)*a}]:[{x:o.x*s+(t.x-o.x)*r,y:o.y*s+(t.y-o.y)*r},{x:o.x*s+(t.x-o.x)*r+(i[1].x-t.x)*a,y:o.y*s+(t.y-o.y)*r+(i[1].y-t.y)*a},{x:o.x*s+(t.x-o.x)*r+(i[2].x-t.x)*a,y:o.y*s+(t.y-o.y)*r+(i[2].y-t.y)*a}]}},_getZoomHotSpot:function(t,e){if(e){var i=this._getZoomPoint(t),n=this.getLocationZoom(t);t=this.getSizeZoom(t);return{x:i.x*n+(e.x-i.x)*t,y:i.y*n+(e.y-i.y)*t}}return null},limitZoom:function(t){return t},_isVisible:function(t){var e=this._getZoomVisibilityThresholds();return!(null!=(t=e[t])&&("sizeZoom"==(e=e.zoomName)?this.getSizeZoom():"locationZoom"==e?this.getLocationZoom():"graphicsZoom"==e?this.getGraphicsZoom():this.getZoom())<t)},isElementVisible:function(t){var e=this.getZoom();return(e=this._isVisible("element",e))&&t instanceof n.Link?this.isLinkVisible(t):e},isLinkVisible:function(t){var e=this.getZoom();return this._isVisible("link",e)},isLabelVisible:function(t){var e=this.getZoom();return this._isVisible("label",e)},isAttachmentVisible:function(t){var e=this.getZoom();return this._isVisible("attachment",e)},isAlarmBalloonVisible:function(t){var e=this.getZoom();return this._isVisible("alarmBallon",e)},_getAttachmentOutLineWidth:function(t){return t.getOutlineWidth()},_getAttachmentZoomOutLineRect:function(t,e){var i=this.getLocationZoom(t.getElementUI()),o=this.getAttachmentSizeZoom(t);return 1==i&&1==o?e:(i=this._getAttachmentZoomRect(t,e,null),e=t.getElement(),!this.isAttachmentVisible(e)||(t instanceof n.vector.LabelAttachment||t instanceof n.vector.Label2Attachment)&&!this.isLabelVisible(e)||t instanceof n.vector.AlarmAttachment&&!this.isAlarmBalloonVisible(e)?{x:i.x,y:i.x,width:0,height:0}:{x:i.x,y:i.y,width:i.width*o,height:i.height*o})},_drawText:function(t,e,i,n,o,s,r,a){var h=this.getLocationZoom(t.getElementUI());t=this.getAttachmentSizeZoom(t);1!=h&&1!=t?(e.translate(n.x,n.y),e.scale(t,t),m.drawText(e,i,{x:0,y:0,width:n.width,height:n.height},o,s,r),e.scale(1/t,1/t),e.translate(-n.x,-n.y)):m.drawText(e,i,n,o,s,r,a)},_getOffset:function(t,e){var i=this.getLocationZoom();return{x:(t.x-e.x)/i,y:(t.y-e.y)/i}}});var Pe={"topleft.topleft":function(t){return{x:t.x+t.width,y:t.y+t.height}},"topleft.topright":function(t){return{x:t.x,y:t.y+t.height}},"top.top":function(t){return{x:t.x+t.width/2,y:t.y+t.height}},"topright.topleft":function(t){return{x:t.x+t.width,y:t.y+t.height}},"topright.topright":function(t){return{x:t.x,y:t.y+t.height}},topleft:function(t){return{x:t.x+t.width/2,y:t.y+t.height/2}},top:function(t){return{x:t.x+t.width/2,y:t.y+t.height/2}},topright:function(t){return{x:t.x+t.width/2,y:t.y+t.height/2}},"topleft.bottomleft":function(t){return{x:t.x+t.width,y:t.y}},"topleft.bottomright":function(t){return{x:t.x,y:t.y}},"top.bottom":function(t){return{x:t.x+t.width/2,y:t.y}},"topright.bottomleft":function(t){return{x:t.x+t.width,y:t.y}},"topright.bottomright":function(t){return{x:t.x,y:t.y}},"left.left":function(t){return{x:t.x+t.width,y:t.y+t.height/2}},left:function(t){return{x:t.x+t.width/2,y:t.y+t.height/2}},"left.right":function(t){return{x:t.x,y:t.y+t.height/2}},center:function(t){return{x:t.x+t.width/2,y:t.y+t.height/2}},"right.left":function(t){return{x:t.x+t.width,y:t.y+t.height/2}},right:function(t){return{x:t.x+t.width/2,y:t.y+t.height/2}},"right.right":function(t){return{x:t.x,y:t.y+t.height/2}},"bottomleft.topleft":function(t){return{x:t.x+t.width,y:t.y+t.height}},"bottomleft.topright":function(t){return{x:t.x,y:t.y+t.height}},"bottom.top":function(t){return{x:t.x+t.width/2,y:t.y+t.height}},"bottomright.topleft":function(t){return{x:t.x+t.width,y:t.y+t.height}},"bottomright.topright":function(t){return{x:t.x,y:t.y+t.height}},bottomleft:function(t){return{x:t.x+t.width/2,y:t.y+t.height/2}},bottom:function(t){return{x:t.x+t.width/2,y:t.y+t.height/2}},bottomright:function(t){return{x:t.x+t.width/2,y:t.y+t.height/2}},"bottomleft.bottomleft":function(t){return{x:t.x+t.width,y:t.y}},"bottomleft.bottomright":function(t){return{x:t.x,y:t.y}},"bottom.bottom":function(t){return{x:t.x+t.width/2,y:t.y}},"bottomright.bottomleft":function(t){return{x:t.x+t.width,y:t.y}},"bottomright.bottomright":function(t){return{x:t.x,y:t.y}},from:function(t){return{x:t.x+t.width/2,y:t.y+t.height/2}},to:function(t){return{x:t.x+t.width/2,y:t.y+t.height/2}},get:function(t,e){if(!e)throw"rect can not be null";var i=Pe[t];if(i)return i(e);throw"Can not resolve '"+t+"' position"}};n.vector.PhysicalZoomManager=function(t){n.vector.PhysicalZoomManager.superClass.constructor.apply(this,arguments)},o.ext("b2.vector.PhysicalZoomManager",n.vector.BaseZoomManager,{getGraphicsZoom:function(){return this.getZoom()},_invalidateZoom:function(){}}),n.vector.LogicalZoomManager=function(t,e){n.vector.LogicalZoomManager.superClass.constructor.apply(this,arguments),this.sizeChange=e},o.ext("b2.vector.LogicalZoomManager",n.vector.BaseZoomManager,{getLocationZoom:function(t){return this.getZoom()},getSizeZoom:function(t){return this.sizeChange?this.getZoom():1}}),n.vector.MixedZoomManager=function(t,e){n.vector.MixedZoomManager.superClass.constructor.call(this,t,e)},o.ext("b2.vector.MixedZoomManager",n.vector.LogicalZoomManager,{}),function(){var t,e=n.vector.LogicalZoomManager.prototype,i=n.vector.PhysicalZoomManager.prototype,o=n.vector.MixedZoomManager.prototype;for(t in i)"function"==typeof i[t]&&"constructor"!=t&&(e.hasOwnProperty(t)||i.hasOwnProperty(t))&&function(t){o[t]=function(){return(1<this.getZoom()?e:i)[t].apply(this,arguments)}}(t);o._invalidateZoom=function(){this.network.invalidateElementUIs()}}(),n.vector.interaction.BaseInteraction=function(t){this.network=t},o.ext("b2.vector.interaction.BaseInteraction",Object,{setUp:function(){},tearDown:function(){},repaint:function(){this.network.repaintTopCanvas()},getOffset:function(t,e){return this.network.getOffset(t,e)},convertPointFromView:function(t){return this.network.convertPointFromView(t)},convertFromUIToMarkerRect:function(t,e,i,n){var o=this.network.zoomManager,s=o.getLocationZoom(),r=o.getGraphicsZoom();n=o.getSizeZoom(this.network.getElementUI(n));return{x:t.x*s*r-this.network.getViewRect().x+e*s*r,y:t.y*s*r-this.network.getViewRect().y+i*s*r,width:t.width*n*r,height:t.height*n*r}},getMarkerPoint:function(t){if(u.isTouchable&&t.changedTouches&&0<t.changedTouches.length){var e=t.changedTouches[0];return{x:e.clientX,y:e.clientY}}return u.isFirefox?{x:t.layerX,y:t.layerY}:{x:t.offsetX,y:t.offsetY}},paint:function(t){},addListener:function(){for(var t=0;t<arguments.length;t++){var e=arguments[t];p.addEventListener(e,"handle_"+e,this.network.getView(),this)}},removeListener:function(){for(var t=0;t<arguments.length;t++)p.removeEventListener(arguments[t],this.network.getView(),this)},_handle_mousedown:function(t){0===t.button&&(this._startLogical=this.network.getLogicalPoint2(t),this._startClient=p.getClientPoint(t),this._startLogical&&p.handle_mousedown(this,t))},_handle_mousemove:function(t){this._endLogical={x:this._startLogical.x+(t.clientX-this._startClient.x)/this.network.getGraphicsZoom(),y:this._startLogical.y+(t.clientY-this._startClient.y)/this.network.getGraphicsZoom()}},_handle_mouseup:function(t){delete this._startClient,delete this._startLogical,delete this._endLogical}}),n.vector.interaction.DefaultInteraction=function(t,e){n.vector.interaction.DefaultInteraction.superClass.constructor.call(this,t),this.lazyMode=e},o.ext("b2.vector.interaction.DefaultInteraction",n.vector.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown","mouseover","mouseout","keydown"),u.isFirefox?p.addEventListener("DOMMouseScroll","handleMouseWheel",this.network.getView(),this):p.addEventListener("mousewheel","handleMouseWheel",this.network.getView(),this),p.addEventListener("mouseup","handle_mouseup",window,this),p.addEventListener("dblclick","handleDoubleClicked",this.network.getView(),this),p.addEventListener("blur","handle_blur",this.network.getView(),this),this._oldCursor=this.network.getView().style.cursor,this.network.addPropertyChangeListener(this.handleViewRectChange,this),this.validateScrollBar(),this.network.addMarker(this),this.network.getView().oncontextmenu=function(t){t.preventDefault()},this._createZoomDiv()},tearDown:function(){this.removeListener("mousedown","mouseover","mouseout","keydown"),u.isFirefox?p.removeEventListener("DOMMouseScroll",this.network.getView(),this):p.removeEventListener("mousewheel",this.network.getView(),this),p.removeEventListener("mouseup",window,this),p.removeEventListener("dblclick",this.network.getView(),this),p.removeEventListener("blur",this.network.getView(),this),this.network.removePropertyChangeListener(this.handleViewRectChange,this),this.end(),this.network.removeMarker(this),this._zoomDiv=null},_createZoomDiv:function(){var t,e,i,n,o;null==this._zoomDiv&&(this._zoomDiv=l.createElement("div"),this._zoomLabel=l.createElement("span"),this._zoomLabel.style.display="block",this._zoomLabel.style.textAlign="center",(t=l.createElement("button")).innerHTML="Reset to default",this._zoomDiv.appendChild(this._zoomLabel),this._zoomDiv.appendChild(t),e=Ee,(i=this._zoomDiv.style).position="absolute",i.color=e.TOOLTIP_COLOR,i.background=e.TOOLTIP_BACKGROUND,i.fontSize=e.TOOLTIP_FONT_SIZE,i.padding=e.TOOLTIP_PADDING,i.border=e.TOOLTIP_BORDER,i.borderRadius=e.TOOLTIP_BORDER_RADIUS,i.boxShadow=e.TOOLTIP_BOX_SHADOW,i.zIndex=e.TOOLTIP_ZINDEX,i.setProperty&&i.setProperty("-webkit-box-shadow",e.TOOLTIP_BOX_SHADOW,null),n=this,t.onclick=function(t){n.network.setZoom(1),n._setZoomDivVisible(!1)},(o=this._zoomDiv)._clearFunc=function(){if(o.style.opacity=parseFloat(o.style.opacity)-.05,parseFloat(o.style.opacity)<=.05)return n._setZoomDivVisible(!1),void(o._clearTimeout=null);o._clearTimeout=setTimeout(o._clearFunc,100)},o.onmouseover=function(t){for(var e=(t=t||window.event).relatedTarget||t.fromElement;e&&e!=o;)e=e.parentNode;e!=o&&(o._clearTimeout&&(clearTimeout(o._clearTimeout),o._clearTimeout=null),o.style.opacity=1)},o.onmouseout=function(t){for(var e=(t=t||window.event).relatedTarget||t.toElement;e&&e!=o;)e=e.parentNode;e!=o&&(o._clearTimeout=setTimeout(o._clearFunc,10))})},_isZoomDivVisible:function(){return null!=this._zoomDiv&&null!=this._zoomDiv.parentNode},_getZoomDiv:function(){return this._zoomDiv||this._createZoomDiv(),this._zoomDiv},_setZoomDivVisible:function(t,e,i){var n=this._getZoomDiv();t?(this._zoomLabel.innerHTML=i,n.style.opacity=1,this._isZoomDivVisible()||this.network.getView().appendChild(n),n.style.left=Ee.TOOLTIP_XOFFSET+"px",n.style.top=Ee.TOOLTIP_YOFFSET+"px",n._clearTimeout&&(clearTimeout(n._clearTimeout),n._clearTimeout=null),n._clearTimeout=setTimeout(n._clearFunc,250)):n.parentNode&&n.parentNode.removeChild(n)},handleViewRectChange:function(t){"viewRect"!=t.property&&"canvasSizeChange"!=t.property||this.validateScrollBar()},getScrollBarWidth:function(){return this.network.getScrollBarWidth()},getScrollBarColor:function(){return"#cccccc"},validateScrollBar:function(){var t,e,i,n,o,s,r,a,h,l,c,d,u,g,_,f,A,y,p,m,v,x;this.hThumbRect=null,this.vThumbRect=null,0!=this.network.isScrollBarVisible()&&(t=this.network.getViewRect().height,e=this.network.getViewRect().width,i=this.network.getViewRect().x,n=this.network.getViewRect().y,x=this.network.getCanvasSize(),o=(m=this.network._unionBounds).x,s=m.y,r=m.width,a=m.height,h=x.width,l=x.height,u=!1,g=o<i||e+i<h,(s<n||n+t<l)&&(u=!0),y=A=f=_=0,p=c=e,m=d=t,x=this.getScrollBarWidth(),g&&(u&&(p-=x),A=o<i&&h<i+e?p-(_=v=(v=i-o)*p/(v+c)):i<o&&i+e<h?(_=0,p-(v=p*(v=h-(i+e))/(v+c))):c-(_=p*(i-o)/r)-p*(h-(i+e))/r,this.hThumbRect={x:_,y:f=d-(y=x),width:A,height:y}),y=A=f=_=0,p=c,m=d,u&&(g&&(m-=x),y=s<n&&l<n+t?m-(f=v=m*(v=n-s)/(v+d)):n<s&&n+t<l?(f=0,m-(v=m*(v=l-(n+t))/(v+d))):m-(f=m*(n-s)/a)-m*(l-(n+t))/a,this.vThumbRect={x:_=c-(A=x),y:f,width:A,height:y}),this.network.setHScrollBarVisible(null!=this.hThumbRect),this.network.setVScrollBarVisible(null!=this.vThumbRect)),this.repaint()},scrollXOffset:function(t){var e=this.network.getViewRect().height,i=this.network.getViewRect().width,n=this.network.getViewRect().x,o=this.network.getViewRect().y;t=t?-30:30;this.network.setViewRect(n+t,o,i,e)},scrollYOffset:function(t){var e=this.network.getViewRect().height,i=this.network.getViewRect().width,n=this.network.getViewRect().x,o=this.network.getViewRect().y;t=t?-30:30;this.network.setViewRect(n,o+t,i,e)},handle_mouseover:function(t){1!=this.scrollBarVisible&&(this.scrollBarVisible=!0,this.repaint())},handle_mouseout:function(t){0!=this.scrollBarVisible&&null==this.vBarDownPoint&&null==this.hBarDownPoint&&(this.scrollBarVisible=!1,this.repaint(),this.end(t))},handle_keydown:function(t){this.currentKeyEvent=t,this.addListener("keyup"),At.handleKeyDown(this.network,t)},handle_keyup:function(t){this.currentKeyEvent=null,this.removeListener("keyup")},start:function(t){this.end(t,!0),this.lastPoint=this.network.getLogicalPoint2(t),this.startPoint=this.network.getLogicalPoint2(t),this.lastPanPoint=this.getMarkerPoint(t),this.lazyMode&&(this.pressPoint=this.lastPoint),p.addEventListener("mousemove","handle_mousemove",window,this)},end:function(t,e){var i,n,o,s;this.vBarDownPoint=null,this.hBarDownPoint=null,this.network.state.panning&&(this.network.state.panning=!1,this.network.invalidateElementUIs(!0)),e||(this.network.getView().style.cursor=this._oldCursor),this.isMoving&&(this.lazyMode?null!=this.dragPoint&&null!=this.pressPoint&&(e=(n=(i=this).getOffset(this.dragPoint,this.pressPoint)).x,n=n.y,this.network.moveSelectedElements(e,n,this.network.isLazyMoveAnimate(),function(){i.network.fireInteractionEvent({kind:"lazyMoveEnd",event:t}),i.network.setMovingElement(!1)})):this.network.isMovingElement()&&(this.network.setMovingElement(!1),this.network.fireInteractionEvent({kind:"liveMoveEnd",event:t})),this.isParenting()&&(null==this.parent&&(this.parent=this.network.getCurrentSubNetwork()),(i=this).network.getMovableSelectedElements().forEach(function(t){t.setParent(i.parent)},this.network)),this.parentProcess(t,!0),this.isParenting()&&this.repaint(),this.network.invalidateCanvasSize(),this.lastPoint=null,this.dragPoint=null,this.pressPoint=null,this.repaint()),this.isSelecting&&this.startPoint&&(this.endPoint&&this.startPoint.x!==this.endPoint.x&&this.startPoint.y!==this.endPoint.y&&(n=f.getRect([this.startPoint,this.endPoint]),(n=this.network.getElementsAtRect(n,this.getIntersectMode(),this.network.getRectSelectFilter()))&&0<n.size()&&(o=this.network.getSelectionModel(),s=o.toSelection(),n.forEach(function(t){o.contains(t)?s.remove(t):s.add(t)},this),o.setSelection(s)),this.network.fireInteractionEvent({kind:"selectEnd",event:t})),this.network.setSelectingElement(!1),this.startPoint=null,this.endPoint=null,this.repaint()),this.isMouseDown=!1,p.removeEventListener("mousemove",window,this)},_isDragToSelect:function(t){return!this.network._dragToPan},handle_mousedown:function(t){if(u.isTouchable||0===t.button||!this.network.isSelectingElement()){var e=this.network;if(t.target==e.getView()||t.target==e._topCanvas||t.target==e._rootCanvas){if(this.isMoving=!1,this.isSelecting=!1,this.hBarDownPoint=null,this.vBarDownPoint=null,this._setZoomDivVisible(!1),!this.network.isValidEvent(t)){var i=this.getMarkerPoint(t);return this.start(t),null!=this.vThumbRect&&f.containsPoint(this.vThumbRect,i.x,i.y)&&(this.vBarDownPoint={x:t.screenX,y:t.screenY},this.vBarDownOffset=this.vBarDownPoint.y-this.vThumbRect.y),void(null!=this.hThumbRect&&f.containsPoint(this.hThumbRect,i.x,i.y)&&(this.hBarDownPoint={x:t.screenX,y:t.screenY},this.hBarDownOffset=this.hBarDownPoint.x-this.hThumbRect.x))}this.network.isFocusOnClick()&&n.Util.setFocus(this.network.getView());var s=this.network.getElementAt(t),r=this.network.getElementsAt(t);if(r&&r instanceof at)for(var a=0;a<r.size();a++){var h=r.get(a);if(this.network.getElementBox().getSelectionModel().isSelectable(h)){s=h;break}}this.network.isSelectingElement()||this.network.isEditingElement()||null==s||(this.network.isMovable(s)&&this.network.getElementBox().getSelectionModel().isSelectable(s)?this.isMoving=!0:this.network.getView().style.cursor="pointer",this.start(t)),this.network.isSelectingElement()||this.network.isEditingElement()||(i=this.network.getSelectionModel(),null==s||s&&!this.network.getElementBox().getSelectionModel().isSelectable(s)?(o.isCtrlDown(t)?this.isSelecting=!0:this._isDragToSelect(t)?(this.isSelecting=!0,i.clearSelection()):this.network.isRectSelectEnabled()&&(i.clearSelection(),this.network.getView().style.cursor="pointer"),e._rectSelectEnabled&&this.start(t)):o.isCtrlDown(t)?i.contains(s)?i.removeSelection(s):i.appendSelection(s):i.contains(s)||i.setSelection(s)),this.handleClicked(t,s),this.isMouseDown=!0}}else this.end(t)},handle_mousemove:function(t){if(this._setZoomDivVisible(!1),e=this.network.getLogicalPoint2(t)){var e,i,n={x:t.screenX,y:t.screenY},s=this.network.getCanvasSize(),r=this.network.getViewRect().height,a=this.network.getViewRect().width,h=this.getScrollBarWidth();if(null!=this.hBarDownPoint){var l=n.x-this.hBarDownPoint.x;return this.hBarDownPoint=n,void this.network.setViewOffSet(l*s.width/(a-h),0)}if(null!=this.vBarDownPoint)return a=n.y-this.vBarDownPoint.y,this.vBarDownPoint=n,void this.network.setViewOffSet(0,a*s.height/(r-h));this.network.isSelectingElement()||this.network.isEditingElement()||!this.isMoving||!this.isMouseDown||o.isCtrlDown(t)?this.isSelecting&&(o.isCtrlDown(t)||this._isDragToSelect())?(this.network.setSelectingElement(!0),null==this.endPoint?this.network.fireInteractionEvent({kind:"selectStart",event:t}):this.network.fireInteractionEvent({kind:"selectBetween",event:t}),this.endPoint=e,this.repaint()):this.isMoving||this.isSelecting||!this.isMouseDown?this.end(t):this.lastPanPoint&&this.network._dragToPan&&(e=this.getMarkerPoint(t))&&(h=e.x-this.lastPanPoint.x,i=e.y-this.lastPanPoint.y,this.network.panByOffset(-h,-i),this.network.fireInteractionEvent({kind:"panning",event:t}),this.network.state.panning=!0,this.lastPanPoint=e):(i=this.getOffset(e,this.lastPoint),this.xoffset=i.x,this.yoffset=i.y,Math.abs(this.xoffset)<1&&Math.abs(this.yoffset)<1||(this.lazyMode?null==this.dragPoint?(this.network.fireInteractionEvent({kind:"lazyMoveStart",event:t}),this.network.setMovingElement(!0)):this.network.fireInteractionEvent({kind:"lazyMoveBetween",event:t}):(this.lastPoint=e,this.network.isMovingElement()?this.network.fireInteractionEvent({kind:"liveMoveBetween",event:t}):(this.network.setMovingElement(!0),this.network.fireInteractionEvent({kind:"liveMoveStart",event:t})),this.network.moveSelectedElements(this.xoffset,this.yoffset)),this.parentProcess(t,!1),this.lazyMode&&(this.dragPoint=e),(this.lazyMode||this.isParenting())&&this.repaint()))}},handleMouseWheel:function(t){var e,i;l.activeElement===this.network.getView()&&(this.network._wheelToZoom?(p.preventDefault(t),e={x:t.offsetX||t.layerX,y:t.offsetY||t.layerY},i=this.network.getZoom(),t.wheelDelta&&0<t.wheelDelta||t.detail&&t.detail<0?this.network.setZoom(1.1*i,e):this.network.setZoom(i/1.1,e),this._setZoomDivVisible(this.network.isZoomDivVisible(),t,"Zoom : "+parseFloat(this.network.getZoom().toFixed(4)))):this._handleMouseWheelScroll(t))},_handleMouseWheelScroll:function(t){p.preventDefault(t);var e,i=this._getVisibleScrollBar();null!=i&&(e=t.wheelDelta?0<t.wheelDelta:t.detail<0,"v"==i?this.scrollYOffset(e):this.scrollXOffset(e))},handle_mouseup:function(t){this.end(t)},isParenting:function(){return this.pressPoint&&null!=this.currentKeyEvent&&80===this.currentKeyEvent.keyCode},parentProcess:function(t,e){var i=null;if(this.parent=null,!e&&this.isParenting()){var n={};t=this.network.getLogicalPoint2(t);n.x=t.x-1,n.y=t.y-1,n.width=2,n.height=2;var o=this.network.getElementsAtRect(n,!0);if(o&&0<o.size())for(var s=o.size(),r=0;r<s;r++){var a=o.get(r);if(!this.network.getElementBox().getSelectionModel().contains(a)){this.parent=a;break}}}else this.parent=null;null!=this.parent&&(i=this.network.getElementUI(this.parent).getViewRect()),this.parentRect=null==i||e?null:i},getIntersectMode:function(){return"intersect"===this.network.getSelectMode()||"contain"!==this.network.getSelectMode()&&this.startPoint.x>this.endPoint.x&&this.startPoint.y>this.endPoint.y},_getVisibleScrollBar:function(){return 0==this.network.isScrollBarVisible()?null:null!=this.vThumbRect?"v":null!=this.hThumbRect?"h":null},paintScroll:function(t){var e,i,n,o,s;0!=this.network.isScrollBarVisible()&&(0==this.scrollBarVisible&&null==this.hBarDownPoint&&null==this.vBarDownPoint||(e=this.getScrollBarWidth(),i=this.network.getViewRect().height,n=this.network.getViewRect().width,t.save(),s=this.getScrollBarColor(),null!=this.hThumbRect&&((o=t.createLinearGradient(this.hThumbRect.x,this.hThumbRect.y,this.hThumbRect.x,this.hThumbRect.y+this.hThumbRect.height)).addColorStop(0,s),o.addColorStop(1,"#666666"),this.paintRoundRect(t,this.getScrollBarColor(),.5,0,i-e,n-e,e,e/2),this.paintRoundRect(t,o,.9,this.hThumbRect.x,this.hThumbRect.y+1,this.hThumbRect.width,this.hThumbRect.height-2,e/2)),null!=this.vThumbRect&&((o=t.createLinearGradient(this.vThumbRect.x,this.vThumbRect.y,this.vThumbRect.x+this.vThumbRect.width,this.vThumbRect.y)).addColorStop(0,s),o.addColorStop(1,"#666666"),this.paintRoundRect(t,this.getScrollBarColor(),.5,n-e,0,e,i-e,e/2),this.paintRoundRect(t,o,.9,this.vThumbRect.x+1,this.vThumbRect.y,this.vThumbRect.width-2,this.vThumbRect.height,e/2)),t.restore()))},paintRoundRect:function(t,e,i,n,o,s,r,a){t.beginPath(),t.globalAlpha=i,t.fillStyle=e,m.drawRoundRect(t,n,o,s,r,a),t.fill()},paint:function(t){if(this.paintScroll(t),this.network.isSelectingElement()){var e,i,n,o;null!=this.startPoint&&null!=this.endPoint&&(n=this.convertPointFromView(this.startPoint),o=this.convertPointFromView(this.endPoint),e=n.x,i=n.y,n=o.x,o=o.y,null!=(n=f.getRect([{x:e,y:i},{x:n,y:o}]))&&(t.beginPath(),c=this.network.getSelectOutlineWidth(),o=this.getIntersectMode()?this.network.getSelectFillColor():null,t.strokeStyle=this.network.getSelectOutlineColor(),t.lineWidth=c,ke.rect(t,n.x,n.y,n.width,n.height,o,this.network.getSelectOutlineColor()),t.closePath()))}else{if(this.lazyMode){if(null==this.pressPoint||null==this.dragPoint)return;t.beginPath();var s=(d=this.getOffset(this.dragPoint,this.pressPoint)).x,r=d.y,a=this.network.getMovableSelectedElements(),h=a.size(),l=this.network.isLazyMoveFill()?this.network.getLazyMoveFillColor():null,c=this.network.getLazyMoveOutlineWidth(),d=this.network.getLazyMoveOutlineColor();t.strokeStyle=d,t.lineWidth=c,t.fillStyle=l;for(var u=0;u<h;u++){var g=a.get(u);(g=this.network.getElementUI(g))&&(_=this.convertFromUIToMarkerRect(g.getViewRect(),s,r),ke.rect(t,_.x,_.y,_.width,_.height))}t.fill(),t.stroke()}var _;this.parentRect&&(t.beginPath(),l=this.network.isLazyMoveFill()?this.network.getLazyMoveFillColor():null,c=this.network.getLazyMoveOutlineWidth(),d=this.network.getLazyMoveOutlineColor(),t.strokeStyle=d,t.lineWidth=c,t.fillStyle=l,_=this.parentRect,ke.rect(t,_.x,_.y,_.width,_.height),t.fill(),t.stroke())}},handleClicked:function(t,e){At.handleClicked(this.network,t,e)},handleDoubleClicked:function(t){var e=this.network.getElementAt(t);At.handleDoubleClicked(this.network,t,e)},handle_blur:function(t){this.end()}}),n.vector.interaction.CreateElementInteraction=function(t,e){e=e||n.Node,n.Util.isTypeOf(e,n.Node)?this.elementFunction=function(t){var i=new e;return i instanceof n.Node&&i.setCenterLocation(t),i}:this.elementFunction=e,n.vector.interaction.CreateElementInteraction.superClass.constructor.call(this,t)},o.ext("b2.vector.interaction.CreateElementInteraction",n.vector.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown")},tearDown:function(){this.removeListener("mousedown")},handle_mousedown:function(t){!(t=this.network.getLogicalPoint2(t))||(t=this.elementFunction(t))&&this.network.addElementByInteraction(t)}}),n.vector.interaction.EditInteraction=function(t,e){this.lazyMode=e,this.pointIndex=-1,this.linkPointsType=null,n.vector.interaction.EditInteraction.superClass.constructor.call(this,t)},o.ext("b2.vector.interaction.EditInteraction",n.vector.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown","mouseup","mousemove"),this.oldCursor=this.network.getView().style.cursor,this.network.setHasEditInteraction(!0),this.network.addMarker(this)},tearDown:function(){this.removeListener("mousedown","mouseup","mousemove"),this.network.getView().style.cursor=this.oldCursor,this.network.setHasEditInteraction(!1),this.clear(),this.network.removeMarker(this)},paint:function(t){var e;1==this.lazyMode&&null!=this.resizingRect&&(t.lineWidth=this.network.getResizeLineWidth(),e=this.convertFromUIToMarkerRect(this.resizingRect,0,0,this.node),t.save(),n.Util.rotateCanvas(t,e,this.node.getAngle()),t.beginPath(),ke.rect(t,e.x,e.y,e.width,e.height,null,this.network.getResizeLineColor()),t.restore()),this.isStartRotate&&this.showRotateScale(t)},clear:function(){this.network.setEditingElement(!1),this.network.setRotatingElement(!1),this.isStart=!1,this.isStartRotate=!1,this.node=null,this.shapeNode=null,this.shapeLink=null,this.linkUI=null,this.resizingRect=null,this.resizeDirection=null,this.pointIndex=-1,this._removeCursor(),this.oldCursor=null,this.network.repaintTopCanvas()},_removeCursor:function(){this.cursorID&&(this.network.getView().style.cursor=this.oldCursor||"default",this.cursorID=null),this.resizeDirection=null,this.isCrossCursor=!1},_setCrossCursor:function(){this.isCrossCursor||(this._removeCursor(),this._setCursor("crosshair"),this.isCrossCursor=!0)},_setCursor:function(t){this.cursorID=t,this.network.getView().style.cursor!==this.cursorID&&(this.network.getView().style.cursor=this.cursorID)},isKeyDown:function(t){return o.isAltDown(t)},handle_mousedown:function(t){if(0===t.button){if(this.isKeyDown(t)&&!this.network.isEditingElement()){var e,i,o,s=this.network.getElementAt(t),r=this.network.getLogicalPoint2(t);return s instanceof n.ShapeNode&&0<(o=this.getPointIndex(this.network.getShapeNodeZoomPoints(s),r,!0))&&(this._handle_mousedown(t),this.pointIndex=o,(this.shapeNode=s).addPoint(r,o),this._setCrossCursor(),this.network.setEditingElement(!0),this.isStart=!0,this.network.fireInteractionEvent({kind:"addPoint",event:t,element:s,pointIndex:o}),this.network.fireInteractionEvent({kind:"liveMovePointStart",event:t,element:s,pointIndex:o})),void(s instanceof n.ShapeLink&&(e=new n.List(s.getPoints()),i=this.network.getElementUI(s),e.add(i.getFromPoint(),0),e.add(i.getToPoint()),0<(o=this.getPointIndex(e,r)-1)&&(this._handle_mousedown(t),this.pointIndex=o,(this.shapeLink=s).addPoint(r,o),this._setCrossCursor(),this.network.setEditingElement(!0),this.isStart=!0,this.network.fireInteractionEvent({kind:"addPoint",event:t,element:s,pointIndex:o}),this.network.fireInteractionEvent({kind:"liveMovePointStart",event:t,element:s,pointIndex:o}))))}!this.network.isEditingElement()||this.isStart||this.isStartRotate||(this.node&&this.resizeDirection?(this.isStart=!0,this._handle_mousedown(t),this.network.fireInteractionEvent({kind:this.lazyMode?"lazyResizeStart":"liveResizeStart",event:t,element:this.node,resizeDirection:this.resizeDirection})):this.shapeNode&&0<=this.pointIndex?this.isKeyDown(t)?(this.shapeNode.removeAt(this.pointIndex),this.network.fireInteractionEvent({kind:"removePoint",event:t,element:this.shapeNode})):(this.isStart=!0,this._handle_mousedown(t),this.network.fireInteractionEvent({kind:"liveMovePointStart",event:t,element:this.shapeNode,pointIndex:this.pointIndex})):this.shapeLink?this.isKeyDown(t)?0<=this.pointIndex&&(this.shapeLink.removeAt(this.pointIndex),this.network.fireInteractionEvent({kind:"removePoint",event:t,element:this.shapeLink})):(this.isStart=!0,this._handle_mousedown(t),this.network.fireInteractionEvent({kind:"liveMovePointStart",event:t,element:this.shapeLink,pointIndex:this.pointIndex})):this.linkUI?(this.isStart=!0,this.network.fireInteractionEvent({kind:"liveMovePointStart",event:t,element:this.linkUI._element})):this.node&&(this.isStartRotate=!0,this._handle_mousedown(t)))}},handle_mouseup:function(t){var e,i,o;this.isStart&&(e=this.network.getLogicalPoint2(t),this.resizingRect?this.lazyMode?this.network.isResizeAnimate()?(o=new n.animate.AnimateBounds((i=this).node,this.resizingRect,function(){i.network.fireInteractionEvent({kind:"lazyResizeEnd",event:t,element:i.node,resizeDirection:i.resizeDirection}),i.clear()}),n.animate.AnimateManager.start(o)):(this.node.setLocation(this.resizingRect.x,this.resizingRect.y),this.node.setSize(this.resizingRect.width,this.resizingRect.height),this.network.fireInteractionEvent({kind:"lazyResizeEnd",event:t,element:this.node,resizeDirection:this.resizeDirection})):(this.node.setLocation(this.resizingRect.x,this.resizingRect.y),this.node.setSize(this.resizingRect.width,this.resizingRect.height),this.network.fireInteractionEvent({kind:"liveResizeEnd",event:t,element:this.node,resizeDirection:this.resizeDirection})):this.shapeNode&&0<=this.pointIndex&&e?(this._resetShapeNodePoints(e),this.network.fireInteractionEvent({kind:"liveMovePointEnd",event:t,element:this.shapeNode,pointIndex:this.pointIndex})):e&&(this.shapeLink||this.linkUI)&&("from"===this.linkPointsType?this._setFromPoint(e):"to"===this.linkPointsType?this._setToPoint(e):"shapeControl"===this.linkPointsType?(this._resetShapeLinkPoints(e),this.network.fireInteractionEvent({kind:"liveMovePointEnd",event:t,element:this.shapeLink,pointIndex:this.pointIndex})):"control"===this.linkPointsType&&dt.isOrthogonalLink(this.linkUI._element)&&this.linkUI.getControlPoint()&&(this._setLinkControlPoint(e),this.network.fireInteractionEvent({kind:"liveMovePointEnd",event:t,element:this.linkUI._element})))),this._handle_mouseup(t),this.clear()},handle_mousemove:function(t){var e=this.network.getEditPointSize();if(this.network.isValidEvent(t)){if(this.isStartRotate&&this.node)return this._handleRotateElement(t,this.node),void(this.network.isShowRotateScale()&&this.repaint());if(this.isStart){if(this.shapeNode&&0<=this.pointIndex)return void this._handleMovingShapeNodePoint(t);if(this.node&&this.resizeDirection)return void this._handleResizing(t);if((this.shapeLink||this.linkUI)&&this.linkPointsType){if("from"===this.linkPointsType)return void this._handleMovingFromPoint(t);if("to"===this.linkPointsType)return void this._handleMovingToPoint(t);if("shapeControl"===this.linkPointsType)return void this._handleMovingShapeLinkPoint(t);if("control"===this.linkPointsType&&dt.isOrthogonalLink(this.linkUI._element)&&this.linkUI.getControlPoint())return void this._handleMovingLinkControlPoint(t)}}if(this.network.isSelectingElement()||this.network.isMovingElement()||0===this.network.getSelectionModel().size())this.clear();else{var i=this.network.getElementAt(t),o=this.network.getElementUI(i);if(o&&o.getEditAttachment()){var s=this.network.getLogicalPoint2(t);if(i instanceof n.Node){if(this.node=i,this._isEditingShapeNode(s)||this._isResizingNode(s))return void this.network.setEditingElement(!0);if(this._isRotatingElement(s))return this.network.setRotatingElement(!0),void this.network.setEditingElement(!0)}else if(i instanceof n.Link){i instanceof n.ShapeLink?this.shapeLink=i:o instanceof n.vector.LinkUI&&(this.linkUI=o);var r=i.getFromAgent()?i.getFromAgent():i.getFromNode(),a=i.getStyle("link.from.xoffset"),h=i.getStyle("link.from.yoffset");r={x:(t=this.network.getElementUI(r).getZoomBodyRect()).x+t.width/2+a,y:t.y+t.height/2+h},a=i.getToAgent()?i.getToAgent():i.getToNode(),t=i.getStyle("link.to.xoffset"),h=i.getStyle("link.to.yoffset"),h={x:(a=this.network.getElementUI(a).getZoomBodyRect()).x+a.width/2+t,y:a.y+a.height/2+h};if(this._contains(s,r,e))return this.linkPointsType="from",this._setCrossCursor(),void this.network.setEditingElement(!0);if(this._contains(s,h,e))return this.linkPointsType="to",this._setCrossCursor(),void this.network.setEditingElement(!0);if(i instanceof n.ShapeLink){if(this._isEditingShapeLink(s))return this.linkPointsType="shapeControl",void this.network.setEditingElement(!0)}else if(o instanceof n.vector.LinkUI)return dt.isOrthogonalLink(o._element)&&(o=this.linkUI.getControlPoint())&&this._contains(s,o,e)?(this.linkPointsType="control",this._setCrossCursor(),void this.network.setEditingElement(!0)):void(this.linkPointsType=null);this.linkPointsType=null}this.clear()}else this.clear()}}},_isRotatingElement:function(t){if(this.network.getRotatePointSize()<=0)return!1;var e=this.network.zoomManager,i=this.network.getElementUI(this.node),n=e.getSizeZoom(i);e=e._getElementZoomRect(i,this.node.getOriginalRect()),i=this.node.getAngle();return this._isRotating(t,"crosshair",e,i,n)},_isRotating:function(t,e,i,n,o){var s=this.network.getRotatePointSize()/this.network.getGraphicsZoom(),r={x:i.x+i.width/2,y:i.y-this.network.getRotatePointOffset()/this.network.getGraphicsZoom()-s};s={x:(i=this._rotatePoint(r,n,i)).x-s,y:i.y-s,width:2*s,height:2*s};return!!f.containsPoint(s,t)&&(this._removeCursor(),this._setCursor(e),!0)},_handleRotateElement:function(t,e){this._handle_mousemove(t),t=this._calculateAngle(this.network.getLogicalPoint2(t),e),e.setAngle(t)},_calculateAngle:function(t,e){return e=this.network.getZoomBodyRect(e),e=f.getCenterPoint(e),Math.round(180*Math.atan2(e.x-t.x,t.y-e.y)/Math.PI+180)},_resetShapeNodePoints:function(t){var e=this.network.getShapeNodeZoomPoints(this.shapeNode);e.set(this.pointIndex,t),t=this.network.getElementUI(this.shapeNode),e=this.network.zoomManager._getShapeNodeZoomPoints(t,e,!0),this.shapeNode.setPoints(e)},_handleMovingShapeNodePoint:function(t){var e=this.network.getLogicalPoint2(t);this._resetShapeNodePoints(e),this.network.fireInteractionEvent({kind:"liveMovePointBetween",e:t,element:this.shapeNode,pointIndex:this.pointIndex})},_resetShapeLinkPoints:function(t){var e=this.network.zoomManager._getShapeLinkZoomPoints(this.shapeLink._points);e.set(this.pointIndex,t),e=this.network.zoomManager._getShapeLinkZoomPoints(e,!0),this.shapeLink.setPoints(e)},_handleMovingShapeLinkPoint:function(t){var e=this.network.getLogicalPoint2(t);this._resetShapeLinkPoints(e),this.network.fireInteractionEvent({kind:"liveMovePointBetween",e:t,element:this.shapeLink,pointIndex:this.pointIndex})},_setLinkControlPoint:function(t){var e=this.linkUI.getControlPoint(),i=this.linkUI.getControlPoint(),n=(this.network.zoomManager,t.x-i.x);i=t.y-i.y;e.x+=n,e.y+=i,this.linkUI.setControlPoint(e)},_handleMovingLinkControlPoint:function(t){var e=this.network.getLogicalPoint2(t);this._setLinkControlPoint(e),this.network.fireInteractionEvent({kind:"liveMovePointBetween",e:t,element:this.linkUI._element})},_setFromPoint:function(t){var e;if(this.linkUI)e=this.linkUI._element;else{if(!this.shapeLink)return;e=this.shapeLink}var i=e.getFromAgent()?e.getFromAgent():e.getFromNode(),n=(i=(n=this.network.getElementUI(i).getZoomBodyRect()).x+n.width/2,n.y+n.height/2);n={x:t.x-i,y:t.y-n};e.setStyle("link.from.xoffset",n.x),e.setStyle("link.from.yoffset",n.y)},_handleMovingFromPoint:function(t){t=this.network.getLogicalPoint2(t),this._setFromPoint(t)},_setToPoint:function(t){var e;if(this.linkUI)e=this.linkUI._element;else{if(!this.shapeLink)return;e=this.shapeLink}var i=e.getToAgent()?e.getToAgent():e.getToNode(),n=(i=(n=this.network.getElementUI(i).getZoomBodyRect()).x+n.width/2,n.y+n.height/2);n={x:t.x-i,y:t.y-n};e.setStyle("link.to.xoffset",n.x),e.setStyle("link.to.yoffset",n.y)},_handleMovingToPoint:function(t){t=this.network.getLogicalPoint2(t),this._setToPoint(t)},convertFromUIToMarkerRect:function(t,e,i,n){var o=(l=this.network.zoomManager).getLocationZoom(),s=l.getGraphicsZoom(),r=this.network.getElementUI(n),a=l.getSizeZoom(r),h=t.x+t.width/2,l=(n=t.y+t.height/2,h-t.x);r=n-t.y;return{x:h*o*s-this.network.getViewRect().x+e*o*s-l*a*s,y:n*o*s-this.network.getViewRect().y+i*o*s-r*a*s,width:t.width*a*s,height:t.height*a*s}},_getReverseZoomPoint:function(t,e,i){var n=this.network.zoomManager,o=n.getLocationZoom();t=n.getSizeZoom(this.network.getElementUI(t));return e.x*=o,e.y*=o,{x:e.x/o+(i.x-e.x)/t,y:e.y/o+(i.y-e.y)/t}},_getReverseZoomRect:function(t,e){var i=(o=this.network.zoomManager).getLocationZoom(),n=o.getSizeZoom(s);if(i==n)return t;var o=(r=(s=this.network.getElementUI(e)).getBodyRect()).x+r.width/2,s=(e=r.y+r.height/2,o*i+(t.x-o)*n),r=e*i+(t.y-e)*n;return{x:(o=s+t.width*n/2)/i+(s-o)*n,y:(e=r+t.height*n/2)/i+(r-e)*n,width:t.width,height:t.height}},_handleResizing:function(t){this._handle_mousemove(t);var e,i=this.node.getAngle(),n=this.node.getLocation(),s=this.node.getWidth()/2,r=this.node.getHeight()/2,a={x:n.x+s,y:n.y+r},h={x:-s,y:-r},l={x:-s,y:r},c={x:s,y:r},d={x:s,y:-r},u={x:0,y:-r},g={x:s,y:0};n={x:0,y:r},r={x:-s,y:0},s=this._getReverseZoomPoint(this.node,o.clone(a),this._endLogical);"northwest"===this.resizeDirection&&(this._transformPoint(c,a,i),h.x=s.x,h.y=s.y,a.x=(h.x+c.x)/2,a.y=(h.y+c.y)/2,this._reversPoint(h,a,i),this._reversPoint(c,a,i),this.resizingRect={x:h.x,y:h.y,width:c.x-h.x,height:c.y-h.y},o.isShiftDown(t)&&this._revertResizeRect(this.node,this.resizingRect,1)),"north"===this.resizeDirection&&(e={x:s.x,y:s.y},this._reversPoint(e,a,i),u.y=e.y-a.y,this._transformPoint(u,a,i),this._transformPoint(n,a,i),a.x=(u.x+n.x)/2,a.y=(u.y+n.y)/2,this._reversPoint(u,a,i),this._reversPoint(n,a,i),this.resizingRect={x:a.x-this.node.getWidth()/2,y:a.y-(n.y-u.y)/2,width:this.node.getWidth(),height:n.y-u.y}),"northeast"===this.resizeDirection&&(this._transformPoint(l,a,i),d.x=s.x,d.y=s.y,a.x=(l.x+d.x)/2,a.y=(l.y+d.y)/2,this._reversPoint(l,a,i),this._reversPoint(d,a,i),this.resizingRect={x:l.x,y:d.y,width:d.x-l.x,height:l.y-d.y},o.isShiftDown(t)&&this._revertResizeRect(this.node,this.resizingRect,2)),"west"===this.resizeDirection&&(e={x:s.x,y:s.y},this._reversPoint(e,a,i),r.x=e.x-a.x,this._transformPoint(g,a,i),this._transformPoint(r,a,i),a.x=(g.x+r.x)/2,a.y=(g.y+r.y)/2,this._reversPoint(g,a,i),this._reversPoint(r,a,i),this.resizingRect={x:a.x-(g.x-r.x)/2,y:a.y-this.node.getHeight()/2,width:g.x-r.x,height:this.node.getHeight()}),"east"===this.resizeDirection&&(e={x:s.x,y:s.y},this._reversPoint(e,a,i),g.x=e.x-a.x,this._transformPoint(g,a,i),this._transformPoint(r,a,i),a.x=(g.x+r.x)/2,a.y=(g.y+r.y)/2,this._reversPoint(g,a,i),this._reversPoint(r,a,i),this.resizingRect={x:a.x-(g.x-r.x)/2,y:a.y-this.node.getHeight()/2,width:g.x-r.x,height:this.node.getHeight()}),"southwest"===this.resizeDirection&&(this._transformPoint(d,a,i),l.x=s.x,l.y=s.y,a.x=(l.x+d.x)/2,a.y=(l.y+d.y)/2,this._reversPoint(l,a,i),this._reversPoint(d,a,i),this.resizingRect={x:l.x,y:d.y,width:d.x-l.x,height:l.y-d.y},o.isShiftDown(t)&&this._revertResizeRect(this.node,this.resizingRect,4)),"south"===this.resizeDirection&&(e={x:s.x,y:s.y},this._reversPoint(e,a,i),n.y=e.y-a.y,this._transformPoint(u,a,i),this._transformPoint(n,a,i),a.x=(u.x+n.x)/2,a.y=(u.y+n.y)/2,this._reversPoint(u,a,i),this._reversPoint(n,a,i),this.resizingRect={x:a.x-this.node.getWidth()/2,y:a.y-(n.y-u.y)/2,width:this.node.getWidth(),height:n.y-u.y}),"southeast"===this.resizeDirection&&(this._transformPoint(h,a,i),c.x=s.x,c.y=s.y,a.x=(h.x+c.x)/2,a.y=(h.y+c.y)/2,this._reversPoint(h,a,i),this._reversPoint(c,a,i),this.resizingRect={x:h.x,y:h.y,width:c.x-h.x,height:c.y-h.y},o.isShiftDown(t)&&this._revertResizeRect(this.node,this.resizingRect,3)),this.resizingRect=this._getReverseZoomRect(this.resizingRect,this.node),this.lazyMode?(this.repaint(),this.network.fireInteractionEvent({kind:"lazyResizeBetween",event:t,element:this.node,resizeDirection:this.resizeDirection})):(this.node.setLocation(this.resizingRect.x,this.resizingRect.y),this.node.setSize(this.resizingRect.width,this.resizingRect.height),this.network.fireInteractionEvent({kind:"liveResizeBetween",event:t,element:this.node,resizeDirection:this.resizeDirection}))},_revertResizeRect:function(t,e,i){var n=t.getOriginalRect(),o=Math.max(e.width/n.width,e.height/n.height),s=n.width*o;t=n.height*o,n=e.x,o=e.y;1==i?(n+=e.width-s,o+=e.height-t):2==i?o+=e.height-t:3==i||4==i&&(n+=e.width-s),e.x=n,e.y=o,e.width=s,e.height=t},_isEditingShapeNode:function(t){var e=this.network.getEditPointSize();if(this.node instanceof n.ShapeNode){this.shapeNode=this.node;for(var i=this.network.getShapeNodeZoomPoints(this.node),o=0,s=i.size();o<s;o++){var r=i.get(o);if(this._contains(t,r,e))return this._setCrossCursor(),this.pointIndex=o,!0}}return!(this.pointIndex=-1)},_isEditingShapeLink:function(t){for(var e=this.network.getEditPointSize(),i=this.network.zoomManager._getShapeLinkZoomPoints(this.shapeLink.getPoints()),n=0,o=i.size();n<o;n++){var s=i.get(n);if(this._contains(t,s,e))return this._setCrossCursor(),this.pointIndex=n,!0}return!(this.pointIndex=-1)},_isResizingNode:function(t){if(this.network.getResizePointSize()<=0)return!1;var e=this.network.zoomManager,i=this.network.getElementUI(this.node),n=e._getElementZoomRect(i,this.node.getOriginalRect()),o=this.node.getAngle();e={x:n.x,y:n.y},i=this._rotatePoint(e,o,n);return!!this._isResizing(t,i.x,i.y,"northwest","nwse-resize")||(e={x:n.x+n.width/2,y:n.y},i=this._rotatePoint(e,o,n),!!(this._isResizing(t,i.x,i.y,"north","ns-resize")||(e={x:n.x+n.width,y:n.y},i=this._rotatePoint(e,o,n),this._isResizing(t,i.x,i.y,"northeast","nesw-resize")||(e={x:n.x,y:n.y+n.height/2},i=this._rotatePoint(e,o,n),this._isResizing(t,i.x,i.y,"west","ew-resize")||(e={x:n.x+n.width,y:n.y+n.height/2},i=this._rotatePoint(e,o,n),this._isResizing(t,i.x,i.y,"east","ew-resize")||(e={x:n.x,y:n.y+n.height},i=this._rotatePoint(e,o,n),this._isResizing(t,i.x,i.y,"southwest","nesw-resize")||(e={x:n.x+n.width/2,y:n.y+n.height},i=this._rotatePoint(e,o,n),this._isResizing(t,i.x,i.y,"south","ns-resize")||(e={x:n.x+n.width,y:n.y+n.height},i=this._rotatePoint(e,o,n),this._isResizing(t,i.x,i.y,"southeast","nwse-resize")))))))))},_rotatePoint:function(t,e,i){return f.createMatrix(e*Math.PI/180,i.x+i.width/2,i.y+i.height/2).transform(t)},_isResizing:function(t,e,i,n,o){var s=this.network.getGraphicsZoom();s=this.network.getResizePointSize()/s;return!!this._contains(t,{x:e,y:i},s)&&(this.resizeDirection!==n&&(this._removeCursor(),o=this._changeCursorWithAngle(n,this.node.getAngle()),this._setCursor(o),this.resizeDirection=n),!0)},_getRect:function(t,e,i,n){return{x:t<i?t:i,y:e<n?e:n,width:Math.abs(t-i),height:Math.abs(e-n)}},_contains:function(t,e,i){return i={x:e.x-i,y:e.y-i,width:2*i,height:2*i},f.containsPoint(i,t)},getPointIndex:function(t,e,i){if(t.size()<2)return 0;for(var n,o=t.get(0),s=1;s<t.size();s++){if(n=t.get(s),this.isPointOnLine(e,o,n,6))return s;o=n}return o=t.get(0),i&&this.isPointOnLine(e,o,n,6)?t.size():0},showRotateScale:function(t){new n.List;var e,i,s,r=this.network.getRotateScaleWidth(),a=this.network.getRotateScaleHeight(),h=this.network.getRotatePointSize(),l=this.node.getAngle(),c=this.network.zoomManager,d=this.network.getElementUI(this.node),u=(d={x:(u=c._getElementZoomRect(d,this.node.getOriginalRect())).x+u.width/2,y:u.y-this.network.getRotatePointOffset()-h},d=this._rotatePoint(d,l,u),l+"");l=this.network.getViewRect();1===c.getLocationZoom()&&(t.translate(-l.x,-l.y),t.scale(this.network.getZoom(),this.network.getZoom())),0<=this.node.getAngle()&&this.node.getAngle()<=180?(s={x:(i={x:(e={x:d.x+h,y:d.y}).x+r,y:e.y}).x,y:i.y-a},g={x:e.x,y:s.y}):180<this.node.getAngle()&&this.node.getAngle()<=360&&(s={x:(i={x:(e={x:d.x-h,y:d.y}).x-r,y:e.y}).x,y:i.y-a},g={x:e.x,y:s.y});var g=new n.List([e,i,s,g]);g=o.math.getRect(g);1!==c.getLocationZoom()&&(g.x-=l.x,g.y-=l.y),t.fillStyle=this.network.getRotateScaleFillColor(),t.fillRect(g.x,g.y,g.width,g.height),t.fillStyle=this.network.getRotateScaleFontColor(),t.textBaseline="middle",t.textAlign="center",t.font="13px Arial",t.fillText(u,g.x+g.width/2,g.y+g.height/2),1===c.getLocationZoom()&&(t.scale(1/this.network.getZoom(),1/this.network.getZoom()),t.translate(l.x,l.y))},isPointOnLine:function(t,e,i,n){return n<0&&(n=0),this.getDistanceFromPointToLine(t,e,i)<=n&&t.x>=Math.min(e.x,i.x)-n&&t.x<=Math.max(e.x,i.x)+n&&t.y>=Math.min(e.y,i.y)-n&&t.y<=Math.max(e.y,i.y)+n},getDistanceFromPointToLine:function(t,e,i){if(e.x===i.x)return Math.abs(t.x-e.x);var n=(i.y-e.y)/(i.x-e.x);e=(i.x*e.y-e.x*i.y)/(i.x-e.x);return Math.abs(n*t.x-t.y+e)/Math.sqrt(n*n+1)},_transformPoint:function(t,e,i){var n=Math.cos(i*Math.PI/180),o=Math.sin(i*Math.PI/180),s=t.x,r=t.y;i=s*o+r*n;t.x=s*n-r*o+e.x,t.y=i+e.y},_reversPoint:function(t,e,i){i*=-1;var n=Math.cos(i*Math.PI/180),o=Math.sin(i*Math.PI/180),s=t.x-e.x,r=t.y-e.y;i=s*o+r*n;t.x=s*n-r*o+e.x,t.y=i+e.y},_changeCursorWithAngle:function(t,e){var i;switch(t){case"northwest":i=1;break;case"north":i=2;break;case"northeast":i=3;break;case"east":i=4;break;case"southeast":i=5;break;case"south":i=6;break;case"southwest":i=7;break;case"west":i=8;break;default:i=0}return(360<=e||e<=-360)&&(e%=360),22.5<e&&e<=67.5&&(i+=1),e<-22.5&&-67.5<=e&&(i-=1),67.5<e&&e<=112.5&&(i+=2),e<-67.5&&-112.5<=e&&(i-=2),112.5<e&&e<=157.5&&(i+=3),e<-112.5&&-157.5<=e&&(i-=3),157.5<e&&e<=202.5&&(i+=4),e<-157.5&&-202.5<=e&&(i-=4),202.5<e&&e<=247.5&&(i+=5),e<-202.5&&-247.5<=e&&(i-=5),247.5<e&&e<=292.5&&(i+=6),e<-247.5&&-292.5<=e&&(i-=6),292.5<e&&e<=337.5&&(i+=7),e<-292.5&&-337.5<=e&&(i-=7),8<i&&(i-=8),i<=0&&(i+=8),["auto","nwse-resize","ns-resize","nesw-resize","ew-resize","nwse-resize","ns-resize","nesw-resize","ew-resize"][i]}}),n.vector.interaction.MoveLinkInteraction=function(t,e){n.vector.interaction.MoveLinkInteraction.superClass.constructor.call(this,t),this.xoffset=0,this.yoffset=0},o.ext("b2.vector.interaction.MoveLinkInteraction",n.vector.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown"),this.oldCursor=this.network.getView().style.cursor},tearDown:function(){this.removeListener("mousedown"),this.network.getView().style.cursor=this.oldCursor,this.end()},handle_mousedown:function(t){var e;0===t.button&&(this.network.isSelectingElement()||this.network.isEditingElement()||(e=this.network.getElementAt(t))instanceof n.Link&&(this.element=e,this.end(t),this._handle_mousedown(t)))},handle_mouseup:function(t){this.end(t)},handle_mousemove:function(t){var e,i;!this._startLogical||this.network.isSelectingElement()||this.network.isEditingElement()?this.end(t):(this._handle_mousemove(t),this.xoffset=this._endLogical.x-this._startLogical.x,this.yoffset=this._endLogical.y-this._startLogical.y,this.lazyMode?(this.mark?this.network.fireInteractionEvent({kind:"lazyMoveBetween",event:t,element:this.element}):(this.mark=p.createCanvas(),this.network.getMovableSelectedElements().forEach(function(t){(t=this.getElementUI(t))&&(e=f.unionRect(e,t.getViewRect()))},this.network),this.network.getTopDiv().appendChild(this.mark),this.network.setMovingElement(!0),p.setDiv(this.mark,e,this.network.isLazyMoveFill()?this.network.getLazyMoveFillColor():null,this.network.getLazyMoveOutlineWidth(),this.network.getLazyMoveOutlineColor()),this.network.fireInteractionEvent({kind:"lazyMoveStart",event:t,element:this.element})),this.mark.style.left=this.xoffset+this.mark._viewRect.x+"px",this.mark.style.top=this.yoffset+this.mark._viewRect.y+"px"):(i=new n.List([this.element.getFromNode(),this.element.getToNode()]),n.Util.moveElements(i,this.xoffset,this.yoffset),this._startLogical=this._endLogical,this._startClient=p.getClientPoint(t),this.network.isMovingElement()?this.network.fireInteractionEvent({kind:"liveMoveBetween",event:t,element:this.element}):(this.network.setMovingElement(!0),this.network.fireInteractionEvent({kind:"liveMoveStart",event:t,element:this.element}))))},end:function(t){var e,i;this._startLogical&&(this.lazyMode?this.mark&&(i=new n.List([(e=this).element.getFromNode(),this.element.getToNode()]),n.Util.moveElements(i,this.xoffset,this.yoffset,this.network.isLazyMoveAnimate(),function(){e.network.fireInteractionEvent({kind:"lazyMoveEnd",event:t,element:this.element}),e.mark&&(e.network.getTopDiv().removeChild(e.mark),e.mark=null,e.network.setMovingElement(!1))})):this.network.isMovingElement()&&(this.network.setMovingElement(!1),this.network.fireInteractionEvent({kind:"liveMoveEnd",event:t,element:this.element})),this._handle_mouseup(t),delete this.element)}}),n.vector.interaction.CreateLinkInteraction=function(t,e){e=e||n.Link,n.Util.isTypeOf(e,n.Link)?this.linkFunction=function(t,i){var o=new e;return o instanceof n.Link&&(o.setFromNode(t),o.setToNode(i)),o}:this.linkFunction=e,n.vector.interaction.CreateLinkInteraction.superClass.constructor.call(this,t)},o.ext("b2.vector.interaction.CreateLinkInteraction",n.vector.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown","mousemove"),this.network.addMarker(this)},tearDown:function(){this.removeListener("mousedown","mousemove"),this.clear(),this.network.removeMarker(this)},paint:function(t){var e,i;t.beginPath(),t.lineWidth=this.network.getEditLineWidth();var n=this.network.getEditLineColor();this.currentNode&&this.currentNode!==this.fromNode&&(e=this.network.getElementUI(this.currentNode).getZoomViewRect(!0),i=this.convertFromUIToMarkerRect(e,0,0),ke.rect(t,i.x,i.y,i.width,i.height,null,n)),this.fromNode&&(e=this.network.getElementUI(this.fromNode).getZoomViewRect(!0),i=this.convertFromUIToMarkerRect(e,0,0),ke.rect(t,i.x,i.y,i.width,i.height,null,n)),this.currentPoint&&this.paintLine(t),t.closePath()},convertFromUIToMarkerRect:function(t,e,i){var n=this.network.zoomManager.getGraphicsZoom();return{x:t.x*n-this.network.getViewRect().x+e*n,y:t.y*n-this.network.getViewRect().y+i*n,width:t.width*n,height:t.height*n}},getZoomNodeRectOrPoint:function(t,e){return t=this.network.getElementUI(t).getZoomBodyRect(),e?{x:t.x+t.width/2,y:t.y+t.height/2}:t},paintLine:function(t){var e=this.network.getEditLineColor(),i=this.network.getElementUI(this.fromNode).getZoomBodyRect(),n=(s=this.convertPointFromView({x:i.x+i.width/2,y:i.y+i.height/2})).x,o=s.y,s=(i=this.currentPoint.x,this.currentPoint.y);t.strokeStyle=e,t.beginPath(),t.moveTo(n,o),t.lineTo(i,s),t.stroke()},clear:function(){this.currentPoint=null,this.currentNode=null,this.fromNode=null,this.toNode=null},createLink:function(){return this.linkFunction(this.fromNode,this.toNode)},handle_mousedown:function(t){this.network.isValidEvent(t)&&(this.fromNode?(this.toNode=this.currentNode,!this.toNode||(t=this.createLink())&&this.network.addElementByInteraction(t),this.clear()):(this.fromNode=this.currentNode,this.currentNode=null,this.currentPoint=null,this.repaint()))},handle_mousemove:function(t){var e,i=this.getMarkerPoint(t);i&&(this.network.isMovingElement()||this.network.isEditingElement()?this.clear():(e=null,this.fromNode?(this.currentNode=this.getToNode(t,this.fromNode),this.currentPoint=i,this.repaint()):(e=this.getFromNode(t),this.currentNode!==e&&(this.currentNode=e,this.repaint()))))},getFromNode:function(t){return this.getNode(t)},getToNode:function(t,e){return this.getNode(t,e)},getNode:function(t,e){return(t=this.network.getElementAt(t))instanceof be&&this.network.isLinkable(t,e)&&this.network.getElementBox().getSelectionModel().isSelectable(t)?t:null}}),n.vector.interaction.CreateShapeLinkInteraction=function(t,e){n.vector.interaction.CreateShapeLinkInteraction.superClass.constructor.call(this,t),e=e||n.ShapeLink,n.Util.isTypeOf(e,n.ShapeLink)?this.linkFunction=function(t,i,o){var s=new e;return s instanceof n.ShapeLink&&(s.setFromNode(t),s.setToNode(i),o&&(i=this.network.zoomManager,s.setPoints(i._getShapeLinkZoomPoints(o,!0)))),s}:this.linkFunction=e},o.ext("b2.vector.interaction.CreateShapeLinkInteraction",n.vector.interaction.CreateLinkInteraction,{clear:function(){this.points=null,n.vector.interaction.CreateShapeLinkInteraction.superClass.clear.call(this)},createLink:function(){return this.linkFunction(this.fromNode,this.toNode,this.points)},handle_mousedown:function(t){if(0===t.button&&(t=this.network.getLogicalPoint2(t))){if(this.fromNode)if(this.toNode=this.currentNode,this.toNode){var e=this.createLink();e&&this.network.addElementByInteraction(e),this.clear()}else{if(this.points||(this.points=new n.List),0<this.points.size()&&(e=this.points.get(this.points.size()-1)).x===t.x&&e.y===t.y)return;this.points.add(t)}else this.fromNode=this.currentNode,this.points=null,this.currentNode=null,this.currentPoint=null;this.repaint()}},paintLine:function(t){if(this.currentPoint){var e=new n.List,i=this.convertPointFromView(this.getZoomNodeRectOrPoint(this.fromNode,!0));if(e.add(i,0),this.points&&0<this.points.size())for(var o=this.points.size(),s=0;s<o;s++)i=this.convertPointFromView(this.points.get(s)),e.add(i);i=this.currentPoint,e.add(i),t.lineWidth=this.network.getEditLineWidth(),t.strokeStyle=this.network.getEditLineColor(),t.beginPath(),m.drawLinePoints(t,e),t.stroke()}}}),n.vector.interaction.CreateShapeNodeInteraction=function(t,e){e=e||n.ShapeNode,n.Util.isTypeOf(e,n.ShapeNode)?this.shapeNodeFunction=function(t){var i,o,s=new e;return s instanceof n.ShapeNode&&(i=this.network.zoomManager,o=this.network.createElementUI(s),t&&(t=i._getShapeNodeZoomPoints(o,t,!0),o.invalidateZoom(),s.setPoints(t))),s}:this.shapeNodeFunction=e,n.vector.interaction.CreateShapeNodeInteraction.superClass.constructor.call(this,t),this.timeStamp=-1},o.ext("b2.vector.interaction.CreateShapeNodeInteraction",n.vector.interaction.BaseInteraction,{setUp:function(){this.addListener("mousedown","mousemove"),this.network.addMarker(this)},tearDown:function(){this.removeListener("mousedown","mousemove"),this.clear(),this.network.removeMarker(this),this.network.setEditingElement(!1)},clear:function(){this.points=null,this.currentPoint=null},paint:function(t){if(this.points&&0<this.points.size()&&this.currentPoint){for(var e,i=new n.List,o=this.points.size(),s=0;s<o;s++)e=this.convertPointFromView(this.points.get(s)),i.add(e);e=this.convertPointFromView(this.currentPoint),i.add(e),t.lineWidth=this.network.getEditLineWidth(),t.strokeStyle=this.network.getEditLineColor(),t.beginPath(),m.drawLinePoints(t,i),t.stroke()}},handle_mousedown:function(t){if(0===t.button){var e,i=this.network.getLogicalPoint2(t);if(i){if(2===t.detail||t.timeStamp-this.timeStamp<300)this.points&&(o=this.shapeNodeFunction(this.points),this.network.addElementByInteraction(o),this.clear(),e=this,setTimeout(function(){e.network.setEditingElement(!1)},0));else{if(this.network.isEditingElement()||this.network.setEditingElement(!0),this.points||(this.points=new n.List),0<this.points.size()){var o=this.points.get(this.points.size()-1);if(o.x===i.x&&o.y===i.y)return}this.points.add(i)}this.timeStamp=t.timeStamp,this.repaint()}}},handle_mousemove:function(t){this.points&&(this.currentPoint=this.network.getLogicalPoint2(t),this.repaint())}}),n.vector.interaction.MagnifyInteraction=function(t,e,i,o,s){n.vector.interaction.MagnifyInteraction.superClass.constructor.call(this,t),this.scale=e||2,this.xRadius=i||100,this.yRadius=o||100,this.shape=s||"circle",this.borderColor="black",this.borderWidth=1,this.backgroundColor="white",this.markCanvas=p.createCanvas()},o.ext("b2.vector.interaction.MagnifyInteraction",n.vector.interaction.BaseInteraction,{setUp:function(){this.addListener("mousemove"),this.addListener("mousewheel"),this.network.addMarker(this)},tearDown:function(){this.removeListener("mousemove"),this.removeListener("mousewheel"),this.network.removeMarker(this)},paint:function(t){var e,i,n,o,s;this.point&&(s=(n=this.network.zoomManager).getLocationZoom(),e=n.getGraphicsZoom(),n.getSizeZoom(),this.network.getZoom(),i=this.xRadius/this.scale/e,n=this.yRadius/this.scale/e,s="mousewheel"===this.mouseFlag?(o={x:this.zoomPoint.x-i,y:this.zoomPoint.y-n,width:2*i,height:2*n},this.network.toCanvasByRegion(o,this.scale*e,this.markCanvas,"white"),{x:this.zoomPoint.x-this.xRadius-this.network.viewRect.x,y:this.zoomPoint.y-this.yRadius-this.network.viewRect.y,width:this.markCanvas.width,height:this.markCanvas.height}):(o={x:this.point.x*s-i,y:this.point.y*s-n,width:2*i,height:2*n},this.network.toCanvasByRegion(o,this.scale*e,this.markCanvas,"white"),{x:this.point.x*s*e-this.xRadius-this.network.viewRect.x,y:this.point.y*s*e-this.yRadius-this.network.viewRect.y,width:this.markCanvas.width,height:this.markCanvas.height}),t.save(),t.beginPath(),m.drawVector(t,this.shape,null,s.x,s.y,2*o.width*e,2*o.height*e),t.clip(),t.fillStyle=this.backgroundColor,t.beginPath(),t.rect(s.x,s.y,s.width,s.height),t.fill(),t.drawImage(this.markCanvas,s.x,s.y),t.restore(),t.beginPath(),t.lineWidth=this.borderWidth,m.drawVector(t,this.shape,null,s.x+this.borderWidth/2,s.y+this.borderWidth/2,2*o.width*e-this.borderWidth,2*o.height*e-this.borderWidth),t.strokeStyle=this.borderColor,t.stroke(),this.mouseFlag=null)},handle_mousemove:function(t){this.point=this.network.getLogicalPoint(t),this.point&&(this.mouseFlag="mousemove",this.repaint())},handle_mousewheel:function(t){1!==this.network.zoomManager.getLocationZoom()&&(this.zoomPoint=this.network.getLogicalPoint2(t)),this.zoomPoint&&(this.mouseFlag="mousewheel",this.repaint())},getScale:function(){return this.scale},setScale:function(t){this.scale=t,this.network.repaintTopCanvas()},getShape:function(){return this.shape},setShape:function(t){this.shape=t,this.network.repaintTopCanvas()},getXRadius:function(){return this.xRadius},setXRadius:function(t){this.xRadius=t,this.network.repaintTopCanvas()},getYRadius:function(){return this.yRadius},setYRadius:function(t){this.yRadius=t,this.network.repaintTopCanvas()},getBorderColor:function(){return this.borderColor},setBorderColor:function(t){this.borderColor=t,this.network.repaintTopCanvas()},getBorderWidth:function(){return this.borderWidth},setBorderWidth:function(t){this.borderWidth=t,this.network.repaintTopCanvas()},getBackgroundColor:function(){return this.backgroundColor},setBackgroundColor:function(t){this.backgroundColor=t,this.network.repaintTopCanvas()}}),n.vector.interaction.TouchInteraction=function(t){n.vector.interaction.TouchInteraction.superClass.constructor.call(this,t)},o.ext("b2.vector.interaction.TouchInteraction",n.vector.interaction.BaseInteraction,{setUp:function(){var t=this.network.getView();p.addEventListener("touchstart","handleTouchstart",t,this),p.addEventListener("touchmove","handleTouchmove",t,this),p.addEventListener("touchend","handleTouchend",t,this),p.addEventListener("touchcancel","handleTouchend",t,this)},tearDown:function(){var t=this.network.getView();p.removeEventListener("touchstart",t,this),p.removeEventListener("touchmove",t,this),p.removeEventListener("touchend",t,this),p.removeEventListener("touchcancel",t,this)},_isDragToSelect:function(t){return!this.network._dragToPan},handleTouchstart:function(t){var e,i;p.preventDefault(t),this.isMoving=!1,this.isSelecting=!1,1==t.touches.length?(e=this.network.getLogicalPoint2(t),i=this._element=this.network.getElementAt(e),this._startTouchTime=new Date,this._currentTouchPoint=e,this._startTouchClient=this._currentTouchClient=this.getMarkerPoint(t),i?this.network.getSelectionModel().contains(i)?this.isSelecting=!0:(this.network.getSelectionModel().setSelection(i),this.network.getSelectionModel().contains(i)&&(this.isSelecting=!0)):(this.isSelecting=!1,this.network.getSelectionModel().clearSelection()),At.handleClicked(this.network,t,i),this._endTouchTime&&this._startTouchTime.getTime()-this._endTouchTime.getTime()<=500&&f.getDistance(this._endTouchClient,this._startTouchClient)<=20?(delete this._endTouchTime,delete this._endTouchClient,At.handleDoubleClicked(this.network,t,i)):(this._endTouchTime=this._startTouchTime,this._endTouchClient=this._startTouchClient)):(this._distance=gt.getDistance(t),this._zoom=this.network.getZoom())},handleTouchmove:function(t){var e,i,n,o;p.preventDefault(t),1<t.touches.length?(e=gt.getDistance(t),Math.abs(e-this._distance)<20||(i=e/this._distance,this.network.setZoom(this._zoom*i,!1))):null==this._zoom&&(e=this.getMarkerPoint(t),f.getDistance(this._startTouchClient,e)<20||(this._element&&(this.isSelecting||this._isDragToSelect(t))?(i=this.network.getLogicalPoint2(t),n=(o=this.getOffset(i,this._currentTouchPoint)).x,o=o.y,this._currentTouchPoint=i,this.network.moveSelectedElements(n,o),this.network.isMovingElement()?this.network.fireInteractionEvent({kind:"liveMoveBetween",event:t}):(this.network.setMovingElement(!0),this.network.fireInteractionEvent({kind:"liveMoveStart",event:t}))):(n=this._currentTouchClient.x-e.x,o=this._currentTouchClient.y-e.y,this.network.panByOffset(n,o),this._currentTouchClient=e)))},handleTouchend:function(t){p.preventDefault(t),this.network.isMovingElement()&&(this.network.setMovingElement(!1),this.network.fireInteractionEvent({kind:"liveMoveEnd",event:t})),0===t.touches.length&&(this._distance=null,this._zoom=null,this._element=null,this._startTouchTime=null,this._currentTouchPoint=null,this._startTouchClient=this._currentTouchClient=null)}}),n.vector.interaction.MSTouchInteraction=function(t){n.vector.interaction.MSTouchInteraction.superClass.constructor.call(this,t),this._pointerMap={},this._pointerIdArray=[]},o.ext("b2.vector.interaction.MSTouchInteraction",n.vector.interaction.BaseInteraction,{setUp:function(){var t=this.network.getView();p.addEventListener("MSPointerDown","handleTouchstart",t,this),p.addEventListener("MSPointerMove","handleTouchmove",t,this),p.addEventListener("MSPointerUp","handleTouchend",t,this),p.addEventListener("MSPointerCancel","handleTouchend",t,this),this.network.addMarker(this)},tearDown:function(){var t=this.network.getView();p.removeEventListener("MSPointerDown",t,this),p.removeEventListener("MSPointerMove",t,this),p.removeEventListener("MSPointerUp",t,this),p.removeEventListener("MSPointerCancel",t,this),this.network.removeMarker(this)},handleTouchstart:function(t){var e,i,s,r;this.network.isFocusOnClick()&&n.Util.setFocus(this.network._view),this.network.isSelectingElement()&&t.pointerType==t.MSPOINTER_TYPE_MOUSE||(e=this.network.getLogicalPoint2(t),i=new Date,t.isPrimary&&0<this._pointerIdArray.length&&this.handle_mouseup(t),this._pointerMap[t.pointerId]||(this._pointerIdArray.push(t.pointerId),this._pointerMap[t.pointerId]=t),1==this._pointerIdArray.length?(s=this.network.getElementAt(e),this._startTouchElement=s,this._startClientPoint={x:t.clientX,y:t.clientY},r=this.network.getSelectionModel(),s?o.isCtrlDown(t)?r.contains(s)?r.removeSelection(s):r.appendSelection(s):r.contains(s)||r.setSelection(s):o.isCtrlDown(t)||r.clearSelection(),At.handleClicked(this.network,t,s),this._startTouchTime&&this._startTouchPoint&&i.getTime()-this._startTouchTime.getTime()<=500&&f.getDistance(this._startTouchPoint,e)<=20?(At.handleDoubleClicked(this.network,t,s),this._doubleClick=!0):(p.handle_mousedown(this,t),this._startTouchPoint=e,this._startTouchTime=i)):2==this._pointerIdArray.length&&(this._distance=this._getDistance(),this._zoom=this.network.getZoom()))},handleTouchmove:function(t){null==this._startTouchPoint||0==this._pointerIdArray.length||!this._pointerMap[t.pointerId]||f.getDistance({x:this._pointerMap[t.pointerId].pageX,y:this._pointerMap[t.pointerId].pageY},{x:t.pageX,y:t.pageY})<=10||(this._pointerMap[t.pointerId]=t,2==this._pointerIdArray.length&&(t=this._getDistance()/this._distance,this.network.setZoom(this._zoom*t,!1)))},handleTouchend:function(t){var e,i,n;this.network.isMovingElement()&&(this.network.setMovingElement(!1),this.network.fireInteractionEvent({kind:"liveMoveEnd",event:t})),this.network.isSelectingElement()&&(e=f.getRect([this._startTouchPoint,this._moveTouchPoint]),(e=this.network.getElementsAtRect(e,this.getIntersectMode(),this.network.getRectSelectFilter()))&&0<e.size()&&(i=this.network.getSelectionModel(),n=i.toSelection(),e.forEach(function(t){i.contains(t)?n.remove(t):n.add(t)},this),i.setSelection(n)),this.network.fireInteractionEvent({kind:"selectEnd",event:t}),this._moveTouchPoint=null,this.network.setSelectingElement(!1),this.repaint()),this._doubleClick&&(delete this._doubleClick,delete this._startTouchPoint,delete this._startTouchTime);for(var o=-1,s=0;s<this._pointerIdArray.length;s++)if(this._pointerIdArray[s]==t.pointerId){o=s;break}0<=o&&this._pointerIdArray.splice(o,1),delete this._pointerMap[t.pointerId],this._moveTouchPoint=null},_getDistance:function(){return f.getDistance({x:this._pointerMap[this._pointerIdArray[0]].pageX,y:this._pointerMap[this._pointerIdArray[0]].pageY},{x:this._pointerMap[this._pointerIdArray[1]].pageX,y:this._pointerMap[this._pointerIdArray[1]].pageY})},getIntersectMode:function(){return"intersect"===this.network.getSelectMode()||"contain"!==this.network.getSelectMode()&&this._startTouchPoint.x>this._moveTouchPoint.x&&this._startTouchPoint.y>this._moveTouchPoint.y},handle_mousemove:function(t){var e,i,n,o={x:t.clientX,y:t.clientY};f.getDistance(this._startClientPoint,o)<3||this._startTouchPoint&&1==this._pointerIdArray.length&&(this._moveTouchPoint={x:this._startTouchPoint.x+(o.x-this._startClientPoint.x)/this.network.getZoom(),y:this._startTouchPoint.y+(o.y-this._startClientPoint.y)/this.network.getZoom()},null==this._startTouchElement&&this.network.isRectSelectEnabled()?this.network.getLogicalPoint2(t)&&(this.network.setSelectingElement(!0),this._moveTouchPoint?this.network.fireInteractionEvent({kind:"selectBetween",event:t}):this.network.fireInteractionEvent({kind:"selectStart",event:t}),this.repaint()):(e=this.network.getElementAt(this._moveTouchPoint),null!=this._startTouchElement||this.network.isRectSelectEnabled()?(this.network.isMovingElement()||null!=this._startTouchElement&&e==this._startTouchElement&&this.network.getMovableSelectedElements().contains(e))&&(i=this._moveTouchPoint.x-this._startTouchPoint.x,n=this._moveTouchPoint.y-this._startTouchPoint.y,this.network.moveSelectedElements(i,n),this.network.isMovingElement()?this.network.fireInteractionEvent({kind:"liveMoveBetween",event:t}):(this.network.setMovingElement(!0),this.network.fireInteractionEvent({kind:"liveMoveStart",event:t}))):(i=this._startClientPoint.x-o.x,n=this._startClientPoint.y-o.y,this.network.panByOffset(i,n)),this._startClientPoint=o))},handle_mouseup:function(t){this.handleTouchend(t),this._pointerIdArray=[],this._pointerMap={}},paint:function(t){var e,i,n,o;this._startTouchPoint&&this._moveTouchPoint&&!this._startTouchElement&&this.network.isRectSelectEnabled()&&(n=this.convertPointFromView(this._startTouchPoint),o=this.convertPointFromView(this._moveTouchPoint),e=n.x,i=n.y,n=o.x,o=o.y,null!=(i=f.getRect([{x:e,y:i},{x:n,y:o}]))&&(t.beginPath(),n=this.network.getSelectOutlineWidth(),o=this.getIntersectMode()?this.network.getSelectFillColor():null,t.strokeStyle=this.network.getSelectOutlineColor(),t.lineWidth=n,ke.rect(t,i.x,i.y,i.width,i.height,o,this.network.getSelectOutlineColor()),t.closePath()))}}),n.JsonSerializer=function(t,e,i){this.dataBox=t,this.settings=e||new n.SerializationSettings,this.filterFunction=i,this.ref=0,this.refMap={},this.idMap={},this.jsonObject={}},o.ext("b2.JsonSerializer",Object,{serialize:function(){return this.jsonObject={version:n.Util.getVersion(),platform:"html5"},this.settings.isImageSerializable&&(this.jsonObject.images={}),this.serializeBody(),JSON.stringify(this.jsonObject)},serializeBody:function(){var t;this.ref=0,this.dataBox.getRoots().forEach(this.initRefs,this),this.settings.isDataBoxSerializable&&(t={class:this.dataBox.getClassName(),p:{},s:{},c:{}},this.jsonObject.dataBox=t,this.dataBox.serializeJson(this,this.dataBox.newInstance(),t),o.isEmptyObject(t.p)&&delete t.p,o.isEmptyObject(t.s)&&delete t.s,o.isEmptyObject(t.c)&&delete t.c),this.jsonObject.datas=[],this.dataBox.getRoots().forEach(this.serializeData,this)},initRefs:function(t){this.refMap[t.getId()]=this.ref++,t.getChildren().forEach(this.initRefs,this)},isSerializable:function(t){return!(!this.dataBox.contains(t)||this.filterFunction&&!this.filterFunction(t))},serializeData:function(t){var e,i;this.isSerializable(t)&&(e=t.newInstance(),i=this.refMap[t.getId()],i={class:t.getClassName(),ref:i,p:{},s:{},c:{}},this.settings.getPropertyType("id")&&(i.id=t.getId()),this.jsonObject.datas.push(i),t.serializeJson(this,e,i),o.isEmptyObject(i.p)&&delete i.p,o.isEmptyObject(i.s)&&delete i.s,o.isEmptyObject(i.c)&&delete i.c,this.settings.isImageSerializable&&t.getImage&&("string"!=typeof(e=t.getImage())||Se[e]||this.jsonObject.images[e]||(i=(i=o.getImageAsset(e))&&i.getImage())&&!Vt(i)&&(this.jsonObject.images[e]=i))),t.getChildren().forEach(this.serializeData,this)},serializePropertyJson:function(t,e,i,n){var s=this.settings.getPropertyType(e);!s||(t=o.getValue(t,e,s))!==(i=o.getValue(i,e,s))&&this.serializeValue(e,t,i,s,n.p)},serializeStyleJson:function(t,e,i,n){var o=this.settings.getStyleType(e);o&&(t=t.getStyle(e),i=i.getStyle(e),this.serializeValue(e,t,i,o,n.s))},serializeClientJson:function(t,e,i,n){var o=this.settings.getClientType(e);null==o||(t=t.getClient(e))!=(i=i.getClient(e))&&this.serializeValue(e,t,i,o,n.c)},serializeValue:function(t,e,i,n,o){null==e?o[t]=null:e instanceof at?o[t]=e._as:"data"===n?null!=(n=this.refMap[e.getId()])&&(o[t]=n):o[t]=e},deserialize:function(t,e){o.isDeserializing=!0,this.jsonObject=JSON.parse(t);var i=this.jsonObject.images;this.settings.isImageSerializable&&i&&Object.keys(i).forEach(function(t){o.registerImage(t,i[t])}),this.refMap={},this.idMap={};for(var n,s=new at,r=new at,a=this.jsonObject.datas.length,h=0;h<a;h++){var l=this.jsonObject.datas[h],c=l.class;if(this.settings.getPropertyType("id")&&null!=l.id){if("remove"===l.action){this.dataBox.removeById(l.id);continue}n=(n=this.dataBox.getDataById(l.id))||o.newInstance(c,l.id)}else n=o.newInstance(c);null!=l.ref&&(this.refMap[l.ref]=n),s.add(n),r.add(l),this.idMap[n.getId()]=n}for(this.dataBox.forEach(function(t){this.idMap[t.getId()]=t},this),a=s.size(),h=0;h<a;h++)(n=s.get(h)).deserializeJson(this,r.get(h));for(h=0;h<a;h++)n=s.get(h),this.dataBox.containsById(n.getId())||(e&&!n.getParent()&&n.setParent(e),this.dataBox.add(n));this.settings.isDataBoxSerializable&&this.jsonObject.dataBox&&this.dataBox.deserializeJson(this,this.jsonObject.dataBox),o.isDeserializing=!1},deserializePropertyJson:function(t,e,i){var n=this.settings.getPropertyType(i);n&&o.setValue(t,i,this.deserializeValue(e,n))},deserializeStyleJson:function(t,e,i){var n=this.settings.getStyleType(i);n&&t.setStyle(i,this.deserializeValue(e,n))},deserializeClientJson:function(t,e,i){var n=this.settings.getClientType(i);n&&t.setClient(i,this.deserializeValue(e,n))},deserializeValue:function(t,e){return"data"!==e?"array.number"!==e&&t instanceof Array?new at(t):t:(e=this.refMap[t])||this.idMap[t]}}),o.addMethod(n.Data,{serializeJson:function(t,e,i){if(t.settings.isClientSerializable&&this._clientMap)for(var n in this._clientMap)this.serializeClientJson(t,n,e,i);this.serializePropertyJson(t,"name",e,i),this.serializePropertyJson(t,"icon",e,i),this.serializePropertyJson(t,"toolTip",e,i),this.serializePropertyJson(t,"parent",e,i)},serializePropertyJson:function(t,e,i,n){t.serializePropertyJson(this,e,i,n)},serializeClientJson:function(t,e,i,n){t.serializeClientJson(this,e,i,n)},deserializeJson:function(t,e){for(var i in e.p)this.deserializePropertyJson(t,e.p[i],i);if(t.settings.isClientSerializable)for(i in e.c)this.deserializeClientJson(t,e.c[i],i)},deserializePropertyJson:function(t,e,i){t.deserializePropertyJson(this,e,i)},deserializeClientJson:function(t,e,i){t.deserializeClientJson(this,e,i)}}),o.addMethod(n.Element,{serializeJson:function(t,e,i){if(t.settings.isStyleSerializable&&this._styleMap)for(var s in this._styleMap)this.serializeStyleJson(t,s,e,i);var r;n.Element.superClass.serializeJson.call(this,t,e,i),this.serializePropertyJson(t,"layerId",e,i),this._alarmState.getHighestNativeAlarmSeverity()&&"alarmstate"===t.settings.getPropertyType("alarmState")&&(i.p.alarmState=r={n:{},a:{}},n.AlarmSeverity.forEach(function(t){var e=this.getNewAlarmCount(t);0<e&&(r.n[t.name]=e)},this._alarmState),n.AlarmSeverity.forEach(function(t){var e=this.getAcknowledgedAlarmCount(t);0<e&&(r.a[t.name]=e)},this._alarmState),o.isEmptyObject(r.n)&&delete r.n,o.isEmptyObject(r.a)&&delete r.a,o.isEmptyObject(r)&&delete i.p.alarmState)},serializeStyleJson:function(t,e,i,n){t.serializeStyleJson(this,e,i,n)},deserializeJson:function(t,e){if(n.Element.superClass.deserializeJson.call(this,t,e),t.settings.isStyleSerializable)for(var i in e.s)this.deserializeStyleJson(t,e.s[i],i)},deserializeStyleJson:function(t,e,i){t.deserializeStyleJson(this,e,i)},deserializePropertyJson:function(t,e,i){if("alarmState"===i){if("alarmstate"===t.settings.getPropertyType("alarmState")){for(var o in e.n)this._alarmState.setNewAlarmCount(n.AlarmSeverity.getByName(o),e.n[o]);for(o in e.a)this._alarmState.setAcknowledgedAlarmCount(n.AlarmSeverity.getByName(o),e.a[o])}}else n.Element.superClass.deserializePropertyJson.call(this,t,e,i)}}),o.addMethod(be,{serializeJson:function(t,e,i){be.superClass.serializeJson.call(this,t,e,i),this.serializePropertyJson(t,"image",e,i),this.serializePropertyJson(t,"location",e,i),o.num(this._width)&&0<=this._width&&this.serializePropertyJson(t,"width",e,i),o.num(this._height)&&0<=this._height&&this.serializePropertyJson(t,"height",e,i)}}),o.addMethod(n.Link,{serializeJson:function(t,e,i){n.Link.superClass.serializeJson.call(this,t,e,i),this.serializePropertyJson(t,"fromNode",e,i),this.serializePropertyJson(t,"toNode",e,i)}}),o.addMethod(n.Follower,{serializeJson:function(t,e,i){n.Follower.superClass.serializeJson.call(this,t,e,i),this.serializePropertyJson(t,"host",e,i)}}),o.addMethod(Le,{serializeJson:function(t,e,i){Le.superClass.serializeJson.call(this,t,e,i),this.serializePropertyJson(t,"expanded",e,i)}}),o.addMethod(n.ShapeNode,{serializeJson:function(t,e,i){n.ShapeNode.superClass.serializeJson.call(this,t,e,i),this.serializePropertyJson(t,"points",e,i),this.serializePropertyJson(t,"segments",e,i)}}),o.addMethod(n.ShapeLink,{serializeJson:function(t,e,i){n.ShapeLink.superClass.serializeJson.call(this,t,e,i),this.serializePropertyJson(t,"points",e,i)}}),o.addMethod(n.RotatableNode,{serializeJson:function(t,e,i){n.RotatableNode.superClass.serializeJson.call(this,t,e,i),this.serializePropertyJson(t,"angle",e,i)}}),o.addMethod(n.DataBox,{serializeJson:function(t,e,i){if(t.settings.isClientSerializable&&this._clientMap)for(var n in this._clientMap)this.serializeClientJson(t,n,e,i);this.serializePropertyJson(t,"name",e,i),this.serializePropertyJson(t,"icon",e,i),this.serializePropertyJson(t,"toolTip",e,i)},serializePropertyJson:function(t,e,i,n){t.serializePropertyJson(this,e,i,n)},serializeClientJson:function(t,e,i,n){t.serializeClientJson(this,e,i,n)},deserializeJson:function(t,e){for(var i in e.p)this.deserializePropertyJson(t,e.p[i],i);if(t.settings.isClientSerializable)for(i in e.c)this.deserializeClientJson(t,e.c[i],i)},deserializePropertyJson:function(t,e,i){t.deserializePropertyJson(this,e,i)},deserializeClientJson:function(t,e,i){t.deserializeClientJson(this,e,i)}}),o.addMethod(n.ElementBox,{serializeJson:function(t,e,i){if(t.settings.isLayerBoxSerializable&&(i.layers=[],this._layerBox.forEachByDepthFirst(function(t){var e={};i.layers.push(e),this._layerBox.getDefaultLayer()!==t&&(e.id=t.getId()),t.getName()&&(e.name=t.getName()),e.visible=t.isVisible(),e.editable=t.isEditable(),e.movable=t.isMovable()},null,this)),t.settings.isStyleSerializable&&this._styleMap)for(var o in this._styleMap)this.serializeStyleJson(t,o,e,i);n.ElementBox.superClass.serializeJson.call(this,t,e,i)},serializeStyleJson:function(t,e,i,n){t.serializeStyleJson(this,e,i,n)},deserializeStyleJson:function(t,e,i){t.deserializeStyleJson(this,e,i)},deserializeJson:function(t,e){if(n.ElementBox.superClass.deserializeJson.call(this,t,e),t.settings.isLayerBoxSerializable&&e.layers&&e.layers)for(var i=e.layers.length,o=0;o<i;o++){var s,r=e.layers[o];null!=r.id?(s=new n.Layer(r.id),this._layerBox.getDataById(s.getId())?s=this._layerBox.getDataById(s.getId()):this._layerBox.add(s)):(s=this._layerBox.getDefaultLayer(),this._layerBox.moveToBottom(s)),r.name&&s.setName(r.name),null!=r.visible&&s.setVisible(r.visible),null!=r.editable&&s.setEditable(r.editable),null!=r.movable&&s.setMovable(r.movable)}if(t.settings.isStyleSerializable)for(var a in e.s)this.deserializeStyleJson(t,e.s[a],a)}}),n.algorithm={},n.algorithm.math={},n.algorithm.PolyBool={},n.algorithm.Intersection={},n.algorithm.math.Vec2=function(t,e){this.x=t||0,this.y=e||0},n.algorithm.math.Vec2.prototype={constructor:n.algorithm.math.Vec2,set:function(t,e){return this.x=t,this.y=e,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t){return this.x+=t.x,this.y+=t.y,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScalar:function(t){return this.x+=t,this.y+=t,this},sub:function(t){return this.x-=t.x,this.y-=t.y,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},divideScalar:function(t){return 0!==t?(this.x/=t,this.y/=t):this.set(0,0),this},min:function(t){return this.x>t.x&&(this.x=t.x),this.y>t.y&&(this.y=t.y),this},max:function(t){return this.x<t.x&&(this.x=t.x),this.y<t.y&&(this.y=t.y),this},clamp:function(t,e){return this.x<t.x?this.x=t.x:this.x>e.x&&(this.x=e.x),this.y<t.y?this.y=t.y:this.y>e.y&&(this.y=e.y),this},negate:function(){return this.multiplyScalar(-1)},dot:function(t){return this.x*t.x+this.y*t.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x;return e*e+(t=this.y-t.y)*t},setLength:function(t){var e=this.length();return 0!==e&&t!==e&&this.multiplyScalar(t/e),this},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},equals:function(t){return null!=t&&t.x===this.x&&t.y===this.y},clone:function(){return new n.algorithm.math.Vec2(this.x,this.y)}},(Re=Re||{}).BuildLog=function(){var t,e=0,i=!1;function n(e,i){return t.list.push({type:e,data:i?JSON.parse(JSON.stringify(i)):void 0}),t}return t={list:[],segmentId:function(){return e++},checkIntersection:function(t,e){return n("check",{seg1:t,seg2:e})},segmentChop:function(t,e){return n("div_seg",{seg:t,pt:e}),n("chop",{seg:t,pt:e})},statusRemove:function(t){return n("pop_seg",{seg:t})},segmentUpdate:function(t){return n("seg_update",{seg:t})},segmentNew:function(t,e){return n("new_seg",{seg:t,primary:e})},segmentRemove:function(t){return n("rem_seg",{seg:t})},tempStatus:function(t,e,i){return n("temp_status",{seg:t,above:e,below:i})},rewind:function(t){return n("rewind",{seg:t})},status:function(t,e,i){return n("status",{seg:t,above:e,below:i})},vert:function(e){return e===i?t:n("vert",{x:i=e})},log:function(t){return n("log",{txt:t="string"!=typeof t?JSON.stringify(t,!1,"  "):t})},reset:function(){return n("reset")},selected:function(t){return n("selected",{segs:t})},chainStart:function(t){return n("chain_start",{seg:t})},chainRemoveHead:function(t,e){return n("chain_rem_head",{index:t,pt:e})},chainRemoveTail:function(t,e){return n("chain_rem_tail",{index:t,pt:e})},chainNew:function(t,e){return n("chain_new",{pt1:t,pt2:e})},chainMatch:function(t){return n("chain_match",{index:t})},chainClose:function(t){return n("chain_close",{index:t})},chainAddHead:function(t,e){return n("chain_add_head",{index:t,pt:e})},chainAddTail:function(t,e){return n("chain_add_tail",{index:t,pt:e})},chainConnect:function(t,e){return n("chain_con",{index1:t,index2:e})},chainReverse:function(t){return n("chain_rev",{index:t})},chainJoin:function(t,e){return n("chain_join",{index1:t,index2:e})},done:function(){return n("done")}}},Re.Epsilon=function(t){"number"!=typeof t&&(t=1e-10);var e={epsilon:function(e){return t="number"==typeof e?e:t},pointAboveOrOnLine:function(e,i,n){var o=i[0],s=i[1],r=n[0];i=n[1],n=e[0],e=e[1];return-t<=(r-o)*(e-s)-(i-s)*(n-o)},pointBetween:function(e,i,n){var o=e[1]-i[1],s=n[0]-i[0];return!((o=(e=e[0]-i[0])*s+o*(i=n[1]-i[1]))<t||-t<o-(s*s+i*i))},pointsSameX:function(e,i){return Math.abs(e[0]-i[0])<t},pointsSameY:function(e,i){return Math.abs(e[1]-i[1])<t},pointsSame:function(t,i){return e.pointsSameX(t,i)&&e.pointsSameY(t,i)},pointsCompare:function(t,i){return e.pointsSameX(t,i)?e.pointsSameY(t,i)?0:t[1]<i[1]?-1:1:t[0]<i[0]?-1:1},pointsCollinear:function(e,i,n){var o=e[0]-i[0],s=e[1]-i[1];e=i[0]-n[0],n=i[1]-n[1];return Math.abs(o*n-e*s)<t},linesIntersect:function(e,i,n,o){var s=i[0]-e[0],r=i[1]-e[1],a=o[0]-n[0],h=o[1]-n[1];i=s*h-r*a;return!(Math.abs(i)<t)&&(o=e[0]-n[0],h=(a*(n=e[1]-n[1])-h*o)/i,i=(s*n-r*o)/i,(r={alongA:0,alongB:0,pt:[e[0]+h*s,e[1]+h*r]}).alongA=h<=-t?-2:h<t?-1:h-1<=-t?0:h-1<t?1:2,r.alongB=i<=-t?-2:i<t?-1:i-1<=-t?0:i-1<t?1:2,r)},pointInsideRegion:function(e,i){for(var n=e[0],o=e[1],s=i[i.length-1][0],r=i[i.length-1][1],a=!1,h=0;h<i.length;h++){var l=i[h][0],c=i[h][1];t<c-o!=t<r-o&&t<(s-l)*(o-c)/(r-c)+l-n&&(a=!a),s=l,r=c}return a}};return e},Re.GeoJSON={toPolygon:function(t,e){function i(e){if(e.length<=0)return t.segments({inverted:!1,regions:[]});function i(e){return e=e.slice(0,e.length-1),t.segments({inverted:!1,regions:[e]})}for(var n=i(e[0]),o=1;o<e.length;o++)n=t.selectDifference(t.combine(n,i(e[o])));return n}if("Polygon"===e.type)return t.polygon(i(e.coordinates));if("MultiPolygon"!==e.type)throw new Error("PolyBool: Cannot convert GeoJSON object to PolyBool polygon");for(var n=t.segments({inverted:!1,regions:[]}),o=0;o<e.coordinates.length;o++)n=t.selectUnion(t.combine(n,i(e.coordinates[o])));return t.polygon(n)},fromPolygon:function(t,e,i){function n(t,i){return e.pointInsideRegion([.5*(t[0][0]+t[1][0]),.5*(t[0][1]+t[1][1])],i)}function o(t){return{region:t,children:[]}}i=t.polygon(t.segments(i));for(var s=o(null),r=0;r<i.regions.length;r++){var a=i.regions[r];a.length<3||function t(e,i){for(var s=0;s<e.children.length;s++)if(n(i,(r=e.children[s]).region))return void t(r,i);var r,a=o(i);for(s=0;s<e.children.length;s++)n((r=e.children[s]).region,i)&&(a.children.push(r),e.children.splice(s,1),s--);e.children.push(a)}(s,a)}function h(t,e){for(var i=0,n=t[t.length-1][0],o=t[t.length-1][1],s=[],r=0;r<t.length;r++){var a=t[r][0],h=t[r][1];s.push([a,h]),i+=h*n-a*o,n=a,o=h}return i<0!==e&&s.reverse(),s.push([s[0][0],s[0][1]]),s}var l=[];function c(t){var e=[h(t.region,!1)];l.push(e);for(var i=0;i<t.children.length;i++)e.push(function(t){for(var e=0;e<t.children.length;e++)c(t.children[e]);return h(t.region,!0)}(t.children[i]))}for(r=0;r<s.children.length;r++)c(s.children[r]);return l.length<=0?{type:"Polygon",coordinates:[]}:1==l.length?{type:"Polygon",coordinates:l[0]}:{type:"MultiPolygon",coordinates:l}}},Re.LinkedList={create:function(){var t={root:{root:!0,next:null},exists:function(e){return null!==e&&e!==t.root},isEmpty:function(){return null===t.root.next},getHead:function(){return t.root.next},insertBefore:function(e,i){for(var n=t.root,o=t.root.next;null!==o;){if(i(o))return e.prev=o.prev,(e.next=o).prev.next=e,void(o.prev=e);o=(n=o).next}(n.next=e).prev=n,e.next=null},findTransition:function(e){for(var i=t.root,n=t.root.next;null!==n&&!e(n);)n=(i=n).next;return{before:i===t.root?null:i,after:n,insert:function(t){return t.prev=i,t.next=n,i.next=t,null!==n&&(n.prev=t),t}}}};return t},node:function(t){return t.prev=null,t.next=null,t.remove=function(){t.prev.next=t.next,t.next&&(t.next.prev=t.prev),t.prev=null,t.next=null},t}};var Re,De=Re.LinkedList;function Be(t,e,i){var n=[];return t.forEach(function(t){var o=(t.myFill.above?8:0)+(t.myFill.below?4:0)+(t.otherFill&&t.otherFill.above?2:0)+(t.otherFill&&t.otherFill.below?1:0);0!==e[o]&&n.push({id:i?i.segmentId():-1,start:t.start,end:t.end,myFill:{above:1===e[o],below:2===e[o]},otherFill:null})}),i&&i.selected(n),n}Re.Intersecter=function(t,e,i){function n(t,e,n){return{id:i?i.segmentId():-1,start:t,end:e,myFill:{above:n.myFill.above,below:n.myFill.below},otherFill:null}}var o=De.create();function s(t,i){o.insertBefore(t,function(n){var o,s,r,a,h;return o=t.isStart,s=t.pt,r=i,a=n.isStart,h=n.pt,n=n.other.pt,(0!==(s=e.pointsCompare(s,h))?s:e.pointsSame(r,n)?0:o!==a?o?1:-1:e.pointAboveOrOnLine(r,a?h:n,a?n:h)?1:-1)<0})}function r(t,e){var i,n=(n=t,i=e,s(i=De.node({isStart:!0,pt:n.start,seg:n,primary:i,other:null,status:null}),n.end),i);return i=n,e=e,e=De.node({isStart:!1,pt:t.end,seg:t,primary:e,other:i,status:null}),s(i.other=e,i.pt),n}function a(t,e){var o,a=n(e,t.seg.end,t.seg);return o=t,e=e,i&&i.segmentChop(o.seg,e),o.other.remove(),o.seg.end=e,o.other.pt=e,s(o.other,o.pt),r(a,t.primary)}function h(n,s){var r=De.create();function h(t){return r.findTransition(function(i){var n,o,s;return 0<(n=t,o=i.ev,s=n.seg.start,i=n.seg.end,n=o.seg.start,o=o.seg.end,e.pointsCollinear(s,n,o)?e.pointsCollinear(i,n,o)||e.pointAboveOrOnLine(i,n,o)?1:-1:e.pointAboveOrOnLine(s,n,o)?1:-1)})}function l(t,n){var o=t.seg,s=n.seg,r=o.start,h=o.end,l=s.start,c=s.end;i&&i.checkIntersection(o,s);var d=e.linesIntersect(r,h,l,c);if(!1===d){if(!e.pointsCollinear(r,h,l))return!1;if(e.pointsSame(r,c)||e.pointsSame(h,l))return!1;var u=e.pointsSame(r,l),g=e.pointsSame(h,c);if(u&&g)return n;if(o=!u&&e.pointBetween(r,l,c),s=!g&&e.pointBetween(h,l,c),u)return s?a(n,h):a(t,c),n;o&&(g||(s?a(n,h):a(t,c)),a(n,r))}else 0===d.alongA&&(-1===d.alongB?a(t,l):0===d.alongB?a(t,d.pt):1===d.alongB&&a(t,c)),0===d.alongB&&(-1===d.alongA?a(n,r):0===d.alongA?a(n,d.pt):1===d.alongA&&a(n,h));return!1}for(var c=[];!o.isEmpty();){var d=o.getHead();if(i&&i.vert(d.pt[0]),d.isStart){i&&i.segmentNew(d.seg,d.primary);var u=h(d),g=u.before?u.before.ev:null,_=u.after?u.after.ev:null;i&&i.tempStatus(d.seg,!!g&&g.seg,!!_&&_.seg);var f,A=function(){if(g){var t=l(d,g);if(t)return t}return!!_&&l(d,_)}();if(A&&(t?(f=null===d.seg.myFill.below||d.seg.myFill.above!==d.seg.myFill.below)&&(A.seg.myFill.above=!A.seg.myFill.above):A.seg.otherFill=d.seg.myFill,i&&i.segmentUpdate(A.seg),d.other.remove(),d.remove()),o.getHead()!==d){i&&i.rewind(d.seg);continue}t?(f=null===d.seg.myFill.below||d.seg.myFill.above!==d.seg.myFill.below,d.seg.myFill.below=_?_.seg.myFill.above:n,d.seg.myFill.above=f?!d.seg.myFill.below:d.seg.myFill.below):null===d.seg.otherFill&&(A=_?(d.primary===_.primary?_.seg.otherFill:_.seg.myFill).above:d.primary?s:n,d.seg.otherFill={above:A,below:A}),i&&i.status(d.seg,!!g&&g.seg,!!_&&_.seg),d.other.status=u.insert(De.node({ev:d}))}else{if(null===(u=d.status))throw new Error("PolyBool: Zero-length segment detected; your epsilon is probably too small or too large");r.exists(u.prev)&&r.exists(u.next)&&l(u.prev.ev,u.next.ev),i&&i.statusRemove(u.ev.seg),u.remove(),d.primary||(u=d.seg.myFill,d.seg.myFill=d.seg.otherFill,d.seg.otherFill=u),c.push(d.seg)}o.getHead().remove()}return i&&i.done(),c}return t?{addRegion:function(t){for(var n,o=t[t.length-1],s=0;s<t.length;s++){var a=o,h=(o=t[s],e.pointsCompare(a,o));0!==h&&r((n=h<0?a:o,a=h<0?o:a,{id:i?i.segmentId():-1,start:n,end:a,myFill:{above:null,below:null},otherFill:null}),!0)}},calculate:function(t){return h(t,!1)}}:{calculate:function(t,e,i,o){return t.forEach(function(t){r(n(t.start,t.end,t),!0)}),i.forEach(function(t){r(n(t.start,t.end,t),!1)}),h(e,o)}}},Re.SegmentChainer=function(t,e,i){var n=[],o=[];return t.forEach(function(t){var s=t.start,r=t.end;if(e.pointsSame(s,r))console.warn("PolyBool: Warning: Zero-length segment detected; your epsilon is probably too small or too large");else{i&&i.chainStart(t);for(var a={index:0,matches_head:!1,matches_pt1:!1},h={index:0,matches_head:!1,matches_pt1:!1},l=a,c=0;c<n.length;c++){var d=(A=n[c])[0],u=(A[1],A[A.length-1]);if(A[A.length-2],e.pointsSame(d,s)){if(v(c,!0,!0))break}else if(e.pointsSame(d,r)){if(v(c,!0,!1))break}else if(e.pointsSame(u,s)){if(v(c,!1,!0))break}else if(e.pointsSame(u,r)&&v(c,!1,!1))break}if(l===a)return n.push([s,r]),void(i&&i.chainNew(s,r));if(l===h){i&&i.chainMatch(a.index);var g=a.index,_=a.matches_pt1?r:s,f=a.matches_head,A=n[g],y=f?A[0]:A[A.length-1],p=f?A[1]:A[A.length-2],m=f?A[A.length-1]:A[0];t=f?A[A.length-2]:A[1];return e.pointsCollinear(p,y,_)&&(f?(i&&i.chainRemoveHead(a.index,_),A.shift()):(i&&i.chainRemoveTail(a.index,_),A.pop()),y=p),e.pointsSame(m,_)?(n.splice(g,1),e.pointsCollinear(t,m,y)&&(f?(i&&i.chainRemoveTail(a.index,y),A.pop()):(i&&i.chainRemoveHead(a.index,y),A.shift())),i&&i.chainClose(a.index),void o.push(A)):void(f?(i&&i.chainAddHead(a.index,_),A.unshift(_)):(i&&i.chainAddTail(a.index,_),A.push(_)))}y=a.index,f=h.index,i&&i.chainConnect(y,f),_=n[y].length<n[f].length,a.matches_head?h.matches_head?_?(x(y),w(y,f)):(x(f),w(f,y)):w(f,y):h.matches_head?w(y,f):_?(x(y),w(f,y)):(x(f),w(y,f))}function v(t,e,i){if(l.index=t,l.matches_head=e,l.matches_pt1=i,l!==a)return l=null,1;l=h}function x(t){i&&i.chainReverse(t),n[t].reverse()}function w(t,o){var s=n[t],r=n[o],a=s[s.length-1],h=s[s.length-2],l=r[0],c=r[1];e.pointsCollinear(h,a,l)&&(i&&i.chainRemoveTail(t,a),s.pop(),a=h),e.pointsCollinear(a,l,c)&&(i&&i.chainRemoveHead(o,l),r.shift()),i&&i.chainJoin(t,o),n[t]=s.concat(r),n.splice(o,1)}}),o},Re.SegmentSelector={union:function(t,e){return Be(t,[0,2,1,0,2,2,0,0,1,0,1,0,0,0,0,0],e)},intersect:function(t,e){return Be(t,[0,0,0,0,0,2,0,2,0,0,1,1,0,2,1,0],e)},difference:function(t,e){return Be(t,[0,0,0,0,2,0,2,0,1,1,0,0,0,1,2,0],e)},differenceRev:function(t,e){return Be(t,[0,2,1,0,0,0,1,1,0,2,0,2,0,0,0,0],e)},xor:function(t,e){return Be(t,[0,2,1,0,2,0,0,1,1,0,0,2,0,1,2,0],e)}};var Me=(Re=Re||{}).BuildLog,Oe=(h=Re.Epsilon,Re.Intersecter),Ne=Re.SegmentChainer,Fe=Re.SegmentSelector,ze=Re.GeoJSON,Ve=!1,Ue=h();function He(t,e,i){return t=PolyBool.segments(t),e=PolyBool.segments(e),e=i(PolyBool.combine(t,e)),PolyBool.polygon(e)}function Ze(t){0<arguments.length&&this.init(t)}n.algorithm.PolyBool={buildLog:function(t){return!0===t?Ve=Me():!1===t&&(Ve=!1),!1!==Ve&&Ve.list},epsilon:function(t){return Ue.epsilon(t)},segments:function(t){var e=Oe(!0,Ue,Ve);return t.regions.forEach(e.addRegion),{segments:e.calculate(t.inverted),inverted:t.inverted}},combine:function(t,e){return{combined:Oe(!1,Ue,Ve).calculate(t.segments,t.inverted,e.segments,e.inverted),inverted1:t.inverted,inverted2:e.inverted}},selectUnion:function(t){return{segments:Fe.union(t.combined,Ve),inverted:t.inverted1||t.inverted2}},selectIntersect:function(t){return{segments:Fe.intersect(t.combined,Ve),inverted:t.inverted1&&t.inverted2}},selectDifference:function(t){return{segments:Fe.difference(t.combined,Ve),inverted:t.inverted1&&!t.inverted2}},selectDifferenceRev:function(t){return{segments:Fe.differenceRev(t.combined,Ve),inverted:!t.inverted1&&t.inverted2}},selectXor:function(t){return{segments:Fe.xor(t.combined,Ve),inverted:t.inverted1!==t.inverted2}},polygon:function(t){return{regions:Ne(t.segments,Ue,Ve),inverted:t.inverted}},polygonFromGeoJSON:function(t){return ze.toPolygon(PolyBool,t)},polygonToGeoJSON:function(t){return ze.fromPolygon(PolyBool,Ue,t)},union:function(t,e){return He(t,e,PolyBool.selectUnion)},intersect:function(t,e){return He(t,e,PolyBool.selectIntersect)},difference:function(t,e){return He(t,e,PolyBool.selectDifference)},differenceRev:function(t,e){return He(t,e,PolyBool.selectDifferenceRev)},xor:function(t,e){return He(t,e,PolyBool.selectXor)}},$Vec2=n.algorithm.math.Vec2,Ze.prototype.init=function(t){this.status=t,this.points=new Array},Ze.prototype.appendPoint=function(t){this.points.push(t)},Ze.prototype.appendPoints=function(t){this.points=this.points.concat(t)},Ze.intersectShapes=function(t,e){var i,n=t.getIntersectionParams(),o=e.getIntersectionParams();if(null!=n&&null!=o)if("Path"==n.name)i=Ze.intersectPathShape(t,e);else if("Path"==o.name)i=Ze.intersectPathShape(e,t);else{var s;n=n.name<o.name?(s="intersect"+n.name+o.name,n.params.concat(o.params)):(s="intersect"+o.name+n.name,o.params.concat(n.params));if(!(s in Ze))throw new Error("Intersection not available: "+s);i=Ze[s].apply(null,n)}else i=new Ze("No Intersection");return i},Ze.intersectPathShape=function(t,e){return t.intersectShape(e)},Ze.intersectBezier2Bezier2=function(t,e,i,n,o,s){var r,a,h,l,c,d,u,g=new Ze("No Intersection"),_=e.multiply(-2),f=t.add(_.add(i));_=t.multiply(-2),e=e.multiply(2),r=_.add(e),a=new $Vec2(t.x,t.y),_=o.multiply(-2),h=n.add(_.add(s)),_=n.multiply(-2);e=o.multiply(2);for(var A=_.add(e),y=new $Vec2(n.x,n.y),p=(0==f.y?(u=(l=f.x*(a.y-y.y))+(c=l-r.x*r.y),d=r.y*r.y,new Polynomial(f.x*h.y*h.y,2*f.x*A.y*h.y,f.x*A.y*A.y-h.x*d-h.y*l-h.y*c,-A.x*d-A.y*l-A.y*c,(a.x-y.x)*d+(a.y-y.y)*c)):(l=f.x*h.y-f.y*h.x,c=f.x*A.y-A.x*f.y,u=r.x*f.y-r.y*f.x,d=a.y-y.y,e=f.y*(a.x-y.x)-f.x*d,n=-r.y*u+f.y*e,u*=u,new Polynomial(l*l,2*l*c,(-h.y*u+f.y*c*c+f.y*l*e+l*n)/f.y,(-A.y*u+f.y*c*e+c*n)/f.y,(d*u+e*n)/f.y))).getRoots(),m=0;m<p.length;m++){var v=p[m];if(0<=v&&v<=1){var x=new Polynomial(f.x,r.x,a.x-y.x-v*A.x-v*v*h.x).getRoots(),w=new Polynomial(f.y,r.y,a.y-y.y-v*A.y-v*v*h.y).getRoots();if(0<x.length&&0<w.length)t:for(var E=0;E<x.length;E++){var C=x[E];if(0<=C&&C<=1)for(var T=0;T<w.length;T++)if(Math.abs(C-w[T])<1e-4){g.points.push(h.multiply(v*v).add(A.multiply(v).add(y)));break t}}}}return 0<g.points.length&&(g.status="$Intersection"),g},Ze.intersectBezier2Bezier3=function(t,e,i,n,o,s,r){var a,h,l,c,d=new Ze("No Intersection"),u=e.multiply(-2),g=t.add(u.add(i));u=t.multiply(-2),_=e.multiply(2),a=u.add(_),h=new $Vec2(t.x,t.y),u=n.multiply(-1),_=o.multiply(3),f=s.multiply(-3),x=u.add(_.add(f.add(r))),l=new Vector2D(x.x,x.y),u=n.multiply(3),_=o.multiply(-6),f=s.multiply(3),x=u.add(_.add(f)),c=new Vector2D(x.x,x.y),u=n.multiply(-3);for(var _=o.multiply(3),f=u.add(_),A=new Vector2D(f.x,f.y),y=new Vector2D(n.x,n.y),p=h.x*h.x,m=h.y*h.y,v=a.x*a.x,x=(i=a.y*a.y,e=g.x*g.x,t=g.y*g.y,r=y.x*y.x,s=y.y*y.y,A.x*A.x),w=(o=A.y*A.y,u=c.x*c.x,_=c.y*c.y,f=l.x*l.x,n=l.y*l.y,new Polynomial(-2*g.x*g.y*l.x*l.y+e*n+t*f,-2*g.x*g.y*c.x*l.y-2*g.x*g.y*c.y*l.x+2*t*c.x*l.x+2*e*c.y*l.y,-2*g.x*A.x*g.y*l.y-2*g.x*g.y*A.y*l.x-2*g.x*g.y*c.x*c.y+2*A.x*t*l.x+t*u+e*(2*A.y*l.y+_),2*h.x*g.x*g.y*l.y+2*h.y*g.x*g.y*l.x+a.x*a.y*g.x*l.y+a.x*a.y*g.y*l.x-2*y.x*g.x*g.y*l.y-2*g.x*y.y*g.y*l.x-2*g.x*A.x*g.y*c.y-2*g.x*g.y*A.y*c.x-2*h.x*t*l.x-2*h.y*e*l.y+2*y.x*t*l.x+2*A.x*t*c.x-i*g.x*l.x-v*g.y*l.y+e*(2*y.y*l.y+2*A.y*c.y),2*h.x*g.x*g.y*c.y+2*h.y*g.x*g.y*c.x+a.x*a.y*g.x*c.y+a.x*a.y*g.y*c.x-2*y.x*g.x*g.y*c.y-2*g.x*y.y*g.y*c.x-2*g.x*A.x*g.y*A.y-2*h.x*t*c.x-2*h.y*e*c.y+2*y.x*t*c.x-i*g.x*c.x-v*g.y*c.y+x*t+e*(2*y.y*c.y+o),2*h.x*g.x*g.y*A.y+2*h.y*g.x*A.x*g.y+a.x*a.y*g.x*A.y+a.x*a.y*A.x*g.y-2*y.x*g.x*g.y*A.y-2*g.x*y.y*A.x*g.y-2*h.x*A.x*t-2*h.y*e*A.y+2*y.x*A.x*t-i*g.x*A.x-v*g.y*A.y+2*e*y.y*A.y,-2*h.x*h.y*g.x*g.y-h.x*a.x*a.y*g.y-h.y*a.x*a.y*g.x+2*h.x*g.x*y.y*g.y+2*h.y*y.x*g.x*g.y+a.x*y.x*a.y*g.y+a.x*a.y*g.x*y.y-2*y.x*g.x*y.y*g.y-2*h.x*y.x*t+h.x*i*g.x+h.y*v*g.y-2*h.y*e*y.y-y.x*i*g.x-v*y.y*g.y+p*t+m*e+r*t+e*s).getRootsInInterval(0,1)),E=0;E<w.length;E++){var C=w[E],T=new Polynomial(g.x,a.x,h.x-y.x-C*A.x-C*C*c.x-C*C*C*l.x).getRoots(),b=new Polynomial(g.y,a.y,h.y-y.y-C*A.y-C*C*c.y-C*C*C*l.y).getRoots();if(0<T.length&&0<b.length)t:for(var I=0;I<T.length;I++){var L=T[I];if(0<=L&&L<=1)for(var S=0;S<b.length;S++)if(Math.abs(L-b[S])<1e-4){d.points.push(l.multiply(C*C*C).add(c.multiply(C*C).add(A.multiply(C).add(y))));break t}}}return 0<d.points.length&&(d.status="Intersection"),d},Ze.intersectBezier2Circle=function(t,e,i,n,o){return Ze.intersectBezier2Ellipse(t,e,i,n,o,o)},Ze.intersectBezier2Ellipse=function(t,e,i,n,o,s){var r=new Ze("No Intersection"),a=e.multiply(-2),h=t.add(a.add(i));a=t.multiply(-2);e=e.multiply(2);for(var l=a.add(e),c=new $Vec2(t.x,t.y),d=(o=o*o,s=s*s,new Polynomial(s*h.x*h.x+o*h.y*h.y,2*(s*h.x*l.x+o*h.y*l.y),s*(2*h.x*c.x+l.x*l.x)+o*(2*h.y*c.y+l.y*l.y)-2*(s*n.x*h.x+o*n.y*h.y),2*(s*l.x*(c.x-n.x)+o*l.y*(c.y-n.y)),s*(c.x*c.x+n.x*n.x)+o*(c.y*c.y+n.y*n.y)-2*(s*n.x*c.x+o*n.y*c.y)-o*s).getRoots()),u=0;u<d.length;u++){var g=d[u];0<=g&&g<=1&&r.points.push(h.multiply(g*g).add(l.multiply(g).add(c)))}return 0<r.points.length&&(r.status="Intersection"),r},Ze.intersectBezier2Line=function(t,e,i,n,o){var s,r,a,h=n.min(o),l=n.max(o),c=new Ze("No Intersection"),d=e.multiply(-2),u=t.add(d.add(i));d=t.multiply(-2),a=e.multiply(2),s=d.add(a),r=new $Vec2(t.x,t.y),d=new Vector2D(n.y-o.y,o.x-n.x),a=n.x*o.y-o.x*n.y,roots=new Polynomial(d.dot(u),d.dot(s),d.dot(r)+a).getRoots();for(var g=0;g<roots.length;g++){var _,f,A=roots[g];0<=A&&A<=1&&(_=t.lerp(e,A),f=e.lerp(i,A),A=_.lerp(f,A),n.x==o.x?h.y<=A.y&&A.y<=l.y&&(c.status="Intersection",c.appendPoint(A)):n.y==o.y?h.x<=A.x&&A.x<=l.x&&(c.status="Intersection",c.appendPoint(A)):A.gte(h)&&A.lte(l)&&(c.status="Intersection",c.appendPoint(A)))}return c},Ze.intersectBezier2Polygon=function(t,e,i,n){for(var o=new Ze("No Intersection"),s=n.length,r=0;r<s;r++){var a=n[r],h=n[(r+1)%s];h=Ze.intersectBezier2Line(t,e,i,a,h);o.appendPoints(h.points)}return 0<o.points.length&&(o.status="Intersection"),o},Ze.intersectBezier2Rectangle=function(t,e,i,n,o){var s=n.min(o),r=n.max(o),a=new $Vec2(r.x,s.y);n=new $Vec2(s.x,r.y),o=Ze.intersectBezier2Line(t,e,i,s,a),a=Ze.intersectBezier2Line(t,e,i,a,r),r=Ze.intersectBezier2Line(t,e,i,r,n),n=Ze.intersectBezier2Line(t,e,i,n,s);return(s=new Ze("No Intersection")).appendPoints(o.points),s.appendPoints(a.points),s.appendPoints(r.points),s.appendPoints(n.points),0<s.points.length&&(s.status="Intersection"),s},Ze.intersectBezier3Bezier3=function(t,e,i,n,o,s,r,a){var h,l,c,d,u,g=new Ze("No Intersection"),_=t.multiply(-1),f=e.multiply(3),A=i.multiply(-3),y=_.add(f.add(A.add(n))),p=new Vector2D(y.x,y.y);_=t.multiply(3),f=e.multiply(-6),A=i.multiply(3),y=_.add(f.add(A)),h=new Vector2D(y.x,y.y),_=t.multiply(-3),f=e.multiply(3),A=_.add(f),l=new Vector2D(A.x,A.y),c=new Vector2D(t.x,t.y),_=o.multiply(-1),f=s.multiply(3),A=r.multiply(-3),y=_.add(f.add(A.add(a))),d=new Vector2D(y.x,y.y),_=o.multiply(3),f=s.multiply(-6),A=r.multiply(3),y=_.add(f.add(A)),u=new Vector2D(y.x,y.y),_=o.multiply(-3),f=s.multiply(3),A=_.add(f);for(var m=new Vector2D(A.x,A.y),v=new Vector2D(o.x,o.y),x=c.x*c.x,w=c.x*c.x*c.x,E=c.y*c.y,C=c.y*c.y*c.y,T=l.x*l.x,b=l.x*l.x*l.x,I=l.y*l.y,L=l.y*l.y*l.y,S=h.x*h.x,k=h.x*h.x*h.x,P=h.y*h.y,R=h.y*h.y*h.y,D=p.x*p.x,B=p.x*p.x*p.x,M=p.y*p.y,O=p.y*p.y*p.y,N=v.x*v.x,F=v.x*v.x*v.x,z=(n=v.y*v.y,i=v.y*v.y*v.y,e=m.x*m.x,t=m.x*m.x*m.x,a=m.y*m.y,r=u.x*u.x,y=u.x*u.x*u.x,s=u.y*u.y,_=d.x*d.x,f=d.x*d.x*d.x,A=d.y*d.y,o=d.y*d.y*d.y,new Polynomial(-B*o+O*f-3*p.x*M*_*d.y+3*D*p.y*d.x*A,-6*p.x*u.x*M*d.x*d.y+6*D*p.y*u.y*d.x*d.y+3*u.x*O*_-3*B*u.y*A-3*p.x*M*u.y*_+3*D*u.x*p.y*A,-6*m.x*p.x*M*d.x*d.y-6*p.x*u.x*M*u.y*d.x+6*D*u.x*p.y*u.y*d.y+3*m.x*O*_+3*r*O*d.x+3*m.x*D*p.y*A-3*p.x*m.y*M*_-3*p.x*r*M*d.y+D*p.y*d.x*(6*m.y*d.y+3*s)+B*(-m.y*A-2*s*d.y-d.y*(2*m.y*d.y+s)),l.x*h.y*p.x*p.y*d.x*d.y-l.y*h.x*p.x*p.y*d.x*d.y+6*m.x*u.x*O*d.x+3*l.x*h.x*p.x*p.y*A+6*c.x*p.x*M*d.x*d.y-3*l.x*h.x*M*d.x*d.y-3*l.y*h.y*p.x*p.y*_-6*c.y*D*p.y*d.x*d.y-6*v.x*p.x*M*d.x*d.y+3*l.y*h.y*D*d.x*d.y-2*h.x*P*p.x*d.x*d.y-6*m.x*p.x*u.x*M*d.y-6*m.x*p.x*M*u.y*d.x-6*p.x*m.y*u.x*M*d.x+6*m.x*D*p.y*u.y*d.y+2*S*h.y*p.y*d.x*d.y+y*O-3*c.x*O*_+3*c.y*B*A+3*v.x*O*_+R*p.x*_-k*p.y*A-3*c.x*D*p.y*A+3*c.y*p.x*M*_-2*l.x*h.y*D*A+l.x*h.y*M*_-l.y*h.x*D*A+2*l.y*h.x*M*_+3*v.x*D*p.y*A-h.x*P*p.y*_-3*v.y*p.x*M*_+S*h.y*p.x*A-3*p.x*r*M*u.y+D*p.y*d.x*(6*v.y*d.y+6*m.y*u.y)+D*u.x*p.y*(6*m.y*d.y+3*s)+B*(-2*m.y*u.y*d.y-v.y*A-u.y*(2*m.y*d.y+s)-d.y*(2*v.y*d.y+2*m.y*u.y)),6*l.x*h.x*p.x*p.y*u.y*d.y+l.x*h.y*p.x*u.x*p.y*d.y+l.x*h.y*p.x*p.y*u.y*d.x-l.y*h.x*p.x*u.x*p.y*d.y-l.y*h.x*p.x*p.y*u.y*d.x-6*l.y*h.y*p.x*u.x*p.y*d.x-6*c.x*u.x*O*d.x+6*v.x*u.x*O*d.x+6*c.y*B*u.y*d.y+2*R*p.x*u.x*d.x-2*k*p.y*u.y*d.y+6*c.x*p.x*u.x*M*d.y+6*c.x*p.x*M*u.y*d.x+6*c.y*p.x*u.x*M*d.x-3*l.x*h.x*u.x*M*d.y-3*l.x*h.x*M*u.y*d.x+2*l.x*h.y*u.x*M*d.x+4*l.y*h.x*u.x*M*d.x-6*c.x*D*p.y*u.y*d.y-6*c.y*D*u.x*p.y*d.y-6*c.y*D*p.y*u.y*d.x-4*l.x*h.y*D*u.y*d.y-6*v.x*p.x*u.x*M*d.y-6*v.x*p.x*M*u.y*d.x-2*l.y*h.x*D*u.y*d.y+3*l.y*h.y*D*u.x*d.y+3*l.y*h.y*D*u.y*d.x-2*h.x*P*p.x*u.x*d.y-2*h.x*P*p.x*u.y*d.x-2*h.x*P*u.x*p.y*d.x-6*v.y*p.x*u.x*M*d.x-6*m.x*p.x*m.y*M*d.x-6*m.x*p.x*u.x*M*u.y+6*v.x*D*p.y*u.y*d.y+2*S*h.y*p.x*u.y*d.y+2*S*h.y*u.x*p.y*d.y+2*S*h.y*p.y*u.y*d.x+3*m.x*r*O+3*e*O*d.x-3*p.x*m.y*r*M-3*e*p.x*M*d.y+D*u.x*p.y*(6*v.y*d.y+6*m.y*u.y)+D*p.y*d.x*(6*v.y*u.y+3*a)+m.x*D*p.y*(6*m.y*d.y+3*s)+B*(-2*v.y*u.y*d.y-d.y*(2*v.y*u.y+a)-m.y*(2*m.y*d.y+s)-u.y*(2*v.y*d.y+2*m.y*u.y)),l.x*m.x*h.y*p.x*p.y*d.y+l.x*h.y*p.x*m.y*p.y*d.x+l.x*h.y*p.x*u.x*p.y*u.y-l.y*h.x*m.x*p.x*p.y*d.y-l.y*h.x*p.x*m.y*p.y*d.x-l.y*h.x*p.x*u.x*p.y*u.y-6*l.y*m.x*h.y*p.x*p.y*d.x-6*c.x*m.x*O*d.x+6*v.x*m.x*O*d.x+2*m.x*R*p.x*d.x+6*c.x*m.x*p.x*M*d.y+6*c.x*p.x*m.y*M*d.x+6*c.x*p.x*u.x*M*u.y+6*c.y*m.x*p.x*M*d.x-3*l.x*h.x*m.x*M*d.y-3*l.x*h.x*m.y*M*d.x-3*l.x*h.x*u.x*M*u.y+2*l.x*m.x*h.y*M*d.x+4*l.y*h.x*m.x*M*d.x-6*c.y*m.x*D*p.y*d.y-6*c.y*D*m.y*p.y*d.x-6*c.y*D*u.x*p.y*u.y-6*v.x*m.x*p.x*M*d.y-6*v.x*p.x*m.y*M*d.x-6*v.x*p.x*u.x*M*u.y+3*l.y*m.x*h.y*D*d.y-3*l.y*h.y*p.x*r*p.y+3*l.y*h.y*D*m.y*d.x+3*l.y*h.y*D*u.x*u.y-2*h.x*m.x*P*p.x*d.y-2*h.x*m.x*P*p.y*d.x-2*h.x*P*p.x*m.y*d.x-2*h.x*P*p.x*u.x*u.y-6*v.y*m.x*p.x*M*d.x-6*m.x*p.x*m.y*u.x*M+6*v.y*D*m.y*p.y*d.x+2*S*m.x*h.y*p.y*d.y+2*S*h.y*m.y*p.y*d.x+2*S*h.y*u.x*p.y*u.y-3*c.x*r*O+3*v.x*r*O+3*e*u.x*O+R*p.x*r+3*c.y*p.x*r*M+l.x*h.y*r*M+2*l.y*h.x*r*M-h.x*P*r*p.y-3*v.y*p.x*r*M-3*e*p.x*M*u.y+S*h.y*p.x*(2*m.y*d.y+s)+l.x*h.x*p.x*p.y*(6*m.y*d.y+3*s)+m.x*D*p.y*(6*v.y*d.y+6*m.y*u.y)+k*p.y*(-2*m.y*d.y-s)+c.y*B*(6*m.y*d.y+3*s)+l.y*h.x*D*(-2*m.y*d.y-s)+l.x*h.y*D*(-4*m.y*d.y-2*s)+c.x*D*p.y*(-6*m.y*d.y-3*s)+D*u.x*p.y*(6*v.y*u.y+3*a)+v.x*D*p.y*(6*m.y*d.y+3*s)+B*(-2*v.y*m.y*d.y-u.y*(2*v.y*u.y+a)-v.y*(2*m.y*d.y+s)-m.y*(2*v.y*d.y+2*m.y*u.y)),-c.x*l.x*h.y*p.x*p.y*d.y+c.x*l.y*h.x*p.x*p.y*d.y+6*c.x*l.y*h.y*p.x*p.y*d.x-6*c.y*l.x*h.x*p.x*p.y*d.y-c.y*l.x*h.y*p.x*p.y*d.x+c.y*l.y*h.x*p.x*p.y*d.x+l.x*l.y*h.x*h.y*p.x*d.y-l.x*l.y*h.x*h.y*p.y*d.x+l.x*v.x*h.y*p.x*p.y*d.y+l.x*v.y*h.y*p.x*p.y*d.x+l.x*m.x*h.y*p.x*p.y*u.y+l.x*h.y*p.x*m.y*u.x*p.y-v.x*l.y*h.x*p.x*p.y*d.y-6*v.x*l.y*h.y*p.x*p.y*d.x-l.y*h.x*v.y*p.x*p.y*d.x-l.y*h.x*m.x*p.x*p.y*u.y-l.y*h.x*p.x*m.y*u.x*p.y-6*l.y*m.x*h.y*p.x*u.x*p.y-6*c.x*v.x*O*d.x-6*c.x*m.x*u.x*O-2*c.x*R*p.x*d.x+6*v.x*m.x*u.x*O+2*v.x*R*p.x*d.x+2*m.x*R*p.x*u.x+2*c.y*k*p.y*d.y-6*c.x*c.y*p.x*M*d.x+3*c.x*l.x*h.x*M*d.y-2*c.x*l.x*h.y*M*d.x-4*c.x*l.y*h.x*M*d.x+3*c.y*l.x*h.x*M*d.x+6*c.x*c.y*D*p.y*d.y+6*c.x*v.x*p.x*M*d.y-3*c.x*l.y*h.y*D*d.y+2*c.x*h.x*P*p.x*d.y+2*c.x*h.x*P*p.y*d.x+6*c.x*v.y*p.x*M*d.x+6*c.x*m.x*p.x*M*u.y+6*c.x*p.x*m.y*u.x*M+4*c.y*l.x*h.y*D*d.y+6*c.y*v.x*p.x*M*d.x+2*c.y*l.y*h.x*D*d.y-3*c.y*l.y*h.y*D*d.x+2*c.y*h.x*P*p.x*d.x+6*c.y*m.x*p.x*u.x*M-3*l.x*v.x*h.x*M*d.y+2*l.x*v.x*h.y*M*d.x+l.x*l.y*P*p.x*d.x-3*l.x*h.x*v.y*M*d.x-3*l.x*h.x*m.x*M*u.y-3*l.x*h.x*m.y*u.x*M+2*l.x*m.x*h.y*u.x*M+4*v.x*l.y*h.x*M*d.x+4*l.y*h.x*m.x*u.x*M-2*c.x*S*h.y*p.y*d.y-6*c.y*v.x*D*p.y*d.y-6*c.y*v.y*D*p.y*d.x-6*c.y*m.x*D*p.y*u.y-2*c.y*S*h.y*p.x*d.y-2*c.y*S*h.y*p.y*d.x-6*c.y*D*m.y*u.x*p.y-l.x*l.y*S*p.y*d.y-2*l.x*I*p.x*p.y*d.x+3*v.x*l.y*h.y*D*d.y-2*v.x*h.x*P*p.x*d.y-2*v.x*h.x*P*p.y*d.x-6*v.x*v.y*p.x*M*d.x-6*v.x*m.x*p.x*M*u.y-6*v.x*p.x*m.y*u.x*M+3*l.y*v.y*h.y*D*d.x+3*l.y*m.x*h.y*D*u.y+3*l.y*h.y*D*m.y*u.x-2*h.x*v.y*P*p.x*d.x-2*h.x*m.x*P*p.x*u.y-2*h.x*m.x*P*u.x*p.y-2*h.x*P*p.x*m.y*u.x-6*v.y*m.x*p.x*u.x*M-I*h.x*h.y*p.x*d.x+2*v.x*S*h.y*p.y*d.y+6*v.y*D*m.y*u.x*p.y+2*T*l.y*p.x*p.y*d.y+T*h.x*h.y*p.y*d.y+2*S*v.y*h.y*p.y*d.x+2*S*m.x*h.y*p.y*u.y+2*S*h.y*m.y*u.x*p.y+t*O+3*x*O*d.x-3*E*B*d.y+3*N*O*d.x+L*D*d.x-b*M*d.y-l.x*I*D*d.y+T*l.y*M*d.x-3*x*p.x*M*d.y+3*E*D*p.y*d.x-T*P*p.x*d.y+I*S*p.y*d.x-3*e*p.x*m.y*M-3*N*p.x*M*d.y+3*n*D*p.y*d.x+l.x*h.x*p.x*p.y*(6*v.y*d.y+6*m.y*u.y)+k*p.y*(-2*v.y*d.y-2*m.y*u.y)+c.y*B*(6*v.y*d.y+6*m.y*u.y)+l.y*h.x*D*(-2*v.y*d.y-2*m.y*u.y)+S*h.y*p.x*(2*v.y*d.y+2*m.y*u.y)+l.x*h.y*D*(-4*v.y*d.y-4*m.y*u.y)+c.x*D*p.y*(-6*v.y*d.y-6*m.y*u.y)+v.x*D*p.y*(6*v.y*d.y+6*m.y*u.y)+m.x*D*p.y*(6*v.y*u.y+3*a)+B*(-2*v.y*m.y*u.y-n*d.y-m.y*(2*v.y*u.y+a)-v.y*(2*v.y*d.y+2*m.y*u.y)),-c.x*l.x*h.y*p.x*p.y*u.y+c.x*l.y*h.x*p.x*p.y*u.y+6*c.x*l.y*h.y*p.x*u.x*p.y-6*c.y*l.x*h.x*p.x*p.y*u.y-c.y*l.x*h.y*p.x*u.x*p.y+c.y*l.y*h.x*p.x*u.x*p.y+l.x*l.y*h.x*h.y*p.x*u.y-l.x*l.y*h.x*h.y*u.x*p.y+l.x*v.x*h.y*p.x*p.y*u.y+l.x*v.y*h.y*p.x*u.x*p.y+l.x*m.x*h.y*p.x*m.y*p.y-v.x*l.y*h.x*p.x*p.y*u.y-6*v.x*l.y*h.y*p.x*u.x*p.y-l.y*h.x*v.y*p.x*u.x*p.y-l.y*h.x*m.x*p.x*m.y*p.y-6*c.x*v.x*u.x*O-2*c.x*R*p.x*u.x+2*v.x*R*p.x*u.x+2*c.y*k*p.y*u.y-6*c.x*c.y*p.x*u.x*M+3*c.x*l.x*h.x*M*u.y-2*c.x*l.x*h.y*u.x*M-4*c.x*l.y*h.x*u.x*M+3*c.y*l.x*h.x*u.x*M+6*c.x*c.y*D*p.y*u.y+6*c.x*v.x*p.x*M*u.y-3*c.x*l.y*h.y*D*u.y+2*c.x*h.x*P*p.x*u.y+2*c.x*h.x*P*u.x*p.y+6*c.x*v.y*p.x*u.x*M+6*c.x*m.x*p.x*m.y*M+4*c.y*l.x*h.y*D*u.y+6*c.y*v.x*p.x*u.x*M+2*c.y*l.y*h.x*D*u.y-3*c.y*l.y*h.y*D*u.x+2*c.y*h.x*P*p.x*u.x-3*l.x*v.x*h.x*M*u.y+2*l.x*v.x*h.y*u.x*M+l.x*l.y*P*p.x*u.x-3*l.x*h.x*v.y*u.x*M-3*l.x*h.x*m.x*m.y*M+4*v.x*l.y*h.x*u.x*M-2*c.x*S*h.y*p.y*u.y-6*c.y*v.x*D*p.y*u.y-6*c.y*v.y*D*u.x*p.y-6*c.y*m.x*D*m.y*p.y-2*c.y*S*h.y*p.x*u.y-2*c.y*S*h.y*u.x*p.y-l.x*l.y*S*p.y*u.y-2*l.x*I*p.x*u.x*p.y+3*v.x*l.y*h.y*D*u.y-2*v.x*h.x*P*p.x*u.y-2*v.x*h.x*P*u.x*p.y-6*v.x*v.y*p.x*u.x*M-6*v.x*m.x*p.x*m.y*M+3*l.y*v.y*h.y*D*u.x+3*l.y*m.x*h.y*D*m.y-2*h.x*v.y*P*p.x*u.x-2*h.x*m.x*P*p.x*m.y-I*h.x*h.y*p.x*u.x+2*v.x*S*h.y*p.y*u.y-3*l.y*e*h.y*p.x*p.y+6*v.y*m.x*D*m.y*p.y+2*T*l.y*p.x*p.y*u.y+T*h.x*h.y*p.y*u.y+2*S*v.y*h.y*u.x*p.y+2*S*m.x*h.y*m.y*p.y-3*c.x*e*O+3*v.x*e*O+3*x*u.x*O-3*E*B*u.y+3*N*u.x*O+e*R*p.x+L*D*u.x-b*M*u.y+3*c.y*e*p.x*M-l.x*I*D*u.y+l.x*e*h.y*M+2*l.y*h.x*e*M+T*l.y*u.x*M-h.x*e*P*p.y-3*v.y*e*p.x*M-3*x*p.x*M*u.y+3*E*D*u.x*p.y-T*P*p.x*u.y+I*S*u.x*p.y-3*N*p.x*M*u.y+3*n*D*u.x*p.y+S*h.y*p.x*(2*v.y*u.y+a)+l.x*h.x*p.x*p.y*(6*v.y*u.y+3*a)+k*p.y*(-2*v.y*u.y-a)+c.y*B*(6*v.y*u.y+3*a)+l.y*h.x*D*(-2*v.y*u.y-a)+l.x*h.y*D*(-4*v.y*u.y-2*a)+c.x*D*p.y*(-6*v.y*u.y-3*a)+v.x*D*p.y*(6*v.y*u.y+3*a)+B*(-2*v.y*a-n*u.y-v.y*(2*v.y*u.y+a)),-c.x*l.x*h.y*p.x*m.y*p.y+c.x*l.y*h.x*p.x*m.y*p.y+6*c.x*l.y*m.x*h.y*p.x*p.y-6*c.y*l.x*h.x*p.x*m.y*p.y-c.y*l.x*m.x*h.y*p.x*p.y+c.y*l.y*h.x*m.x*p.x*p.y-l.x*l.y*h.x*m.x*h.y*p.y+l.x*l.y*h.x*h.y*p.x*m.y+l.x*v.x*h.y*p.x*m.y*p.y+6*l.x*h.x*v.y*p.x*m.y*p.y+l.x*v.y*m.x*h.y*p.x*p.y-v.x*l.y*h.x*p.x*m.y*p.y-6*v.x*l.y*m.x*h.y*p.x*p.y-l.y*h.x*v.y*m.x*p.x*p.y-6*c.x*v.x*m.x*O-2*c.x*m.x*R*p.x+6*c.y*v.y*B*m.y+2*v.x*m.x*R*p.x+2*c.y*k*m.y*p.y-2*k*v.y*m.y*p.y-6*c.x*c.y*m.x*p.x*M+3*c.x*l.x*h.x*m.y*M-2*c.x*l.x*m.x*h.y*M-4*c.x*l.y*h.x*m.x*M+3*c.y*l.x*h.x*m.x*M+6*c.x*c.y*D*m.y*p.y+6*c.x*v.x*p.x*m.y*M-3*c.x*l.y*h.y*D*m.y+2*c.x*h.x*m.x*P*p.y+2*c.x*h.x*P*p.x*m.y+6*c.x*v.y*m.x*p.x*M+4*c.y*l.x*h.y*D*m.y+6*c.y*v.x*m.x*p.x*M+2*c.y*l.y*h.x*D*m.y-3*c.y*l.y*m.x*h.y*D+2*c.y*h.x*m.x*P*p.x-3*l.x*v.x*h.x*m.y*M+2*l.x*v.x*m.x*h.y*M+l.x*l.y*m.x*P*p.x-3*l.x*h.x*v.y*m.x*M+4*v.x*l.y*h.x*m.x*M-6*c.x*v.y*D*m.y*p.y-2*c.x*S*h.y*m.y*p.y-6*c.y*v.x*D*m.y*p.y-6*c.y*v.y*m.x*D*p.y-2*c.y*S*m.x*h.y*p.y-2*c.y*S*h.y*p.x*m.y-l.x*l.y*S*m.y*p.y-4*l.x*v.y*h.y*D*m.y-2*l.x*I*m.x*p.x*p.y+3*v.x*l.y*h.y*D*m.y-2*v.x*h.x*m.x*P*p.y-2*v.x*h.x*P*p.x*m.y-6*v.x*v.y*m.x*p.x*M-2*l.y*h.x*v.y*D*m.y+3*l.y*v.y*m.x*h.y*D-2*h.x*v.y*m.x*P*p.x-I*h.x*m.x*h.y*p.x+6*v.x*v.y*D*m.y*p.y+2*v.x*S*h.y*m.y*p.y+2*T*l.y*p.x*m.y*p.y+T*h.x*h.y*m.y*p.y+2*S*v.y*m.x*h.y*p.y+2*S*v.y*h.y*p.x*m.y+3*x*m.x*O-3*E*B*m.y+3*N*m.x*O+L*m.x*D-b*m.y*M-3*n*B*m.y-l.x*I*D*m.y+T*l.y*m.x*M-3*x*p.x*m.y*M+3*E*m.x*D*p.y-T*P*p.x*m.y+I*S*m.x*p.y-3*N*p.x*m.y*M+3*n*m.x*D*p.y,c.x*c.y*l.x*h.y*p.x*p.y-c.x*c.y*l.y*h.x*p.x*p.y+c.x*l.x*l.y*h.x*h.y*p.y-c.y*l.x*l.y*h.x*h.y*p.x-c.x*l.x*v.y*h.y*p.x*p.y+6*c.x*v.x*l.y*h.y*p.x*p.y+c.x*l.y*h.x*v.y*p.x*p.y-c.y*l.x*v.x*h.y*p.x*p.y-6*c.y*l.x*h.x*v.y*p.x*p.y+c.y*v.x*l.y*h.x*p.x*p.y-l.x*v.x*l.y*h.x*h.y*p.y+l.x*l.y*h.x*v.y*h.y*p.x+l.x*v.x*v.y*h.y*p.x*p.y-v.x*l.y*h.x*v.y*p.x*p.y-2*c.x*v.x*R*p.x+2*c.y*k*v.y*p.y-3*c.x*c.y*l.x*h.x*M-6*c.x*c.y*v.x*p.x*M+3*c.x*c.y*l.y*h.y*D-2*c.x*c.y*h.x*P*p.x-2*c.x*l.x*v.x*h.y*M-c.x*l.x*l.y*P*p.x+3*c.x*l.x*h.x*v.y*M-4*c.x*v.x*l.y*h.x*M+3*c.y*l.x*v.x*h.x*M+6*c.x*c.y*v.y*D*p.y+2*c.x*c.y*S*h.y*p.y+2*c.x*l.x*I*p.x*p.y+2*c.x*v.x*h.x*P*p.y+6*c.x*v.x*v.y*p.x*M-3*c.x*l.y*v.y*h.y*D+2*c.x*h.x*v.y*P*p.x+c.x*I*h.x*h.y*p.x+c.y*l.x*l.y*S*p.y+4*c.y*l.x*v.y*h.y*D-3*c.y*v.x*l.y*h.y*D+2*c.y*v.x*h.x*P*p.x+2*c.y*l.y*h.x*v.y*D+l.x*v.x*l.y*P*p.x-3*l.x*v.x*h.x*v.y*M-2*c.x*S*v.y*h.y*p.y-6*c.y*v.x*v.y*D*p.y-2*c.y*v.x*S*h.y*p.y-2*c.y*T*l.y*p.x*p.y-c.y*T*h.x*h.y*p.y-2*c.y*S*v.y*h.y*p.x-2*l.x*v.x*I*p.x*p.y-l.x*l.y*S*v.y*p.y+3*v.x*l.y*v.y*h.y*D-2*v.x*h.x*v.y*P*p.x-v.x*I*h.x*h.y*p.x+3*E*l.x*h.x*p.x*p.y+3*l.x*h.x*n*p.x*p.y+2*v.x*S*v.y*h.y*p.y-3*x*l.y*h.y*p.x*p.y+2*T*l.y*v.y*p.x*p.y+T*h.x*v.y*h.y*p.y-3*N*l.y*h.y*p.x*p.y-w*O+C*B+F*O-i*B-3*c.x*N*O-c.x*L*D+3*x*v.x*O+c.y*b*M+3*c.y*n*B+v.x*L*D+x*R*p.x-3*E*v.y*B-E*k*p.y+N*R*p.x-b*v.y*M-k*n*p.y-c.x*T*l.y*M+c.y*l.x*I*D-3*c.x*E*D*p.y-c.x*I*S*p.y+c.y*T*P*p.x-l.x*I*v.y*D+3*x*c.y*p.x*M+x*l.x*h.y*M+2*x*l.y*h.x*M-2*E*l.x*h.y*D-E*l.y*h.x*D+T*v.x*l.y*M-3*c.x*n*D*p.y+3*c.y*N*p.x*M+l.x*N*h.y*M-2*l.x*n*h.y*D+v.x*I*S*p.y-l.y*h.x*n*D-x*h.x*P*p.y-3*x*v.y*p.x*M+3*E*v.x*D*p.y+E*S*h.y*p.x-T*v.y*P*p.x+2*N*l.y*h.x*M+3*v.x*n*D*p.y-N*h.x*P*p.y-3*N*v.y*p.x*M+S*n*h.y*p.x).getRootsInInterval(0,1)),V=0;V<z.length;V++){var U=z[V],H=new Polynomial(p.x,h.x,l.x,c.x-v.x-U*m.x-U*U*u.x-U*U*U*d.x).getRoots(),Z=new Polynomial(p.y,h.y,l.y,c.y-v.y-U*m.y-U*U*u.y-U*U*U*d.y).getRoots();if(0<H.length&&0<Z.length)t:for(var W=0;W<H.length;W++){var G=H[W];if(0<=G&&G<=1)for(var Y=0;Y<Z.length;Y++)if(Math.abs(G-Z[Y])<1e-4){g.points.push(d.multiply(U*U*U).add(u.multiply(U*U).add(m.multiply(U).add(v))));break t}}}return 0<g.points.length&&(g.status="Intersection"),g},Ze.intersectBezier3Circle=function(t,e,i,n,o,s){return Ze.intersectBezier3Ellipse(t,e,i,n,o,s,s)},Ze.intersectBezier3Ellipse=function(t,e,i,n,o,s,r){var a,h=new Ze("No Intersection"),l=t.multiply(-1),c=e.multiply(3),d=i.multiply(-3),u=(n=l.add(c.add(d.add(n))),new Vector2D(n.x,n.y));l=t.multiply(3),c=e.multiply(-6),d=i.multiply(3),n=l.add(c.add(d)),a=new Vector2D(n.x,n.y),l=t.multiply(-3),c=e.multiply(3),d=l.add(c);for(var g=new Vector2D(d.x,d.y),_=new Vector2D(t.x,t.y),f=(s=s*s,r=r*r,new Polynomial(u.x*u.x*r+u.y*u.y*s,2*(u.x*a.x*r+u.y*a.y*s),2*(u.x*g.x*r+u.y*g.y*s)+a.x*a.x*r+a.y*a.y*s,2*u.x*r*(_.x-o.x)+2*u.y*s*(_.y-o.y)+2*(a.x*g.x*r+a.y*g.y*s),2*a.x*r*(_.x-o.x)+2*a.y*s*(_.y-o.y)+g.x*g.x*r+g.y*g.y*s,2*g.x*r*(_.x-o.x)+2*g.y*s*(_.y-o.y),_.x*_.x*r-2*_.y*o.y*s-2*_.x*o.x*r+_.y*_.y*s+o.x*o.x*r+o.y*o.y*s-s*r).getRootsInInterval(0,1)),A=0;A<f.length;A++){var y=f[A];h.points.push(u.multiply(y*y*y).add(a.multiply(y*y).add(g.multiply(y).add(_))))}return 0<h.points.length&&(h.status="Intersection"),h},Ze.intersectBezier3Line=function(t,e,i,n,o,s){var r,a=o.min(s),h=o.max(s),l=new Ze("No Intersection"),c=t.multiply(-1),d=e.multiply(3),u=i.multiply(-3),g=c.add(d.add(u.add(n))),_=new Vector2D(g.x,g.y);c=t.multiply(3),d=e.multiply(-6),u=i.multiply(3),g=c.add(d.add(u)),r=new Vector2D(g.x,g.y),c=t.multiply(-3),d=e.multiply(3),u=c.add(d),g=new Vector2D(u.x,u.y),c=new Vector2D(t.x,t.y),d=new Vector2D(o.y-s.y,s.x-o.x),u=o.x*s.y-s.x*o.y,roots=new Polynomial(d.dot(_),d.dot(r),d.dot(g),d.dot(c)+u).getRoots();for(var f=0;f<roots.length;f++){var A,y,p,m=roots[f];0<=m&&m<=1&&(y=t.lerp(e,m),A=e.lerp(i,m),p=i.lerp(n,m),y=y.lerp(A,m),p=A.lerp(p,m),m=y.lerp(p,m),o.x==s.x?a.y<=m.y&&m.y<=h.y&&(l.status="Intersection",l.appendPoint(m)):o.y==s.y?a.x<=m.x&&m.x<=h.x&&(l.status="Intersection",l.appendPoint(m)):m.gte(a)&&m.lte(h)&&(l.status="Intersection",l.appendPoint(m)))}return l},Ze.intersectBezier3Polygon=function(t,e,i,n,o){for(var s=new Ze("No Intersection"),r=o.length,a=0;a<r;a++){var h=o[a],l=o[(a+1)%r];l=Ze.intersectBezier3Line(t,e,i,n,h,l);s.appendPoints(l.points)}return 0<s.points.length&&(s.status="Intersection"),s},Ze.intersectBezier3Rectangle=function(t,e,i,n,o,s){var r=o.min(s),a=o.max(s),h=new $Vec2(a.x,r.y);o=new $Vec2(r.x,a.y),s=Ze.intersectBezier3Line(t,e,i,n,r,h),h=Ze.intersectBezier3Line(t,e,i,n,h,a),a=Ze.intersectBezier3Line(t,e,i,n,a,o),o=Ze.intersectBezier3Line(t,e,i,n,o,r);return(r=new Ze("No Intersection")).appendPoints(s.points),r.appendPoints(h.points),r.appendPoints(a.points),r.appendPoints(o.points),0<r.points.length&&(r.status="Intersection"),r},Ze.intersectCircleCircle=function(t,e,i,n){var o,s=e+n,r=Math.abs(e-n),a=t.distanceFrom(i);return s<a?o=new Ze("Outside"):a<r?o=new Ze("Inside"):(o=new Ze("Intersection"),n=(e*e-n*n+a*a)/(2*a),e=Math.sqrt(e*e-n*n),n=t.lerp(i,n/a),a=e/a,o.points.push(new $Vec2(n.x-a*(i.y-t.y),n.y+a*(i.x-t.x))),o.points.push(new $Vec2(n.x+a*(i.y-t.y),n.y-a*(i.x-t.x)))),o},Ze.intersectCircleEllipse=function(t,e,i,n,o){return Ze.intersectEllipseEllipse(t,e,e,i,n,o)},Ze.intersectCircleLine=function(t,e,i,n){var o,s=(n.x-i.x)*(n.x-i.x)+(n.y-i.y)*(n.y-i.y),r=2*((n.x-i.x)*(i.x-t.x)+(n.y-i.y)*(i.y-t.y));return(t=r*r-4*s*(t.x*t.x+t.y*t.y+i.x*i.x+i.y*i.y-2*(t.x*i.x+t.y*i.y)-e*e))<0?o=new Ze("Outside"):0==t?o=new Ze("Tangent"):(t=(-r-(e=Math.sqrt(t)))/(2*s),((s=(-r+e)/(2*s))<0||1<s)&&(t<0||1<t)?o=new Ze(s<0&&t<0||1<s&&1<t?"Outside":"Inside"):(o=new Ze("Intersection"),0<=s&&s<=1&&o.points.push(i.lerp(n,s)),0<=t&&t<=1&&o.points.push(i.lerp(n,t)))),o},Ze.intersectCirclePolygon=function(t,e,i){for(var n=new Ze("No Intersection"),o=i.length,s=0;s<o;s++){var r=i[s],a=i[(s+1)%o],h=Ze.intersectCircleLine(t,e,r,a);n.appendPoints(h.points)}return 0<n.points.length?n.status="Intersection":n.status=h.status,n},Ze.intersectCircleRectangle=function(t,e,i,n){var o=i.min(n),s=i.max(n),r=new $Vec2(s.x,o.y);i=new $Vec2(o.x,s.y),n=Ze.intersectCircleLine(t,e,o,r),r=Ze.intersectCircleLine(t,e,r,s),s=Ze.intersectCircleLine(t,e,s,i),i=Ze.intersectCircleLine(t,e,i,o);return(o=new Ze("No Intersection")).appendPoints(n.points),o.appendPoints(r.points),o.appendPoints(s.points),o.appendPoints(i.points),0<o.points.length?o.status="Intersection":o.status=n.status,o},Ze.intersectEllipseEllipse=function(t,e,i,n,o,s){for(var r=[i*i,0,e*e,-2*i*i*t.x,-2*e*e*t.y,i*i*t.x*t.x+e*e*t.y*t.y-e*e*i*i],a=[s*s,0,o*o,-2*s*s*n.x,-2*o*o*n.y,s*s*n.x*n.x+o*o*n.y*n.y-o*o*s*s],h=Ze.bezout(r,a).getRoots(),l=.001*(r[0]*r[0]+2*r[1]*r[1]+r[2]*r[2]),c=.001*(a[0]*a[0]+2*a[1]*a[1]+a[2]*a[2]),d=new Ze("No Intersection"),u=0;u<h.length;u++)for(var g=new Polynomial(r[0],r[3]+h[u]*r[1],r[5]+h[u]*(r[4]+h[u]*r[2])).getRoots(),_=0;_<g.length;_++){var f=(r[0]*g[_]+r[1]*h[u]+r[3])*g[_]+(r[2]*h[u]+r[4])*h[u]+r[5];Math.abs(f)<l&&(f=(a[0]*g[_]+a[1]*h[u]+a[3])*g[_]+(a[2]*h[u]+a[4])*h[u]+a[5],Math.abs(f)<c&&d.appendPoint(new $Vec2(g[_],h[u])))}return 0<d.points.length&&(d.status="Intersection"),d},Ze.intersectEllipseLine=function(t,e,i,n,o){var s,r=new Vector2D(n.x,n.y),a=Vector2D.fromPoints(n,o),h=new Vector2D(t.x,t.y);r=r.subtract(h),h=new Vector2D(a.x/(e*e),a.y/(i*i)),i=new Vector2D(r.x/(e*e),r.y/(i*i)),h=a.dot(h);return(i=(a=a.dot(i))*a-h*(t=r.dot(i)-1))<0?s=new Ze("Outside"):0<i?(i=(-a+(t=Math.sqrt(i)))/h,((t=(-a-t)/h)<0||1<t)&&(i<0||1<i)?s=new Ze(t<0&&i<0||1<t&&1<i?"Outside":"Inside"):(s=new Ze("Intersection"),0<=t&&t<=1&&s.appendPoint(n.lerp(o,t)),0<=i&&i<=1&&s.appendPoint(n.lerp(o,i)))):0<=(h=-a/h)&&h<=1?(s=new Ze("Intersection")).appendPoint(n.lerp(o,h)):s=new Ze("Outside"),s},Ze.intersectEllipsePolygon=function(t,e,i,n){for(var o=new Ze("No Intersection"),s=n.length,r=0;r<s;r++){var a=n[r],h=n[(r+1)%s];h=Ze.intersectEllipseLine(t,e,i,a,h);o.appendPoints(h.points)}return 0<o.points.length&&(o.status="Intersection"),o},Ze.intersectEllipseRectangle=function(t,e,i,n,o){var s=n.min(o),r=n.max(o),a=new $Vec2(r.x,s.y);n=new $Vec2(s.x,r.y),o=Ze.intersectEllipseLine(t,e,i,s,a),a=Ze.intersectEllipseLine(t,e,i,a,r),r=Ze.intersectEllipseLine(t,e,i,r,n),n=Ze.intersectEllipseLine(t,e,i,n,s);return(s=new Ze("No Intersection")).appendPoints(o.points),s.appendPoints(a.points),s.appendPoints(r.points),s.appendPoints(n.points),0<s.points.length&&(s.status="Intersection"),s},Ze.intersectLineLine=function(t,e,i,n){var o,s=(n.x-i.x)*(t.y-i.y)-(n.y-i.y)*(t.x-i.x),r=(e.x-t.x)*(t.y-i.y)-(e.y-t.y)*(t.x-i.x);return 0!=(n=(n.y-i.y)*(e.x-t.x)-(n.x-i.x)*(e.y-t.y))?(i=r/n,0<=(n=s/n)&&n<=1&&0<=i&&i<=1?(o=new Ze("Intersection")).points.push(new $Vec2(t.x+n*(e.x-t.x),t.y+n*(e.y-t.y))):o=new Ze("No Intersection")):o=new Ze(0==s||0==r?"Coincident":"Parallel"),o},Ze.intersectLinePolygon=function(t,e,i){for(var n=new Ze("No Intersection"),o=i.length,s=0;s<o;s++){var r=i[s],a=i[(s+1)%o];a=Ze.intersectLineLine(t,e,r,a);n.appendPoints(a.points)}return 0<n.points.length&&(n.status="Intersection"),n},Ze.intersectLineRectangle=function(t,e,i,n){var o=i.min(n),s=i.max(n),r=new $Vec2(s.x,o.y);i=new $Vec2(o.x,s.y),n=Ze.intersectLineLine(o,r,t,e),r=Ze.intersectLineLine(r,s,t,e),s=Ze.intersectLineLine(s,i,t,e),t=Ze.intersectLineLine(i,o,t,e);return(e=new Ze("No Intersection")).appendPoints(n.points),e.appendPoints(r.points),e.appendPoints(s.points),e.appendPoints(t.points),0<e.points.length&&(e.status="Intersection"),e},Ze.intersectPolygonPolygon=function(t,e){for(var i=new Ze("No Intersection"),n=t.length,o=0;o<n;o++){var s=t[o],r=t[(o+1)%n];r=Ze.intersectLinePolygon(s,r,e);i.appendPoints(r.points)}return 0<i.points.length&&(i.status="Intersection"),i},Ze.intersectPolygonRectangle=function(t,e,i){var n=e.min(i),o=e.max(i),s=new $Vec2(o.x,n.y);e=new $Vec2(n.x,o.y),i=Ze.intersectLinePolygon(n,s,t),s=Ze.intersectLinePolygon(s,o,t),o=Ze.intersectLinePolygon(o,e,t),n=Ze.intersectLinePolygon(e,n,t);return(t=new Ze("No Intersection")).appendPoints(i.points),t.appendPoints(s.points),t.appendPoints(o.points),t.appendPoints(n.points),0<t.points.length&&(t.status="Intersection"),t},Ze.intersectRayRay=function(t,e,i,n){var o,s=(n.x-i.x)*(t.y-i.y)-(n.y-i.y)*(t.x-i.x),r=(e.x-t.x)*(t.y-i.y)-(e.y-t.y)*(t.x-i.x);return 0!=(i=(n.y-i.y)*(e.x-t.x)-(n.x-i.x)*(e.y-t.y))?(i=s/i,(o=new Ze("Intersection")).points.push(new $Vec2(t.x+i*(e.x-t.x),t.y+i*(e.y-t.y)))):o=new Ze(0==s||0==r?"Coincident":"Parallel"),o},Ze.intersectRectangleRectangle=function(t,e,i,n){var o=t.min(e),s=t.max(e),r=new $Vec2(s.x,o.y);t=new $Vec2(o.x,s.y),e=Ze.intersectLineRectangle(o,r,i,n),r=Ze.intersectLineRectangle(r,s,i,n),s=Ze.intersectLineRectangle(s,t,i,n),i=Ze.intersectLineRectangle(t,o,i,n);return(n=new Ze("No Intersection")).appendPoints(e.points),n.appendPoints(r.points),n.appendPoints(s.points),n.appendPoints(i.points),0<n.points.length&&(n.status="Intersection"),n},Ze.bezout=function(t,e){var i=t[0]*e[1]-e[0]*t[1],n=t[0]*e[2]-e[0]*t[2],o=t[0]*e[3]-e[0]*t[3],s=t[0]*e[4]-e[0]*t[4],r=t[0]*e[5]-e[0]*t[5],a=t[1]*e[2]-e[1]*t[2],h=t[1]*e[4]-e[1]*t[4],l=t[1]*e[5]-e[1]*t[5],c=t[2]*e[3]-e[2]*t[3],d=t[3]*e[4]-e[3]*t[4];t=t[3]*e[5]-e[3]*t[5],d=l+d,c=h-c;return new Polynomial(i*a-n*n,i*c+o*a-2*n*s,i*d+o*c-s*s-2*n*r,i*t+o*d-2*s*r,o*t-r*r)},n.algorithm.Intersection=Ze}();
},{}]},{},["XaHR"], null)
//# sourceMappingURL=b2.min.391f4f60.js.map